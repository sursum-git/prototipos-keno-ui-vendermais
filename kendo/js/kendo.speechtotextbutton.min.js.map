{"version":3,"file":"kendo.speechtotextbutton.min.js","names":[],"sources":["../../node_modules/@progress/kendo-webspeech-common/dist/es/webspeech/speechrecognition.js","../../src/kendo.speechtotextbutton.js"],"sourcesContent":["const START = \"start\";\nconst END = \"end\";\nconst RESULT = \"result\";\nconst ERROR = \"error\";\nconst DEFAULT_SPEECH_OPTIONS = {\n    lang: 'en-US',\n    continuous: false,\n    interimResults: false,\n    maxAlternatives: 1,\n    events: {\n        [START]: null,\n        [END]: null,\n        [RESULT]: null,\n        [ERROR]: null\n    }\n};\nfunction getSpeechRecognitionCtor() {\n    return window ? (window.SpeechRecognition || window.webkitSpeechRecognition) : undefined;\n}\nexport class KendoSpeechRecognition {\n    constructor(options) {\n        this.recognition = null;\n        this.isListening = false;\n        this.options = { ...DEFAULT_SPEECH_OPTIONS };\n        this.handleResult = (event) => {\n            this.triggerOnResult(event);\n        };\n        this.handleError = (event) => {\n            this.triggerOnError(event);\n        };\n        this.handleEnd = () => {\n            this.triggerOnEnd();\n            this.isListening = false;\n        };\n        this.handleStart = () => {\n            this.triggerOnStart();\n            this.isListening = true;\n        };\n        this.init(options);\n    }\n    init(options) {\n        const RecognitionCtor = getSpeechRecognitionCtor();\n        if (!RecognitionCtor) {\n            console.error('Speech recognition is not supported in this browser.');\n            this.recognition = null;\n            return;\n        }\n        this.recognition = new RecognitionCtor();\n        this.setOptions(options);\n        this.bindEvents();\n    }\n    destroy() {\n        this.unbindEvents();\n        this.isListening = false;\n    }\n    bindEvents() {\n        if (!this.recognition) {\n            return;\n        }\n        this.recognition.onresult = this.handleResult;\n        this.recognition.onerror = this.handleError;\n        this.recognition.onend = this.handleEnd;\n        this.recognition.onstart = this.handleStart;\n    }\n    unbindEvents() {\n        if (this.recognition) {\n            this.recognition.onresult = null;\n            this.recognition.onerror = null;\n            this.recognition.onend = null;\n            this.recognition.onstart = null;\n            this.recognition.abort();\n            this.recognition = null;\n        }\n    }\n    setOptions(options) {\n        if (!this.recognition) {\n            return;\n        }\n        const mergedEvents = { ...this.options.events, ...options.events };\n        this.options = {\n            ...this.options,\n            ...options,\n            events: mergedEvents\n        };\n        const { lang, continuous, interimResults, maxAlternatives } = this.options;\n        Object.assign(this.recognition, { lang, continuous, interimResults, maxAlternatives });\n    }\n    triggerOnStart() {\n        if (this.options.events[START]) {\n            this.options.events[START]();\n        }\n    }\n    triggerOnEnd() {\n        if (this.options.events[END]) {\n            this.options.events[END]();\n        }\n    }\n    triggerOnResult(event) {\n        if (this.options.events[RESULT]) {\n            this.options.events[RESULT](event);\n        }\n    }\n    triggerOnError(event) {\n        if (this.options.events[ERROR]) {\n            this.options.events[ERROR](event);\n        }\n    }\n    start() {\n        if (this.recognition && !this.isListening) {\n            this.recognition.start();\n        }\n    }\n    stop() {\n        if (this.recognition && this.isListening) {\n            this.recognition.stop();\n        }\n    }\n    abort() {\n        if (this.recognition && this.isListening) {\n            this.recognition.abort();\n        }\n    }\n    isSupported() {\n        return !!getSpeechRecognitionCtor();\n    }\n    isActive() {\n        return this.isListening;\n    }\n}\n","import \"./kendo.core.js\";\nimport \"./kendo.button.js\";\nimport { KendoSpeechRecognition } from '@progress/kendo-webspeech-common';\n\nexport const __meta__ = {\n    id: \"speechtotextbutton\",\n    name: \"SpeechToTextButton\",\n    category: \"web\",\n    description: \"The SpeechToTextButton widget is an extension of the Kendo UI Button that allows for speech-to-text input.\",\n    depends: [\"core\", \"button\"]\n};\n\n(function($, undefined) {\n    const kendo = window.kendo,\n        ui = kendo.ui,\n        Button = ui.Button;\n\n    const SpeechToTextButton = Button.extend({\n        init: function(element, options) {\n            Button.fn.init.call(this, element, $.extend({ icon: this.options.icon }, options));\n            $(element).addClass(\"k-speech-to-text-button\").attr(\"aria-live\", \"polite\");\n            this._isListening = false;\n            this._initSpeechRecognition();\n            this._updateIcon();\n        },\n\n        _initSpeechRecognition: function() {\n            if (this.options.integrationMode !== 'webSpeech') {\n                return;\n            }\n\n            if (!KendoSpeechRecognition) {\n                this.enable(false);\n                return;\n            }\n\n            const self = this;\n            this.speechRecognition = new KendoSpeechRecognition({\n                lang: this.options.lang,\n                interimResults: this.options.interimResults,\n                maxAlternatives: this.options.maxAlternatives,\n                continuous: this.options.continuous,\n                events: {\n                    start: function() { self._handleStart(); },\n                    end: function() { self._handleEnd(); },\n                    result: function(e) { self._handleResult(e); },\n                    error: function(e) { self._handleError(e); }\n                }\n            });\n\n            if (!this.speechRecognition.isSupported()) {\n                this.enable(false);\n                this.trigger(\"error\", { error: this.options.messages.unsupported });\n            }\n        },\n\n        _handleStart: function() {\n            this._isListening = true;\n            this.element.addClass(\"k-listening\");\n            this._updateIcon();\n            this.trigger(\"start\");\n        },\n        _handleEnd: function() {\n            this._isListening = false;\n            this.element.removeClass(\"k-listening\");\n            this._updateIcon();\n            this.trigger(\"end\");\n        },\n        _handleResult: function(e) {\n            const results = e.results;\n            const lastResult = results[results.length - 1];\n            const alternatives = [];\n            for (let i = 0; i < lastResult.length; i++) {\n                alternatives.push({\n                    transcript: lastResult[i].transcript,\n                    confidence: lastResult[i].confidence\n                });\n            }\n            this.trigger(\"result\", {\n                isFinal: lastResult.isFinal,\n                alternatives: alternatives\n            });\n        },\n        _handleError: function(e) {\n            this._isListening = false;\n            this.element.removeClass(\"k-listening\");\n            this._updateIcon();\n            const error = e && (e.error || e.message) || 'Unknown error';\n            this.trigger(\"error\", { error: error });\n        },\n\n        options: {\n            name: \"SpeechToTextButton\",\n            icon: \"microphone-outline\",\n            stopIcon: \"stop-sm\",\n            integrationMode: \"webSpeech\",\n            lang: 'en-US',\n            continuous: false,\n            interimResults: false,\n            maxAlternatives: 1,\n            messages: {\n                unsupported: \"Speech recognition is not supported in this browser.\",\n                notInitialized: \"Speech recognition engine not initialized.\",\n                start: \"Start speech recognition\",\n                stop: \"Stop speech recognition\"\n            }\n        },\n\n        events: [\n            \"start\",\n            \"end\",\n            \"result\",\n            \"error\",\n            \"click\"\n        ],\n\n        _updateIcon: function() {\n            const iconElement = this.element.find(\".k-icon, .k-svg-icon\");\n            const newIcon = this.isListening() ? this.options.stopIcon : this.options.icon;\n            const newAriaLabel = this.isListening() ? this.options.messages.stop : this.options.messages.start;\n\n            if (iconElement.length) {\n                kendo.ui.icon(iconElement, { icon: newIcon });\n            }\n\n            this.element.attr(\"aria-label\", newAriaLabel);\n        },\n        isListening: function() {\n            return !!this._isListening;\n        },\n\n        _click: function(e) {\n            Button.fn._click.call(this, e);\n\n            if (e.isDefaultPrevented()) {\n                return;\n            }\n\n            if (this.options.integrationMode === 'webSpeech') {\n                if (!this.speechRecognition || !this.speechRecognition.isSupported()) {\n                    this.trigger(\"error\", { error: this.options.messages.unsupported });\n                    return;\n                }\n\n                if (this.isListening()) {\n                    this.speechRecognition.stop();\n                } else {\n                    this.speechRecognition.start();\n                }\n            } else if (this.options.integrationMode === 'none') {\n                const eventName = this.isListening() ? \"end\" : \"start\";\n                const eventData = {\n                    sender: this\n                };\n\n                this.trigger(eventName, eventData);\n\n                this._isListening = !this.isListening();\n                this._updateIcon();\n            }\n        },\n\n        startRecognition: function() {\n            if (!this.options.enable) { return; }\n            if (!this.speechRecognition) {\n                this.trigger(\"error\", { error: this.options.messages.notInitialized });\n                return;\n            }\n\n            if (!this.speechRecognition.isSupported()) {\n                this.trigger(\"error\", { error: this.options.messages.unsupported });\n                return;\n            }\n\n            if (!this.isListening()) {\n                this.speechRecognition.start();\n            }\n        },\n\n        stopRecognition: function() {\n            if (this.speechRecognition && this.isListening()) {\n                this.speechRecognition.stop();\n            }\n        },\n\n        abortRecognition: function() {\n            if (this.speechRecognition && this.isListening()) {\n                this.speechRecognition.abort();\n            }\n        },\n\n        destroy: function() {\n            if (this.speechRecognition) {\n                this.speechRecognition.stop();\n                if (typeof this.speechRecognition.destroy === 'function') {\n                    this.speechRecognition.destroy();\n                }\n                this.speechRecognition = null;\n            }\n\n            $(this.element).removeClass(\"k-speech-to-text-button\");\n            Button.fn.destroy.call(this);\n        }\n    });\n\n\n    kendo.cssProperties.registerPrefix(\"SpeechToTextButton\", \"k-button-\");\n    kendo.cssProperties.registerValues(\"SpeechToTextButton\", [{\n        prop: \"rounded\",\n        values: kendo.cssProperties.roundedValues.concat([['full', 'full']])\n    }]);\n\n    ui.plugin(SpeechToTextButton);\n})(window.kendo.jQuery);\n\nexport default kendo;\n"],"x_google_ignoreList":[0],"mappings":";qhBAAA,IAAM,EAAQ,QAER,EAAS,SACT,EAAQ,QACR,EAAyB,CAC3B,KAAM,QACN,WAAY,GACZ,eAAgB,GAChB,gBAAiB,EACjB,OAAQ,EACH,GAAQ,KACR,IAAM,MACN,GAAS,MACT,GAAQ,KACZ,CACJ,CACD,SAAS,GAA2B,CAChC,OAAO,OAAU,OAAO,mBAAqB,OAAO,wBAA2B,OAEnF,IAAa,EAAb,KAAoC,CAChC,YAAY,EAAS,CACjB,KAAK,YAAc,KACnB,KAAK,YAAc,GACnB,KAAK,QAAU,CAAE,GAAG,EAAwB,CAC5C,KAAK,aAAgB,GAAU,CAC3B,KAAK,gBAAgB,EAAM,EAE/B,KAAK,YAAe,GAAU,CAC1B,KAAK,eAAe,EAAM,EAE9B,KAAK,cAAkB,CACnB,KAAK,cAAc,CACnB,KAAK,YAAc,IAEvB,KAAK,gBAAoB,CACrB,KAAK,gBAAgB,CACrB,KAAK,YAAc,IAEvB,KAAK,KAAK,EAAQ,CAEtB,KAAK,EAAS,CACV,IAAM,EAAkB,GAA0B,CAClD,GAAI,CAAC,EAAiB,CAClB,QAAQ,MAAM,uDAAuD,CACrE,KAAK,YAAc,KACnB,OAEJ,KAAK,YAAc,IAAI,EACvB,KAAK,WAAW,EAAQ,CACxB,KAAK,YAAY,CAErB,SAAU,CACN,KAAK,cAAc,CACnB,KAAK,YAAc,GAEvB,YAAa,CACJ,KAAK,cAGV,KAAK,YAAY,SAAW,KAAK,aACjC,KAAK,YAAY,QAAU,KAAK,YAChC,KAAK,YAAY,MAAQ,KAAK,UAC9B,KAAK,YAAY,QAAU,KAAK,aAEpC,cAAe,CACX,AAMI,KAAK,eALL,KAAK,YAAY,SAAW,KAC5B,KAAK,YAAY,QAAU,KAC3B,KAAK,YAAY,MAAQ,KACzB,KAAK,YAAY,QAAU,KAC3B,KAAK,YAAY,OAAO,CACL,MAG3B,WAAW,EAAS,CAChB,GAAI,CAAC,KAAK,YACN,OAEJ,IAAM,EAAe,CAAE,GAAG,KAAK,QAAQ,OAAQ,GAAG,EAAQ,OAAQ,CAClE,KAAK,QAAU,CACX,GAAG,KAAK,QACR,GAAG,EACH,OAAQ,EACX,CACD,GAAM,CAAE,OAAM,aAAY,iBAAgB,mBAAoB,KAAK,QACnE,OAAO,OAAO,KAAK,YAAa,CAAE,OAAM,aAAY,iBAAgB,kBAAiB,CAAC,CAE1F,gBAAiB,CACT,KAAK,QAAQ,OAAO,IACpB,KAAK,QAAQ,OAAO,IAAQ,CAGpC,cAAe,CACP,KAAK,QAAQ,OAAO,KACpB,KAAK,QAAQ,OAAO,KAAM,CAGlC,gBAAgB,EAAO,CACf,KAAK,QAAQ,OAAO,IACpB,KAAK,QAAQ,OAAO,GAAQ,EAAM,CAG1C,eAAe,EAAO,CACd,KAAK,QAAQ,OAAO,IACpB,KAAK,QAAQ,OAAO,GAAO,EAAM,CAGzC,OAAQ,CACA,KAAK,aAAe,CAAC,KAAK,aAC1B,KAAK,YAAY,OAAO,CAGhC,MAAO,CACC,KAAK,aAAe,KAAK,aACzB,KAAK,YAAY,MAAM,CAG/B,OAAQ,CACA,KAAK,aAAe,KAAK,aACzB,KAAK,YAAY,OAAO,CAGhC,aAAc,CACV,MAAO,CAAC,CAAC,GAA0B,CAEvC,UAAW,CACP,OAAO,KAAK,cC1HpB,IAAa,EAAW,CACpB,GAAI,qBACJ,KAAM,qBACN,SAAU,MACV,YAAa,6GACb,QAAS,CAAC,OAAQ,SAAS,CAC9B,EAEA,SAAS,EAAG,EAAW,CACpB,IAAM,EAAQ,OAAO,MACjB,EAAK,EAAM,GACX,EAAS,EAAG,OAEV,EAAqB,EAAO,OAAO,CACrC,KAAM,SAAS,EAAS,EAAS,CAC7B,EAAO,GAAG,KAAK,KAAK,KAAM,EAAS,EAAE,OAAO,CAAE,KAAM,KAAK,QAAQ,KAAM,CAAE,EAAQ,CAAC,CAClF,EAAE,EAAQ,CAAC,SAAS,0BAA0B,CAAC,KAAK,YAAa,SAAS,CAC1E,KAAK,aAAe,GACpB,KAAK,wBAAwB,CAC7B,KAAK,aAAa,EAGtB,uBAAwB,UAAW,CAC/B,GAAI,KAAK,QAAQ,kBAAoB,YACjC,OAGJ,GAAI,CAAC,EAAwB,CACzB,KAAK,OAAO,GAAM,CAClB,OAGJ,IAAM,EAAO,KACb,KAAK,kBAAoB,IAAI,EAAuB,CAChD,KAAM,KAAK,QAAQ,KACnB,eAAgB,KAAK,QAAQ,eAC7B,gBAAiB,KAAK,QAAQ,gBAC9B,WAAY,KAAK,QAAQ,WACzB,OAAQ,CACJ,MAAO,UAAW,CAAE,EAAK,cAAc,EACvC,IAAK,UAAW,CAAE,EAAK,YAAY,EACnC,OAAQ,SAAS,EAAG,CAAE,EAAK,cAAc,EAAE,EAC3C,MAAO,SAAS,EAAG,CAAE,EAAK,aAAa,EAAE,EAC5C,CACJ,CAAC,CAEG,KAAK,kBAAkB,aAAa,GACrC,KAAK,OAAO,GAAM,CAClB,KAAK,QAAQ,QAAS,CAAE,MAAO,KAAK,QAAQ,SAAS,YAAa,CAAC,GAI3E,aAAc,UAAW,CACrB,KAAK,aAAe,GACpB,KAAK,QAAQ,SAAS,cAAc,CACpC,KAAK,aAAa,CAClB,KAAK,QAAQ,QAAQ,EAEzB,WAAY,UAAW,CACnB,KAAK,aAAe,GACpB,KAAK,QAAQ,YAAY,cAAc,CACvC,KAAK,aAAa,CAClB,KAAK,QAAQ,MAAM,EAEvB,cAAe,SAAS,EAAG,CACvB,IAAM,EAAU,EAAE,QACZ,EAAa,EAAQ,EAAQ,OAAS,GACtC,EAAe,EAAE,CACvB,IAAK,IAAI,EAAI,EAAG,EAAI,EAAW,OAAQ,IACnC,EAAa,KAAK,CACd,WAAY,EAAW,GAAG,WAC1B,WAAY,EAAW,GAAG,WAC7B,CAAC,CAEN,KAAK,QAAQ,SAAU,CACnB,QAAS,EAAW,QACN,eACjB,CAAC,EAEN,aAAc,SAAS,EAAG,CACtB,KAAK,aAAe,GACpB,KAAK,QAAQ,YAAY,cAAc,CACvC,KAAK,aAAa,CAClB,IAAM,EAAQ,IAAM,EAAE,OAAS,EAAE,UAAY,gBAC7C,KAAK,QAAQ,QAAS,CAAS,QAAO,CAAC,EAG3C,QAAS,CACL,KAAM,qBACN,KAAM,qBACN,SAAU,UACV,gBAAiB,YACjB,KAAM,QACN,WAAY,GACZ,eAAgB,GAChB,gBAAiB,EACjB,SAAU,CACN,YAAa,uDACb,eAAgB,6CAChB,MAAO,2BACP,KAAM,0BACT,CACJ,CAED,OAAQ,CACJ,QACA,MACA,SACA,QACA,QACH,CAED,YAAa,UAAW,CACpB,IAAM,EAAc,KAAK,QAAQ,KAAK,uBAAuB,CACvD,EAAU,KAAK,aAAa,CAAG,KAAK,QAAQ,SAAW,KAAK,QAAQ,KACpE,EAAe,KAAK,aAAa,CAAG,KAAK,QAAQ,SAAS,KAAO,KAAK,QAAQ,SAAS,MAEzF,EAAY,QACZ,EAAM,GAAG,KAAK,EAAa,CAAE,KAAM,EAAS,CAAC,CAGjD,KAAK,QAAQ,KAAK,aAAc,EAAa,EAEjD,YAAa,UAAW,CACpB,MAAO,CAAC,CAAC,KAAK,cAGlB,OAAQ,SAAS,EAAG,CAChB,KAAO,GAAG,OAAO,KAAK,KAAM,EAAE,CAE1B,GAAE,oBAAoB,CAI1B,IAAI,KAAK,QAAQ,kBAAoB,YAAa,CAC9C,GAAI,CAAC,KAAK,mBAAqB,CAAC,KAAK,kBAAkB,aAAa,CAAE,CAClE,KAAK,QAAQ,QAAS,CAAE,MAAO,KAAK,QAAQ,SAAS,YAAa,CAAC,CACnE,OAGA,KAAK,aAAa,CAClB,KAAK,kBAAkB,MAAM,CAE7B,KAAK,kBAAkB,OAAO,SAE3B,KAAK,QAAQ,kBAAoB,OAAQ,CAChD,IAAM,EAAY,KAAK,aAAa,CAAG,MAAQ,QACzC,EAAY,CACd,OAAQ,KACX,CAED,KAAK,QAAQ,EAAW,EAAU,CAElC,KAAK,aAAe,CAAC,KAAK,aAAa,CACvC,KAAK,aAAa,IAI1B,iBAAkB,UAAW,CACpB,QAAK,QAAQ,OAClB,IAAI,CAAC,KAAK,kBAAmB,CACzB,KAAK,QAAQ,QAAS,CAAE,MAAO,KAAK,QAAQ,SAAS,eAAgB,CAAC,CACtE,OAGJ,GAAI,CAAC,KAAK,kBAAkB,aAAa,CAAE,CACvC,KAAK,QAAQ,QAAS,CAAE,MAAO,KAAK,QAAQ,SAAS,YAAa,CAAC,CACnE,OAGC,KAAK,aAAa,EACnB,KAAK,kBAAkB,OAAO,GAItC,gBAAiB,UAAW,CACpB,KAAK,mBAAqB,KAAK,aAAa,EAC5C,KAAK,kBAAkB,MAAM,EAIrC,iBAAkB,UAAW,CACrB,KAAK,mBAAqB,KAAK,aAAa,EAC5C,KAAK,kBAAkB,OAAO,EAItC,QAAS,UAAW,CAChB,AAKI,KAAK,qBAJL,KAAK,kBAAkB,MAAM,CACzB,OAAO,KAAK,kBAAkB,SAAY,YAC1C,KAAK,kBAAkB,SAAS,CAEX,MAG7B,EAAE,KAAK,QAAQ,CAAC,YAAY,0BAA0B,CACtD,EAAO,GAAG,QAAQ,KAAK,KAAK,EAEnC,CAAC,CAGF,EAAM,cAAc,eAAe,qBAAsB,YAAY,CACrE,EAAM,cAAc,eAAe,qBAAsB,CAAC,CACtD,KAAM,UACN,OAAQ,EAAM,cAAc,cAAc,OAAO,CAAC,CAAC,OAAQ,OAAO,CAAC,CAAC,CACvE,CAAC,CAAC,CAEH,EAAG,OAAO,EAAmB,GAC9B,OAAO,MAAM,OAAO,CAEvB,IAAA,EAAe"}