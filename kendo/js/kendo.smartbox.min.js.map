{"version":3,"file":"kendo.smartbox.min.js","names":[],"sources":["../../src/utils/prefix-suffix-containers.js","../../src/kendo.smartbox.js"],"sourcesContent":["import '../kendo.core.js';\n\nlet $ = kendo.jQuery;\n\nexport function addInputPrefixSuffixContainers({ widget, wrapper, options, prefixInsertBefore, suffixInsertAfter }) {\n    var prefix = options.prefixOptions,\n        suffix = options.suffixOptions,\n        hasPrefixContent = prefix.template || prefix.icon,\n        hasSuffixContent = suffix.template || suffix.icon,\n        suffixInsertAfter = suffixInsertAfter || prefixInsertBefore,\n        layoutFlow = options.layoutFlow,\n        containerOrientation = layoutFlow ? (layoutFlow == \"vertical\" ? \"horizontal\" : \"vertical\") : \"horizontal\",\n        separatorOrientation = layoutFlow == \"vertical\" ? \"horizontal\" : \"vertical\",\n        INPUT_SEPARATOR = `<span class=\"k-input-separator k-input-separator-${separatorOrientation}\"></span>`,\n        prefixContainer,\n        suffixContainer;\n\n    if (prefix && hasPrefixContent) {\n        prefixContainer = wrapper.children(\".k-input-prefix\");\n\n        if (!prefixContainer[0]) {\n            if (options._isInInlineAIPrompt) {\n                containerOrientation = layoutFlow || \"horizontal\";\n            }\n\n            prefixContainer = $(`<span class=\"k-input-prefix k-input-prefix-${containerOrientation}\" />`);\n            if (prefixInsertBefore) {\n                prefixContainer.insertBefore(prefixInsertBefore);\n            } else {\n                prefixContainer.prependTo(wrapper);\n            }\n        }\n\n        if (prefix.icon) {\n            prefixContainer.html(kendo.html.renderIcon({ icon: prefix.icon, iconClass: prefix.iconClass }));\n        }\n\n        if (prefix.template) {\n            prefixContainer.html(kendo.template(prefix.template)({}));\n        }\n\n        if (prefix.separator) {\n            $(INPUT_SEPARATOR).insertAfter(prefixContainer);\n        }\n    }\n\n    if (suffix && hasSuffixContent) {\n        suffixContainer = wrapper.children(\".k-input-suffix\");\n\n        if (!suffixContainer[0]) {\n            suffixContainer = $(`<span class=\"k-input-suffix k-input-suffix-${containerOrientation}\" />`).appendTo(wrapper);\n            if (suffixInsertAfter) {\n                suffixContainer.insertAfter(suffixInsertAfter);\n            } else {\n                suffixContainer.appendTo(wrapper);\n            }\n        }\n\n        if (suffix.icon) {\n            suffixContainer.html(kendo.html.renderIcon({ icon: suffix.icon, iconClass: suffix.iconClass }));\n        }\n\n        if (suffix.template) {\n            suffixContainer.html(kendo.template(suffix.template)({}));\n        }\n\n        if (suffix.separator) {\n            $(INPUT_SEPARATOR).insertBefore(suffixContainer);\n        }\n    }\n\n    widget._prefixContainer = prefixContainer;\n    widget._suffixContainer = suffixContainer;\n}","import \"./kendo.list.js\";\nimport \"./kendo.textbox.js\";\nimport \"./kendo.speechtotextbutton.js\";\nimport \"./kendo.segmentedbutton.js\";\nimport { addInputPrefixSuffixContainers } from \"./utils/prefix-suffix-containers.js\";\n\nexport const __meta__ = {\n    id: \"smartbox\",\n    name: \"SmartBox\",\n    category: \"web\",\n    description: \"The SmartBox is a new AI-powered capability designed to enhance standard search fields across key UI components.\",\n    depends: [\"list\", \"speechtotextbutton\", \"textbox\", \"segmentedbutton\"]\n};\n\n(function($, undefined) {\n    const kendo = window.kendo;\n    const encode = kendo.htmlEncode;\n    const ui = kendo.ui;\n    const List = kendo.ui.List;\n    const DataSource = kendo.data.DataSource;\n    const keys = kendo.keys;\n    const ns = \".kendoSmartBox\";\n    const FOCUSED = \"k-focus\";\n    const DISABLED = \"k-disabled\";\n    const FOCUS = \"focus\";\n    const BLUR = \"blur\";\n    const OPEN = \"open\";\n    const CLOSE = \"close\";\n    const INPUT = \"input\";\n    const KEYDOWN = \"keydown\";\n    const CLICK = \"click\";\n    const AI_ASSISTANT_PROMPT_REQUEST = \"aiAssistantPromptRequest\";\n    const AI_ASSISTANT_RESPONSE_SUCCESS = \"aiAssistantResponseSuccess\";\n    const AI_ASSISTANT_RESPONSE_ERROR = \"aiAssistantResponseError\";\n    const AI_ASSISTANT_CANCEL_REQUEST = \"aiAssistantCancelRequest\";\n    const STREAMING_UPDATE = \"streamingUpdate\";\n    const SEARCH = \"search\";\n    const SEMANTIC_SEARCH = \"semanticSearch\";\n\n    const MODES = {\n        search: \"Search\",\n        semanticSearch: \"SemanticSearch\",\n        aiAssistant: \"AIAssistant\"\n    };\n\n    const HISTORY_MAP = {\n        [MODES.search]: \"_searchHistory\",\n        [MODES.semanticSearch]: \"_semanticSearchHistory\",\n        [MODES.aiAssistant]: \"_aiAssistantHistory\"\n    };\n\n    const DEFAULT_ITEM_FIELD = \"value\";\n    const SEARCH_MODE_OPTIONS_ROLE = \"_searchModeOptions\";\n    const DEFAULT_POPUP_MAX_HEIGHT = \"320px\";\n    const DEFAULT_INPUT_WIDTH = \"450px\";\n    const DEFAULT_INPUT_MIN_WIDTH = \"350px\";\n\n    const getFirstValidActivatedMode = (activeModeOption, enabledModes) => {\n        const includesDefaultMode = enabledModes.indexOf(MODES.search) > -1;\n        const isIncluded = enabledModes.indexOf(activeModeOption) > -1;\n\n        if (enabledModes.length > 1) {\n            if (!activeModeOption) {\n                return includesDefaultMode ? MODES.search : enabledModes[0];\n            }\n\n\n            if (isIncluded) {\n                return activeModeOption;\n            } else if (includesDefaultMode) {\n                return MODES.search;\n            } else {\n                return enabledModes[0];\n            }\n\n        }\n\n        return isIncluded ? activeModeOption : enabledModes[0];\n\n    };\n\n    const SmartBox = List.extend({\n        init: function(element, options) {\n            var that = this;\n\n            that.ns = ns;\n\n            List.fn.init.call(that, element, options);\n            options = that.options;\n\n            that._enabledModes = that._getEnabledModes();\n            that._activeMode = getFirstValidActivatedMode(options.activeMode, that._enabledModes);\n\n            that._input();\n            that._wrapper();\n            that._popup();\n\n            that._dataSource();\n\n            that._initList();\n            that._setHeaderTemplate();\n            that._header();\n\n            that._aiTransport();\n            that._addPromptSuggestions();\n            that._addPrefixSuffix();\n\n            if (!that._enabledModes.length && that.options.searchSettings?.enabled === false) {\n                that._textBox.enable(false);\n            };\n\n            that._bindEvents();\n            kendo.notify(that);\n        },\n\n        options: {\n            name: \"SmartBox\",\n            activeMode: \"Search\",\n            placeholder: \"\",\n            size: undefined,\n            rounded: undefined,\n            fillMode: undefined,\n            history: {\n                size: 5,\n                timestampFormat: 'h:mm'\n            },\n            searchSettings: {\n                delay: 300,\n                enabled: true,\n            },\n            semanticSearchSettings: null,\n            aiAssistantSettings: null,\n            suggestionTemplate: null,\n            historyItemTemplate: null,\n            messages: {\n                noPreviousSearches: \"No previous searches\",\n                noPreviousPrompts: \"No previous prompts\",\n                previousSearches: \"Previously Searched\",\n                previousPrompts: \"Previously Asked\",\n                suggestedPrompts: \"Suggested Prompts\",\n                searchModeLabel: \"Search\",\n                searchModeDescription: \"Looks for exact word matches across your data\",\n                searchPlaceholder: \"Search\",\n                semanticSearchModeLabel: \"Semantic Search\",\n                semanticSearchModeDescription: \"Understands context to surface the most relevant results.\",\n                semanticSearchPlaceholder: \"Semantic Search\",\n                semanticSearchButtonText: \"Search\",\n                aiAssistantPlaceholder: \"Sort, filter or group with AI\",\n                speechToText: \"Speech to text\",\n                speechToTextAriaLabel: \"Start speech recognition\",\n                cancel: \"Cancel\",\n                send: \"Send\",\n                searchButtonText: \"Search\",\n                aiAssistantButtonText: \"AI Assistant\",\n            }\n        },\n\n        events: [\n            OPEN,\n            CLOSE,\n            FOCUS,\n            BLUR,\n            AI_ASSISTANT_PROMPT_REQUEST,\n            AI_ASSISTANT_RESPONSE_SUCCESS,\n            AI_ASSISTANT_RESPONSE_ERROR,\n            AI_ASSISTANT_CANCEL_REQUEST,\n            STREAMING_UPDATE,\n            SEARCH,\n            SEMANTIC_SEARCH\n        ],\n\n        _dataSource: function() {\n            const that = this;\n\n            if (that.dataSource && that._refreshHandler) {\n                that.dataSource.off();\n                that.dataSource = null;\n            }\n\n            that.dataSource = DataSource.create({\n                data: [],\n                group: {\n                    field: \"role\",\n                    compare: that._compareGroups\n                }\n            });\n        },\n\n        _compareGroups: function(a, b) {\n            const aOrder = a.items?.[0]?._groupOrder ?? 99;\n            const bOrder = b.items?.[0]?._groupOrder ?? 99;\n\n            return aOrder - bOrder;\n        },\n\n        _aiTransport: function() {\n            const that = this;\n\n            that.transport = new kendo.data.AiTransport({\n                service: that._getAIServiceConfig(),\n                success: that._aiServiceSuccess.bind(that),\n                error: that._aiServiceError.bind(that),\n                requestStart: () => that._aiRequestStart()\n            });\n        },\n\n        _addPromptSuggestions: function() {\n            const that = this;\n            const options = that.options;\n            const aiSettings = options.aiAssistantSettings;\n\n            if (!aiSettings || !aiSettings.promptSuggestions) {\n                return;\n            }\n\n            that._suggestions = aiSettings?.promptSuggestions?.map(item => ({\n                value: item,\n                suggestion: item,\n                role: options.messages.suggestedPrompts,\n                groupIcon: \"clock-arrow-rotate\",\n                _isSuggestion: true,\n                _groupOrder: 1,\n            })) || [];\n        },\n\n        _aiRequestStart: function() {\n            const that = this;\n\n            that._isLoading = true;\n            that._addPrefixSuffix();\n        },\n\n        _aiServiceSuccess: function(output) {\n            const that = this;\n\n            that._currentRequest = null;\n            that._isLoading = false;\n            that._addPrefixSuffix();\n\n            const eventArgs = {\n                prompt: output.prompt,\n                response: output.response\n            };\n\n            if (!that.trigger(AI_ASSISTANT_RESPONSE_SUCCESS, eventArgs)) {\n                that._pushValueToHistory(output.prompt);\n            }\n        },\n\n        _aiServiceError: function(output) {\n            const that = this;\n\n            that._currentRequest = null;\n\n            // Check if the request was aborted - don't trigger error event\n            if (output.response && output.response.statusText === \"abort\") {\n                return;\n            }\n\n            that._isLoading = false;\n            that._addPrefixSuffix();\n\n            const eventArgs = {\n                output: output.output,\n                prompt: output.prompt,\n                response: output.response\n            };\n\n            that.trigger(AI_ASSISTANT_RESPONSE_ERROR, eventArgs);\n        },\n\n        cancelAIRequest: function() {\n            const that = this;\n\n            if (that._isLoading) {\n                if (that._currentRequest && that._currentRequest.abort) {\n                    that._currentRequest.abort();\n                    that._currentRequest = null;\n                }\n                that._isLoading = false;\n                that._addPrefixSuffix();\n                that.trigger(AI_ASSISTANT_CANCEL_REQUEST);\n            }\n        },\n\n        sendAIPrompt: function(prompt, options) {\n            const that = this;\n\n            if (!that.transport) {\n                return;\n            }\n\n            options = options || {};\n            const history = that._aiAssistantHistory || [];\n            const service = that._getAIServiceConfig();\n\n            const request = that.transport.read({\n                prompt: prompt,\n                history: options.history || history.map(item => ({\n                    role: \"user\",\n                    contents: [{ $type: \"text\", text: item.value }]\n                })),\n                service: service\n            });\n            that._currentRequest = request;\n\n            if (request && typeof request.always === \"function\") {\n                request.always(() => that.value(\"\"));\n            } else if (request && typeof request.finally === \"function\") {\n                request.finally(() => that.value(\"\"));\n            }\n        },\n\n        startStreaming: function() {\n            const that = this;\n            that._isLoading = true;\n            that._addPrefixSuffix();\n        },\n\n        stopStreaming: function() {\n            const that = this;\n            that._isLoading = false;\n            that._addPrefixSuffix();\n        },\n\n        _wrapper: function() {\n            let wrapper = this.element.parent();\n\n            this.wrapper = wrapper.addClass(\"k-smart-box\").removeClass(\"k-textbox\");\n            this._focused = this.element;\n        },\n\n        _input: function() {\n            const that = this;\n            const options = that.options;\n\n            that.element.attr({\n                placeholder: that._getPlaceholder(),\n                autocomplete: \"off\",\n                \"aria-expanded\": false\n            }).css({\n                width: DEFAULT_INPUT_WIDTH,\n                minWidth: DEFAULT_INPUT_MIN_WIDTH\n            });\n\n            that._textBox = that.element.kendoTextBox({\n                size: options.size,\n                rounded: options.rounded,\n                fillMode: options.fillMode,\n                clearButton: that._isSearchMode()\n            }).data(\"kendoTextBox\");\n\n            if (that._textBox._clear) {\n                that._textBox._clear.off(CLICK);\n                that._textBox._clear.on(CLICK + ns, function(e) {\n                    e.preventDefault();\n                    that._onClearClick();\n                });\n            }\n        },\n\n        _onClearClick: function() {\n            const that = this;\n\n            that.value(\"\");\n            that._executeSearch(\"\");\n            that._textBox._hideClear();\n            that.focus();\n        },\n\n        _addPrefixSuffix: function() {\n            const that = this;\n            const mode = that._activeMode;\n            const isLoading = that._isLoading;\n\n            const clearButton = that._textBox?._clear;\n            if (clearButton && clearButton.length) {\n                clearButton.detach();\n            }\n\n            that.wrapper.find(\".k-input-prefix, .k-input-suffix\").remove();\n            if (that._speechToTextButton) {\n                that._speechToTextButton.destroy();\n                that._speechToTextButton = null;\n            }\n\n            let prefixOptions = {};\n            let suffixOptions = {};\n            const modeSettings = that._getModeSettings(mode);\n            const hasSpeechToText = modeSettings.speechToTextButton;\n\n            if (mode === MODES.search) {\n                prefixOptions = {\n                    icon: \"search\"\n                };\n            } else if (mode === MODES.semanticSearch) {\n                prefixOptions = {\n                    icon: \"zoom-sparkle\",\n                    iconClass: \"k-accent-icon\"\n                };\n            } else if (mode === MODES.aiAssistant) {\n                prefixOptions = {\n                    icon: \"sparkles\",\n                    iconClass: \"k-accent-icon\"\n                };\n\n                suffixOptions = {\n                    template: () => that._renderAISuffixTemplate(isLoading, hasSpeechToText, that.options.messages)\n                };\n            }\n\n            addInputPrefixSuffixContainers({\n                widget: that,\n                wrapper: that.wrapper,\n                options: {\n                    prefixOptions: prefixOptions,\n                    suffixOptions: suffixOptions\n                },\n                prefixInsertBefore: that.element\n            });\n\n            if (that._isSearchMode() && clearButton && clearButton.length) {\n                let suffix = that.wrapper.find(\".k-input-suffix\");\n                if (!suffix.length) {\n                    suffix = $('<span class=\"k-input-suffix\"></span>');\n                    that.wrapper.append(suffix);\n                }\n                suffix.append(clearButton);\n            }\n\n            if (mode === MODES.aiAssistant && hasSpeechToText) {\n                that._initSpeechToTextButton();\n            }\n\n           that._toggleClearButtonPerMode();\n        },\n\n        _toggleClearButtonPerMode: function() {\n            const that = this;\n            const mode = that._activeMode;\n            const isLoading = that._isLoading;\n\n            if (mode === MODES.aiAssistant) {\n                that._bindSuffixEvents(isLoading);\n                if (that._textBox && that._textBox._clear) {\n                    that._textBox._clear.hide();\n                }\n            } else if (that._textBox && that._textBox._clear) {\n                that._textBox._clear.show();\n\n                if (that.value()) {\n                    that._textBox._showClear();\n                } else {\n                    that._textBox._hideClear();\n                }\n            }\n        },\n\n        _renderAISuffixTemplate: function(isLoading, hasSpeechToText, messages) {\n            const that = this;\n            let template = \"\";\n\n            if (hasSpeechToText) {\n                template += `<button title=\"${encode(messages.speechToText)}\" aria-label=\"${encode(messages.speechToTextAriaLabel)}\" ref='smartbox-speech-to-text'></button>`;\n            }\n\n            if (isLoading) {\n                template += kendo.html.renderButton(`<button class='k-smart-box-send' ref='smartbox-cancel' title='${encode(messages.cancel)}'></button>`, {\n                    icon: \"stop-sm\",\n                    fillMode: \"solid\",\n                    themeColor: \"base\",\n                    size: that.options.size,\n                    rounded: \"full\"\n                });\n            } else {\n                template += kendo.html.renderButton(`<button class='k-smart-box-send${!that.value() ? ` ${DISABLED}` : \"\"}' ref='smartbox-send' title='${encode(messages.send)}'></button>`, {\n                    icon: \"arrow-up-outline\",\n                    fillMode: \"solid\",\n                    size: that.options.size,\n                    themeColor: \"base\",\n                    rounded: \"full\",\n                });\n            }\n\n            return template;\n        },\n\n        _initSpeechToTextButton: function() {\n            const that = this;\n            const modeSettings = that._getModeSettings();\n            const speechToTextOptions = modeSettings.speechToTextButton;\n            const SpeechToTextButton = kendo.ui.SpeechToTextButton;\n\n            if (!SpeechToTextButton || !speechToTextOptions) {\n                return;\n            }\n\n            const element = that.wrapper.find(\"[ref='smartbox-speech-to-text']\");\n\n            if (!element.length) {\n                return;\n            }\n\n            const options = $.extend({}, {\n                themeColor: \"base\",\n                fillMode: \"clear\",\n                size: that.options.size,\n                integrationMode: speechToTextOptions.integrationMode || \"webSpeech\",\n                lang: speechToTextOptions.lang || \"en-US\",\n                continuous: speechToTextOptions.continuous || false,\n                interimResults: speechToTextOptions.interimResults || false,\n                maxAlternatives: speechToTextOptions.maxAlternatives || 1,\n                result: function(ev) {\n                    if (ev.isFinal && ev.alternatives && ev.alternatives.length > 0) {\n                        const currentValue = that.value() || \"\";\n                        const newValue = currentValue + (currentValue ? \" \" : \"\") + ev.alternatives[0].transcript;\n\n                        that.value(newValue);\n                        that.element.trigger(\"input\");\n                    }\n                }\n            }, speechToTextOptions);\n\n            that._speechToTextButton = new SpeechToTextButton(element, options);\n        },\n\n        _bindSuffixEvents: function(isLoading) {\n            const that = this;\n\n            that.wrapper.find(\"[ref='smartbox-send'], [ref='smartbox-cancel']\").off(ns);\n\n            if (isLoading) {\n                that.wrapper.find(\"[ref='smartbox-cancel']\").on(CLICK + ns, function(e) {\n                    e.preventDefault();\n                    that.cancelAIRequest();\n                });\n            } else {\n                that.wrapper.find(\"[ref='smartbox-send']\").on(CLICK + ns, function(e) {\n                    e.preventDefault();\n                    const value = that.value();\n                    if (value) {\n                        that._triggerAIAssistantRequest(value);\n                    }\n                });\n            }\n        },\n\n        _getModeSettings: function(mode) {\n            const that = this;\n            const options = that.options;\n            const getMode = mode || that._activeMode;\n\n            if (getMode === MODES.search) {\n                return options.searchSettings || {};\n            } else if (getMode === MODES.semanticSearch) {\n                return options.semanticSearchSettings || {};\n            } else if (getMode === MODES.aiAssistant) {\n                return options.aiAssistantSettings || {};\n            }\n\n            return {};\n        },\n\n        _getPlaceholder: function() {\n            const that = this;\n            const options = that.options;\n            const mode = that._activeMode;\n            const messages = options.messages;\n            const settings = that._getModeSettings(mode);\n\n            let defaultPlaceholder = \"\";\n\n            switch (mode) {\n                case MODES.search:\n                    defaultPlaceholder = messages.searchPlaceholder;\n                    break;\n                case MODES.semanticSearch:\n                    defaultPlaceholder = messages.semanticSearchPlaceholder;\n                    break;\n                case MODES.aiAssistant:\n                    defaultPlaceholder = messages.aiAssistantPlaceholder;\n                    break;\n            }\n\n            return settings?.placeholder || options.placeholder || defaultPlaceholder;\n        },\n\n        _popup: function() {\n            this.options.popup = $.extend(this.options.popup, { copyAnchorStyles: true });\n            List.fn._popup.call(this);\n        },\n\n        value: function(val) {\n            var that = this;\n\n            if (val === undefined) {\n                return that._textBox ? that._textBox.value() : that.element.val();\n            }\n\n            if (that._textBox) {\n                that._textBox.value(val);\n            } else {\n                that.element.val(val);\n            }\n        },\n\n        enable: function(enable) {\n            var that = this;\n\n            if (that._textBox) {\n                that._textBox.enable(enable);\n            }\n\n            that.wrapper.toggleClass(DISABLED, enable === false);\n        },\n\n        readonly: function(readonly) {\n            var that = this;\n\n            if (that._textBox) {\n                that._textBox.readonly(readonly);\n            }\n        },\n\n        focus: function() {\n            var that = this;\n\n            if (that._textBox) {\n                that._textBox.focus();\n            } else {\n                that.element[0].focus();\n            }\n        },\n\n        _isSearchMode: function() {\n            const that = this;\n            const mode = that._activeMode;\n\n            return mode === MODES.search || mode === MODES.semanticSearch;\n        },\n\n        _handleItemClick: function(item) {\n            const that = this;\n            const mode = that._activeMode;\n\n            if (!item) {\n                return;\n            }\n\n            const textEl = item.find(\".k-list-item-text\");\n            const value = textEl.length ? textEl.first().text() : item.text();\n\n            that.value(value);\n            that._oldValue = value;\n\n            if (mode === MODES.search) {\n                that._executeSearch(value);\n            }\n\n            if (that._textBox && that._isSearchMode()) {\n                that._textBox._showClear();\n            }\n\n            const aiSendButton = that.wrapper.find(\"[ref='smartbox-send']\");\n\n            if (mode === MODES.aiAssistant && aiSendButton.length) {\n                aiSendButton.removeClass(DISABLED);\n            }\n\n            that.close();\n        },\n\n        _handleActionItem: function(e) {\n            const that = this;\n            const action = e.action;\n\n            if (action && action.indexOf(\"switchMode:\") === 0) {\n                const mode = action.replace(\"switchMode:\", \"\");\n                that._switchMode(mode);\n            }\n        },\n\n        _listBound: function() {\n            const that = this;\n            const data = that.dataSource.flatView();\n            const length = data.length;\n            const groupsLength = that.dataSource._group ? that.dataSource._group.length : 0;\n\n            that._renderNoData();\n            that._toggleNoData(!length && that._shouldRenderModeButton());\n            that._toggleHeader(!!groupsLength && !!length);\n\n            that._removeSearchModeOptionsGroupHeader();\n\n            that._applyListItemTooltips();\n        },\n\n        _applyListItemTooltips: function() {\n            const that = this;\n\n            if (!that.list) {\n                return;\n            }\n\n            const listItems = that.list.find(\".k-list-item:not(.k-list-group-item):not([data-action])\");\n            listItems.each(function() {\n                const item = $(this);\n                const textEl = item.find(\".k-list-item-text\");\n                const text = textEl.length ? textEl.text() : item.text();\n                item.attr(\"title\", text.trim());\n            });\n        },\n\n        _renderNoData: function() {\n            const that = this;\n            const noData = that.noData;\n\n            if (!noData) {\n                return;\n            }\n\n            const messages = that.options.messages;\n            const isAIMode = that._activeMode === MODES.aiAssistant;\n            const icon = \"file-report\";\n            const text = isAIMode ? messages.noPreviousPrompts : messages.noPreviousSearches;\n\n            const html = kendo.ui.icon({ icon: icon, iconClass: \"k-icon-xxxl\" }) + '<span>' + encode(text) + '</span>';\n\n            noData.addClass(\"k-smart-box-no-data\").html(html);\n        },\n\n        _removeSearchModeOptionsGroupHeader: function() {\n            const that = this;\n\n            if (!that.listView || !that.listView.content || !that._shouldRenderSearchModeOptions() || !that._isSearchMode()) {\n                return;\n            }\n\n            that.listView.content.find(\".k-list-group-item\").each(function() {\n                const $groupItem = $(this);\n                if ($groupItem.text().trim() === \"\") {\n                    $groupItem.remove();\n                }\n            });\n        },\n\n        _updateCssClasses: function() {\n            const that = this;\n            const popup = that.popup;\n\n            popup.element.removeClass(\"k-list-container\").addClass(\"k-smart-box-popup\");\n            that.list.find(\".k-list-content\").removeClass(\"k-list-scroller\");\n        },\n\n        _listOptions: function(options) {\n            const that = this;\n\n            return $.extend({\n                autoBind: false,\n                selectable: false,\n                dataSource: that.dataSource,\n                click: function(e) {\n                    that._handleItemClick(e.item);\n                },\n                action: function(e) {\n                    that._handleActionItem(e);\n                },\n                dataBound: that._listBound.bind(that),\n                dataValueField: DEFAULT_ITEM_FIELD,\n                dataTextField: DEFAULT_ITEM_FIELD,\n                iconField: \"icon\",\n                descriptionField: \"description\",\n                actionField: \"action\",\n                groupIconField: \"groupIcon\",\n                fixedGroupHeader: false,\n                template: that._getItemTemplate(),\n                groupTemplate: function(group) {\n                    if (group === SEARCH_MODE_OPTIONS_ROLE) {\n                        return \"\";\n                    }\n                    return encode(group);\n                }\n            }, options);\n        },\n\n        _getItemTemplate: function() {\n            const that = this;\n            const suggestionTemplate = that.options.suggestionTemplate;\n            const historyItemTemplate = that.options.historyItemTemplate;\n\n            if (!suggestionTemplate && !historyItemTemplate) {\n                return null;\n            }\n\n            const compiledSuggestionTemplate = suggestionTemplate ? kendo.template(suggestionTemplate) : null;\n            const compiledHistoryItemTemplate = historyItemTemplate ? kendo.template(historyItemTemplate) : null;\n\n            return function(dataItem) {\n                if (dataItem._isSuggestion && compiledSuggestionTemplate) {\n                    return compiledSuggestionTemplate(dataItem);\n                }\n\n                if (dataItem._isHistoryItem && compiledHistoryItemTemplate) {\n                    return compiledHistoryItemTemplate(dataItem);\n                }\n\n                return encode(dataItem.value || \"\");\n            };\n        },\n\n        _setHeaderTemplate: function() {\n            const that = this;\n\n            if (!that._shouldRenderModeButton()) {\n                return;\n            }\n\n            that.options.headerTemplate = function() {\n                return `<div ref=\"modeSwitcher\"></div>`;\n            };\n        },\n\n        _initModeButton: function() {\n            const that = this;\n            const messages = that.options.messages;\n\n            if (!that._shouldRenderModeButton() || !that.header) {\n                return;\n            }\n\n            const container = that.header;\n\n            let selectedValue = that._isSearchMode() ? MODES.search : MODES.aiAssistant;\n            let searchModeButton = { value: MODES.search, text: messages.searchButtonText, icon: \"search\" };\n\n            if (that._enabledModes.indexOf(MODES.search) < 0) {\n                searchModeButton = {\n                    value: MODES.semanticSearch,\n                    text: messages.semanticSearchButtonText,\n                    icon: \"zoom-sparkle\",\n                    iconClassOnSelection: \"k-accent-icon\"\n                };\n\n                selectedValue = that._activeMode;\n            }\n\n            that._segmentedButton = container.kendoSegmentedButton({\n                size: that.options.size,\n                selected: selectedValue,\n                stretched: true,\n                items: [\n                    searchModeButton,\n                    { value: MODES.aiAssistant, text: messages.aiAssistantButtonText, icon: \"sparkles\", iconClassOnSelection: \"k-accent-icon\" }\n                ],\n                select: function(e) {\n                    that._switchMode(e.value);\n                }\n            }).data(\"kendoSegmentedButton\");\n        },\n\n        _switchMode: function(mode) {\n            const that = this;\n            const currentMode = that._activeMode;\n\n            if (that._isSearchMode() && mode === MODES.aiAssistant) {\n                that._lastSearchMode = currentMode;\n            }\n\n            if (mode === MODES.search && currentMode === MODES.aiAssistant && that._lastSearchMode) {\n                mode = that._lastSearchMode;\n            }\n\n            that._activeMode = mode;\n\n            that.element.attr(\"placeholder\", that._getPlaceholder());\n\n            that.value(\"\");\n\n            that._addPrefixSuffix();\n\n            that._updateHeaderActiveState();\n\n            that._showViewPopup();\n        },\n\n        _updateHeaderActiveState: function() {\n            const that = this;\n\n            if (!that._segmentedButton) {\n                return;\n            }\n\n            that._segmentedButton.value(that._activeMode);\n        },\n\n        _shouldRenderSearchModeOptions: function() {\n            const enabledModes = this._enabledModes;\n\n            return enabledModes.includes(MODES.search) && enabledModes.includes(MODES.semanticSearch);\n        },\n\n        _getSearchModeOptions: function() {\n            const that = this;\n            const messages = that.options.messages;\n            const enabledModes = that._enabledModes;\n            const options = [];\n\n            if (enabledModes.includes(MODES.search)) {\n                const isActive = that._activeMode === MODES.search;\n                options.push({\n                    value: messages.searchModeLabel,\n                    description: messages.searchModeDescription,\n                    icon: isActive ? \"check\" : null,\n                    action: \"switchMode:\" + MODES.search,\n                    mode: MODES.search,\n                    role: SEARCH_MODE_OPTIONS_ROLE,\n                    _groupOrder: 2\n                });\n            }\n\n            if (enabledModes.includes(MODES.semanticSearch)) {\n                const isActive = that._activeMode === MODES.semanticSearch;\n                options.push({\n                    value: messages.semanticSearchModeLabel,\n                    description: messages.semanticSearchModeDescription,\n                    icon: isActive ? \"check\" : null,\n                    action: \"switchMode:\" + MODES.semanticSearch,\n                    mode: MODES.semanticSearch,\n                    role: SEARCH_MODE_OPTIONS_ROLE,\n                    _groupOrder: 2\n                });\n            }\n\n            return options;\n        },\n\n        _shouldRenderModeButton: function() {\n            const enabledModes = this._enabledModes;\n\n            const hasSearchMode = enabledModes.includes(MODES.search) || enabledModes.includes(MODES.semanticSearch);\n            const hasAIAssistant = enabledModes.includes(MODES.aiAssistant);\n\n            return hasSearchMode && hasAIAssistant;\n        },\n\n        _shouldRenderNoData: function() {\n            const that = this;\n\n            return that._shouldRenderModeButton() && that.dataSource.data().length === 0;\n        },\n\n        _getEnabledModes: function() {\n            const that = this;\n            const options = that.options;\n            const modes = [];\n\n            if (options.searchSettings && options.searchSettings.enabled !== false) {\n                modes.push(MODES.search);\n            }\n            if (options.semanticSearchSettings && options.semanticSearchSettings.enabled !== false) {\n                modes.push(MODES.semanticSearch);\n            }\n            if (options.aiAssistantSettings && options.aiAssistantSettings.enabled !== false) {\n                modes.push(MODES.aiAssistant);\n            }\n\n\n            return modes;\n        },\n\n        _bindEvents: function() {\n            const that = this;\n            that.element\n                .on(`${FOCUS}${ns}`, () => that._onFocus())\n                .on(`${BLUR}${ns}`, () => that._onBlur())\n                .on(`${KEYDOWN}${ns}`, (e) => that._onKeydown(e))\n                .on(`${INPUT}${ns}`, (e) => that._onInput(e));\n\n            that.wrapper.on(`${CLICK}${ns}`, \".k-input-prefix\", () => {\n                if (that.popup.visible()) {\n                    that.close();\n                }\n\n            that.element.trigger(FOCUS + ns);\n        });\n\n            that.popup.one(OPEN, () => {\n                that._updateCssClasses();\n                that.popup.element.css({\n                    \"margin-top\": \"2px\"\n                });\n                that.popup.element.find(\".k-list\").css({\n                    \"max-height\": DEFAULT_POPUP_MAX_HEIGHT\n                });\n                that._initModeButton();\n            });\n\n            that.popup.bind(\"activate\", () => {\n                if (that.listView) {\n                    that.listView.select([]);\n                    that.current(-1);\n                }\n\n                if (that._segmentedButton) {\n                    that._segmentedButton._calculateThumbPosition();\n                }\n            });\n        },\n\n        _unbindEvents: function() {\n            const that = this;\n            that.element.off(ns);\n            that.wrapper.off(ns);\n        },\n\n        _onFocus: function() {\n            const that = this;\n            const mode = that._activeMode;\n            const hasHistory = that[HISTORY_MAP[mode]]?.length > 0;\n            const hasSuggestions = mode === MODES.aiAssistant && that._suggestions?.length > 0;\n            const shouldRenderModeButton = that._shouldRenderModeButton();\n            const shouldRenderSearchModeOptions = that._shouldRenderSearchModeOptions() && that._isSearchMode();\n\n            const shouldShowPopup = hasHistory || hasSuggestions || shouldRenderModeButton || shouldRenderSearchModeOptions;\n\n            that.wrapper.addClass(FOCUSED);\n\n            if (shouldShowPopup) {\n                that._showViewPopup();\n            }\n            that.trigger(FOCUS);\n        },\n\n        _onBlur: function() {\n            if (!this.trigger(BLUR)) {\n                this.wrapper.removeClass(FOCUSED);\n                this.close();\n            }\n        },\n\n        _onKeydown: function(e) {\n            const that = this;\n            const key = e.keyCode;\n            const mode = that._activeMode;\n            const value = that.element.val();\n\n            if (key === keys.ENTER) {\n                if (value) {\n                    that.close();\n                    if (mode === MODES.aiAssistant) {\n                        that._triggerAIAssistantRequest(value);\n                    } else {\n                        clearTimeout(that._searchTimeout);\n                        that._executeSearch(value);\n                    }\n                }\n                e.preventDefault();\n            } else if (key === keys.ESC) {\n                that.close();\n            }\n        },\n\n        _executeSearch: function(value) {\n            const that = this;\n            const mode = that._activeMode;\n\n            if (!value && value !== \"\") {\n                return;\n            }\n\n            if (mode === MODES.search) {\n                if (!that.trigger(SEARCH, { searchValue: value })) {\n                    that._search(value);\n                    that._pushValueToHistory(value);\n                }\n            } else if (mode === MODES.semanticSearch) {\n                that.trigger(\"semanticSearch\", { searchValue: value });\n                that._pushValueToHistory(value);\n            }\n        },\n\n        _onInput: function(e) {\n            const that = this;\n            const options = that.options;\n            const mode = that._activeMode;\n            const value = that.element.val();\n\n            const isDeleting = that._oldValue && value.length < that._oldValue.length;\n\n            that.wrapper.find(\"[ref='smartbox-send']\")?.toggleClass(DISABLED, !value);\n\n            if (isDeleting && value === \"\") {\n                that._showViewPopup();\n            } else {\n                that.close();\n            }\n\n            if (that._isSearchMode()) {\n                let delay;\n\n                if (mode === MODES.search) {\n                    delay = options.searchSettings?.delay || 300;\n                }\n\n                if (mode === MODES.semanticSearch) {\n                    delay = options.semanticSearchSettings?.delay || 900;\n                }\n\n                clearTimeout(that._searchTimeout);\n\n                that._searchTimeout = setTimeout(() => {\n                    that._executeSearch(value);\n                }, delay);\n            }\n            that.value(value);\n            that._oldValue = value;\n        },\n\n        _showViewPopup: function() {\n            const that = this;\n            const mode = that._activeMode;\n            const hasSuggestions = that._suggestions?.length > 0;\n            const shouldRenderModeButton = that._shouldRenderModeButton();\n            const shouldRenderSearchModeOptions = that._shouldRenderSearchModeOptions();\n            const isSearchMode = that._isSearchMode();\n            const historySettings = that._getHistorySettings(mode);\n            const historyEnabled = historySettings.enabled !== false;\n            let history = historyEnabled ? (that[HISTORY_MAP[mode]] || []) : [];\n            const hasHistory = history.length > 0;\n\n            if (!hasHistory && !hasSuggestions && !shouldRenderModeButton && !(shouldRenderSearchModeOptions && isSearchMode)) {\n                return;\n            }\n\n            if (shouldRenderSearchModeOptions && isSearchMode) {\n                const searchModeOptions = that._getSearchModeOptions();\n                history = [...searchModeOptions, ...history];\n            }\n\n            if (mode === MODES.aiAssistant && hasSuggestions) {\n                history = [...that._suggestions, ...history];\n            }\n\n            that._setListData(history);\n            that.open();\n        },\n\n        _setListData: function(data) {\n            var that = this;\n\n            if (!data) {\n                data = [];\n            }\n\n            data.sort((a, b) => (a._groupOrder || 0) - (b._groupOrder || 0));\n\n            that.dataSource.data(data);\n        },\n\n\n        _getHistorySettings: function(mode) {\n            const that = this;\n            const options = that.options;\n            const getMode = mode || that._activeMode;\n            const modeSettings = that._getModeSettings(getMode);\n            const componentHistory = options.history;\n            const modeHistory = modeSettings?.history;\n\n            if (modeHistory === false) {\n                return { enabled: false, size: 0, timestampFormat: null };\n            }\n\n            if (componentHistory === false) {\n                return { enabled: false, size: 0, timestampFormat: null };\n            }\n\n            const globalSettings = componentHistory || {};\n            const modeHistorySettings = modeHistory || {};\n\n            let size, timestampFormat;\n\n            if (modeHistorySettings.size !== undefined) {\n                size = modeHistorySettings.size;\n            } else if (globalSettings.size !== undefined) {\n                size = globalSettings.size;\n            }\n\n            if (modeHistorySettings.timestampFormat !== undefined) {\n                timestampFormat = modeHistorySettings.timestampFormat;\n            } else if (globalSettings.timestampFormat !== undefined) {\n                timestampFormat = globalSettings.timestampFormat;\n            }\n\n            return { enabled: true, size, timestampFormat };\n        },\n\n        _pushValueToHistory: function(value) {\n            const that = this;\n            const mode = that._activeMode;\n            const historySettings = that._getHistorySettings(mode);\n\n            if (!value) {\n                return;\n            }\n\n            // Check if history is disabled for this mode\n            if (historySettings.enabled === false) {\n                return;\n            }\n\n            const size = historySettings.size;\n            const timestampFormat = historySettings.timestampFormat;\n\n            if (size <= 0) {\n                return;\n            }\n\n            let history = that[HISTORY_MAP[mode]] || [];\n\n            if (history.length >= size) {\n                history.pop();\n            }\n\n            const timestamp = new Date();\n\n            history.unshift({\n                value,\n                role: that._isSearchMode() ? that.options.messages.previousSearches : that.options.messages.previousPrompts,\n                groupIcon: \"clock\",\n                timestamp: timestamp,\n                timestampFormat: timestampFormat,\n                description: kendo.toString(timestamp, timestampFormat),\n                _groupOrder: 3,\n                _isHistoryItem: true\n            });\n\n            that[HISTORY_MAP[mode]] = history;\n\n            that.close();\n        },\n\n        _search: function(value) {\n            const that = this;\n            const options = that.options;\n            const searchSettings = options.searchSettings || {};\n            const dataSourceReference = searchSettings.dataSource || null;\n\n            if (!dataSourceReference) {\n                return;\n            }\n            const searchFields = searchSettings.fields || dataSourceReference.options?.search?.fields || null;\n\n            let expression = { filters: [], logic: \"or\" };\n\n            if (that.dataSourceReference.options.endless) {\n                that.dataSourceReference.options.endless = null;\n                that._endlessPageSize = that.dataSourceReference.options.pageSize;\n            }\n\n            if (value) {\n                for (let i = 0; i < searchFields.length; i++) {\n                    that._pushExpression(expression.filters, searchFields[i], value);\n                }\n            } else {\n                expression = {};\n            }\n\n            dataSourceReference.filter(expression);\n        },\n\n        _getAIServiceConfig: function() {\n            const that = this;\n            const aiOptions = that.options.aiAssistantSettings || {};\n            const serviceIsString = typeof aiOptions.service === \"string\";\n\n            if (!aiOptions.service) {\n                return {};\n            }\n\n            const url = serviceIsString ? aiOptions.service : aiOptions.service.url;\n\n            if (url) {\n                return {\n                    ...(!serviceIsString ? aiOptions.service : {}),\n                    url: url,\n                };\n            }\n\n            return {};\n        },\n\n        _triggerAIAssistantRequest: function(prompt) {\n            const that = this;\n\n            if (!prompt) {\n                return;\n            }\n\n            const history = that._aiAssistantHistory || [];\n\n            const eventArgs = {\n                prompt: prompt,\n                history: history.map(item => ({\n                    role: \"user\",\n                    contents: [{ $type: \"text\", text: item.value }]\n                })),\n                service: that._getAIServiceConfig(),\n            };\n\n            if (that.trigger(AI_ASSISTANT_PROMPT_REQUEST, eventArgs)) {\n                return;\n            }\n\n            if (that.transport) {\n                that.sendAIPrompt(prompt, eventArgs);\n            }\n\n            that.close();\n        },\n\n        open: function() {\n            const that = this;\n            that.popup.open();\n        },\n\n        close: function() {\n            const that = this;\n\n            that.popup.close();\n        },\n\n\n        activeMode: function(mode) {\n            if (mode === undefined) {\n                return this._activeMode;\n            }\n\n            if (mode !== this._activeMode && this._getEnabledModes().indexOf(mode) > -1) {\n                this._activeMode = mode;\n                this.element.attr(\"placeholder\", this._getPlaceholder());\n            }\n        },\n\n        destroy: function() {\n            const that = this;\n\n            clearTimeout(that._searchTimeout);\n\n            if (that.popup) {\n                that.popup.unbind();\n            }\n\n            if (that.transport) {\n                that.transport = null;\n            }\n\n            if (that._speechToTextButton) {\n                that._speechToTextButton.destroy();\n                that._speechToTextButton = null;\n            }\n\n            if (that._textBox) {\n                that._textBox.destroy();\n                that._textBox = null;\n            }\n\n            if (that._segmentedButton) {\n                that._segmentedButton.destroy();\n                that._segmentedButton = null;\n            }\n\n            that.wrapper.find(\"[ref='smartbox-send'], [ref='smartbox-cancel']\").off(ns);\n            that.element.off(ns);\n            that.wrapper.off(ns);\n\n            List.fn.destroy.call(that);\n        }\n    });\n\n    ui.plugin(SmartBox);\n})(window.kendo.jQuery);\n\nexport default kendo;\n\n"],"mappings":"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"}