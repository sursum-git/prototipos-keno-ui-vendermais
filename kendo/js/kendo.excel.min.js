/**
 * Kendo UI v2026.1.212 (http://www.telerik.com/kendo-ui)
 * Copyright 2026 Progress Software Corporation and/or one of its subsidiaries or affiliates. All rights reserved.
 *
 * Kendo UI commercial licenses may be obtained at
 * http://www.telerik.com/purchase/license-agreement/kendo-ui-complete
 * If you do not own a commercial license, this file shall be governed by the trial license terms.
 */
(function(e,t){typeof exports==`object`&&typeof module<`u`?t(exports,require(`kendo.core.min.js`),require(`kendo.data.min.js`),require(`kendo.ooxml.min.js`)):typeof define==`function`&&define.amd?define([`exports`,`kendo.core.min`,`kendo.data.min`,`kendo.ooxml.min`],t):(e=typeof globalThis<`u`?globalThis:e||self,t((e.kendo=e.kendo||{},e.kendo._globals=e.kendo._globals||{},e.kendo._globals.Excel={}),e.kendo._globals.Core,e.kendo._globals.Data,e.kendo._globals.Ooxml))})(this,function(e,t,n,r){Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});let i={compile:function(e){return e}};var a=class{static register(e){i=e}static compile(e){return i.compile(e)}};let o=/\[(?:(\d+)|['"](.*?)['"])\]|((?:(?!\[.*?\]|\.).)+)/g,s={},c=`undefined`;s[c]=function(e){return e};function l(e){if(s[e])return s[e];let t=[];return e.replace(o,function(e,n,r,i){t.push(typeof n===c?r||i:n)}),s[e]=function(e){let n=e;for(let e=0;e<t.length&&n;e++)n=n[t[e]];return n},s[e]}function u(e,t){return e.reduce((e,n,r)=>{let i=t(n,r);return i!=null&&e.push(i),e},[])}function d(e){return`${e.title}: ${e.value}`}function f(e,t){let n=[];for(let r=0;r<e;r++)n.push(t(r));return n}function p(e){return e.id}var m=class{constructor(e){e.columns=this._trimColumns(e.columns||[]),this.allColumns=u(this._leafColumns(e.columns||[]),this._prepareColumn),this.columns=this._visibleColumns(this.allColumns),this.options=e,this.data=e.data||[],this.aggregates=e.aggregates||{},this.groups=[].concat(e.groups||[]),this.hasGroups=this.groups.length>0,this.hierarchy=e.hierarchy,this.hasGroupHeaderColumn=this.columns.some(e=>e.groupHeaderColumnTemplate),this.collapsible=this.options.collapsible}workbook(){return{sheets:[{columns:this._columns(),rows:this.hierarchy?this._hierarchyRows():this._rows(),freezePane:this._freezePane(),filter:this._filter()}]}}_trimColumns(e){return e.filter(e=>{let t=!!e.field;return!t&&e.columns&&(t=this._trimColumns(e.columns).length>0),t})}_leafColumns(e){let t=[];for(let n=0;n<e.length;n++)e[n].columns?t=t.concat(this._leafColumns(e[n].columns)):t.push(e[n]);return t}_prepareColumn(e){if(!e.field)return null;let t=function(t){return l(e.field,!0)(t)},n=null;return e.values&&(n={},e.values.forEach(function(e){n[e.value]=e.text}),t=function(t){return n[l(e.field,!0)(t)]}),Object.assign({},e,{value:t,values:n,groupHeaderTemplate:e.groupHeaderTemplate?a.compile(e.groupHeaderTemplate):d,groupHeaderColumnTemplate:e.groupHeaderColumnTemplate?a.compile(e.groupHeaderColumnTemplate):null,groupFooterTemplate:e.groupFooterTemplate?a.compile(e.groupFooterTemplate):null,footerTemplate:e.footerTemplate?a.compile(e.footerTemplate):null})}_filter(){if(!this.options.filterable)return null;let e=this._depth();return{from:e,to:e+this.columns.length-1}}_createPaddingCells(e){return f(e,()=>Object.assign({background:`#dfdfdf`,color:`#333`},this.options.paddingCellOptions))}_dataRow(e,t,n){let r=this._createPaddingCells(t);if(this.hasGroups&&n&&e.items){r=r.concat(this._groupHeaderCells(e,t,n));let i=this._dataRows(e.items,t+1);return i.unshift({type:`group-header`,cells:r,level:this.collapsible?t:null}),i.concat(this._footer(e,t))}let i=[];for(let t=0;t<this.columns.length;t++)i[t]=this._cell(e,this.columns[t]);return this.hierarchy&&(i[0].colSpan=n-t+1),[{type:`data`,cells:r.concat(i),level:this.collapsible?t:null}]}_groupHeaderCells(e,t,n){let r=[],i=this.allColumns.filter(function(t){return t.field===e.field})[0]||{},a=i&&i.title?i.title:e.field,o=i?i.groupHeaderTemplate||i.groupHeaderColumnTemplate:null,s=Object.assign({title:a,field:e.field,value:i&&i.values?i.values[e.value]:e.value,aggregates:e.aggregates,items:e.items},e.aggregates[e.field]),c=o?o(s):`${a}: ${e.value}`;return r.push(Object.assign({value:c,background:`#dfdfdf`,color:`#333`,colSpan:(this.hasGroupHeaderColumn?1:this.columns.length)+n-t},i.groupHeaderCellOptions)),this.hasGroupHeaderColumn&&this.columns.forEach(function(t,n){n>0&&r.push(Object.assign({background:`#dfdfdf`,color:`#333`,value:t.groupHeaderColumnTemplate?t.groupHeaderColumnTemplate(Object.assign({group:s},s,e.aggregates[t.field])):void 0},t.groupHeaderCellOptions))}),r}_dataRows(e,t){let n=this._depth(),r=[];for(let i=0;i<e.length;i++)r.push.apply(r,this._dataRow(e[i],t,n));return r}_hierarchyRows(){let e=this._depth(),t=this.data,n=this.hierarchy.itemLevel,r=this.hierarchy.itemId||p,i=this._hasFooterTemplate(),a=[],o=[],s=0,c;i||(this.collapsible=!1);for(let l=0;l<t.length;l++){let u=t[l],d=n(u,l);i&&(d>s?o.push({id:c,level:s}):d<s&&a.push.apply(a,this._hierarchyFooterRows(o,d,e)),s=d,c=r(u,l)),a.push.apply(a,this._dataRow(u,d+1,e))}if(i){a.push.apply(a,this._hierarchyFooterRows(o,0,e));let n=t.length?this.aggregates[t[0].parentId]:{};a.push(this._hierarchyFooter(n,0,e))}return this._prependHeaderRows(a),a}_hierarchyFooterRows(e,t,n){let r=[];for(;e.length&&e[e.length-1].level>=t;){let t=e.pop();r.push(this._hierarchyFooter(this.aggregates[t.id],t.level+1,n))}return r}_hasFooterTemplate(){let e=this.columns;for(let t=0;t<e.length;t++)if(e[t].footerTemplate)return!0}_hierarchyFooter(e,t,n){let r=this.columns.map(function(r,i){let a=i?1:n-t+1;if(r.footerTemplate){let t=(e||{})[r.field];return Object.assign({background:`#dfdfdf`,color:`#333`,colSpan:a,value:r.footerTemplate(Object.assign({aggregates:e},t))},r.footerCellOptions)}return Object.assign({background:`#dfdfdf`,color:`#333`,colSpan:a},r.footerCellOptions)});return{type:`footer`,cells:this._createPaddingCells(t).concat(r),level:this.collapsible?t:null}}_footer(e,t){let n=[],r=this.columns.some(e=>e.groupFooterTemplate),i,a;r&&(a={group:{items:e.items,field:e.field,value:e.value}},i={},Object.keys(e.aggregates).forEach(t=>{i[t]=Object.assign({},e.aggregates[t],a)}));let o=this.columns.map(t=>{if(t.groupFooterTemplate){let n=Object.assign({},i,e.aggregates[t.field],a);return Object.assign({background:`#dfdfdf`,color:`#333`,value:t.groupFooterTemplate(n)},t.groupFooterCellOptions)}return Object.assign({background:`#dfdfdf`,color:`#333`},t.groupFooterCellOptions)});return r&&n.push({type:`group-footer`,cells:this._createPaddingCells(this.groups.length).concat(o),level:this.collapsible?t:null}),n}_isColumnVisible(e){return this._visibleColumns([e]).length>0&&(e.field||e.columns)}_visibleColumns(e){return e.filter(e=>{let t=e.exportable;typeof t==`object`&&(t=e.exportable.excel);let n=!e.hidden&&t!==!1,r=e.hidden&&t===!0,i=n||r;return i&&e.columns&&(i=this._visibleColumns(e.columns).length>0),i})}_headerRow(e,t){let n=e.cells.map(function(t){return Object.assign(t,{colSpan:t.colSpan>1?t.colSpan:1,rowSpan:e.rowSpan>1&&!t.colSpan?e.rowSpan:1})});return this.hierarchy&&n[0].firstCell&&(n[0].colSpan+=this._depth()),{type:`header`,cells:f(t.length,()=>Object.assign({background:`#7a7a7a`,color:`#fff`},this.options.headerPaddingCellOptions)).concat(n)}}_prependHeaderRows(e){let t=this.groups,n=[{rowSpan:1,cells:[],index:0}];this._prepareHeaderRows(n,this.options.columns);for(let r=n.length-1;r>=0;r--)e.unshift(this._headerRow(n[r],t))}_prepareHeaderRows(e,t,n,r){let i=r||e[e.length-1],a=e[i.index+1],o=0;for(let r=0;r<t.length;r++){let s=t[r];if(this._isColumnVisible(s)){let t=Object.assign({background:`#7a7a7a`,color:`#fff`,value:s.title||s.field,colSpan:0,firstCell:r===0&&(!n||n.firstCell)},s.headerCellOptions);i.cells.push(t),s.columns&&s.columns.length&&(a||(a={rowSpan:0,cells:[],index:e.length},e.push(a)),t.colSpan=this._trimColumns(this._visibleColumns(s.columns)).length,this._prepareHeaderRows(e,s.columns,t,a),o+=t.colSpan-1,i.rowSpan=e.length-i.index)}}n&&(n.colSpan+=o)}_rows(){let e=this._dataRows(this.data,0);if(this.columns.length){this._prependHeaderRows(e);let t=!1,n=this.columns.map(e=>e.footerTemplate?(t=!0,Object.assign({background:`#dfdfdf`,color:`#333`,value:e.footerTemplate(Object.assign({},this.aggregates,this.aggregates[e.field]))},e.footerCellOptions)):Object.assign({background:`#dfdfdf`,color:`#333`},e.footerCellOptions));t&&e.push({type:`footer`,cells:this._createPaddingCells(this.groups.length).concat(n)})}return e}_headerDepth(e){let t=0;for(let n=0;n<e.length;n++)if(e[n].columns){let r=this._headerDepth(e[n].columns);r>t&&(t=r)}return 1+t}_freezePane(){let e=this._visibleColumns(this.options.columns||[]),t=this._visibleColumns(this._trimColumns(this._leafColumns(e.filter(function(e){return e.locked})))).length;return{rowSplit:this._headerDepth(e),colSplit:t?t+this.groups.length:0}}_cell(e,t){return Object.assign({value:t.value(e)},t.cellOptions)}_depth(){let e=0;return e=this.hierarchy?this.hierarchy.depth:this.groups.length,e}_columns(){return f(this._depth(),()=>({width:20})).concat(this.columns.map(function(e){return{width:parseInt(e.width,10),autoWidth:!e.width}}))}},h=0,g=4,_=0,v=-2,y=1,b=4,x=0,S=1,C=2,ee=8;function te(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)}var w={arraySet:function(e,t,n,r,i){if(t.subarray&&e.subarray){e.set(t.subarray(n,n+r),i);return}for(var a=0;a<r;a++)e[i+a]=t[n+a]},flattenChunks:function(e){var t,n,r=0,i,a,o;for(t=0,n=e.length;t<n;t++)r+=e[t].length;for(o=new Uint8Array(r),i=0,t=0,n=e.length;t<n;t++)a=e[t],o.set(a,i),i+=a.length;return o},Buf8:function(e){return new Uint8Array(e)},Buf16:function(e){return new Uint16Array(e)},Buf32:function(e){return new Int32Array(e)}},T={arraySet:function(e,t,n,r,i){for(var a=0;a<r;a++)e[i+a]=t[n+a]},flattenChunks:function(e){return[].concat.apply([],e)},Buf8:function(e){return Array(e)},Buf16:function(e){return Array(e)},Buf32:function(e){return Array(e)}};let E=()=>{let e=typeof Uint8Array<`u`&&typeof Uint16Array<`u`&&typeof Int32Array<`u`;return E=()=>e,e},D=(e,t,n,r,i)=>(D=E()?w.arraySet:T.arraySet,D(e,t,n,r,i)),ne=e=>(ne=E()?w.flattenChunks:T.flattenChunks,ne(e)),re=e=>(re=E()?w.Buf8:T.Buf8,re(e)),ie=e=>(ie=E()?w.Buf16:T.Buf16,ie(e)),O=e=>(O=E()?w.Buf32:T.Buf32,O(e)),ae=function(){let e=!0;try{String.fromCharCode.apply(null,[0])}catch{e=!1}return ae=()=>e,e},oe=function(){let e=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{e=!1}return oe=()=>e,e},se=function(e){for(var t=re(256),n=0;n<256;n++)t[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;return t[254]=t[254]=1,se=e=>t[e],t[e]};function ce(e,t,n,r){for(var i=e&65535|0,a=e>>>16&65535|0,o=0;n!==0;){o=n>2e3?2e3:n,n-=o;do i=i+t[r++]|0,a=a+i|0;while(--o);i%=65521,a%=65521}return i|a<<16|0}function le(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=e&1?3988292384^e>>>1:e>>>1;t[n]=e}return t}let ue=function(){let e=le();return ue=()=>e,e};function de(e,t,n,r){var i=ue(),a=r+n;e^=-1;for(var o=r;o<a;o++)e=e>>>8^i[(e^t[o])&255];return e^-1}var fe=30,pe=12,k=15,me=852,he=592,ge=0,_e=1,ve=2,ye=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],be=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],xe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],Se=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];function Ce(e,t,n,r,i,a,o,s){var c=s.bits,l=0,u=0,d=0,f=0,p=0,m=0,h=0,g=0,_=0,v=0,y,b,x,S,C,ee=null,te=0,w,T=ie(k+1),E=ie(k+1),D=null,ne=0,re,O,ae;for(l=0;l<=k;l++)T[l]=0;for(u=0;u<r;u++)T[t[n+u]]++;for(p=c,f=k;f>=1&&T[f]===0;f--);if(p>f&&(p=f),f===0)return i[a++]=20971520,i[a++]=20971520,s.bits=1,0;for(d=1;d<f&&T[d]===0;d++);for(p<d&&(p=d),g=1,l=1;l<=k;l++)if(g<<=1,g-=T[l],g<0)return-1;if(g>0&&(e===ge||f!==1))return-1;for(E[1]=0,l=1;l<k;l++)E[l+1]=E[l]+T[l];for(u=0;u<r;u++)t[n+u]!==0&&(o[E[t[n+u]]++]=u);if(e===ge?(ee=D=o,w=19):e===_e?(ee=ye,te-=257,D=be,ne-=257,w=256):(ee=xe,D=Se,w=-1),v=0,u=0,l=d,C=a,m=p,h=0,x=-1,_=1<<p,S=_-1,e===_e&&_>me||e===ve&&_>he)return 1;for(;;){re=l-h,o[u]<w?(O=0,ae=o[u]):o[u]>w?(O=D[ne+o[u]],ae=ee[te+o[u]]):(O=96,ae=0),y=1<<l-h,b=1<<m,d=b;do b-=y,i[C+(v>>h)+b]=re<<24|O<<16|ae|0;while(b!==0);for(y=1<<l-1;v&y;)y>>=1;if(y===0?v=0:(v&=y-1,v+=y),u++,--T[l]===0){if(l===f)break;l=t[n+o[u]]}if(l>p&&(v&S)!==x){for(h===0&&(h=p),C+=d,m=l-h,g=1<<m;m+h<f&&(g-=T[m+h],!(g<=0));)m++,g<<=1;if(_+=1<<m,e===_e&&_>me||e===ve&&_>he)return 1;x=v&S,i[x]=p<<24|m<<16|C-a|0}}return v!==0&&(i[C+v]=l-h<<24|4194304),s.bits=p,0}var we=1,Te=2,Ee=0,De=-2,Oe=1,ke=852,Ae=592;function je(e){var t;return!e||!e.state?De:(t=e.state,e.total_in=e.total_out=t.total=0,e.msg=``,t.wrap&&(e.adler=t.wrap&1),t.mode=Oe,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=O(ke),t.distcode=t.distdyn=O(Ae),t.sane=1,t.back=-1,Ee)}function Me(e){var t;return!e||!e.state?De:(t=e.state,t.wsize=0,t.whave=0,t.wnext=0,je(e))}var Ne=!0,Pe,Fe,Ie={2:`need dictionary`,1:`stream end`,0:``,"-1":`file error`,"-2":`stream error`,"-3":`data error`,"-4":`insufficient memory`,"-5":`buffer error`,"-6":`incompatible version`};Object.prototype.toString;function A(e){for(var t=e.length;--t>=0;)e[t]=0}var Le=0,Re=1,ze=2,Be=3,Ve=258,He=29,j=256,M=j+1+He,N=30,Ue=19,We=2*M+1,P=15,Ge=16,Ke=7,qe=256,Je=16,Ye=17,Xe=18,Ze=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Qe=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],$e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],et=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],tt=512,F,I,L,R,nt,rt;function it(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}var at,ot,st;function ct(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function lt(e){return e<256?L[e]:L[256+(e>>>7)]}function ut(e,t){e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255}function z(e,t,n){e.bi_valid>Ge-n?(e.bi_buf|=t<<e.bi_valid&65535,ut(e,e.bi_buf),e.bi_buf=t>>Ge-e.bi_valid,e.bi_valid+=n-Ge):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function B(e,t,n){z(e,n[t*2],n[t*2+1])}function dt(e,t){var n=0;do n|=e&1,e>>>=1,n<<=1;while(--t>0);return n>>>1}function ft(e){e.bi_valid===16?(ut(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)}function pt(e,t){var n=t.dyn_tree,r=t.max_code,i=t.stat_desc.static_tree,a=t.stat_desc.has_stree,o=t.stat_desc.extra_bits,s=t.stat_desc.extra_base,c=t.stat_desc.max_length,l,u,d,f,p,m,h=0;for(f=0;f<=P;f++)e.bl_count[f]=0;for(n[e.heap[e.heap_max]*2+1]=0,l=e.heap_max+1;l<We;l++)u=e.heap[l],f=n[n[u*2+1]*2+1]+1,f>c&&(f=c,h++),n[u*2+1]=f,!(u>r)&&(e.bl_count[f]++,p=0,u>=s&&(p=o[u-s]),m=n[u*2],e.opt_len+=m*(f+p),a&&(e.static_len+=m*(i[u*2+1]+p)));if(h!==0){do{for(f=c-1;e.bl_count[f]===0;)f--;e.bl_count[f]--,e.bl_count[f+1]+=2,e.bl_count[c]--,h-=2}while(h>0);for(f=c;f!==0;f--)for(u=e.bl_count[f];u!==0;)d=e.heap[--l],!(d>r)&&(n[d*2+1]!==f&&(e.opt_len+=(f-n[d*2+1])*n[d*2],n[d*2+1]=f),u--)}}function mt(e,t,n){var r=Array(P+1),i=0,a,o;for(a=1;a<=P;a++)r[a]=i=i+n[a-1]<<1;for(o=0;o<=t;o++){var s=e[o*2+1];s!==0&&(e[o*2]=dt(r[s]++,s))}}function ht(){var e,t,n,r,i,a=Array(P+1);for(F=Array((M+2)*2),A(F),I=Array(N*2),A(I),L=Array(tt),A(L),R=Array(Ve-Be+1),A(R),nt=Array(He),A(nt),rt=Array(N),A(rt),n=0,r=0;r<He-1;r++)for(nt[r]=n,e=0;e<1<<Ze[r];e++)R[n++]=r;for(R[n-1]=r,i=0,r=0;r<16;r++)for(rt[r]=i,e=0;e<1<<Qe[r];e++)L[i++]=r;for(i>>=7;r<N;r++)for(rt[r]=i<<7,e=0;e<1<<Qe[r]-7;e++)L[256+ i++]=r;for(t=0;t<=P;t++)a[t]=0;for(e=0;e<=143;)F[e*2+1]=8,e++,a[8]++;for(;e<=255;)F[e*2+1]=9,e++,a[9]++;for(;e<=279;)F[e*2+1]=7,e++,a[7]++;for(;e<=287;)F[e*2+1]=8,e++,a[8]++;for(mt(F,M+1,a),e=0;e<N;e++)I[e*2+1]=5,I[e*2]=dt(e,5);at=new it(F,Ze,j+1,M,P),ot=new it(I,Qe,0,N,P),st=new it([],$e,0,Ue,Ke)}function gt(e){var t;for(t=0;t<M;t++)e.dyn_ltree[t*2]=0;for(t=0;t<N;t++)e.dyn_dtree[t*2]=0;for(t=0;t<Ue;t++)e.bl_tree[t*2]=0;e.dyn_ltree[qe*2]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function _t(e){e.bi_valid>8?ut(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function vt(e,t,n,r){_t(e),r&&(ut(e,n),ut(e,~n)),D(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}function yt(e,t,n,r){var i=t*2,a=n*2;return e[i]<e[a]||e[i]===e[a]&&r[t]<=r[n]}function bt(e,t,n){for(var r=e.heap[n],i=n<<1;i<=e.heap_len&&(i<e.heap_len&&yt(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!yt(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r}function xt(e,t,n){var r,i,a=0,o,s;if(e.last_lit!==0)do r=e.pending_buf[e.d_buf+a*2]<<8|e.pending_buf[e.d_buf+a*2+1],i=e.pending_buf[e.l_buf+a],a++,r===0?B(e,i,t):(o=R[i],B(e,o+j+1,t),s=Ze[o],s!==0&&(i-=nt[o],z(e,i,s)),r--,o=lt(r),B(e,o,n),s=Qe[o],s!==0&&(r-=rt[o],z(e,r,s)));while(a<e.last_lit);B(e,qe,t)}function St(e,t){var n=t.dyn_tree,r=t.stat_desc.static_tree,i=t.stat_desc.has_stree,a=t.stat_desc.elems,o,s,c=-1,l;for(e.heap_len=0,e.heap_max=We,o=0;o<a;o++)n[o*2]===0?n[o*2+1]=0:(e.heap[++e.heap_len]=c=o,e.depth[o]=0);for(;e.heap_len<2;)l=e.heap[++e.heap_len]=c<2?++c:0,n[l*2]=1,e.depth[l]=0,e.opt_len--,i&&(e.static_len-=r[l*2+1]);for(t.max_code=c,o=e.heap_len>>1;o>=1;o--)bt(e,n,o);l=a;do o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],bt(e,n,1),s=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=s,n[l*2]=n[o*2]+n[s*2],e.depth[l]=(e.depth[o]>=e.depth[s]?e.depth[o]:e.depth[s])+1,n[o*2+1]=n[s*2+1]=l,e.heap[1]=l++,bt(e,n,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],pt(e,t),mt(n,c,e.bl_count)}function Ct(e,t,n){var r,i=-1,a,o=t[1],s=0,c=7,l=4;for(o===0&&(c=138,l=3),t[(n+1)*2+1]=65535,r=0;r<=n;r++)a=o,o=t[(r+1)*2+1],!(++s<c&&a===o)&&(s<l?e.bl_tree[a*2]+=s:a===0?s<=10?e.bl_tree[Ye*2]++:e.bl_tree[Xe*2]++:(a!==i&&e.bl_tree[a*2]++,e.bl_tree[Je*2]++),s=0,i=a,o===0?(c=138,l=3):a===o?(c=6,l=3):(c=7,l=4))}function wt(e,t,n){var r,i=-1,a,o=t[1],s=0,c=7,l=4;for(o===0&&(c=138,l=3),r=0;r<=n;r++)if(a=o,o=t[(r+1)*2+1],!(++s<c&&a===o)){if(s<l)do B(e,a,e.bl_tree);while(--s!==0);else a===0?s<=10?(B(e,Ye,e.bl_tree),z(e,s-3,3)):(B(e,Xe,e.bl_tree),z(e,s-11,7)):(a!==i&&(B(e,a,e.bl_tree),s--),B(e,Je,e.bl_tree),z(e,s-3,2));s=0,i=a,o===0?(c=138,l=3):a===o?(c=6,l=3):(c=7,l=4)}}function Tt(e){var t;for(Ct(e,e.dyn_ltree,e.l_desc.max_code),Ct(e,e.dyn_dtree,e.d_desc.max_code),St(e,e.bl_desc),t=Ue-1;t>=3&&e.bl_tree[et[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t}function Et(e,t,n,r){var i;for(z(e,t-257,5),z(e,n-1,5),z(e,r-4,4),i=0;i<r;i++)z(e,e.bl_tree[et[i]*2+1],3);wt(e,e.dyn_ltree,t-1),wt(e,e.dyn_dtree,n-1)}function Dt(e){var t=4093624447,n;for(n=0;n<=31;n++,t>>>=1)if(t&1&&e.dyn_ltree[n*2]!==0)return x;if(e.dyn_ltree[18]!==0||e.dyn_ltree[20]!==0||e.dyn_ltree[26]!==0)return S;for(n=32;n<j;n++)if(e.dyn_ltree[n*2]!==0)return S;return x}var Ot=!1;function kt(e){Ot||=(ht(),!0),e.l_desc=new ct(e.dyn_ltree,at),e.d_desc=new ct(e.dyn_dtree,ot),e.bl_desc=new ct(e.bl_tree,st),e.bi_buf=0,e.bi_valid=0,gt(e)}function At(e,t,n,r){z(e,(Le<<1)+(r?1:0),3),vt(e,t,n,!0)}function jt(e,t,n,r){var i,a,o=0;e.level>0?(e.strm.data_type===C&&(e.strm.data_type=Dt(e)),St(e,e.l_desc),St(e,e.d_desc),o=Tt(e),i=e.opt_len+3+7>>>3,a=e.static_len+3+7>>>3,a<=i&&(i=a)):i=a=n+5,n+4<=i&&t!==-1?At(e,t,n,r):e.strategy===b||a===i?(z(e,(Re<<1)+(r?1:0),3),xt(e,F,I)):(z(e,(ze<<1)+(r?1:0),3),Et(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),xt(e,e.dyn_ltree,e.dyn_dtree)),gt(e),r&&_t(e)}function Mt(e,t,n){return e.pending_buf[e.d_buf+e.last_lit*2]=t>>>8&255,e.pending_buf[e.d_buf+e.last_lit*2+1]=t&255,e.pending_buf[e.l_buf+e.last_lit]=n&255,e.last_lit++,t===0?e.dyn_ltree[n*2]++:(e.matches++,t--,e.dyn_ltree[(R[n]+j+1)*2]++,e.dyn_dtree[lt(t)*2]++),e.last_lit===e.lit_bufsize-1}var Nt=286,Pt=30,Ft=19,It=2*Nt+1,Lt=15,V=3,Rt=258,H=Rt+V+1,zt=42,Bt=113,U=1,Vt=2,Ht=3,Ut=4;function Wt(e,t){return e.msg=Ie[t],t}function Gt(e){for(var t=e.length;--t>=0;)e[t]=0}function Kt(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),n!==0&&(D(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,t.pending===0&&(t.pending_out=0))}function W(e,t){jt(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Kt(e.strm)}function qt(e,t,n,r){var i=e.avail_in;return i>r&&(i=r),i===0?0:(e.avail_in-=i,D(t,e.input,e.next_in,i,n),e.state.wrap===1?e.adler=ce(e.adler,t,i,n):e.state.wrap===2&&(e.adler=de(e.adler,t,i,n)),e.next_in+=i,e.total_in+=i,i)}function Jt(e,t){var n=e.max_chain_length,r=e.strstart,i,a,o=e.prev_length,s=e.nice_match,c=e.strstart>e.w_size-H?e.strstart-(e.w_size-H):0,l=e.window,u=e.w_mask,d=e.prev,f=e.strstart+Rt,p=l[r+o-1],m=l[r+o];e.prev_length>=e.good_match&&(n>>=2),s>e.lookahead&&(s=e.lookahead);do{if(i=t,l[i+o]!==m||l[i+o-1]!==p||l[i]!==l[r]||l[++i]!==l[r+1])continue;r+=2,i++;do;while(l[++r]===l[++i]&&l[++r]===l[++i]&&l[++r]===l[++i]&&l[++r]===l[++i]&&l[++r]===l[++i]&&l[++r]===l[++i]&&l[++r]===l[++i]&&l[++r]===l[++i]&&r<f);if(a=Rt-(f-r),r=f-Rt,a>o){if(e.match_start=t,o=a,a>=s)break;p=l[r+o-1],m=l[r+o]}}while((t=d[t&u])>c&&--n!==0);return o<=e.lookahead?o:e.lookahead}function Yt(e){var t=e.w_size,n,r,i,a,o;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-H)){D(e.window,e.window,t,t,0),e.match_start-=t,e.strstart-=t,e.block_start-=t,r=e.hash_size,n=r;do i=e.head[--n],e.head[n]=i>=t?i-t:0;while(--r);r=t,n=r;do i=e.prev[--n],e.prev[n]=i>=t?i-t:0;while(--r);a+=t}if(e.strm.avail_in===0)break;if(r=qt(e.strm,e.window,e.strstart+e.lookahead,a),e.lookahead+=r,e.lookahead+e.insert>=V)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+V-1])&e.hash_mask,e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<V)););}while(e.lookahead<H&&e.strm.avail_in!==0)}function Xt(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(Yt(e),e.lookahead===0&&t===h)return U;if(e.lookahead===0)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+n;if((e.strstart===0||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,W(e,!1),e.strm.avail_out===0)||e.strstart-e.block_start>=e.w_size-H&&(W(e,!1),e.strm.avail_out===0))return U}return e.insert=0,t===g?(W(e,!0),e.strm.avail_out===0?Ht:Ut):(e.strstart>e.block_start&&(W(e,!1),e.strm.avail_out),U)}function Zt(e,t){for(var n,r;;){if(e.lookahead<H){if(Yt(e),e.lookahead<H&&t===h)return U;if(e.lookahead===0)break}if(n=0,e.lookahead>=V&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+V-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),n!==0&&e.strstart-n<=e.w_size-H&&(e.match_length=Jt(e,n)),e.match_length>=V)if(r=Mt(e,e.strstart-e.match_start,e.match_length-V),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=V){e.match_length--;do e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+V-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=Mt(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(W(e,!1),e.strm.avail_out===0))return U}return e.insert=e.strstart<V-1?e.strstart:V-1,t===g?(W(e,!0),e.strm.avail_out===0?Ht:Ut):e.last_lit&&(W(e,!1),e.strm.avail_out===0)?U:Vt}function G(e,t){for(var n,r,i;;){if(e.lookahead<H){if(Yt(e),e.lookahead<H&&t===h)return U;if(e.lookahead===0)break}if(n=0,e.lookahead>=V&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+V-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=V-1,n!==0&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-H&&(e.match_length=Jt(e,n),e.match_length<=5&&(e.strategy===y||e.match_length===V&&e.strstart-e.match_start>4096)&&(e.match_length=V-1)),e.prev_length>=V&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-V,r=Mt(e,e.strstart-1-e.prev_match,e.prev_length-V),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+V-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=V-1,e.strstart++,r&&(W(e,!1),e.strm.avail_out===0))return U}else if(e.match_available){if(r=Mt(e,0,e.window[e.strstart-1]),r&&W(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return U}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&=(r=Mt(e,0,e.window[e.strstart-1]),0),e.insert=e.strstart<V-1?e.strstart:V-1,t===g?(W(e,!0),e.strm.avail_out===0?Ht:Ut):e.last_lit&&(W(e,!1),e.strm.avail_out===0)?U:Vt}function K(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}let Qt=function(){let e=[new K(0,0,0,0,Xt),new K(4,4,8,4,Zt),new K(4,5,16,8,Zt),new K(4,6,32,32,Zt),new K(4,4,16,16,G),new K(8,16,32,32,G),new K(8,16,128,128,G),new K(8,32,128,256,G),new K(32,128,258,1024,G),new K(32,258,258,4096,G)];return Qt=()=>e,e};function $t(e){e.window_size=2*e.w_size,Gt(e.head);let t=Qt();e.max_lazy_match=t[e.level].max_lazy,e.good_match=t[e.level].good_length,e.nice_match=t[e.level].nice_length,e.max_chain_length=t[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=V-1,e.match_available=0,e.ins_h=0}function en(e){var t;return!e||!e.state?Wt(e,v):(e.total_in=e.total_out=0,e.data_type=C,t=e.state,t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?zt:Bt,e.adler=t.wrap===2?0:1,t.last_flush=h,kt(t),_)}Object.prototype.toString;var q={Promise};let J={base64:!0,array:!0,string:!0,nodebuffer:!1,nodestream:!1,get arraybuffer(){return typeof ArrayBuffer<`u`&&typeof Uint8Array<`u`},get uint8array(){return typeof Uint8Array<`u`},get blob(){return tn()}},tn=function(){let e;if(typeof ArrayBuffer>`u`)e=!1;else{let t=new ArrayBuffer(0);try{e=new Blob([t],{type:`application/zip`}).size===0}catch{e=!1}}return tn=()=>e,e},Y=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=`,nn=function(e){let t=[],n,r,i,a,o,s,c,l=0,u=e.length,d=u,f=typeof e!=`string`;for(;l<e.length;)d=u-l,f?(n=e[l++],r=l<u?e[l++]:0,i=l<u?e[l++]:0):(n=e.charCodeAt(l++),r=l<u?e.charCodeAt(l++):0,i=l<u?e.charCodeAt(l++):0),a=n>>2,o=(n&3)<<4|r>>4,s=d>1?(r&15)<<2|i>>6:64,c=d>2?i&63:64,t.push(Y.charAt(a)+Y.charAt(o)+Y.charAt(s)+Y.charAt(c));return t.join(``)},rn=function(e){let t,n,r,i,a,o,s,c=0,l=0;if(e.substr(0,5)===`data:`)throw Error(`Invalid base64 input, it looks like a data url.`);e=e.replace(/[^A-Za-z0-9\+\/\=]/g,``);let u=e.length*3/4;if(e.charAt(e.length-1)===Y.charAt(64)&&u--,e.charAt(e.length-2)===Y.charAt(64)&&u--,u%1!=0)throw Error(`Invalid base64 input, bad content length.`);let d;for(d=J.uint8array?new Uint8Array(u|0):Array(u|0);c<e.length;)i=Y.indexOf(e.charAt(c++)),a=Y.indexOf(e.charAt(c++)),o=Y.indexOf(e.charAt(c++)),s=Y.indexOf(e.charAt(c++)),t=i<<2|a>>4,n=(a&15)<<4|o>>2,r=(o&3)<<6|s,d[l++]=t,o!==64&&(d[l++]=n),s!==64&&(d[l++]=r);return d};function an(e){var t=null;return t=J.uint8array?new Uint8Array(e.length):Array(e.length),cn(e,t)}let on=function(e,t){return gn(`blob`),new Blob([e],{type:t})};function sn(e){return e}function cn(e,t){for(var n=0;n<e.length;++n)t[n]=e.charCodeAt(n)&255;return t}function ln(e,t,n){var r=[],i=0,a=e.length;if(a<=n)return String.fromCharCode.apply(null,e);for(;i<a;)t===`array`?r.push(String.fromCharCode.apply(null,e.slice(i,Math.min(i+n,a)))):r.push(String.fromCharCode.apply(null,e.subarray(i,Math.min(i+n,a)))),i+=n;return r.join(``)}function un(e){for(var t=``,n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}let dn=()=>{let e;try{e=J.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{e=!1}return dn=()=>e,e};function fn(e){var t=65536,n=Z(e),r=!0;if(n===`uint8array`&&(r=dn()),r)for(;t>1;)try{return ln(e,n,t)}catch{t=Math.floor(t/2)}return un(e)}let pn=fn;function mn(e,t){for(var n=0;n<e.length;n++)t[n]=e[n];return t}var hn={string:{string:sn,array:function(e){return cn(e,Array(e.length))},arraybuffer:function(e){return hn.string.uint8array(e).buffer},uint8array:function(e){return cn(e,new Uint8Array(e.length))}},array:{string:fn,array:sn,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)}},arraybuffer:{string:function(e){return fn(new Uint8Array(e))},array:function(e){return mn(new Uint8Array(e),Array(e.byteLength))},arraybuffer:sn,uint8array:function(e){return new Uint8Array(e)}},uint8array:{string:fn,array:function(e){return mn(e,Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:sn}};let X=function(e,t){return t||=``,e?(gn(e),hn[Z(t)][e](t)):t},Z=function(e){if(typeof e==`string`)return`string`;if(Object.prototype.toString.call(e)===`[object Array]`)return`array`;if(J.uint8array&&e instanceof Uint8Array)return`uint8array`;if(J.arraybuffer&&e instanceof ArrayBuffer)return`arraybuffer`},gn=function(e){if(!J[e.toLowerCase()])throw Error(e+` is not supported by this platform`)},_n=function(e,t,n){setTimeout(function(){e.apply(n||null,t||[])},0)},vn=function(){var e={},t,n;for(t=0;t<arguments.length;t++)for(n in arguments[t])Object.hasOwnProperty.call(arguments[t],n)&&e[n]===void 0&&(e[n]=arguments[t][n]);return e},yn=function(e,t,n,r,i){return q.Promise.resolve(t).then(function(e){return J.blob&&(e instanceof Blob||[`[object File]`,`[object Blob]`].indexOf(Object.prototype.toString.call(e))!==-1)&&typeof FileReader<`u`?new q.Promise(function(t,n){var r=new FileReader;r.onload=function(e){t(e.target.result)},r.onerror=function(e){n(e.target.error)},r.readAsArrayBuffer(e)}):e}).then(function(t){var a=Z(t);return a?(a===`arraybuffer`?t=X(`uint8array`,t):a===`string`&&(i?t=rn(t):n&&r!==!0&&(t=an(t))),t):q.Promise.reject(Error(`Can't read the data of '`+e+`'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?`))})};var Q=class{constructor(e){this.name=e||`default`,this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}push(e){this.emit(`data`,e)}end(){if(this.isFinished)return!1;this.flush();try{this.emit(`end`),this.cleanUp(),this.isFinished=!0}catch(e){this.emit(`error`,e)}return!0}error(e){return this.isFinished?!1:(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit(`error`,e),this.previous&&this.previous.error(e),this.cleanUp()),!0)}on(e,t){return this._listeners[e].push(t),this}cleanUp(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]}emit(e,t){if(this._listeners[e])for(var n=0;n<this._listeners[e].length;n++)this._listeners[e][n].call(this,t)}pipe(e){return e.registerPrevious(this)}registerPrevious(e){if(this.isLocked)throw Error(`The stream '`+this+`' has already been used.`);this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on(`data`,function(e){t.processChunk(e)}),e.on(`end`,function(){t.end()}),e.on(`error`,function(e){t.error(e)}),this}pause(){return this.isPaused||this.isFinished?!1:(this.isPaused=!0,this.previous&&this.previous.pause(),!0)}resume(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var e=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e}flush(){}processChunk(e){this.push(e)}withStreamInfo(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this}mergeStreamInfo(){for(var e in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(e)&&(this.streamInfo[e]=this.extraStreamInfo[e])}lock(){if(this.isLocked)throw Error(`The stream '`+this+`' has already been used.`);this.isLocked=!0,this.previous&&this.previous.lock()}toString(){var e=`Worker `+this.name;return this.previous?this.previous+` -> `+e:e}};let bn=function(e){let t=Array(256);for(let e=0;e<256;e++)t[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;return t[254]=t[254]=1,bn=function(e){return t[e]},t[e]};var xn=function(e){var t,n,r,i,a,o=e.length,s=0;for(i=0;i<o;i++)n=e.charCodeAt(i),(n&64512)==55296&&i+1<o&&(r=e.charCodeAt(i+1),(r&64512)==56320&&(n=65536+(n-55296<<10)+(r-56320),i++)),s+=n<128?1:n<2048?2:n<65536?3:4;for(t=J.uint8array?new Uint8Array(s):Array(s),a=0,i=0;a<s;i++)n=e.charCodeAt(i),(n&64512)==55296&&i+1<o&&(r=e.charCodeAt(i+1),(r&64512)==56320&&(n=65536+(n-55296<<10)+(r-56320),i++)),n<128?t[a++]=n:n<2048?(t[a++]=192|n>>>6,t[a++]=128|n&63):n<65536?(t[a++]=224|n>>>12,t[a++]=128|n>>>6&63,t[a++]=128|n&63):(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63,t[a++]=128|n>>>6&63,t[a++]=128|n&63);return t},Sn=function(e,t){var n;for(t||=e.length,t>e.length&&(t=e.length),n=t-1;n>=0&&(e[n]&192)==128;)n--;return n<0||n===0?t:n+bn(e[n])>t?n:t},Cn=function(e){var t,n,r,i,a=e.length,o=Array(a*2);for(n=0,t=0;t<a;){if(r=e[t++],r<128){o[n++]=r;continue}if(i=bn(r),i>4){o[n++]=65533,t+=i-1;continue}for(r&=i===2?31:i===3?15:7;i>1&&t<a;)r=r<<6|e[t++]&63,i--;if(i>1){o[n++]=65533;continue}r<65536?o[n++]=r:(r-=65536,o[n++]=55296|r>>10&1023,o[n++]=56320|r&1023)}return o.length!==n&&(o.subarray?o=o.subarray(0,n):o.length=n),pn(o)};let wn=function(e){return xn(e)},Tn=function(e){return e=X(J.uint8array?`uint8array`:`array`,e),Cn(e)};var En=class extends Q{constructor(){super(`utf-8 decode`),this.leftOver=null}processChunk(e){var t=X(J.uint8array?`uint8array`:`array`,e.data);if(this.leftOver&&this.leftOver.length){if(J.uint8array){var n=t;t=new Uint8Array(n.length+this.leftOver.length),t.set(this.leftOver,0),t.set(n,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var r=Sn(t),i=t;r!==t.length&&(J.uint8array?(i=t.subarray(0,r),this.leftOver=t.subarray(r,t.length)):(i=t.slice(0,r),this.leftOver=t.slice(r,t.length))),this.push({data:Tn(i),meta:e.meta})}flush(){this.leftOver&&this.leftOver.length&&(this.push({data:Tn(this.leftOver),meta:{}}),this.leftOver=null)}},Dn=class extends Q{constructor(){super(`utf-8 encode`)}processChunk(e){this.push({data:wn(e.data),meta:e.meta})}},On=class extends Q{constructor(e){super(`ConvertWorker to `+e),this.destType=e}processChunk(e){this.push({data:X(this.destType,e.data),meta:e.meta})}};function kn(e,t,n){switch(e){case`blob`:return on(X(`arraybuffer`,t),n);case`base64`:return nn(t);default:return X(e,t)}}function An(e,t){var n,r=0,i=null,a=0;for(n=0;n<t.length;n++)a+=t[n].length;switch(e){case`string`:return t.join(``);case`array`:return Array.prototype.concat.apply([],t);case`uint8array`:for(i=new Uint8Array(a),n=0;n<t.length;n++)i.set(t[n],r),r+=t[n].length;return i;default:throw Error(`concat : unsupported type '`+e+`'`)}}function jn(e,t){return new q.Promise(function(n,r){var i=[],a=e._internalType,o=e._outputType,s=e._mimeType;e.on(`data`,function(e,n){i.push(e),t&&t(n)}).on(`error`,function(e){i=[],r(e)}).on(`end`,function(){try{n(kn(o,An(a,i),s))}catch(e){r(e)}i=[]}).resume()})}var Mn=class{constructor(e,t,n){var r=t;switch(t){case`blob`:case`arraybuffer`:r=`uint8array`;break;case`base64`:r=`string`;break}try{this._internalType=r,this._outputType=t,this._mimeType=n,gn(r),this._worker=e.pipe(new On(r)),e.lock()}catch(e){this._worker=new Q(`error`),this._worker.error(e)}}accumulate(e){return jn(this,e)}on(e,t){var n=this;return e===`data`?this._worker.on(e,function(e){t.call(n,e.data,e.meta)}):this._worker.on(e,function(){_n(t,arguments,n)}),this}resume(){return _n(this._worker.resume,[],this._worker),this}pause(){return this._worker.pause(),this}},Nn=Object.freeze({__proto__:null,base64:!1,binary:!1,comment:null,compression:null,compressionOptions:null,createFolders:!0,date:null,dir:!1,dosPermissions:null,unixPermissions:null}),Pn=class extends Q{constructor(e){super(`DataWorker`);var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type=``,this._tickScheduled=!1,e.then(function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=Z(e),t.isPaused||t._tickAndRepeat()},function(e){t.error(e)})}cleanUp(){super.cleanUp(),this.data=null}resume(){return super.resume()?(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,_n(this._tickAndRepeat,[],this)),!0):!1}_tickAndRepeat(){this._tickScheduled=!1,!(this.isPaused||this.isFinished)&&(this._tick(),this.isFinished||(_n(this._tickAndRepeat,[],this),this._tickScheduled=!0))}_tick(){if(this.isPaused||this.isFinished)return!1;var e=16384,t=null,n=Math.min(this.max,this.index+e);if(this.index>=this.max)return this.end();switch(this.type){case`string`:t=this.data.substring(this.index,n);break;case`uint8array`:t=this.data.subarray(this.index,n);break;case`array`:t=this.data.slice(this.index,n);break}return this.index=n,this.push({data:t,meta:{percent:this.max?this.index/this.max*100:0}})}},Fn=class extends Q{constructor(e){super(`DataLengthProbe for `+e),this.propName=e,this.withStreamInfo(e,0)}processChunk(e){if(e){let t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}super.processChunk(e)}};let In=function(){let e=[];for(let t=0;t<256;t++){let n=t;for(let e=0;e<8;e++)n=n&1?3988292384^n>>>1:n>>>1;e[t]=n}return In=function(){return e},e};function Ln(e,t,n,r){let i=In(),a=r+n;e^=-1;for(let n=r;n<a;n++)e=e>>>8^i[(e^t[n])&255];return e^-1}function Rn(e,t,n,r){let i=In(),a=r+n;e^=-1;for(let n=r;n<a;n++)e=e>>>8^i[(e^t.charCodeAt(n))&255];return e^-1}function zn(e,t){return e===void 0||!e.length?0:Z(e)===`string`?Rn(t|0,e,e.length,0):Ln(t|0,e,e.length,0)}var Bn=class extends Q{constructor(){super(`Crc32Probe`),this.withStreamInfo(`crc32`,0)}processChunk(e){this.streamInfo.crc32=zn(e.data,this.streamInfo.crc32||0),this.push(e)}},Vn=class{constructor(e,t,n,r,i){this.compressedSize=e,this.uncompressedSize=t,this.crc32=n,this.compression=r,this.compressedContent=i}getContentWorker(){var e=new Pn(q.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new Fn(`data_length`)),t=this;return e.on(`end`,function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw Error(`Bug : uncompressed data size mismatch`)}),e}getCompressedWorker(){return new Pn(q.Promise.resolve(this.compressedContent)).withStreamInfo(`compressedSize`,this.compressedSize).withStreamInfo(`uncompressedSize`,this.uncompressedSize).withStreamInfo(`crc32`,this.crc32).withStreamInfo(`compression`,this.compression)}static createWorkerFrom(e,t,n){return e.pipe(new Bn).pipe(new Fn(`uncompressedSize`)).pipe(t.compressWorker(n)).pipe(new Fn(`compressedSize`)).withStreamInfo(`compression`,t)}},Hn=class{constructor(e,t,n){this.name=e,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this._data=t,this._dataBinary=n.binary,this.options={compression:n.compression,compressionOptions:n.compressionOptions}}internalStream(e){var t=null,n=`string`;try{if(!e)throw Error(`No output type specified.`);n=e.toLowerCase();var r=n===`string`||n===`text`;(n===`binarystring`||n===`text`)&&(n=`string`),t=this._decompressWorker();var i=!this._dataBinary;i&&!r&&(t=t.pipe(new Dn)),!i&&r&&(t=t.pipe(new En))}catch(e){t=new Q(`error`),t.error(e)}return new Mn(t,n,``)}async(e,t){return this.internalStream(e).accumulate(t)}_compressWorker(e,t){if(this._data instanceof Vn&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var n=this._decompressWorker();return this._dataBinary||(n=n.pipe(new Dn)),Vn.createWorkerFrom(n,e,t)}_decompressWorker(){return this._data instanceof Vn?this._data.getContentWorker():this._data instanceof Q?this._data:new Pn(this._data)}};let Un=function(){let e=typeof Uint8Array<`u`&&typeof Uint16Array<`u`&&typeof Uint32Array<`u`?`uint8array`:`array`;Un=function(){return e}};var Wn=function(e,t,n){var r=Z(t),i,a=vn(n||{},Nn);a.date=a.date||new Date,a.compression!==null&&(a.compression=a.compression.toUpperCase()),typeof a.unixPermissions==`string`&&(a.unixPermissions=parseInt(a.unixPermissions,8)),a.unixPermissions&&a.unixPermissions&16384&&(a.dir=!0),a.dosPermissions&&a.dosPermissions&16&&(a.dir=!0),a.dir&&(e=Kn(e)),a.createFolders&&(i=Gn(e))&&qn.call(this,i,!0);var o=r===`string`&&a.binary===!1&&a.base64===!1;(!n||n.binary===void 0)&&(a.binary=!o),(t instanceof Vn&&t.uncompressedSize===0||a.dir||!t||t.length===0)&&(a.base64=!1,a.binary=!0,t=``,a.compression=`STORE`,r=`string`);var s=null;s=t instanceof Vn||t instanceof Q?t:yn(e,t,a.binary,a.optimizedBinaryString,a.base64);var c=new Hn(e,s,a);this.files[e]=c},Gn=function(e){e.slice(-1)===`/`&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf(`/`);return t>0?e.substring(0,t):``},Kn=function(e){return e.slice(-1)!==`/`&&(e+=`/`),e},qn=function(e,t){return t=t===void 0?!0:t,e=Kn(e),this.files[e]||Wn.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function Jn(e,t,n){return(1461*(e+4800+((t-13)/12|0))/4|0)+(367*(t-1-12*((t-13)/12|0))/12|0)-(3*((e+4900+((t-13)/12|0))/100|0)/4|0)+n-32075}Jn(1900,0,-1),JSON.parse.bind(JSON);function Yn(e,t){let n=``;if(e!=null)if(Array.isArray(e))for(let r=0;r<e.length;++r)n+=t(e[r],r);else typeof e==`object`&&Object.keys(e).forEach((r,i)=>{n+=t(e[r],r,i)});return n}function Xn(e){let t=Math.floor(e/26)-1;return(t>=0?Xn(t):``)+String.fromCharCode(65+e%26)}let Zn=({ref:e,columns:t,generators:n})=>`
<autoFilter ref="${e}">
  ${Yn(t,e=>`
    <filterColumn colId="${e.index}">
      ${n[e.filter](e)}
    </filterColumn>
  `)}
</autoFilter>`,Qn=({logic:e,criteria:t})=>`
<customFilters ${e===`and`?`and="1"`:``}>
${Yn(t,e=>{let t=$.customOperator(e),n=$.customValue(e);return`<customFilter ${t?`operator="${t}"`:``} val="${n}"/>`})}
</customFilters>`,$n=({type:e})=>`<dynamicFilter type="${$.dynamicFilterType(e)}" />`,er=({type:e,value:t})=>`<top10 percent="${/percent$/i.test(e)?1:0}"
       top="${/^top/i.test(e)?1:0}"
       val="${t}" />`,tr=({blanks:e,values:t})=>`<filters ${e?`blank="1"`:``}>
    ${Yn(t,e=>`
      <filter val="${e}" />`)}
  </filters>`;function $(e){return Zn({ref:e.ref,columns:e.columns,generators:{custom:Qn,dynamic:$n,top:er,value:tr}})}$.customOperator=function(e){return{eq:`equal`,gt:`greaterThan`,gte:`greaterThanOrEqual`,lt:`lessThan`,lte:`lessThanOrEqual`,ne:`notEqual`,doesnotstartwith:`notEqual`,doesnotendwith:`notEqual`,doesnotcontain:`notEqual`,doesnotmatch:`notEqual`}[e.operator.toLowerCase()]},$.customValue=function(e){function t(e){return e.replace(/([*?])/g,`~$1`)}switch(e.operator.toLowerCase()){case`startswith`:case`doesnotstartwith`:return t(e.value)+`*`;case`endswith`:case`doesnotendwith`:return`*`+t(e.value);case`contains`:case`doesnotcontain`:return`*`+t(e.value)+`*`;default:return e.value}},$.dynamicFilterType=function(e){return{quarter1:`Q1`,quarter2:`Q2`,quarter3:`Q3`,quarter4:`Q4`,january:`M1`,february:`M2`,march:`M3`,april:`M4`,may:`M5`,june:`M6`,july:`M7`,august:`M8`,september:`M9`,october:`M10`,november:`M11`,december:`M12`}[e.toLowerCase()]||e},(function(e,t){var n=e.extend;let r=t.ConvertClass(m);a.register({compile:t.template}),t.ExcelExporter=t.Class.extend({init:function(e){this.options=e;var r=e.dataSource;if(r instanceof t.data.DataSource){r.filter()||(r.options.filter=void 0),this.dataSource=new r.constructor(n({},r.options,{page:e.allPages?0:r.page(),filter:r.filter(),pageSize:e.allPages||e.groupPaging?r.total():r.pageSize()||r.total(),sort:r.sort(),group:r.group(),aggregate:r.aggregate(),isExcelExportRequest:!0}));var i=r.data();if(i.length>0){if(e.hierarchy)for(var a=0;a<i.length;a++)(i[a].expanded===!1||i[a].expanded===void 0)&&(i[a].expanded=!0,i[a].shouldRestoreExpandedState=!0);this.dataSource._data=i;var o=this.dataSource.transport;r._isServerGrouped()&&o.options&&o.options.data&&(o.options.data=null)}}else this.dataSource=t.data.DataSource.create(r)},_hierarchy:function(){var e=this.options.hierarchy,t=this.dataSource;if(e&&t.level){e={itemLevel:function(e){return t.level(e)}};for(var n=t.view(),r=0,i,a=0;a<n.length;a++)i=t.level(n[a]),i>r&&(r=i);e.depth=r+1}else e=!1;return{hierarchy:e}},_restoreExpandedState:function(){var e=this.options,t=e.dataSource.data(),n=e.hierarchy;if(t.length>0&&n)for(var r=0;r<t.length;r++)t[r].shouldRestoreExpandedState&&(t[r].expanded=!1,delete t[r].shouldRestoreExpandedState)},workbook:function(){return e.Deferred((function(e){this.dataSource.fetch().then((function(){var t=new r(n({},this.options,this._hierarchy(),{data:this.dataSource.view(),groups:this.dataSource.group(),aggregates:this.dataSource.aggregates()})).workbook();e.resolve(t,this.dataSource.view())}).bind(this))}).bind(this)).promise()}}),window.kendo.excel=window.kendo.excel||{},window.kendo.excel.ExcelExporter=r,window.kendo.excel.TemplateService=a})(kendo.jQuery,kendo),(function(e,t){t.ExcelMixin={extend:function(t){t.events.push(`excelExport`),t.options.excel=e.extend(t.options.excel,this.options),t.saveAsExcel=this.saveAsExcel},options:{proxyURL:``,allPages:!1,filterable:!1,fileName:`Export.xlsx`,collapsible:!1},saveAsExcel:function(e){var n=this.options.excel||{},r=new t.ExcelExporter({columns:this.columns,dataSource:this.dataSource,allPages:n.allPages,filterable:n.filterable,hierarchy:n.hierarchy,collapsible:n.collapsible});r.workbook().then((function(i,a){if(this.trigger(`excelExport`,{workbook:i,data:a}))e&&e.resolve();else{var o=new t.ooxml.Workbook(i);o.options||={},o.options.skipCustomHeight=!0,o.toDataURLAsync().then(function(a){t.saveAs({dataURI:a,fileName:i.fileName||n.fileName,proxyURL:n.proxyURL,forceProxy:n.forceProxy}),r._restoreExpandedState&&r._restoreExpandedState(),e&&e.resolve()})}}).bind(this))}}})(kendo.jQuery,kendo),e.__meta__={id:`excel`,name:`Excel export`,category:`framework`,advanced:!0,mixin:!0,depends:[`data`,`ooxml`]}});
//# sourceMappingURL=kendo.excel.min.js.map