{"version":3,"file":"kendo.spreadsheet.min.js","names":[],"sources":["../../src/spreadsheet/dialogs.js","../../src/spreadsheet/borderpalette.js","../../src/spreadsheet/toolbar.js","../../src/spreadsheet/print.js","../../src/spreadsheet/customeditors.js","../../src/spreadsheet/sheetsbar.js","../../src/spreadsheet/filtermenu.js","../../src/spreadsheet/messages.js","../../src/spreadsheet/workbook.js","../../src/kendo.spreadsheet.js"],"sourcesContent":["import \"../kendo.core.js\";\nimport \"../kendo.binder.js\";\nimport \"../kendo.validator.js\";\nimport \"../kendo.icons.js\";\nimport \"../kendo.window.js\";\n\n(function(kendo) {\n    var $ = kendo.jQuery;\n    var ObservableObject = kendo.data.ObservableObject;\n\n    var MESSAGES = kendo.spreadsheet.messages.dialogs = {\n        apply: \"Apply\",\n        save: \"Save\",\n        cancel: \"Cancel\",\n        remove: \"Remove\",\n        retry: \"Retry\",\n        revert: \"Revert\",\n        okText: \"OK\",\n        formatCellsDialog: {\n            title: \"Format\",\n            categories: {\n                number: \"Number\",\n                currency: \"Currency\",\n                date: \"Date\"\n            }\n        },\n        fontFamilyDialog: {\n            title: \"Font\"\n        },\n        fontSizeDialog: {\n            title: \"Font size\"\n        },\n        bordersDialog: {\n            title: \"Borders\"\n        },\n        alignmentDialog: {\n            title: \"Alignment\",\n            buttons: {\n                justifyLeft: \"Align left\",\n                justifyCenter: \"Center\",\n                justifyRight: \"Align right\",\n                justifyFull: \"Justify\",\n                alignTop: \"Align top\",\n                alignMiddle: \"Align middle\",\n                alignBottom: \"Align bottom\"\n            }\n        },\n        mergeDialog: {\n            title: \"Merge cells\",\n            buttons: {\n                mergeCells: \"Merge all\",\n                mergeHorizontally: \"Merge horizontally\",\n                mergeVertically: \"Merge vertically\",\n                unmerge: \"Unmerge\"\n            }\n        },\n        freezeDialog: {\n            title: \"Freeze panes\",\n            buttons: {\n                freezePanes: \"Freeze panes\",\n                freezeRows: \"Freeze rows\",\n                freezeColumns: \"Freeze columns\",\n                unfreeze: \"Unfreeze panes\"\n            }\n        },\n        confirmationDialog: {\n            text: \"Are you sure you want to remove this sheet?\",\n            title: \"Sheet remove\"\n        },\n        validationDialog: {\n            title: \"Data Validation\",\n            hintMessage: \"Please enter a valid {0} value {1}.\",\n            hintTitle: \"Validation {0}\",\n            criteria: {\n                any: \"Any value\",\n                number: \"Number\",\n                text: \"Text\",\n                date: \"Date\",\n                custom: \"Custom Formula\",\n                list: \"List\"\n            },\n            comparers: {\n                greaterThan: \"greater than\",\n                lessThan: \"less than\",\n                between: \"between\",\n                notBetween: \"not between\",\n                equalTo: \"equal to\",\n                notEqualTo: \"not equal to\",\n                greaterThanOrEqualTo: \"greater than or equal to\",\n                lessThanOrEqualTo: \"less than or equal to\"\n            },\n            comparerMessages: {\n                greaterThan: \"greater than {0}\",\n                lessThan: \"less than {0}\",\n                between: \"between {0} and {1}\",\n                notBetween: \"not between {0} and {1}\",\n                equalTo: \"equal to {0}\",\n                notEqualTo: \"not equal to {0}\",\n                greaterThanOrEqualTo: \"greater than or equal to {0}\",\n                lessThanOrEqualTo: \"less than or equal to {0}\",\n                custom: \"that satisfies the formula: {0}\"\n            },\n            labels: {\n                criteria: \"Criteria\",\n                comparer: \"Comparer\",\n                min: \"Min\",\n                max: \"Max\",\n                value: \"Value\",\n                start: \"Start\",\n                end: \"End\",\n                onInvalidData: \"On invalid data\",\n                rejectInput: \"Reject input\",\n                showWarning: \"Show warning\",\n                showHint: \"Show hint\",\n                hintTitle: \"Hint title\",\n                hintMessage: \"Hint message\",\n                ignoreBlank: \"Ignore blank\",\n                showListButton: \"Display button to show list\",\n                showCalendarButton: \"Display button to show calendar\"\n            },\n            placeholders: {\n                typeTitle: \"Type title\",\n                typeMessage: \"Type message\"\n            }\n        },\n        exportAsDialog: {\n            title: \"Export...\",\n            defaultFileName: \"Workbook\",\n            xlsx: {\n                description: \"Excel Workbook (.xlsx)\"\n            },\n            pdf: {\n                description: \"Portable Document Format (.pdf)\",\n                area: {\n                    workbook: \"Entire Workbook\",\n                    sheet: \"Active Sheet\",\n                    selection: \"Selection\"\n                },\n                paper: {\n                    a2        : \"A2 (420 mm × 594 mm)\",\n                    a3        : \"A3 (297 mm x 420 mm)\",\n                    a4        : \"A4 (210 mm x 297 mm)\",\n                    a5        : \"A5 (148 mm x 210 mm)\",\n                    b3        : \"B3 (353 mm × 500 mm)\",\n                    b4        : \"B4 (250 mm x 353 mm)\",\n                    b5        : \"B5 (176 mm x 250 mm)\",\n                    folio     : 'Folio (8.5\" x 13\")',\n                    legal     : 'Legal (8.5\" x 14\")',\n                    letter    : 'Letter (8.5\" x 11\")',\n                    tabloid   : 'Tabloid (11\" x 17\")',\n                    executive : 'Executive (7.25\" x 10.5\")'\n                },\n                margin: {\n                    normal: \"Normal\",\n                    narrow: \"Narrow\",\n                    wide: \"Wide\"\n                }\n            },\n            labels: {\n                scale: \"Scale\",\n                fit: \"Fit to page\",\n                fileName: \"File name\",\n                saveAsType: \"Save as type\",\n                exportArea: \"Export\",\n                paperSize: \"Paper size\",\n                margins: \"Margins\",\n                orientation: \"Orientation\",\n                print: \"Print\",\n                guidelines: \"Guidelines\",\n                center: \"Center\",\n                horizontally: \"Horizontally\",\n                vertically: \"Vertically\"\n            }\n        },\n        modifyMergedDialog: {\n            errorMessage: \"Cannot change part of a merged cell.\"\n        },\n        rangeDisabledDialog: {\n            errorMessage: \"Destination range contains disabled cells.\"\n        },\n        intersectsArrayDialog: {\n            errorMessage: \"You cannot alter part of an array\"\n        },\n        incompatibleRangesDialog: {\n            errorMessage: \"Incompatible ranges\"\n        },\n        noFillDirectionDialog: {\n            errorMessage: \"Cannot determine fill direction\"\n        },\n        duplicateSheetNameDialog: {\n            errorMessage: \"Duplicate sheet name\"\n        },\n        overflowDialog: {\n            errorMessage: \"Cannot paste, because the copy area and the paste area are not the same size and shape.\"\n        },\n        useKeyboardDialog: {\n            title: \"Copying and pasting\",\n            errorMessage: \"These actions cannot be invoked through the menu. Please use the keyboard shortcuts instead:\",\n            labels: {\n                forCopy: \"for copy\",\n                forCut: \"for cut\",\n                forPaste: \"for paste\"\n            }\n        },\n        unsupportedSelectionDialog: {\n            errorMessage: \"That action cannot be performed on multiple selection.\"\n        },\n        linkDialog: {\n            title: \"Hyperlink\",\n            labels: {\n                text: \"Text\",\n                url: \"Address\",\n                removeLink: \"Remove link\"\n            }\n        },\n        sheetRenameDialog: {\n            title: \"Rename Sheet\",\n            labels: {\n                text: \"Rename Sheet\",\n                rename: \"Rename\"\n            }\n        },\n        insertCommentDialog: {\n            title: \"Insert comment\",\n            labels: {\n                comment: \"Comment\",\n                removeComment: \"Remove comment\"\n            }\n        },\n        insertImageDialog: {\n            title: \"Insert image\",\n            info: \"Drag an image here, or click to select\",\n            typeError: \"Please select a JPEG, PNG or GIF image\"\n        }\n    };\n\n    var registry = {};\n    kendo.spreadsheet.dialogs = {\n        register: function(name, dialogClass) {\n            registry[name] = dialogClass;\n        },\n        registered: function(name) {\n            return !!registry[name];\n        },\n        create: function(name, options) {\n            var dialogClass = registry[name];\n\n            if (dialogClass) {\n                return new dialogClass(options);\n            }\n        }\n    };\n\n    var SpreadsheetDialog = kendo.spreadsheet.SpreadsheetDialog = kendo.Observable.extend({\n        init: function(options) {\n            kendo.Observable.fn.init.call(this, options);\n\n            this.options = translate($.extend(true, {}, this.options, options));\n\n            this.bind(this.events, options);\n        },\n        events: [\n            \"close\",\n            \"activate\"\n        ],\n        options: {\n            autoFocus: true\n        },\n        dialog: function() {\n            if (!this._dialog) {\n                var options = {\n                    autoFocus: false,\n                    scrollable: false,\n                    resizable: false,\n                    modal: true,\n                    visible: false,\n                    width: this.options.width || 320,\n                    title: this.options.title,\n                    open: function() {\n                        this.center();\n                    },\n                    close: this._onDialogClose.bind(this),\n                    activate: this._onDialogActivate.bind(this),\n                    deactivate: this._onDialogDeactivate.bind(this)\n                };\n                this._dialog = $(\"<div class='k-spreadsheet-window k-action-window k-popup-edit-form' />\")\n                    .addClass(this.options.className || \"\")\n                    .append(kendo.template(this.options.template)({\n                        messages: kendo.spreadsheet.messages.dialogs || MESSAGES,\n                        ns: kendo.ns,\n\n                        // this is for ImportErrorDialog.  ugly that\n                        // we need this line here, but I couldn't\n                        // figure out a better way\n                        errors: this.options.errors\n                    }))\n                    .kendoWindow(options)\n                    .data(\"kendoWindow\");\n            }\n\n            return this._dialog;\n        },\n        _onDialogClose: function() {\n            this.trigger(\"close\", {\n                action: this._action\n            });\n        },\n        _onDialogActivate: function() {\n            this.trigger(\"activate\");\n        },\n        _onDialogDeactivate: function() {\n            this.trigger(\"deactivate\");\n            this.destroy();\n        },\n        destroy: function() {\n            if (this._dialog) {\n                this._dialog.destroy();\n                this._dialog = null;\n            }\n        },\n        open: function() {\n            this.dialog().open();\n            this.dialog().element.find(\".k-button-primary\").trigger(\"focus\");\n        },\n        apply: function() {\n            this.close();\n        },\n        close: function() {\n            this._action = \"close\";\n\n            this.dialog().close();\n        }\n    });\n\n    function formattedValue(value, format) {\n        return kendo.spreadsheet.formatting.text(value, format);\n    }\n\n    var FormatCellsViewModel = kendo.spreadsheet.FormatCellsViewModel = ObservableObject.extend({\n        init: function(options) {\n            ObservableObject.fn.init.call(this, options);\n\n            this.useCategory(this.category);\n        },\n        useCategory: function(category) {\n            var type = category && category.type || \"number\";\n            var formatCurrency = type == \"currency\";\n\n            this.category = category;\n\n            this.set(\"showCurrencyFilter\", formatCurrency && this.currencies.length > 1);\n\n            if (!formatCurrency) {\n                this.set(\"formats\", this.allFormats[type + \"Formats\"]);\n            } else {\n                this.currency(this.currencies[0]);\n            }\n\n            this.useFirstFormat();\n        },\n        useFirstFormat: function() {\n            if (this.formats.length) {\n                this.set(\"format\", this.formats[0].value);\n            }\n        },\n        currency: function(currency) {\n            if (currency !== undefined) {\n                this._currency = currency;\n\n                var info = currency.value;\n                var formats = [\n                    { currency: info, decimals: true },\n                    { currency: info, decimals: true, iso: true },\n                    { currency: info, decimals: false }\n                ];\n\n                formats = formats.map(function(format) {\n                    format = FormatCellsViewModel.convert.currency(format);\n\n                    return { value: format, name: formattedValue(1000, format) };\n                });\n\n                this.set(\"formats\", formats);\n\n                this.useFirstFormat();\n            }\n\n            return this._currency || this.currencies[0];\n        },\n        categoryFilter: function(category) {\n            if (category !== undefined) {\n                this.useCategory(category);\n            }\n\n            return this.category;\n        },\n        preview: function() {\n            var format = this.get(\"format\");\n            var value = this.value || 0;\n\n            if (format && format.length) {\n                return formattedValue(value, format);\n            } else {\n                return value;\n            }\n        }\n    });\n\n    FormatCellsViewModel.convert = {\n        currency: function(options) {\n            function repeat(token, n) {\n                return new Array(n+1).join(token);\n            }\n\n            // convert culture info to spreadsheet format\n            var info = options.currency;\n            var format = info.pattern[1];\n\n            if (options.decimals) {\n                format = format.replace(/n/g, \"n\" + info[\".\"] + repeat(\"0\", info.decimals));\n            }\n\n            if (options.iso) {\n                format = '\"' + info.abbr + '\" ' + format.replace(/\\s*\\$\\s*/g, \"\");\n            } else {\n                format = format.replace(/\\$/g, JSON.stringify(info.symbol));\n            }\n\n            format = format.replace(/n/g, \"?\");\n\n            return format;\n        },\n        date: function(format) {\n            if ((/T|Z/).test(format)) {\n                return \"\";\n            }\n\n            return format.toLowerCase().replace(/tt/g, \"AM/PM\").replace(/'/g, '\"');\n        }\n    };\n\n    function uniqueBy(field, array) {\n        var result = [];\n        var values = [];\n\n        for (var i = 0; i < array.length; i++) {\n            if ($.inArray(array[i][field], values) == -1) {\n                result.push(array[i]);\n                values.push(array[i][field]);\n            }\n        }\n\n        return result;\n    }\n\n    var FormatCellsDialog = SpreadsheetDialog.extend({\n        init: function(options) {\n            var messages = kendo.spreadsheet.messages.dialogs.formatCellsDialog || MESSAGES;\n            var defaultOptions = {\n                title: messages.title,\n                categories: [\n                    { type: \"number\", name: messages.categories.number },\n                    { type: \"currency\", name: messages.categories.currency },\n                    { type: \"date\", name: messages.categories.date }\n                ]\n            };\n\n            SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n\n            this._generateFormats();\n        },\n        options: {\n            className: \"k-spreadsheet-format-cells\",\n            template: (data) => {\n                let $kendoOutput;\n                $kendoOutput = `<div class='k-edit-form-container'><div class='k-root-tabs' data-${kendo.htmlEncode(data.ns)}role='tabstrip' data-${kendo.htmlEncode(data.ns)}text-field='name' data-${kendo.htmlEncode(data.ns)}bind='source: categories, value: categoryFilter' data-${kendo.htmlEncode(data.ns)}animation='false'></div>\n    <div class='k-spreadsheet-preview' data-${kendo.htmlEncode(data.ns)}bind='text: preview'></div><select data-${kendo.htmlEncode(data.ns)}role='dropdownlist' class='k-format-filter' data-${kendo.htmlEncode(data.ns)}text-field='description' data-${kendo.htmlEncode(data.ns)}value-field='value.name' data-${kendo.htmlEncode(data.ns)}bind='visible: showCurrencyFilter, value: currency, source: currencies'></select><ul data-${kendo.htmlEncode(data.ns)}role='staticlist' tabindex='0' id='formats-list' aria-label='formats list' class='k-list k-reset' bind:data-${kendo.htmlEncode(data.ns)}template='formatItemTemplate' data-${kendo.htmlEncode(data.ns)}value-primitive='true' data-${kendo.htmlEncode(data.ns)}value-field='value' data-${kendo.htmlEncode(data.ns)}bind='source: formats, value: format'></ul>\n    <div class='k-actions'><button class='k-button k-button-primary' data-${kendo.htmlEncode(data.ns)}bind='click: apply'><span class='k-button-text'>${kendo.htmlEncode(data.messages.apply)}</span></button><button class='k-button' data-${kendo.htmlEncode(data.ns)}bind='click: close'><span class='k-button-text'>${kendo.htmlEncode(data.messages.cancel)}</span></button></div>\n</div>`;\n                return $kendoOutput;\n            }\n        },\n        _generateFormats: function() {\n            var options = this.options;\n\n            if (!options.currencies) {\n                options.currencies = FormatCellsDialog.currenciesFrom(kendo.cultures);\n            }\n\n            if (!options.numberFormats) {\n                options.numberFormats = [\n                    { value: \"#.00%\", name: \"100.00%\" },\n                    { value: \"#%\", name: \"100%\" },\n                    { value: \"#.00\", name: \"1024.00\" },\n                    { value: \"#,###.00\", name: \"1,024.00\" }\n                ];\n            }\n\n            if (!options.dateFormats) {\n                var calendarPatterns = kendo.cultures.current.calendars.standard.patterns;\n\n                options.dateFormats = uniqueBy(\"value\", $.map(calendarPatterns, function(format) {\n                    format = FormatCellsViewModel.convert.date(format);\n\n                    if (!format) {\n                        return;\n                    }\n\n                    return { value: format, name: formattedValue(34567.7678, format) };\n                }));\n            }\n        },\n        open: function(range) {\n            var options = this.options;\n            var value = range.value();\n            var categories = options.categories.slice(0);\n            var element;\n\n            this.viewModel = new FormatCellsViewModel({\n                currencies: options.currencies.slice(0),\n                allFormats: {\n                    numberFormats: options.numberFormats.slice(0),\n                    dateFormats: options.dateFormats.slice(0)\n                },\n                categories: categories,\n                format: range.format(),\n                category: value instanceof Date ? categories[2] : categories[0],\n                apply: this.apply.bind(this),\n                close: this.close.bind(this),\n                value: value,\n                formatItemTemplate: (data) => kendo.htmlEncode(data.name)\n            });\n\n            SpreadsheetDialog.fn.open.call(this);\n\n            element = this.dialog().element;\n\n            kendo.bind(element, this.viewModel);\n\n            var currencyFilter = element.find(\"select.k-format-filter\").data(\"kendoDropDownList\");\n\n            if (options.currencies.length > 10) {\n                currencyFilter.setOptions({ filter: \"contains\" });\n            }\n\n            element.find(kendo.roleSelector(\"staticlist\")).parent().addClass(\"k-list-wrapper\");\n\n            element.find(\".k-tabstrip-item\").attr(\"aria-controls\", \"formats-list\");\n        },\n        apply: function() {\n            var format = this.viewModel.format;\n\n            SpreadsheetDialog.fn.apply.call(this);\n\n            this.trigger(\"action\", {\n                command: \"PropertyChangeCommand\",\n                options: {\n                    property: \"format\",\n                    value: format\n                }\n            });\n        }\n    });\n\n    FormatCellsDialog.currenciesFrom = function (cultures) {\n        return uniqueBy(\"description\", $.map(cultures, function(culture, name) {\n            if (!(/-/).test(name)) {\n                return;\n            }\n\n            var currency = culture.numberFormat.currency;\n            var description = kendo.format(\n                \"{0} ({1}, {2})\",\n                currency.name,\n                currency.abbr,\n                currency.symbol\n            );\n\n            return { description: description, value: currency };\n        }));\n    };\n\n    kendo.spreadsheet.dialogs.register(\"formatCells\", FormatCellsDialog);\n\n    kendo.spreadsheet.dialogs.FormatCellsDialog = FormatCellsDialog;\n\n    var MessageDialog = SpreadsheetDialog.extend({\n        options: {\n            className: \"k-spreadsheet-message\",\n            title: \"\",\n            messageId: \"\",\n            text: \"\",\n            template: (data) => {\n                let $kendoOutput;\n                $kendoOutput = `<div class='k-spreadsheet-message-content' data-${kendo.htmlEncode(data.ns)}bind='text: text'></div>\n<div class='k-actions'><button class='k-button k-button-primary'\n        data-${kendo.htmlEncode(data.ns)}bind='click: close'><span\n            class='k-button-text'>${data.messages.okText}</span></button></div>`;\n                return $kendoOutput;\n            }\n        },\n        open: function() {\n            SpreadsheetDialog.fn.open.call(this);\n\n            var options = this.options;\n            var text = options.text;\n\n            if (options.messageId) {\n                text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n            }\n\n            kendo.bind(this.dialog().element, {\n                text: text,\n                close: this.close.bind(this)\n            });\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"message\", MessageDialog);\n\n    var ConfirmationDialog = SpreadsheetDialog.extend({\n        init: function(options) {\n            var messages = kendo.spreadsheet.messages.dialogs.confirmationDialog || MESSAGES;\n            var defaultOptions = {\n                title: messages.title,\n                text: messages.text\n            };\n\n            SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n        },\n        options: {\n            className: \"k-spreadsheet-message\",\n            messageId: \"\",\n            template: (data) => {\n                let $kendoOutput;\n                $kendoOutput = `<div class='k-spreadsheet-message-content' data-${kendo.htmlEncode(data.ns)}bind='text: text'></div>\n<div class='k-actions'><button class='k-button k-button-primary'\n        data-${kendo.htmlEncode(data.ns)}bind='click: confirm'><span\n            class='k-button-text'>${data.messages.okText}</span></button><button\n        class='k-button'\n        data-${kendo.htmlEncode(data.ns)}bind='click: cancel'><span\n            class='k-button-text'>${data.messages.cancel}</span></button></div>`;\n                return $kendoOutput;\n            }\n        },\n        open: function() {\n            SpreadsheetDialog.fn.open.call(this);\n\n            var options = this.options;\n            var text = options.text;\n\n            if (options.messageId) {\n                text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n            }\n\n            kendo.bind(this.dialog().element, {\n                text: text,\n                confirm: this.confirm.bind(this),\n                cancel: this.close.bind(this)\n            });\n        },\n        isConfirmed: function() {\n            return this._confirmed;\n        },\n        confirm: function() {\n            this._confirmed = true;\n            this.close();\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"confirmation\", ConfirmationDialog);\n\n    var ValidationErrorDialog = SpreadsheetDialog.extend({\n        options: {\n            className: \"k-spreadsheet-message\",\n            title: \"\",\n            messageId: \"\",\n            text: \"\",\n            template: (data) => {\n                let $kendoOutput;\n                $kendoOutput = `<div class='k-spreadsheet-message-content' data-${kendo.htmlEncode(data.ns)}bind='text: text'></div><div class='k-actions'><button class='k-button k-button-primary' data-${kendo.htmlEncode(data.ns)}bind='click: retry'><span class='k-button-text'>${data.messages.retry}</span></button><button class='k-button' data-${kendo.htmlEncode(data.ns)}bind='click: cancel'><span class='k-button-text'>${data.messages.cancel}</span></button></div>`;\n                return $kendoOutput;\n            }\n        },\n        open: function() {\n            SpreadsheetDialog.fn.open.call(this);\n\n            var options = this.options;\n            var text = options.text;\n\n            if (options.messageId) {\n                text = kendo.getter(options.messageId, true)(kendo.spreadsheet.messages.dialogs);\n            }\n\n            kendo.bind(this.dialog().element, {\n                text: text,\n                retry: this.retry.bind(this),\n                cancel: this.close.bind(this)\n            });\n        },\n        retry: function() {\n            this._retry = true;\n            this.close();\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"validationError\", ValidationErrorDialog);\n\n    var FontFamilyDialog = SpreadsheetDialog.extend({\n        init: function(options) {\n            var messages = kendo.spreadsheet.messages.dialogs.fontFamilyDialog || MESSAGES;\n\n            SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n\n            this._list();\n        },\n        options: {\n            template: () => \"<ul class='k-list k-reset'></ul>\"\n        },\n        _list: function() {\n            var ul = this.dialog().element.find(\"ul\");\n            var fonts = this.options.options;\n            var defaultFont = this.options.default;\n\n            this.list = new kendo.ui.StaticList(ul, {\n                dataSource: new kendo.data.DataSource({ data: fonts }),\n                template: (data) => kendo.htmlEncode(data),\n                value: defaultFont,\n                change: this.apply.bind(this)\n            });\n\n            this.list.dataSource.fetch();\n        },\n        apply: function(e) {\n            SpreadsheetDialog.fn.apply.call(this);\n\n            this.trigger(\"action\", {\n                command: \"PropertyChangeCommand\",\n                options: {\n                    property: \"fontFamily\",\n                    value: e.sender.value()[0]\n                }\n            });\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"fontFamily\", FontFamilyDialog);\n\n    var FontSizeDialog = SpreadsheetDialog.extend({\n        init: function(options) {\n            var messages = kendo.spreadsheet.messages.dialogs.fontSizeDialog || MESSAGES;\n\n            SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n\n            this._list();\n        },\n        options: {\n            template: () => \"<ul class='k-list k-reset'></ul>\"\n        },\n        _list: function() {\n            var ul = this.dialog().element.find(\"ul\");\n            var sizes = this.options.options;\n            var defaultSize = this.options.default;\n\n            this.list = new kendo.ui.StaticList(ul, {\n                dataSource: new kendo.data.DataSource({ data: sizes }),\n                template: (data) => kendo.htmlEncode(data),\n                value: defaultSize,\n                change: this.apply.bind(this)\n            });\n\n            this.list.dataSource.fetch();\n        },\n        apply: function(e) {\n            SpreadsheetDialog.fn.apply.call(this);\n\n            this.trigger(\"action\", {\n                command: \"PropertyChangeCommand\",\n                options: {\n                    property: \"fontSize\",\n                    value: kendo.parseInt(e.sender.value()[0])\n                }\n            });\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"fontSize\", FontSizeDialog);\n\n    var BordersDialog = SpreadsheetDialog.extend({\n        init: function(options) {\n            var messages = kendo.spreadsheet.messages.dialogs.bordersDialog || MESSAGES;\n\n            SpreadsheetDialog.fn.init.call(this, $.extend({ title: messages.title }, options));\n\n            this.element = this.dialog().element;\n            this._borderPalette();\n\n            this.viewModel = kendo.observable({\n                apply: this.apply.bind(this),\n                close: this.close.bind(this)\n            });\n\n            kendo.bind(this.element.find(\".k-actions\"), this.viewModel);\n        },\n        options: {\n            template: (data) => {\n                let $kendoOutput;\n                $kendoOutput = `<div></div>\n<div class='k-actions'><button class='k-button k-button-primary'\n        data-${kendo.htmlEncode(data.ns)}bind='click: apply'><span\n            class='k-button-text'>${kendo.htmlEncode(data.messages.apply)}</span></button><button\n        class='k-button'\n        data-${kendo.htmlEncode(data.ns)}bind='click: close'><span\n            class='k-button-text'>${kendo.htmlEncode(data.messages.cancel)}</span></button></div>`;\n                return $kendoOutput;\n            }\n        },\n        apply: function() {\n            SpreadsheetDialog.fn.apply.call(this);\n\n            var state = this.borderPalette.value();\n\n            if (state.color && state.type) {\n                this.trigger(\"action\", {\n                    command: \"BorderChangeCommand\",\n                    options: {\n                        border: state.type,\n                        style: { size: 1, color: state.color }\n                    }\n                });\n            }\n        },\n        _borderPalette: function() {\n            var element = this.dialog().element.find(\"div\").first();\n\n            this.borderPalette = new kendo.spreadsheet.BorderPalette(element, {\n                change: this.value.bind(this)\n            });\n        },\n        value: function(state) {\n            if (state === undefined) {\n                return this._state;\n            } else {\n                this._state = state;\n            }\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"borders\", BordersDialog);\n\n    var ColorChooser = SpreadsheetDialog.extend({\n        init: function(options) {\n            SpreadsheetDialog.fn.init.call(this, options);\n\n            this.element = this.dialog().element;\n            this.property = options.property;\n            this.options.title = options.title;\n\n            this.viewModel = kendo.observable({\n                apply: this.apply.bind(this),\n                close: this.close.bind(this)\n            });\n\n            kendo.bind(this.element.find(\".k-actions\"), this.viewModel);\n        },\n        options: {\n            template: (data) => {\n                let $kendoOutput;\n                $kendoOutput = `<div></div>\n<div class='k-actions'><button class='k-button k-button-primary'\n        data-${kendo.htmlEncode(data.ns)}bind='click: apply'><span\n            class='k-button-text'>${kendo.htmlEncode(data.messages.apply)}</span></button><button\n        class='k-button'\n        data-${kendo.htmlEncode(data.ns)}bind='click: close'><span\n            class='k-button-text'>${kendo.htmlEncode(data.messages.cancel)}</span></button></div>`;\n                return $kendoOutput;\n            }\n        },\n        apply: function() {\n            SpreadsheetDialog.fn.apply.call(this);\n\n            this.trigger(\"action\", {\n                command: \"PropertyChangeCommand\",\n                options: {\n                    property: this.property,\n                    value: this.value()\n                }\n            });\n        },\n        value: function(e) {\n            if (e === undefined) {\n                return this._value;\n            } else {\n                this._value = e.value;\n            }\n        }\n    });\n\n    var ColorPickerDialog = ColorChooser.extend({\n        init: function(options) {\n            options.width = 177;\n            ColorChooser.fn.init.call(this, options);\n            this._colorPalette();\n        },\n        _colorPalette: function() {\n            var element = this.dialog().element.find(\"div\").first();\n            this.colorPalette = element.kendoColorPalette({\n                palette: [ //metro palette\n                    \"#ffffff\", \"#000000\", \"#d6ecff\", \"#4e5b6f\", \"#7fd13b\", \"#ea157a\", \"#feb80a\", \"#00addc\", \"#738ac8\", \"#1ab39f\",\n                    \"#f2f2f2\", \"#7f7f7f\", \"#a7d6ff\", \"#d9dde4\", \"#e5f5d7\", \"#fad0e4\", \"#fef0cd\", \"#c5f2ff\", \"#e2e7f4\", \"#c9f7f1\",\n                    \"#d8d8d8\", \"#595959\", \"#60b5ff\", \"#b3bcca\", \"#cbecb0\", \"#f6a1c9\", \"#fee29c\", \"#8be6ff\", \"#c7d0e9\", \"#94efe3\",\n                    \"#bfbfbf\", \"#3f3f3f\", \"#007dea\", \"#8d9baf\", \"#b2e389\", \"#f272af\", \"#fed46b\", \"#51d9ff\", \"#aab8de\", \"#5fe7d5\",\n                    \"#a5a5a5\", \"#262626\", \"#003e75\", \"#3a4453\", \"#5ea226\", \"#af0f5b\", \"#c58c00\", \"#0081a5\", \"#425ea9\", \"#138677\",\n                    \"#7f7f7f\", \"#0c0c0c\", \"#00192e\", \"#272d37\", \"#3f6c19\", \"#750a3d\", \"#835d00\", \"#00566e\", \"#2c3f71\", \"#0c594f\"\n                ],\n                change: this.value.bind(this)\n            }).data(\"kendoColorPalette\");\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"colorPicker\", ColorPickerDialog);\n\n    var CustomColorDialog = ColorChooser.extend({\n        init: function(options) {\n            options.width = 268;\n            ColorChooser.fn.init.call(this, options);\n            this.dialog().setOptions({ animation: false });\n            this.dialog().one(\"activate\", this._colorPicker.bind(this));\n        },\n        _colorPicker: function() {\n            var element = this.dialog().element.find(\"div\").first();\n            this.colorPicker = element.kendoFlatColorPicker({\n                change: this.value.bind(this)\n            }).data(\"kendoFlatColorPicker\");\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"customColor\", CustomColorDialog);\n\n    var AlignmentDialog = SpreadsheetDialog.extend({\n        init: function(options) {\n            var messages = kendo.spreadsheet.messages.dialogs.alignmentDialog || MESSAGES;\n            var defaultOptions = {\n                title: messages.title,\n                buttons: [\n                    { property: \"textAlign\",     value: \"left\",    iconClass: \"align-left\",   text: messages.buttons.justifyLeft },\n                    { property: \"textAlign\",     value: \"center\",  iconClass: \"align-center\", text: messages.buttons.justifyCenter },\n                    { property: \"textAlign\",     value: \"right\",   iconClass: \"align-right\",  text: messages.buttons.justifyRight },\n                    { property: \"textAlign\",     value: \"justify\", iconClass: \"align-justify\",   text: messages.buttons.justifyFull },\n                    { property: \"verticalAlign\", value: \"top\",     iconClass: \"align-top\",      text: messages.buttons.alignTop },\n                    { property: \"verticalAlign\", value: \"center\",  iconClass: \"align-middle\",   text: messages.buttons.alignMiddle },\n                    { property: \"verticalAlign\", value: \"bottom\",  iconClass: \"align-bottom\",   text: messages.buttons.alignBottom }\n                ]\n            };\n\n            SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n\n            this._list();\n        },\n        options: {\n            template: () => \"<ul class='k-list k-reset'></ul>\"\n        },\n        _list: function() {\n            var ul = this.dialog().element.find(\"ul\");\n\n            this.list = new kendo.ui.StaticList(ul, {\n                dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                template: (data) => `<a role='button' title='${data.text}' data-property='${data.property}' data-value='${data.value}'>\n                                ${kendo.ui.icon(data.iconClass)} ${data.text}\n                           </a>`,\n                change: this.apply.bind(this)\n            });\n\n            this.list.dataSource.fetch();\n        },\n        apply: function(e) {\n            var dataItem = e.sender.value()[0];\n            SpreadsheetDialog.fn.apply.call(this);\n\n            this.trigger(\"action\", {\n                command: \"PropertyChangeCommand\",\n                options: {\n                    property: dataItem.property,\n                    value: dataItem.value\n                }\n            });\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"alignment\", AlignmentDialog);\n\n    var MergeDialog = SpreadsheetDialog.extend({\n        init: function(options) {\n            var messages = kendo.spreadsheet.messages.dialogs.mergeDialog || MESSAGES;\n            var defaultOptions = {\n                title: messages.title,\n                buttons: [\n                    { value: \"cells\",        iconClass: \"cells-merge\",        text: messages.buttons.mergeCells },\n                    { value: \"horizontally\", iconClass: \"cells-merge-horizontally\", text: messages.buttons.mergeHorizontally },\n                    { value: \"vertically\",   iconClass: \"cells-merge-vertically\",   text: messages.buttons.mergeVertically },\n                    { value: \"unmerge\",      iconClass: \"table-unmerge\",      text: messages.buttons.unmerge }\n                ]\n            };\n\n            SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n\n            this._list();\n        },\n        options: {\n            template: () => \"<ul class='k-list k-reset'></ul>\"\n        },\n        _list: function() {\n            var ul = this.dialog().element.find(\"ul\");\n\n            this.list = new kendo.ui.StaticList(ul, {\n                dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                template: (data) => `<a role='button' title='${data.text}' data-value='${data.value}'>` +\n                            `${kendo.ui.icon(data.iconClass)}${data.text}` +\n                          \"</a>\",\n                change: this.apply.bind(this)\n            });\n\n            this.list.dataSource.fetch();\n        },\n        apply: function(e) {\n            var dataItem = e.sender.value()[0];\n            SpreadsheetDialog.fn.apply.call(this);\n\n            this.trigger(\"action\", {\n                command: \"MergeCellCommand\",\n                options: {\n                    value: dataItem.value\n                }\n            });\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"merge\", MergeDialog);\n\n    var FreezeDialog = SpreadsheetDialog.extend({\n        init: function(options) {\n            var messages = kendo.spreadsheet.messages.dialogs.freezeDialog || MESSAGES;\n            var defaultOptions = {\n                title: messages.title,\n                buttons: [\n                    { value: \"panes\",    iconClass: \"pane-freeze\",  text: messages.buttons.freezePanes },\n                    { value: \"rows\",     iconClass: \"row-freeze\",    text: messages.buttons.freezeRows },\n                    { value: \"columns\",  iconClass: \"column-freeze\",    text: messages.buttons.freezeColumns },\n                    { value: \"unfreeze\", iconClass: \"table-unmerge\", text: messages.buttons.unfreeze }\n                ]\n            };\n\n            SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n\n            this._list();\n        },\n        options: {\n            template: () => \"<ul class='k-list k-reset'></ul>\"\n        },\n        _list: function() {\n            var ul = this.dialog().element.find(\"ul\");\n\n            this.list = new kendo.ui.StaticList(ul, {\n                dataSource: new kendo.data.DataSource({ data: this.options.buttons }),\n                template: (data) => `<a role='button' title='${data.text}' data-value='${data.value}'>` +\n                            `${kendo.ui.icon(data.iconClass)}${data.text}` +\n                          \"</a>\",\n                change: this.apply.bind(this)\n            });\n\n            this.list.dataSource.fetch();\n        },\n        apply: function(e) {\n            var dataItem = e.sender.value()[0];\n            SpreadsheetDialog.fn.apply.call(this);\n\n            this.trigger(\"action\", {\n                command: \"FreezePanesCommand\",\n                options: {\n                    value: dataItem.value\n                }\n            });\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"freeze\", FreezeDialog);\n\n    var ValidationViewModel = kendo.spreadsheet.ValidationCellsViewModel = ObservableObject.extend({\n        init: function(options) {\n            ObservableObject.fn.init.call(this, options);\n\n            this.bind(\"change\", (function(e) {\n\n                if (e.field === \"criterion\") {\n                    this.reset();\n\n                    if (this.criterion === \"custom\" || this.criterion === \"list\") {\n                        this.setHintMessageTemplate();\n                    }\n                }\n\n                if (e.field === \"comparer\") {\n                    this.setHintMessageTemplate();\n                }\n\n                if ((e.field == \"hintMessage\" || e.field == \"hintTitle\") && !this._mute) {\n                    this.shouldBuild = false;\n                }\n\n                if ((e.field == \"from\" || e.field == \"to\" || e.field == \"hintMessageTemplate\" || e.field == \"type\") && this.shouldBuild) {\n                    this.buildMessages();\n                }\n            }).bind(this));\n\n            this.reset();\n        },\n        buildMessages: function() {\n            this._mute = true;\n            this.set(\"hintTitle\", this.hintTitleTemplate ? kendo.format(this.hintTitleTemplate, this.type) : \"\");\n            this.set(\"hintMessage\", this.hintMessageTemplate ? kendo.format(this.hintMessageTemplate, this.from, this.to) : \"\");\n            this._mute = false;\n        },\n        reset: function() {\n            this.setComparers();\n            this.set(\"comparer\", this.comparers[0].type);\n            this.set(\"from\", null);\n            this.set(\"to\", null);\n\n            this.set(\"useCustomMessages\", false);\n\n            this.shouldBuild = true;\n\n            this.hintTitleTemplate = this.defaultHintTitle;\n            this.buildMessages();\n        },\n        //TODO: refactor\n        setComparers: function() {\n            var all = this.defaultComparers;\n            var comparers = [];\n\n            if (this.criterion === \"text\") {\n                var text_comparers = [\"equalTo\", \"notEqualTo\"];\n                for (var idx = 0; idx < all.length; idx++) {\n                    if (text_comparers[0] == all[idx].type) {\n                        comparers.push(all[idx]);\n                        text_comparers.shift();\n                    }\n                }\n            } else {\n                comparers = all.slice();\n            }\n\n            this.set(\"comparers\", comparers);\n        },\n        setHintMessageTemplate: function() {\n           if (this.criterion !== \"custom\" && this.criterion !== \"list\") {\n               this.set(\"hintMessageTemplate\", kendo.format(this.defaultHintMessage, this.criterion, this.comparerMessages[this.comparer]));\n           } else {\n               this.set(\"hintMessageTemplate\", \"\");\n               this.set(\"hintMessage\", \"\");\n           }\n        },\n        isAny: function() {\n            return this.get(\"criterion\") === \"any\";\n        },\n        isNumber: function() {\n            return this.get(\"criterion\") === \"number\";\n        },\n        showToForNumber: function() {\n            return this.showTo() && this.isNumber();\n        },\n        showToForDate: function() {\n            return this.showTo() && this.isDate();\n        },\n        isText: function() {\n            return this.get(\"criterion\") === \"text\";\n        },\n        isDate: function() {\n            return this.get(\"criterion\") === \"date\";\n        },\n        isList: function() {\n            return this.get(\"criterion\") === \"list\";\n        },\n        isCustom: function() {\n            return this.get(\"criterion\") === \"custom\";\n        },\n        showRemove: function() {\n            return this.get(\"hasValidation\");\n        },\n        showTo: function() {\n            return this.get(\"comparer\") == \"between\" || this.get(\"comparer\") == \"notBetween\";\n        },\n        update: function(validation) {\n            this.set(\"hasValidation\", !!validation);\n\n            if (validation) {\n                this.fromValidationObject(validation);\n            }\n        },\n        fromValidationObject: function(validation) {\n            this.set(\"criterion\", validation.dataType);\n            this.set(\"comparer\", validation.comparerType);\n            this.set(\"from\", validation.from);\n            this.set(\"to\", validation.to);\n            this.set(\"type\", validation.type);\n            this.set(\"ignoreBlank\", validation.allowNulls);\n            this.set(\"showButton\", validation.showButton);\n\n            if (validation.messageTemplate || validation.titleTemplate) {\n                this.hintMessageTemplate = validation.messageTemplate;\n                this.hintMessage = validation.messageTemplate;\n                this.hintTitleTemplate = validation.titleTemplate;\n                this.hintTitle = validation.titleTemplate;\n                this.useCustomMessages = true;\n                this.buildMessages();\n            } else {\n                this.useCustomMessages = false;\n            }\n        },\n        toValidationObject: function() {\n            if (this.criterion === \"any\") {\n                return null;\n            }\n\n            var options = {\n                type: this.type,\n                dataType: this.criterion,\n                comparerType: this.comparer,\n                from: this.from,\n                to: this.to,\n                allowNulls: this.ignoreBlank,\n                showButton: this.showButton\n            };\n\n            if (this.useCustomMessages) {\n                options.messageTemplate = this.shouldBuild ? this.hintMessageTemplate : this.hintMessage;\n                options.titleTemplate = this.hintTitle;\n            }\n\n            return options;\n        }\n    });\n\n    var ValidationDialog = SpreadsheetDialog.extend({\n        init: function(options) {\n            var messages = kendo.spreadsheet.messages.dialogs.validationDialog || MESSAGES;\n            var defaultOptions = {\n                title: messages.title,\n                hintMessage: messages.hintMessage,\n                hintTitle: messages.hintTitle,\n                criteria: [\n                    { type: \"any\", name: messages.criteria.any },\n                    { type: \"number\", name: messages.criteria.number },\n                    { type: \"text\", name: messages.criteria.text },\n                    { type: \"date\", name: messages.criteria.date },\n                    { type: \"custom\", name: messages.criteria.custom },\n                    { type: \"list\", name: messages.criteria.list }\n                ],\n                comparers: [\n                    { type: \"greaterThan\", name: messages.comparers.greaterThan },\n                    { type: \"lessThan\",    name: messages.comparers.lessThan },\n                    { type: \"between\",     name: messages.comparers.between },\n                    { type: \"notBetween\",  name: messages.comparers.notBetween },\n                    { type: \"equalTo\",     name: messages.comparers.equalTo },\n                    { type: \"notEqualTo\",  name: messages.comparers.notEqualTo },\n                    { type: \"greaterThanOrEqualTo\", name: messages.comparers.greaterThanOrEqualTo },\n                    { type: \"lessThanOrEqualTo\",    name: messages.comparers.lessThanOrEqualTo }\n                ],\n                comparerMessages: messages.comparerMessages\n            };\n\n            SpreadsheetDialog.fn.init.call(this, $.extend(defaultOptions, options));\n        },\n        options: {\n            width: 450,\n            criterion: \"any\",\n            type: \"reject\",\n            ignoreBlank: true,\n            showButton: true,\n            useCustomMessages: false,\n            errorTemplate: (data) =>\n                `<div class=\"k-tooltip k-tooltip-error k-validator-tooltip\">\n                    ${kendo.ui.icon({ icon: \"exclamation-circle\", iconClass: \"k-tooltip-icon\" })}\n                    <span class=\"k-tooltip-content\">${data.message}</span>\n                    <span class=\"k-callout k-callout-n\"></span>\n                </div>`,\n            template: (data) => {\n                let $kendoOutput;\n                $kendoOutput = `<div class=\"k-edit-form-container\">\n                    <div class=\"k-edit-label\"><label for=\"criteria\">${kendo.htmlEncode(data.messages.validationDialog.labels.criteria)}:</label></div>\n                    <div class=\"k-edit-field\"><select id=\"criteria\" data-${kendo.htmlEncode(data.ns)}role=\"dropdownlist\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.criteria)}\" data-${kendo.htmlEncode(data.ns)}text-field=\"name\" data-${kendo.htmlEncode(data.ns)}value-field=\"type\" data-${kendo.htmlEncode(data.ns)}bind=\"value: criterion, source: criteria\"></select></div>\n                    <div data-${kendo.htmlEncode(data.ns)}bind=\"visible: isNumber\">\n                    <div class=\"k-edit-label\"><label for=\"number-comparer\">${kendo.htmlEncode(data.messages.validationDialog.labels.comparer)}:</label></div>\n                    <div class=\"k-edit-field\"><select id=\"number-comparer\" data-${kendo.htmlEncode(data.ns)}role=\"dropdownlist\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.comparer)}\" data-${kendo.htmlEncode(data.ns)}text-field=\"name\" data-${kendo.htmlEncode(data.ns)}value-field=\"type\" data-${kendo.htmlEncode(data.ns)}bind=\"value: comparer, source: comparers\"></select></div>\n                    <div class=\"k-edit-label\"><label for=\"comparer-min\">${kendo.htmlEncode(data.messages.validationDialog.labels.min)}:</label></div>\n                    <div class=\"k-edit-field\"><span class=\"k-textbox k-input\"><input id=\"comparer-min\" name=\"${kendo.htmlEncode(data.messages.validationDialog.labels.min)}\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.min)}\" placeholder=\"e.g. 10\" class=\"k-input-inner\" data-${kendo.htmlEncode(data.ns)}bind=\"value: from, enabled: isNumber\" required=\"required\" /></span></div>\n                    <div data-${kendo.htmlEncode(data.ns)}bind=\"visible: showTo\">\n                    <div class=\"k-edit-label\"><label for=\"comparer-max\">${kendo.htmlEncode(data.messages.validationDialog.labels.max)}:</label></div>\n                    <div class=\"k-edit-field\"><span class=\"k-textbox k-input\"><input id=\"comparer-max\" name=\"${kendo.htmlEncode(data.messages.validationDialog.labels.max)}\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.max)}\" placeholder=\"e.g. 100\" class=\"k-input-inner\" data-${kendo.htmlEncode(data.ns)}bind=\"value: to, enabled: showToForNumber\" required=\"required\" /></span></div>\n                    </div>\n                    </div><div data-${kendo.htmlEncode(data.ns)}bind=\"visible: isText\">\n                    <div class=\"k-edit-label\"><label for=\"text-comparer\">${kendo.htmlEncode(data.messages.validationDialog.labels.comparer)}:</label></div>\n                    <div class=\"k-edit-field\"><select id=\"text-comparer\" data-${kendo.htmlEncode(data.ns)}role=\"dropdownlist\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.comparer)}\" data-${kendo.htmlEncode(data.ns)}text-field=\"name\" data-${kendo.htmlEncode(data.ns)}value-field=\"type\" data-${kendo.htmlEncode(data.ns)}bind=\"value: comparer, source: comparers\"></select></div>\n                    <div class=\"k-edit-label\"><label for=\"text-comparer-value\">${kendo.htmlEncode(data.messages.validationDialog.labels.value)}:</label></div>\n                    <div class=\"k-edit-field\"><span class=\"k-textbox k-input\"><input id=\"text-comparer-value\" name=\"${kendo.htmlEncode(data.messages.validationDialog.labels.value)}\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.value)}\" class=\"k-input-inner\" data-${kendo.htmlEncode(data.ns)}bind=\"value: from, enabled: isText\" required=\"required\" /></span></div>\n                    </div><div data-${kendo.htmlEncode(data.ns)}bind=\"visible: isDate\">\n                    <div class=\"k-edit-label\"><label for=\"date-comparer\">${kendo.htmlEncode(data.messages.validationDialog.labels.comparer)}:</label></div>\n                    <div class=\"k-edit-field\"><select id=\"date-comparer\" data-${kendo.htmlEncode(data.ns)}role=\"dropdownlist\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.comparer)}\" data-${kendo.htmlEncode(data.ns)}text-field=\"name\" data-${kendo.htmlEncode(data.ns)}value-field=\"type\" data-${kendo.htmlEncode(data.ns)}bind=\"value: comparer, source: comparers\"></select></div>\n                    <div class=\"k-edit-label\"><label for=\"date-comparer-start\">${kendo.htmlEncode(data.messages.validationDialog.labels.start)}:</label></div>\n                    <div class=\"k-edit-field\"><span class=\"k-textbox k-input\"><input id=\"date-comparer-start\" name=\"${kendo.htmlEncode(data.messages.validationDialog.labels.start)}\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.start)}\" class=\"k-input-inner\" data-${kendo.htmlEncode(data.ns)}bind=\"value: from, enabled: isDate\" required=\"required\" /></span></div>\n                    <div data-${kendo.htmlEncode(data.ns)}bind=\"visible: showTo\">\n                    <div class=\"k-edit-label\"><label for=\"date-comparer-end\">${kendo.htmlEncode(data.messages.validationDialog.labels.end)}:</label></div>\n                    <div class=\"k-edit-field\"><span class=\"k-textbox k-input\"><input id=\"date-comparer-end\" name=\"${kendo.htmlEncode(data.messages.validationDialog.labels.end)}\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.end)}\" class=\"k-input-inner\" data-${kendo.htmlEncode(data.ns)}bind=\"value: to, enabled: showToForDate\" required=\"required\" /></span></div>\n                    </div></div><div data-${kendo.htmlEncode(data.ns)}bind=\"visible: isCustom\">\n                    <div class=\"k-edit-label\"><label for=\"custom-comparer-value\">${kendo.htmlEncode(data.messages.validationDialog.labels.value)}:</label></div>\n                    <div class=\"k-edit-field\"><span class=\"k-textbox k-input\"><input id=\"custom-comparer-value\" name=\"${kendo.htmlEncode(data.messages.validationDialog.labels.value)}\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.value)}\" class=\"k-input-inner\" data-${kendo.htmlEncode(data.ns)}bind=\"value: from, enabled: isCustom\" required=\"required\" /></span></div>\n                    </div><div data-${kendo.htmlEncode(data.ns)}bind=\"visible: isList\">\n                    <div class=\"k-edit-label\"><label for=\"list-comparer-value\">${kendo.htmlEncode(data.messages.validationDialog.labels.value)}:</label></div>\n                    <div class=\"k-edit-field\"><span class=\"k-textbox k-input\"><input id=\"list-comparer-value\" name=\"${kendo.htmlEncode(data.messages.validationDialog.labels.value)}\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.value)}\" class=\"k-input-inner\" data-${kendo.htmlEncode(data.ns)}bind=\"value: from, enabled: isList\" required=\"required\" /></span></div>\n                    </div><div data-${kendo.htmlEncode(data.ns)}bind=\"visible: isList\">\n                    <div class=\"k-edit-field\"><input type=\"checkbox\" name=\"showButton\" id=\"listShowButton\" class=\"k-checkbox\" data-${kendo.htmlEncode(data.ns)}bind=\"checked: showButton\" /><label for=\"listShowButton\" class=\"k-checkbox-label\"> ${kendo.htmlEncode(data.messages.validationDialog.labels.showListButton)}</label></div>\n                    </div><div data-${kendo.htmlEncode(data.ns)}bind=\"visible: isDate\">\n                    <div class=\"k-edit-field\"><input type=\"checkbox\" name=\"showButton\" id=\"dateShowButton\" class=\"k-checkbox\" data-${kendo.htmlEncode(data.ns)}bind=\"checked: showButton\" /><label for=\"dateShowButton\" class=\"k-checkbox-label\"> ${kendo.htmlEncode(data.messages.validationDialog.labels.showCalendarButton)}</label></div>\n                    </div><div data-${kendo.htmlEncode(data.ns)}bind=\"invisible: isAny\">\n                    <div class=\"k-edit-field\"><input type=\"checkbox\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.ignoreBlank)}\" name=\"ignoreBlank\" id=\"ignoreBlank\" class=\"k-checkbox\" data-${kendo.htmlEncode(data.ns)}bind=\"checked: ignoreBlank\" /><label for=\"ignoreBlank\" class=\"k-checkbox-label\"> ${kendo.htmlEncode(data.messages.validationDialog.labels.ignoreBlank)}</label></div>\n                    </div><div data-${kendo.htmlEncode(data.ns)}bind=\"invisible: isAny\">\n                    <div class=\"k-hr\"></div>\n                    <div class=\"k-edit-label\"><label>${kendo.htmlEncode(data.messages.validationDialog.labels.onInvalidData)}:</label></div>\n                    <div class=\"k-edit-field\"><input type=\"radio\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.rejectInput)}\" id=\"validationTypeReject\" name=\"validationType\" value=\"reject\" data-${kendo.htmlEncode(data.ns)}bind=\"checked: type\" class=\"k-radio\" /><label for=\"validationTypeReject\" class=\"k-radio-label\">${kendo.htmlEncode(data.messages.validationDialog.labels.rejectInput)}</label> <input type=\"radio\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.showWarning)}\" id=\"validationTypeWarning\" name=\"validationType\" value=\"warning\" data-${kendo.htmlEncode(data.ns)}bind=\"checked: type\" class=\"k-radio\" /><label for=\"validationTypeWarning\" class=\"k-radio-label\">${kendo.htmlEncode(data.messages.validationDialog.labels.showWarning)}</label></div>\n                    </div><div data-${kendo.htmlEncode(data.ns)}bind=\"invisible: isAny\" class=\"hint-wrapper\">\n                    <div class=\"k-edit-field\"><input type=\"checkbox\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.showHint)}\" name=\"useCustomMessages\" id=\"useCustomMessages\" class=\"k-checkbox\" data-${kendo.htmlEncode(data.ns)}bind=\"checked: useCustomMessages\" /><label class=\"k-checkbox-label\" for=\"useCustomMessages\"> ${kendo.htmlEncode(data.messages.validationDialog.labels.showHint)}</label></div>\n                    <div data-${kendo.htmlEncode(data.ns)}bind=\"visible: useCustomMessages\">\n                    <div class=\"k-edit-label\"><label for=\"hint-title\">${kendo.htmlEncode(data.messages.validationDialog.labels.hintTitle)}:</label></div>\n                    <div class=\"k-edit-field\"><span class=\"k-textbox k-input\"><input id=\"hint-title\" name=\"hint-title\" class=\"k-input-inner\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.hintTitle)}\" placeholder=\"${kendo.htmlEncode(data.messages.validationDialog.placeholders.typeTitle)}\" data-${kendo.htmlEncode(data.ns)}bind=\"value: hintTitle\" /></span></div>\n                    <div class=\"k-edit-label\"><label for=\"hint-message\">${kendo.htmlEncode(data.messages.validationDialog.labels.hintMessage)}:</label></div>\n                    <div class=\"k-edit-field\"><span class=\"k-textbox k-input\"><input id=\"hint-message\" class=\"k-input-inner\" title=\"${kendo.htmlEncode(data.messages.validationDialog.labels.hintMessage)}\" placeholder=\"${kendo.htmlEncode(data.messages.validationDialog.placeholders.typeMessage)}\" data-${kendo.htmlEncode(data.ns)}bind=\"value: hintMessage\" /></span></div>\n                    </div></div>\n                    <div class=\"k-actions\"><button class=\"k-button\" data-${kendo.htmlEncode(data.ns)}bind=\"visible: showRemove, click: remove\"><span class=\"k-button-text\">${kendo.htmlEncode(data.messages.remove)}</span></button><button class=\"k-button k-button-primary\" data-${kendo.htmlEncode(data.ns)}bind=\"click: apply\"><span class=\"k-button-text\">${kendo.htmlEncode(data.messages.apply)}</span></button><button class=\"k-button\" data-${kendo.htmlEncode(data.ns)}bind=\"click: close\"><span class=\"k-button-text\">${kendo.htmlEncode(data.messages.cancel)}</span></button></div>\n                    </div>`;\n                return $kendoOutput;\n            }\n        },\n        open: function(range) {\n            var options = this.options;\n            var element;\n\n            this.viewModel = new ValidationViewModel({\n                type: options.type,\n                defaultHintMessage: options.hintMessage,\n                defaultHintTitle: options.hintTitle,\n                defaultComparers: options.comparers.slice(0),\n                comparerMessages: options.comparerMessages,\n                criteria: options.criteria.slice(0),\n                criterion: options.criterion,\n                ignoreBlank: options.ignoreBlank,\n                showButton: options.showButton,\n                apply: this.apply.bind(this),\n                close: this.close.bind(this),\n                remove: this.remove.bind(this)\n            });\n\n            this.viewModel.update(range.validation());\n\n            SpreadsheetDialog.fn.open.call(this);\n\n            element = this.dialog().element;\n\n            if (this.validatable) {\n                this.validatable.destroy();\n            }\n\n            kendo.bind(element, this.viewModel);\n\n            this.validatable = new kendo.ui.Validator(element.find(\".k-edit-form-container\"), {\n                validateOnBlur: false,\n                errorTemplate: this.options.errorTemplate || undefined\n            });\n        },\n        apply: function() {\n\n            if (this.validatable.validate()) {\n                SpreadsheetDialog.fn.apply.call(this);\n\n                this.trigger(\"action\", {\n                    command: \"EditValidationCommand\",\n                    options: {\n                        value: this.viewModel.toValidationObject()\n                    }\n                });\n            }\n        },\n        remove: function() {\n            this.viewModel.set(\"criterion\", \"any\");\n            this.apply();\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"validation\", ValidationDialog);\n    kendo.spreadsheet.dialogs.ValidationDialog = ValidationDialog;\n\n    function PDF_PAPER_SIZE(size) {\n        return {\n            value: size,\n            text: TEXT(\"exportAsDialog.pdf.paper.\" + size)\n        };\n    }\n\n    var ExportAsDialog = SpreadsheetDialog.extend({\n        init: function(options) {\n            SpreadsheetDialog.fn.init.call(this, options);\n            options = this.options;\n\n            this.viewModel = kendo.observable({\n                title: options.title,\n                name: options.name,\n                extension: options.extension,\n                fileFormats:options.fileFormats,\n                excel: options.excelExport,\n                pdf: {\n                    proxyURL: options.pdfExport.proxyURL,\n                    forceProxy: options.pdfExport.forceProxy,\n                    title: options.pdfExport.title,\n                    author: options.pdfExport.author,\n                    autoPrint: options.pdfExport.autoPrint,\n                    subject: options.pdfExport.subject,\n                    keywords: options.pdfExport.keywords,\n                    creator: options.pdfExport.creator,\n                    date: options.pdfExport.date,\n\n                    fitWidth: options.pdf.fitWidth,\n                    area: options.pdf.area,\n                    areas: options.pdf.areas,\n                    paperSize: options.pdf.paperSize,\n                    paperSizes: options.pdf.paperSizes,\n                    margin: options.pdf.margin,\n                    margins: options.pdf.margins,\n                    landscape: options.pdf.landscape,\n                    guidelines: options.pdf.guidelines,\n                    hCenter: options.pdf.hCenter,\n                    vCenter: options.pdf.vCenter\n                },\n                apply: this.apply.bind(this),\n                close: this.close.bind(this)\n            });\n\n            var dialog = this.dialog();\n            this.viewModel.bind(\"change\", function(e) {\n                if (e.field === \"extension\") {\n                    this.set(\"showPdfOptions\", this.extension === \".pdf\" ? true : false);\n                    dialog.center();\n                }\n            });\n\n            kendo.bind(dialog.element, this.viewModel);\n        },\n        options: {\n            title: TEXT(\"exportAsDialog.title\", \"Export...\"),\n            name: TEXT(\"exportAsDialog.defaultFileName\", \"Workbook\"),\n            extension: \".xlsx\",\n            fileFormats: [{\n                description: TEXT(\"exportAsDialog.xlsx.description\", \"Excel Workbook (.xlsx)\"),\n                extension: \".xlsx\"\n            }, {\n                description: TEXT(\"exportAsDialog.pdf.description\", \"Portable Document Format (.pdf)\"),\n                extension: \".pdf\"\n            }],\n            pdf: {\n                fitWidth: true,\n                area: \"workbook\",\n                areas: [{\n                    area: \"workbook\",\n                    text: TEXT(\"exportAsDialog.pdf.area.workbook\", \"Entire Workbook\")\n                },{\n                    area: \"sheet\",\n                    text: TEXT(\"exportAsDialog.pdf.area.sheet\", \"Active Sheet\")\n                },{\n                    area: \"selection\",\n                    text: TEXT(\"exportAsDialog.pdf.area.selection\", \"Selection\")\n                }],\n                paperSize: \"a4\",\n                paperSizes: [\n                    \"a2\", \"a3\", \"a4\", \"a5\", \"b3\", \"b4\", \"b5\", \"folio\", \"legal\", \"letter\", \"tabloid\", \"executive\"\n                ].map(PDF_PAPER_SIZE),\n                margin: {bottom: \"0.75in\", left: \"0.7in\", right: \"0.7in\", top: \"0.75in\"},\n                margins: [\n                    { value: { bottom: \"0.75in\", left: \"0.7in\", right: \"0.7in\", top: \"0.75in\" },\n                      text: TEXT(\"exportAsDialog.pdf.margin.normal\", \"Normal\")\n                    },\n                    { value: { bottom: \"0.75in\", left: \"0.25in\", right: \"0.25in\", top: \"0.75in\" },\n                      text: TEXT(\"exportAsDialog.pdf.margin.narrow\", \"Narrow\")\n                    },\n                    { value: { bottom: \"1in\", left: \"1in\", right: \"1in\", top: \"1in\" },\n                      text: TEXT(\"exportAsDialog.pdf.margin.wide\", \"Wide\")\n                    }\n                ],\n                landscape: true,\n                guidelines: true,\n                hCenter: true,\n                vCenter: true\n            },\n            width: 520,\n            template: (data) => {\n                let $kendoOutput;\n                $kendoOutput = `<div class='k-edit-label'><label id='name-label'>${kendo.htmlEncode(data.messages.exportAsDialog.labels.fileName)}:</label></div>\n                    <div class='k-edit-field'><span class='k-textbox k-input'><input aria-labelledby='name-label' class='k-input-inner' data-${kendo.htmlEncode(data.ns)}bind='value: name' /></span></div>\n                    <div >\n                       <div class='k-edit-label'><label id='file-format-label'>${kendo.htmlEncode(data.messages.exportAsDialog.labels.saveAsType)}:</label></div>\n                       <div class='k-edit-field'><select aria-labelledby='file-format-label' data-${kendo.htmlEncode(data.ns)}role='dropdownlist' class='k-file-format' data-${kendo.htmlEncode(data.ns)}text-field='description' data-${kendo.htmlEncode(data.ns)}value-field='extension' data-${kendo.htmlEncode(data.ns)}bind='value: extension, source: fileFormats'></select></div>\n                    </div>\n                    <div class='k-export-config' data-${kendo.htmlEncode(data.ns)}bind='visible: showPdfOptions'>\n                    <hr class='k-hr' />\n                    <div class='k-edit-label'><label id='export-area-label'>${kendo.htmlEncode(data.messages.exportAsDialog.labels.exportArea)}:</label></div>\n                    <div class='k-edit-field'><select aria-labelledby='export-area-label' data-${kendo.htmlEncode(data.ns)}role='dropdownlist' class='k-file-format' data-${kendo.htmlEncode(data.ns)}text-field='text' data-${kendo.htmlEncode(data.ns)}value-field='area' data-${kendo.htmlEncode(data.ns)}bind='value: pdf.area, source: pdf.areas'></select></div>\n                    <div class='k-edit-label'><label id='paper-size-label'>${kendo.htmlEncode(data.messages.exportAsDialog.labels.paperSize)}:</label></div>\n                    <div class='k-edit-field'><select aria-labelledby='paper-size-label' data-${kendo.htmlEncode(data.ns)}role='dropdownlist' class='k-file-format' data-${kendo.htmlEncode(data.ns)}text-field='text' data-${kendo.htmlEncode(data.ns)}value-field='value' data-${kendo.htmlEncode(data.ns)}bind='value: pdf.paperSize, source: pdf.paperSizes'></select></div>\n                    <div class='k-edit-label'><label id='margins-label'>${kendo.htmlEncode(data.messages.exportAsDialog.labels.margins)}:</label></div>\n                    <div class='k-edit-field'><select aria-labelledby='margins-label' data-${kendo.htmlEncode(data.ns)}role='dropdownlist' class='k-file-format' data-${kendo.htmlEncode(data.ns)}value-primitive='true'data-${kendo.htmlEncode(data.ns)}text-field='text' data-${kendo.htmlEncode(data.ns)}value-field='value' data-${kendo.htmlEncode(data.ns)}bind='value: pdf.margin, source: pdf.margins'></select></div>\n                    <div class='k-edit-label'><label>${kendo.htmlEncode(data.messages.exportAsDialog.labels.orientation)}:</label></div>\n                    <div class='k-edit-field'>\n                       <div class='k-button-group'>\n                          <input type='radio' id='k-orientation-portrait' aria-label='orientation portrait' name='orientation' data-${kendo.htmlEncode(data.ns)}type='boolean' data-${kendo.htmlEncode(data.ns)}bind='checked: pdf.landscape' value='false' />\n                          <label class='k-button k-icon-button k-group-start k-orientation-button' for='k-orientation-portrait'>\n                          ${kendo.ui.icon({ icon: \"file\", iconClass: \"k-button-icon\" })}\n                          </label>\n                          <input type='radio' id='k-orientation-landscape' aria-label='orientation landscape' name='orientation' data-${kendo.htmlEncode(data.ns)}type='boolean' data-${kendo.htmlEncode(data.ns)}bind='checked: pdf.landscape' value='true' />\n                          <label class='k-button k-icon-button k-group-end k-orientation-button' for='k-orientation-landscape'>\n                          ${kendo.ui.icon({ icon: \"file-horizontal\", iconClass: \"k-button-icon\" })}\n                          </label>\n                       </div>\n                    </div>\n                    <div class='k-edit-label'><label>${kendo.htmlEncode(data.messages.exportAsDialog.labels.print)}:</label></div>\n                    <div class='k-edit-field'><input class='k-checkbox' id='guidelines' type='checkbox' data-${kendo.htmlEncode(data.ns)}bind='checked: pdf.guidelines'/><label class='k-checkbox-label' for='guidelines'>${kendo.htmlEncode(data.messages.exportAsDialog.labels.guidelines)}</label></div>\n                    <div class='k-edit-label'><label>${kendo.htmlEncode(data.messages.exportAsDialog.labels.scale)}:</label></div>\n                    <div class='k-edit-field'><input class='k-checkbox' id='fitWidth' type='checkbox' data-${kendo.htmlEncode(data.ns)}bind='checked: pdf.fitWidth'/><label class='k-checkbox-label' for='fitWidth'>${kendo.htmlEncode(data.messages.exportAsDialog.labels.fit)}</label></div>\n                    <div class='k-edit-label'><label>${kendo.htmlEncode(data.messages.exportAsDialog.labels.center)}:</label></div>\n                    <div class='k-edit-field'><input class='k-checkbox' id='hCenter' type='checkbox' data-${kendo.htmlEncode(data.ns)}bind='checked: pdf.hCenter'/><label class='k-checkbox-label' for='hCenter'>${kendo.htmlEncode(data.messages.exportAsDialog.labels.horizontally)}</label><input class='k-checkbox' id='vCenter' type='checkbox' data-${kendo.htmlEncode(data.ns)}bind='checked: pdf.vCenter'/><label class='k-checkbox-label' for='vCenter'>${kendo.htmlEncode(data.messages.exportAsDialog.labels.vertically)}</label></div>\n                    <div class='k-page-orientation'>\n                       ${kendo.ui.icon($(`<span data-${data.ns}bind='invisible: pdf.landscape'></span>`), { icon: \"file\" })}\n                       ${kendo.ui.icon($(`<span data-${data.ns}bind='visible: pdf.landscape'></span>`), { icon: \"file-horizontal\" })}\n                    </div>\n                    </div>\n                    <div class='k-actions'><button class='k-button k-button-primary' data-${kendo.htmlEncode(data.ns)}bind='click: apply'><span class='k-button-text'>${kendo.htmlEncode(data.messages.save)}</span></button><button class='k-button' data-${kendo.htmlEncode(data.ns)}bind='click: close'><span class='k-button-text'>${kendo.htmlEncode(data.messages.cancel)}</span></button></div>`;\n                return $kendoOutput;\n            }\n        },\n        apply: function() {\n            SpreadsheetDialog.fn.apply.call(this);\n\n            this.trigger(\"action\", {\n                command: \"SaveAsCommand\",\n                options: this.viewModel\n            });\n        }\n    });\n    kendo.spreadsheet.dialogs.register(\"exportAs\", ExportAsDialog);\n\n    function basicErrorDialog(id, msg) {\n        kendo.spreadsheet.dialogs.register(\n            id,\n            MessageDialog.extend({\n                options: { messageId: msg }\n            })\n        );\n    }\n\n    basicErrorDialog(\"modifyMerged\", \"modifyMergedDialog.errorMessage\");\n    basicErrorDialog(\"rangeDisabled\", \"rangeDisabledDialog.errorMessage\");\n    basicErrorDialog(\"intersectsArray\", \"intersectsArrayDialog.errorMessage\");\n    basicErrorDialog(\"overflow\", \"overflowDialog.errorMessage\");\n    basicErrorDialog(\"unsupportedSelection\", \"unsupportedSelectionDialog.errorMessage\");\n    basicErrorDialog(\"incompatibleRanges\", \"incompatibleRangesDialog.errorMessage\");\n    basicErrorDialog(\"noFillDirection\", \"noFillDirectionDialog.errorMessage\");\n    basicErrorDialog(\"duplicateSheetName\", \"duplicateSheetNameDialog.errorMessage\");\n\n    var ImportErrorDialog = MessageDialog.extend({\n        options: {\n            width: 640,\n            title: \"Errors in import\",\n            template: (data) => {\n                let $kendoOutput;\n                const errors = data.errors;\n                $kendoOutput = `<div class='k-spreadsheet-message-content k-spreadsheet-import-errors'><div class='k--header-message'>We encountered ${errors.length} errors while reading this file.  Please be aware that some formulas might be missing, or contain invalid results.</div><div class='k--errors'><table><thead><tr><th>Context</th><th>Error message</th></tr></thead>`;\n                for (let i = 0; i < errors.length; ++i) {\n                    $kendoOutput += ``; let err = errors[i];;\n                    $kendoOutput += `<tr><td>${kendo.htmlEncode(err.context)}</td><td>${kendo.htmlEncode(err.error)}</td></tr>`;\n                }\n                $kendoOutput += `</table></div></div><div class='k-actions'><button class='k-button k-button-primary' data-${kendo.htmlEncode(data.ns)}bind='click: close'><span class='k-button-text'>${kendo.htmlEncode(data.messages.okText)}</span></button></div>`;\n                return $kendoOutput;\n            }\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"importError\", ImportErrorDialog);\n\n    var UseKeyboardDialog = MessageDialog.extend({\n        options: {\n            title: TEXT(\"useKeyboardDialog.title\", \"Copying and pasting\"),\n            template: (data) => {\n                let $kendoOutput;\n                $kendoOutput = `${kendo.htmlEncode(data.messages.useKeyboardDialog.errorMessage)}\n                <div>Ctrl+C ${kendo.htmlEncode(data.messages.useKeyboardDialog.labels.forCopy)}</div>\n                <div>Ctrl+X ${kendo.htmlEncode(data.messages.useKeyboardDialog.labels.forCut)}</div>\n                <div>Ctrl+V ${kendo.htmlEncode(data.messages.useKeyboardDialog.labels.forPaste)}</div>\n                <div class=\"k-actions\"><button class='k-button k-button-primary'\n                        data-${kendo.htmlEncode(data.ns)}bind='click: close'><span\n                            class='k-button-text'>${data.messages.okText}</span></button></div>`;\n                return $kendoOutput;\n            }\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"useKeyboard\", UseKeyboardDialog);\n\n    var HyperlinkDialog = SpreadsheetDialog.extend({\n        options: {\n            title: TEXT(\"linkDialog.title\", \"Hyperlink\"),\n            template: (data) => {\n                let $kendoOutput;\n                $kendoOutput = `<div class='k-edit-label'><label id='url-label'>${kendo.htmlEncode(data.messages.linkDialog.labels.url)}:</label></div>\n<div class='k-edit-field'><span class='k-textbox k-input'><input\n            class='k-input-inner' data-${kendo.htmlEncode(data.ns)}bind='value: url'\n            title='${kendo.htmlEncode(data.messages.linkDialog.labels.url)}' aria-labelledby='url-label' /></span></div>\n<div class='k-actions'><button class='k-button k-left'\n        data-${kendo.htmlEncode(data.ns)}bind='click: remove'><span\n            class='k-button-text'>${data.messages.linkDialog.labels.removeLink}</span></button><button\n        class='k-button k-button-primary'\n        data-${kendo.htmlEncode(data.ns)}bind='click: apply'><span\n            class='k-button-text'>${data.messages.okText}</span></button><button\n        class='k-button'\n        data-${kendo.htmlEncode(data.ns)}bind='click: cancel'><span\n            class='k-button-text'>${data.messages.cancel}</span></button></div>`;\n                return $kendoOutput;\n            },\n            autoFocus: false\n        },\n        open: function(range) {\n            var self = this;\n            SpreadsheetDialog.fn.open.apply(self, arguments);\n            var element = self.dialog().element;\n            var model = kendo.observable({\n                url: range.link(),\n                apply: function() {\n                    if (!/\\S/.test(model.url)) {\n                        model.url = null;\n                    }\n                    self.trigger(\"action\", {\n                        command: \"HyperlinkCommand\",\n                        options: {\n                            link: model.url\n                        }\n                    });\n                    self.close();\n                },\n                remove: function() {\n                    model.url = null;\n                    model.apply();\n                },\n                cancel: self.close.bind(self)\n            });\n            kendo.bind(element, model);\n\n            // it would be nice if we could easily handle that in one\n            // place for all dialogs, but it doesn't seem easily\n            // doable.\n            element.find(\"input\")\n                .trigger(\"focus\")\n                .on(\"keydown\", function(ev){\n                    if (ev.keyCode == 13 /*ENTER*/) {\n                        model.url = $(this).val(); // there won't be a \"change\" event and the model wouldn't update :-\\\n                        ev.stopPropagation();\n                        ev.preventDefault();\n                        model.apply();\n                    } else if (ev.keyCode == 27 /*ESC*/) {\n                        ev.stopPropagation();\n                        ev.preventDefault();\n                        model.cancel();\n                    }\n                });\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"hyperlink\", HyperlinkDialog);\n\n    var SheetRenameDialog = SpreadsheetDialog.extend({\n        options: {\n            title: TEXT(\"sheetRenameDialog.title\", \"Rename Sheet\"),\n            template: (data) => {\n                let $kendoOutput;\n                $kendoOutput = `<div class='k-edit-label'><label id='sheet-name-label'>${kendo.htmlEncode(data.messages.sheetRenameDialog.labels.text)}:</label></div>\n<div class='k-edit-field'><span class='k-textbox k-input'><input\n            class='k-input-inner' data-${kendo.htmlEncode(data.ns)}bind='value: sheetName'\n            title='${kendo.htmlEncode(data.messages.sheetRenameDialog.labels.text)}' aria-labelledby='sheet-name-label' /></span></div>\n<div class='k-actions'><button class='k-button k-button-primary'\n        data-${kendo.htmlEncode(data.ns)}bind='click: apply'><span\n            class='k-button-text'>${data.messages.sheetRenameDialog.labels.rename}</span></button><button\n        class='k-button'\n        data-${kendo.htmlEncode(data.ns)}bind='click: cancel'><span\n            class='k-button-text'>${data.messages.cancel}</span></button></div>`;\n                return $kendoOutput;\n            },\n            autoFocus: false\n        },\n        open: function(range, args) {\n            let sheet = range.sheet();\n            let self = this;\n            SpreadsheetDialog.fn.open.apply(self, arguments);\n            let element = self.dialog().element;\n            let model = kendo.observable({\n                sheetName: args?._oldSheetName || sheet.name(),\n                apply: function() {\n                    self._newSheetName = model.sheetName;\n                    self.close();\n                },\n                cancel: self.close.bind(self)\n            });\n            kendo.bind(element, model);\n\n            element.find(\"input\")\n                .trigger(\"focus\")\n                .on(\"keydown\", function(ev){\n                    if (ev.keyCode == 13 /*ENTER*/) {\n                        model.sheetName = $(this).val();\n                        ev.stopPropagation();\n                        ev.preventDefault();\n                        model.apply();\n                    } else if (ev.keyCode == 27 /*ESC*/) {\n                        ev.stopPropagation();\n                        ev.preventDefault();\n                        model.cancel();\n                    }\n                });\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"renameSheet\", SheetRenameDialog);\n\n    var InsertCommentDialog = SpreadsheetDialog.extend({\n        options: {\n            className: \"k-spreadsheet-insert-comment\",\n            template: (data) => {\n                let $kendoOutput;\n                $kendoOutput = `<div class='k-edit-label'><label id='comment-label'>${kendo.htmlEncode(data.messages.insertCommentDialog.labels.comment)}:</label></div>\n                <div class='k-edit-field'><span class='k-input k-textarea'><textarea\n                    aria-labelledby='comment-label' rows='5' class='k-input-inner'\n                    data-${kendo.htmlEncode(data.ns)}bind='value: comment'></textarea></span></div>\n                <div class='k-actions'> <button class='k-button k-left'\n                    data-${kendo.htmlEncode(data.ns)}bind='click: remove'><span\n                    class='k-button-text'>${kendo.htmlEncode(data.messages.insertCommentDialog.labels.removeComment)}</span></button>\n                <button class='k-button k-button-primary'\n                    data-${kendo.htmlEncode(data.ns)}bind='click: apply'><span\n                    class='k-button-text'>${kendo.htmlEncode(data.messages.okText)}</span></button> <button\n                    class='k-button'\n                    data-${kendo.htmlEncode(data.ns)}bind='click: cancel'><span\n                    class='k-button-text'>${data.messages.cancel}</span></button></div>`;\n                return $kendoOutput;\n            },\n            title: TEXT(\"insertCommentDialog.title\", \"Insert comment\"),\n            autoFocus: false,\n            width: 450\n        },\n        open: function(range) {\n            var self = this;\n            SpreadsheetDialog.fn.open.apply(self, arguments);\n            var element = self.dialog().element;\n            var model = kendo.observable({\n                comment: range.comment(),\n                apply: function() {\n                    if (!/\\S/.test(model.comment)) {\n                        model.comment = null;\n                    }\n                    self.trigger(\"action\", {\n                        command: \"InsertCommentCommand\",\n                        options: {\n                            value: model.comment\n                        }\n                    });\n                    self.close();\n                },\n                remove: function() {\n                    model.comment = null;\n                    model.apply();\n                },\n                cancel: self.close.bind(self)\n            });\n            kendo.bind(element, model);\n\n            element.find(\"textarea\").trigger(\"focus\");\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"insertComment\", InsertCommentDialog);\n\n    var InsertImageDialog = SpreadsheetDialog.extend({\n        options: {\n            template: (data) => {\n                let $kendoOutput;\n                $kendoOutput = `<div class='k-spreadsheet-insert-image-dialog'> <label\n        data-${kendo.htmlEncode(data.ns)}bind='style: { background-image: imageUrl }, css: { k-spreadsheet-has-image: hasImage, k-hover: isHovered }, events: { dragenter: dragEnter, dragover: stopEvent, dragleave: dragLeave, drop: drop }'>\n        <div data-${kendo.htmlEncode(data.ns)}bind='text: info'></div>\n        <input type='file' data-${kendo.htmlEncode(data.ns)}bind='events: { change: change }'\n            accept='image/png, image/jpeg, image/gif' />\n    </label></div>\n<div class='k-actions'> <button class='k-button k-button-primary'\n        data-${kendo.htmlEncode(data.ns)}bind='enabled: okEnabled, click: apply'><span\n            class='k-button-text'>${kendo.htmlEncode(data.messages.okText)}</span></button> <button\n        class='k-button'\n        data-${kendo.htmlEncode(data.ns)}bind='click: cancel'><span\n            class='k-button-text'>${data.messages.cancel}</span></button></div>`;\n                return $kendoOutput;\n            },\n            title: TEXT(\"insertImageDialog.title\", \"Insert image\"),\n            width: \"auto\"\n        },\n        open: function() {\n            var self = this;\n            SpreadsheetDialog.fn.open.apply(self, arguments);\n            var element = self.dialog().element;\n            var model = kendo.observable({\n                okEnabled: false,\n                info: kendo.spreadsheet.messages.dialogs.insertImageDialog.info,\n                imageUrl: \"\",\n                hasImage: false,\n                isHovered: false,\n                _url: null,\n                _image: null,\n                apply: function() {\n                    window.URL.revokeObjectURL(model._url);\n                    self.trigger(\"action\", {\n                        command: \"InsertImageCommand\",\n                        options: {\n                            blob   : model._image,\n                            width  : model._width,\n                            height : model._height\n                        }\n                    });\n                    self.close();\n                },\n                cancel: self.close.bind(self),\n                stopEvent: function(ev) {\n                    ev.stopPropagation();\n                    ev.preventDefault();\n                },\n                drop: function(ev) {\n                    model.stopEvent(ev);\n                    model.selectFile(ev.originalEvent.dataTransfer.files);\n                    model.set(\"isHovered\", false);\n                },\n                dragEnter: function(ev) {\n                    model.stopEvent(ev);\n                    model.set(\"isHovered\", true);\n                },\n                dragLeave: function(ev) {\n                    model.stopEvent(ev);\n                    model.set(\"isHovered\", false);\n                },\n                change: function(ev) {\n                    model.selectFile(ev.target.files);\n                },\n                selectFile: function(files) {\n                    var image;\n                    for (var i = 0; i < files.length; ++i) {\n                        if (/^image\\//i.test(files[i].type)) {\n                            image = files[i];\n                            break;\n                        }\n                    }\n                    if (model._url) {\n                        window.URL.revokeObjectURL(model._url);\n                    }\n                    if (image) {\n                        model._image = image;\n                        model._url = window.URL.createObjectURL(image);\n                        var img = new Image();\n                        img.src = model._url;\n                        img.onload = function() {\n                            model._width = img.width;\n                            model._height = img.height;\n                            model.set(\"info\", kendo.spreadsheet.messages.dialogs.insertImageDialog.info);\n                            model.set(\"okEnabled\", true);\n                            model.set(\"imageUrl\", \"url('\" + model._url + \"')\");\n                            model.set(\"hasImage\", true);\n                        };\n                    } else {\n                        model._image = null;\n                        model.set(\"info\", kendo.spreadsheet.messages.dialogs.insertImageDialog.typeError);\n                        model.set(\"okEnabled\", false);\n                        model.set(\"imageUrl\", \"\");\n                        model.set(\"hasImage\", false);\n                    }\n                }\n            });\n            kendo.bind(element, model);\n        }\n    });\n\n    kendo.spreadsheet.dialogs.register(\"insertImage\", InsertImageDialog);\n\n    function Localizable(path, def) {\n        this.path = path.split(\".\");\n        this.def = def;\n    }\n\n    Localizable.prototype.trans = function() {\n        var msg = kendo.spreadsheet.messages.dialogs;\n        for (var i = 0; i < this.path.length; ++i) {\n            msg = msg[this.path[i]];\n            if (!msg) {\n                return this.def;\n            }\n        }\n        return msg;\n    };\n\n    function TEXT(path, def) {\n        return new Localizable(path, def);\n    }\n\n    function translate(thing) {\n        if (thing instanceof Localizable) {\n            return thing.trans();\n        }\n        else if (Array.isArray(thing)) {\n            return thing.map(translate);\n        }\n        else if (thing != null && typeof thing == \"object\") {\n            return Object.keys(thing).reduce(function(ret, key){\n                ret[key] = translate(thing[key]);\n                return ret;\n            }, {});\n        }\n        return thing;\n    }\n\n})(window.kendo);\n","import \"../kendo.core.js\";\nimport \"../kendo.colorpicker.js\";\nimport \"../kendo.popup.js\";\nimport \"../kendo.togglebutton.js\";\n\n    (function(kendo) {\n\n        var $ = kendo.jQuery;\n        var BORDER_TYPES = [\n            \"allBorders\",\n            \"insideBorders\",\n            \"insideHorizontalBorders\",\n            \"insideVerticalBorders\",\n            \"outsideBorders\",\n            \"leftBorder\",\n            \"topBorder\",\n            \"rightBorder\",\n            \"bottomBorder\",\n            \"noBorders\"\n        ];\n        var BORDER_TYPES_ICONS = {\n           allBorders: \"bordersAll\",\n           insideBorders: \"bordersInside\",\n           insideHorizontalBorders: \"bordersInsideHorizontal\",\n           insideVerticalBorders: \"bordersInsideVertical\",\n           outsideBorders: \"bordersOutside\",\n           leftBorder: \"borderLeft\",\n           topBorder: \"borderTop\",\n           rightBorder: \"borderRight\",\n           bottomBorder: \"borderBottom\",\n           noBorders: \"bordersNone\"\n        };\n\n        var BORDER_PALETTE_MESSAGES = kendo.spreadsheet.messages.borderPalette = {\n            allBorders: \"All borders\",\n            insideBorders: \"Inside borders\",\n            insideHorizontalBorders: \"Inside horizontal borders\",\n            insideVerticalBorders: \"Inside vertical borders\",\n            outsideBorders: \"Outside borders\",\n            leftBorder: \"Left border\",\n            topBorder: \"Top border\",\n            rightBorder: \"Right border\",\n            bottomBorder: \"Bottom border\",\n            noBorders: \"No border\"\n        };\n\n        var colorPickerPalette = [ //metro palette\n            \"#ffffff\", \"#000000\", \"#d6ecff\", \"#4e5b6f\", \"#7fd13b\", \"#ea157a\", \"#feb80a\", \"#00addc\", \"#738ac8\", \"#1ab39f\",\n            \"#f2f2f2\", \"#7f7f7f\", \"#a7d6ff\", \"#d9dde4\", \"#e5f5d7\", \"#fad0e4\", \"#fef0cd\", \"#c5f2ff\", \"#e2e7f4\", \"#c9f7f1\",\n            \"#d8d8d8\", \"#595959\", \"#60b5ff\", \"#b3bcca\", \"#cbecb0\", \"#f6a1c9\", \"#fee29c\", \"#8be6ff\", \"#c7d0e9\", \"#94efe3\",\n            \"#bfbfbf\", \"#3f3f3f\", \"#007dea\", \"#8d9baf\", \"#b2e389\", \"#f272af\", \"#fed46b\", \"#51d9ff\", \"#aab8de\", \"#5fe7d5\",\n            \"#a5a5a5\", \"#262626\", \"#003e75\", \"#3a4453\", \"#5ea226\", \"#af0f5b\", \"#c58c00\", \"#0081a5\", \"#425ea9\", \"#138677\",\n            \"#7f7f7f\", \"#0c0c0c\", \"#00192e\", \"#272d37\", \"#3f6c19\", \"#750a3d\", \"#835d00\", \"#00566e\", \"#2c3f71\", \"#0c594f\"\n        ];\n\n        var BorderPalette = kendo.ui.Widget.extend({\n            init: function(element, options) {\n                kendo.ui.Widget.call(this, element, options);\n\n                this.element = element;\n                this.color = \"#000\";\n\n                this.element.addClass(\"k-spreadsheet-popup\");\n\n                this._borderTypePalette();\n                this._borderColorPalette();\n            },\n\n            options: {\n                name: \"BorderPalette\"\n            },\n\n            events: [\n                \"change\"\n            ],\n\n            destroy: function() {\n                this.colorChooser.destroy();\n                kendo.destroy(this.element.find(\".k-spreadsheet-border-type-palette\"));\n            },\n\n            value: function() {\n                return { type: this.type, color: this.color };\n            },\n\n            _borderTypePalette: function() {\n                var that = this;\n                var messages = BORDER_PALETTE_MESSAGES;\n\n                var element = $(\"<div />\", {\n                    \"class\": \"k-spreadsheet-border-type-palette\"\n                });\n\n                $('<span class=\"k-column-menu-group-header\"><span class=\"k-column-menu-group-header-text\">Border type</span></span>').appendTo(this.element);\n\n                element.appendTo(this.element);\n\n                BORDER_TYPES.map(function(type) {\n                    $('<button title=\"' + messages[type] + '\" aria-label=\"' + messages[type] + '\" data-border-type=\"' + type + '\">')\n                        .appendTo(element)\n                        .kendoToggleButton({\n                            icon: kendo.toHyphens(BORDER_TYPES_ICONS[type]),\n                            toggle: that._toggle.bind(that)\n                        })\n                });\n            },\n\n            _borderColorPalette: function() {\n                var element = $(\"<div />\", {\n                    \"class\": \"k-spreadsheet-border-color-palette\"\n                });\n\n                $('<span class=\"k-column-menu-group-header\"><span class=\"k-column-menu-group-header-text\">Border color</span></span>').appendTo(this.element);\n                element.appendTo(this.element);\n\n                this.colorChooser = new kendo.ui.FlatColorPicker(element, {\n                    buttons: !this.options.change,\n                    color: this.color,\n                    view: \"palette\",\n                    palette: colorPickerPalette,\n                    input: false,\n                    change: this._change.bind(this)\n                });\n\n                this.colorChooser.wrapper.find(\".k-coloreditor-apply\").on(\"click\", this._apply.bind(this));\n                this.colorChooser.wrapper.find(\".k-coloreditor-cancel\").on(\"click\", this._cancel.bind(this));\n            },\n\n            _change: function() {\n                this.color = this.colorChooser.value();\n            },\n\n            _toggle: function(e) {\n                var type = e.target.data(\"borderType\"),\n                    previous = e.target.siblings(\".k-selected\").data(\"kendoToggleButton\");\n\n                if (e.checked === true) {\n                    if (previous) {\n                        previous.toggle(false);\n                    }\n\n                    this.type = type;\n                } else {\n                    this.type = null;\n                }\n            },\n\n            _apply: function() {\n                this.trigger(\"change\", { type: this.type, color: this.color });\n            },\n\n            _cancel: function() {\n                this.trigger(\"change\", { type: null, color: null });\n            }\n        });\n\n        kendo.spreadsheet.BorderPalette = BorderPalette;\n\n    })(window.kendo);\n","import \"../kendo.toolbar.js\";\nimport \"../kendo.colorpicker.js\";\nimport \"../kendo.combobox.js\";\nimport \"../kendo.dropdownlist.js\";\nimport \"../kendo.dropdownbutton.js\";\nimport \"../kendo.popup.js\";\nimport \"./borderpalette.js\";\nimport \"../kendo.icons.js\";\n\n(function(kendo) {\n    var $ = kendo.jQuery;\n\n    function getDefaultToolElement(firstIconName) {\n        return `<button role=\"button\">${kendo.ui.icon({ icon: firstIconName, iconClass: \"k-button-icon\" })}<span class=\"k-button-text\">${kendo.ui.icon(\"caret-alt-down\")}</span></button>`\n    }\n\n    var ToolBar = kendo.ui.ToolBar;\n\n    var MESSAGES = kendo.spreadsheet.messages.toolbar = {\n        addColumnLeft: \"Add column left\",\n        addColumnRight: \"Add column right\",\n        addRowAbove: \"Add row above\",\n        addRowBelow: \"Add row below\",\n        alignment: \"Alignment\",\n        alignmentButtons: {\n            justifyLeft: \"Align left\",\n            justifyCenter: \"Center\",\n            justifyRight: \"Align right\",\n            justifyFull: \"Justify\",\n            alignTop: \"Align top\",\n            alignMiddle: \"Align middle\",\n            alignBottom: \"Align bottom\"\n        },\n        backgroundColor: \"Background\",\n        increaseFontSize: \"Increase font size\",\n        decreaseFontSize: \"Decrease font size\",\n        bold: \"Bold\",\n        borders: \"Borders\",\n        copy: \"Copy\",\n        cut: \"Cut\",\n        deleteColumn: \"Delete column\",\n        deleteRow: \"Delete row\",\n        filter: \"Filter\",\n        fontFamily: \"Font\",\n        fontSize: \"Font size\",\n        format: \"Custom format...\",\n        formatTypesSamples: {\n            number: \"1,499.99\",\n            percent: \"14.50%\",\n            financial: \"(1,000.12)\",\n            currency: \"$1,499.99\",\n            date: \"4/21/2012\",\n            time: \"5:49:00 PM\",\n            dateTime: \"4/21/2012 5:49:00\",\n            duration: \"168:05:00\"\n        },\n        formatTypes: {\n            automatic: \"Automatic\",\n            text: \"Text\",\n            number: \"Number\",\n            percent: \"Percent\",\n            financial: \"Financial\",\n            currency: \"Currency\",\n            date: \"Date\",\n            time: \"Time\",\n            dateTime: \"Date time\",\n            duration: \"Duration\",\n            moreFormats: \"More formats...\"\n        },\n        formatDecreaseDecimal: \"Decrease decimal\",\n        formatIncreaseDecimal: \"Increase decimal\",\n        freeze: \"Freeze panes\",\n        freezeButtons: {\n            freezePanes: \"Freeze panes\",\n            freezeRows: \"Freeze rows\",\n            freezeColumns: \"Freeze columns\",\n            unfreeze: \"Unfreeze panes\"\n        },\n        insertComment: \"Insert comment\",\n        insertImage: \"Insert image\",\n        italic: \"Italic\",\n        merge: \"Merge cells\",\n        mergeButtons: {\n            mergeCells: \"Merge all\",\n            mergeHorizontally: \"Merge horizontally\",\n            mergeVertically: \"Merge vertically\",\n            unmerge: \"Unmerge\"\n        },\n        open: \"Open...\",\n        paste: \"Paste\",\n        redo: \"Redo\",\n        undo: \"Undo\",\n        exportAs: \"Export...\",\n        toggleGridlines: \"Toggle gridlines\",\n        sort: \"Sort\",\n        sortButtons: {\n            // sortSheetAsc: \"Sort sheet A to Z\",\n            // sortSheetDesc: \"Sort sheet Z to A\",\n            sortRangeAsc: \"Sort range A to Z\",\n            sortRangeDesc: \"Sort range Z to A\"\n        },\n        textColor: \"Text Color\",\n        textWrap: \"Wrap text\",\n        underline: \"Underline\",\n        validation: \"Data validation...\",\n        hyperlink: \"Link\"\n    };\n\n    var defaultTools = {\n        file: [\n            \"open\",\n            \"exportAs\",\n        ],\n        format: [\n            \"format\",\n            \"formatDecreaseDecimal\",\n            \"formatIncreaseDecimal\"\n        ],\n        home: [\n            [\"undo\", \"redo\"],\n            \"separator\",\n            [\"cut\", \"copy\", \"paste\"],\n            \"separator\",\n            \"fontFamily\", \"fontSize\", \"increaseFontSize\", \"decreaseFontSize\",\n            \"separator\",\n            [\"bold\", \"italic\", \"underline\"],\n            \"separator\",\n            \"textColor\",\n            \"separator\",\n            \"backgroundColor\",\n            \"borders\",\n            \"separator\",\n            \"alignment\",\n            \"textWrap\",\n        ],\n        insert: [\n            \"insertComment\",\n            \"separator\",\n            \"hyperlink\",\n            \"separator\",\n            \"insertImage\",\n            \"separator\",\n            [\"addColumnLeft\", \"addColumnRight\", \"addRowBelow\", \"addRowAbove\"],\n            \"separator\",\n            [\"deleteColumn\", \"deleteRow\"]\n        ],\n        data: [\n            \"sort\",\n            \"separator\",\n            \"filter\",\n            \"separator\",\n            \"validation\"\n        ],\n        view: [\n            \"freeze\",\n            \"merge\",\n            \"toggleGridlines\"\n        ]\n    };\n\n    var defaultFormats = kendo.spreadsheet.formats = {\n        automatic: null,\n        text: \"@\",\n        number: \"#,0.00\",\n        percent: \"0.00%\",\n        financial: '_(\"$\"* #,##0.00_);_(\"$\"* (#,##0.00);_(\"$\"* \"-\"??_);_(@_)',\n        currency: \"$#,##0.00;[Red]$#,##0.00\",\n        date: \"m/d/yyyy\",\n        time: \"h:mm:ss AM/PM\",\n        dateTime: \"m/d/yyyy h:mm\",\n        duration: \"[h]:mm:ss\"\n    };\n\n    var colorPickerPalette = [ //metro palette\n        \"#ffffff\", \"#000000\", \"#d6ecff\", \"#4e5b6f\", \"#7fd13b\", \"#ea157a\", \"#feb80a\", \"#00addc\", \"#738ac8\", \"#1ab39f\",\n        \"#f2f2f2\", \"#7f7f7f\", \"#a7d6ff\", \"#d9dde4\", \"#e5f5d7\", \"#fad0e4\", \"#fef0cd\", \"#c5f2ff\", \"#e2e7f4\", \"#c9f7f1\",\n        \"#d8d8d8\", \"#595959\", \"#60b5ff\", \"#b3bcca\", \"#cbecb0\", \"#f6a1c9\", \"#fee29c\", \"#8be6ff\", \"#c7d0e9\", \"#94efe3\",\n        \"#bfbfbf\", \"#3f3f3f\", \"#007dea\", \"#8d9baf\", \"#b2e389\", \"#f272af\", \"#fed46b\", \"#51d9ff\", \"#aab8de\", \"#5fe7d5\",\n        \"#a5a5a5\", \"#262626\", \"#003e75\", \"#3a4453\", \"#5ea226\", \"#af0f5b\", \"#c58c00\", \"#0081a5\", \"#425ea9\", \"#138677\",\n        \"#7f7f7f\", \"#0c0c0c\", \"#00192e\", \"#272d37\", \"#3f6c19\", \"#750a3d\", \"#835d00\", \"#00566e\", \"#2c3f71\", \"#0c594f\"\n    ];\n\n    var COLOR_PICKER_MESSAGES = kendo.spreadsheet.messages.colorPicker = {\n        reset: \"Reset color\",\n        customColor: \"Custom color...\",\n        apply: \"Apply\",\n        cancel: \"Cancel\"\n    };\n\n    function getToolDefaults() {\n        return {\n        undo: {\n           type: \"button\",\n           name: \"undo\",\n           icon: \"undo\",\n           command: \"undo\"\n        },\n        redo: {\n           type: \"button\",\n           name: \"redo\",\n           icon: \"redo\",\n           command: \"redo\"\n        },\n        separator: { type: \"separator\" },\n        //home tab\n        open: {\n            type: \"open\",\n            name: \"open\",\n            icon: \"folder-open\",\n            extensions: \".xlsx\",\n            command: \"OpenCommand\"\n        },\n        exportAs: {\n            type: \"button\",\n            name: \"exportAs\",\n            dialog: \"exportAs\",\n            overflow: \"never\",\n            icon: \"download\"\n        },\n        bold: {\n            type: \"button\",\n            command: \"PropertyChangeCommand\",\n            property: \"bold\",\n            value: true,\n            icon: \"bold\",\n            togglable: true\n        },\n        italic: {\n            type: \"button\",\n            command: \"PropertyChangeCommand\",\n            property: \"italic\",\n            value: true,\n            icon: \"italic\",\n            togglable: true\n        },\n        underline: {\n            type: \"button\",\n            command: \"PropertyChangeCommand\",\n            property: \"underline\",\n            value: true,\n            icon: \"underline\",\n            togglable: true\n        },\n        formatDecreaseDecimal: {\n            type: \"button\",\n            name: \"formatDecreaseDecimal\",\n            command: \"AdjustDecimalsCommand\",\n            value: -1,\n            icon: \"decimal-decrease\"\n        },\n        formatIncreaseDecimal: {\n            type: \"button\",\n            name: \"formatIncreaseDecimal\",\n            command: \"AdjustDecimalsCommand\",\n            value: +1,\n            icon: \"decimal-increase\"\n        },\n        textWrap: {\n            type: \"button\",\n            name: \"textWrap\",\n            command: \"TextWrapCommand\",\n            property: \"wrap\",\n            value: true,\n            icon: \"text-wrap\",\n            togglable: true\n        },\n        cut: {\n            type: \"button\",\n            name: \"cut\",\n            command: \"ToolbarCutCommand\",\n            icon: \"cut\"\n        },\n        copy: {\n            type: \"button\",\n            name: \"copy\",\n            command: \"ToolbarCopyCommand\",\n            icon: \"copy\"\n        },\n        paste: {\n            type: \"button\",\n            name: \"paste\",\n            command: \"ToolbarPasteCommand\",\n            icon: \"clipboard\"\n        },\n        alignment: {\n            type: \"component\",\n            name: \"alignment\",\n            property: \"alignment\",\n            component: \"DropDownButton\",\n            element: getDefaultToolElement(\"align-left\"),\n            overflowComponent: {\n                type: \"button\",\n                dialog: \"alignment\",\n                icon: \"align-left\"\n            },\n            componentOptions: {\n                fillMode: \"flat\",\n                items: [\n                    { attributes: { \"data-value\": \"left\", \"data-property\": \"textAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-left\", text: MESSAGES.alignmentButtons.justifyLeft },\n                    { attributes: { \"data-value\": \"center\", \"data-property\": \"textAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-center\", text: MESSAGES.alignmentButtons.justifyCenter },\n                    { attributes: { \"data-value\": \"right\", \"data-property\": \"textAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-right\", text: MESSAGES.alignmentButtons.justifyRight },\n                    { attributes: { \"data-value\": \"justify\", \"data-property\": \"textAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-justify\", text: MESSAGES.alignmentButtons.justifyFull },\n                    { attributes: { class: \"k-separator\" } },\n                    { attributes: { \"data-value\": \"top\", \"data-property\": \"verticalAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-top\", text: MESSAGES.alignmentButtons.alignTop },\n                    { attributes: { \"data-value\": \"center\", \"data-property\": \"verticalAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-middle\", text: MESSAGES.alignmentButtons.alignMiddle },\n                    { attributes: { \"data-value\": \"bottom\", \"data-property\": \"verticalAlign\", \"data-command\": \"PropertyChangeCommand\" }, icon: \"align-bottom\", text: MESSAGES.alignmentButtons.alignBottom }\n                ],\n                commandOn: \"click\"\n            }\n        },\n        backgroundColor: {\n            type: \"component\",\n            name: \"backgroundColor\",\n            commandOn: \"change\",\n            command: \"PropertyChangeCommand\",\n            property: \"background\",\n            component: \"ColorPicker\",\n            componentOptions: {\n                view: \"palette\",\n                toolIcon: \"droplet\",\n                fillMode: \"flat\",\n                palette: colorPickerPalette,\n                clearButton: true,\n                messages: COLOR_PICKER_MESSAGES,\n                input: false,\n                commandOn: \"change\"\n            },\n            overflowComponent: {\n                type: \"button\",\n                dialog: \"colorPicker\",\n                icon: \"droplet\",\n                property: \"background\"\n            }\n        },\n        textColor: {\n            type: \"component\",\n            name: \"textColor\",\n            commandOn: \"change\",\n            command: \"PropertyChangeCommand\",\n            property: \"color\",\n            component: \"ColorPicker\",\n            componentOptions: {\n                view: \"palette\",\n                fillMode: \"flat\",\n                toolIcon: \"foreground-color\",\n                palette: colorPickerPalette,\n                clearButton: true,\n                messages: COLOR_PICKER_MESSAGES,\n                input: false,\n                commandOn: \"change\"\n            },\n            overflowComponent: {\n                type: \"button\",\n                dialog: \"colorPicker\",\n                icon: \"foreground-color\",\n                property: \"color\"\n            }\n        },\n        fontFamily: {\n            type: \"component\",\n            name: \"fontFamily\",\n            command: \"PropertyChangeCommand\",\n            property: \"fontFamily\",\n            component: \"DropDownList\",\n            overflowComponent: {\n                type: \"button\",\n                dialog: \"fontFamily\",\n                icon: \"font-family\"\n            },\n            componentOptions: {\n                dataSource: [\"Arial\", \"Courier New\", \"Georgia\", \"Times New Roman\", \"Trebuchet MS\", \"Verdana\"],\n                value: \"Arial\",\n                fillMode: \"flat\",\n                commandOn: \"change\"\n            }\n        },\n        fontSize: {\n            type: \"component\",\n            name: \"fontSize\",\n            command: \"PropertyChangeCommand\",\n            property: \"fontSize\",\n            component: \"ComboBox\",\n            overflowComponent: {\n                type: \"button\",\n                dialog: \"fontSize\",\n                icon: \"font-size\"\n            },\n            componentOptions: {\n                dataSource: [8, 9, 10, 11, 12, 13, 14, 16, 18, 20, 22, 24, 26, 28, 36, 48, 72],\n                value: 12,\n                fillMode: \"flat\",\n                commandOn: \"change\"\n            }\n        },\n        increaseFontSize: {\n            type: \"button\",\n            name: \"increaseFontSize\",\n            command: \"IncreaseFontSize\",\n            property: \"fontSize\",\n            icon: \"font-grow\"\n        },\n        decreaseFontSize: {\n            type: \"button\",\n            name: \"decreaseFontSize\",\n            command: \"DecreaseFontSize\",\n            property: \"fontSize\",\n            icon: \"font-shrink\"\n        },\n        format: {\n            type: \"component\",\n            name: \"format\",\n            component: \"DropDownButton\",\n            element: getDefaultToolElement(\"custom-format\"),\n            overflowComponent: {\n                type: \"button\",\n                dialog: \"formatCells\",\n                icon: \"custom-format\"\n            },\n            componentOptions: {\n                fillMode: \"flat\",\n                items: [\n                    { attributes: { \"data-value\": defaultFormats.automatic, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.automatic },\n                    { attributes: { \"data-value\": defaultFormats.text, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.text },\n                    { attributes: { \"data-value\": defaultFormats.number, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.number, sample: MESSAGES.formatTypesSamples.number },\n                    { attributes: { \"data-value\": defaultFormats.percent, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.percent, sample: MESSAGES.formatTypesSamples.percent },\n                    { attributes: { \"data-value\": defaultFormats.financial, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.financial, sample: MESSAGES.formatTypesSamples.financial },\n                    { attributes: { \"data-value\": defaultFormats.currency, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.currency, sample: MESSAGES.formatTypesSamples.currency },\n                    { attributes: { \"data-value\": defaultFormats.date, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.date, sample: MESSAGES.formatTypesSamples.date },\n                    { attributes: { \"data-value\": defaultFormats.time, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.time, sample: MESSAGES.formatTypesSamples.time },\n                    { attributes: { \"data-value\": defaultFormats.dateTime, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.dateTime, sample: MESSAGES.formatTypesSamples.dateTime },\n                    { attributes: { \"data-value\": defaultFormats.duration, \"data-command\": \"PropertyChangeCommand\", \"data-property\": \"format\" }, text: MESSAGES.formatTypes.duration, sample: MESSAGES.formatTypesSamples.duration },\n                    { attributes: { \"data-value\": \"popup\", \"data-popup\": \"formatCells\" }, text: MESSAGES.formatTypes.moreFormats },\n                ],\n                itemTemplate: (data) => {\n                    let $kendoOutput;\n                    $kendoOutput = `<span class=\"k-link k-menu-link\"><span class=\"k-menu-link-text\">`; if (data.sample) {\n                    $kendoOutput += `<span class='k-spreadsheet-sample'>${kendo.htmlEncode(data.sample)}</span> `; }\n                    $kendoOutput += `${kendo.htmlEncode(data.text)}</span></span>`;\n                    return $kendoOutput;\n                },\n                commandOn: \"click\"\n            }\n        },\n        filter: {\n            type: \"button\",\n            name: \"filter\",\n            property: \"hasFilter\",\n            icon: \"filter\",\n            command: \"FilterCommand\",\n            togglable: true,\n            enable: false\n        },\n        merge: {\n            type: \"component\",\n            name: \"merge\",\n            component: \"DropDownButton\",\n            element: getDefaultToolElement(\"cells-merge\"),\n            overflowComponent: {\n                type: \"button\",\n                dialog: \"merge\",\n                icon: \"cells-merge\"\n            },\n            componentOptions: {\n                fillMode: \"flat\",\n                items: [\n                    { attributes: { \"data-value\": \"cells\", \"data-command\": \"MergeCellCommand\" }, icon: \"cells-merge\", text: MESSAGES.mergeButtons.mergeCells },\n                    { attributes: { \"data-value\": \"horizontally\", \"data-command\": \"MergeCellCommand\" }, icon: \"cells-merge-horizontally\", text: MESSAGES.mergeButtons.mergeHorizontally },\n                    { attributes: { \"data-value\": \"vertically\", \"data-command\": \"MergeCellCommand\" }, icon: \"cells-merge-vertically\", text: MESSAGES.mergeButtons.mergeVertically },\n                    { attributes: { \"data-value\": \"unmerge\", \"data-command\": \"MergeCellCommand\" }, icon: \"table-unmerge\", text: MESSAGES.mergeButtons.unmerge }\n                ],\n                commandOn: \"click\"\n            }\n        },\n        freeze: {\n            type: \"component\",\n            name: \"freeze\",\n            component: \"DropDownButton\",\n            element: getDefaultToolElement(\"pane-freeze\"),\n            overflowComponent: {\n                type: \"button\",\n                dialog: \"freeze\",\n                icon: \"pane-freeze\"\n            },\n            componentOptions: {\n                fillMode: \"flat\",\n                items: [\n                    { attributes: { \"data-value\": \"panes\", \"data-command\": \"FreezePanesCommand\" }, icon: \"pane-freeze\", text: MESSAGES.freezeButtons.freezePanes },\n                    { attributes: { \"data-value\": \"rows\", \"data-command\": \"FreezePanesCommand\" }, icon: \"row-freeze\", text: MESSAGES.freezeButtons.freezeRows },\n                    { attributes: { \"data-value\": \"columns\", \"data-command\": \"FreezePanesCommand\" }, icon: \"column-freeze\", text: MESSAGES.freezeButtons.freezeColumns },\n                    { attributes: { \"data-value\": \"unfreeze\", \"data-command\": \"FreezePanesCommand\" }, icon: \"table-unmerge\", text: MESSAGES.freezeButtons.unfreeze }\n                ],\n                commandOn: \"click\"\n            }\n        },\n        borders: {\n            type: \"popupButton\",\n            name: \"borders\",\n            icon: \"borders-all\",\n            popupComponent: kendo.spreadsheet.BorderPalette,\n            commandOn: \"change\",\n            command: \"BorderChangeCommand\",\n            overflowComponent: {\n                type: \"button\",\n                dialog: \"borders\"\n            }\n        },\n        formatCells: {\n            type: \"button\",\n            dialog: \"formatCells\",\n            overflow: \"never\"\n        },\n        hyperlink: {\n            type: \"button\",\n            name: \"hyperlink\",\n            dialog: \"hyperlink\",\n            icon: \"link\"\n        },\n        toggleGridlines: {\n            type: \"button\",\n            name: \"toggleGridlines\",\n            command: \"GridLinesChangeCommand\",\n            property: \"gridLines\",\n            value: true,\n            icon: \"borders-none\",\n            togglable: true,\n            selected: true\n        },\n        insertComment: {\n            type: \"button\",\n            name: \"insertComment\",\n            dialog: \"insertComment\",\n            property: \"comment\",\n            togglable: true,\n            icon: \"comment\"\n        },\n        insertImage: {\n            type: \"button\",\n            name: \"insertImage\",\n            dialog: \"insertImage\",\n            icon: \"image\",\n        },\n\n        //insert tab\n        addColumnLeft: {\n            type: \"button\",\n            name: \"addColumnLeft\",\n            command: \"AddColumnCommand\",\n            value: \"left\",\n            icon: \"table-column-insert-left\"\n        },\n        addColumnRight: {\n            type: \"button\",\n            name: \"addColumnRight\",\n            command: \"AddColumnCommand\",\n            value: \"right\",\n            icon: \"table-column-insert-right\"\n        },\n        addRowBelow: {\n            type: \"button\",\n            name: \"addRowBelow\",\n            command: \"AddRowCommand\",\n            value: \"below\",\n            icon: \"table-row-insert-below\"\n        },\n        addRowAbove: {\n            type: \"button\",\n            name: \"addRowAbove\",\n            command: \"AddRowCommand\",\n            value: \"above\",\n            icon: \"table-row-insert-above\"\n        },\n        deleteColumn: {\n            type: \"button\",\n            name: \"deleteColumn\",\n            command: \"DeleteColumnCommand\",\n            icon: \"table-column-delete\"\n        },\n        deleteRow: {\n            type: \"button\",\n            name: \"deleteRow\",\n            command: \"DeleteRowCommand\",\n            icon: \"table-row-delete\"\n        },\n\n        //data tab\n        sort: {\n            type: \"component\",\n            name: \"sort\",\n            component: \"DropDownButton\",\n            element: getDefaultToolElement(\"sort-desc\"),\n            overflowComponent: {\n                type: \"button\",\n                dialog: \"sort\",\n                icon: \"sort-desc\"\n            },\n            componentOptions: {\n                fillMode: \"flat\",\n                items: [\n                    { attributes: { \"data-value\": \"asc\", \"data-command\": \"SortCommand\" }, sheet: false, text: MESSAGES.sortButtons.sortRangeAsc, icon: \"sort-asc\" },\n                    { attributes: { \"data-value\": \"desc\", \"data-command\": \"SortCommand\" }, sheet: false, text: MESSAGES.sortButtons.sortRangeDesc, icon: \"sort-desc\" },\n                ],\n                commandOn: \"click\"\n            }\n        },\n        validation: {\n            type: \"button\",\n            name: \"validation\",\n            dialog: \"validation\",\n            icon: \"exclamation-circle\"\n        }\n    };\n}\n\n    var SpreadsheetToolBar = ToolBar.extend({\n        init: function(element, options) {\n            let toolDefaults = getToolDefaults();\n            Object.keys(toolDefaults).forEach((t) => {\n                if (t !== \"validation\") {\n                    toolDefaults[t].showText = \"overflow\";\n                }\n            });\n\n            options.tools = options.tools || SpreadsheetToolBar.prototype.options.tools[options.toolbarName];\n            options.parentMessages = MESSAGES;\n            options.defaultTools = toolDefaults;\n\n            ToolBar.fn.init.call(this, element, options);\n            var handleClick = this._click.bind(this);\n\n            this.element.addClass(\"k-spreadsheet-toolbar\");\n\n            this.bind({\n                click: handleClick,\n                toggle: handleClick,\n                change: handleClick\n            });\n        },\n        _click: function(e) {\n            var target = e.target,\n                property = target.data(\"property\"),\n                value = e.value || target.data(\"value\") || e.target.val(),\n                commandType = target.data(\"command\"),\n                dialog = target.data(\"dialog\"),\n                options = target.data(\"options\") || {};\n\n            if (value === \"popup\") {\n                // Special case to open custom format dialog from option of the format DDL\n                dialog = target.data(\"popup\");\n            }\n\n            if (commandType === \"IncreaseFontSize\") {\n                commandType = \"PropertyChangeCommand\";\n                value++;\n            }\n\n            if (commandType === \"DecreaseFontSize\") {\n                commandType = \"PropertyChangeCommand\";\n                value--;\n            }\n\n            options.property = property || null;\n            options.value = value || null;\n\n            if (dialog) {\n                this.dialog({\n                    name: dialog,\n                    options: options\n                });\n                return;\n            }\n\n            if (!commandType) {\n                return;\n            }\n\n            var args = {\n                command: commandType,\n                options: options\n            };\n\n            if (typeof args.options.value === \"boolean\") {\n                args.options.value = e.checked ? true : null;\n            }\n\n            this.action(args);\n        },\n        events: [\n            \"action\",\n            \"dialog\"\n        ],\n        options: {\n            name: \"SpreadsheetToolBar\",\n            resizable: true,\n            tools: defaultTools,\n            fillMode: \"flat\"\n        },\n        action: function(args) {\n            this.trigger(\"action\", args);\n        },\n        dialog: function(args) {\n            this.trigger(\"dialog\", args);\n        },\n        refresh: function(activeCell) {\n            var range = activeCell,\n                tools = this._tools();\n\n            for (var i = 0; i < tools.length; i++) {\n                var property = tools[i].property,\n                    tool = tools[i].tool,\n                    value = kendo.isFunction(range[property]) ? range[property]() : range;\n\n                if (property == \"gridLines\") {\n                    // this isn't really a property of the range, it's per-sheet.\n                    value = range.sheet().showGridLines();\n                }\n\n                this._updateTool(tool, value, property, range);\n            }\n\n            this.resize(true);\n        },\n        _tools: function() {\n            return this.element.find(\"[data-property]\").toArray().map(function(element) {\n                element = $(element);\n                return {\n                    property: element.attr(\"data-property\"),\n                    tool: this._getItem(element)\n                };\n            }.bind(this));\n        },\n        _updateTool: function(tool, value, property, range) {\n            var component = tool.component,\n                toolbarEl = tool.toolbarEl,\n                widget = kendo.widgetInstance(toolbarEl.find(\"[data-role]\")),\n                menuItem = tool.menuItem,\n                toggle = false,\n                vertical, text, menu, selection, enabled, label;\n\n            if (property === \"hasFilter\") {\n                selection = range.sheet().selection();\n\n                if (selection && selection._ref && selection._ref.height) {\n                    enabled = value || selection._ref.height() > 1;\n\n                    this.enable(toolbarEl, enabled);\n                }\n            } else if (property === \"alignment\") {\n                vertical = value.verticalAlign();\n                text = value.textAlign();\n                menu = component.menu.element;\n\n                menu.find(\".k-item .k-link\").removeClass(\"k-selected\");\n                menu.find(\".k-item[data-property=textAlign][data-value=\" + text + \"] .k-link\").addClass(\"k-selected\");\n                menu.find(\".k-item[data-property=verticalAlign][data-value=\" + vertical + \"] .k-link\").addClass(\"k-selected\");\n            } else if (property === \"background\" || property === \"color\") {\n                widget.value(value);\n            } else if (property === \"fontFamily\" || property === \"fontSize\") {\n                if (toolbarEl.is(\"button\")) {\n                    toolbarEl.attr(\"data-value\", value);\n                    toolbarEl.data(\"value\", value);\n                    return;\n                }\n                label = menuItem.find(\".k-menu-link-text\").text().split(\"(\")[0].trim();\n                menuItem.find(\".k-menu-link-text\").text(label + \" (\" + value + \") ...\");\n                widget.value(value);\n            }\n\n            if (component && component.toggle) {\n                if (typeof value === \"boolean\") {\n                    toggle = !!value;\n                } else if (typeof value === \"string\") {\n                    if (toolbarEl.data(\"value\")) {\n                        toggle = toolbarEl.data(\"value\") === value;\n                    } else {\n                        // if no value is specified in the tool options,\n                        // assume it should be ON if the range value is not null, and OFF otherwise.\n                        toggle = value != null;\n                    }\n                }\n\n                this.toggle(toolbarEl, toggle);\n            }\n        }\n    });\n\n    kendo.cssProperties.propertyDictionary[\"SpreadsheetToolBar\"] = kendo.cssProperties.propertyDictionary[\"ToolBar\"];\n\n    kendo.spreadsheet.ToolBar = SpreadsheetToolBar;\n\n    kendo.spreadsheet.Menu = kendo.ui.Menu;\n\n})(window.kendo);\n","import \"../kendo.pdf.js\";\n    \"use strict\";\n\n    function clone(hash, target) {\n        if (!target) {\n            target = {};\n        }\n        if (Object.assign) {\n            return Object.assign(target, hash);\n        }\n        return Object.keys(hash).reduce(function(copy, key) {\n            copy[key] = hash[key];\n            return copy;\n        }, target);\n    }\n\n    function drawTabularData(options) {\n        var progress = new $.Deferred();\n        var promise = progress.promise();\n\n        options = clone(options, {\n            dataSource       : null,\n            guidelines       : true,\n            guideColor       : \"#000\",\n            columns          : null,\n            headerBackground : \"#999\",\n            headerColor      : \"#000\",\n            oddBackground    : null,\n            evenBackground   : null,\n            fontFamily       : \"Arial\",\n            fontSize         : 12,\n            paperSize        : \"A4\",\n            margin           : \"1cm\",\n            landscape        : true,\n            fitWidth         : false,\n            scale            : 1,\n            rowHeight        : 20,\n            maxEmpty         : 1,\n            useGridFormat    : true\n        });\n\n        // retrieve fonts; custom fonts should be already loaded\n        kendo.drawing.pdf.defineFont(\n            kendo.drawing.drawDOM.getFontFaces(document)\n        );\n\n        var charWidth = charWidthFunction(options.fontFamily, options.fontSize);\n\n        function textWidth(value) {\n            if (value != null) {\n                var width = 12;         // magic numbers :-/\n                for (var i = value.length; --i >= 0;) {\n                    width += charWidth(value.charAt(i));\n                }\n                return width;\n            }\n            return 0;\n        }\n\n        var border = options.guidelines ? { size: 1, color: options.guideColor } : null;\n\n        function mkCell(data) {\n            if (!border) {\n                return data;\n            }\n            return clone(data, {\n                borderLeft: border,\n                borderTop: border,\n                borderRight: border,\n                borderBottom: border\n            });\n        }\n\n        options.dataSource.fetch(function(){\n            var data = options.dataSource.data();\n            if (!data.length) {\n                return progress.reject(\"Empty dataset\");\n            }\n\n            // this really must be present\n            var columns = options.columns.map(function(col){\n                if (typeof col == \"string\") {\n                    return { title: col, field: col };\n                } else {\n                    return col;\n                }\n            });\n            var columnTitles = columns.map(function(col){\n                return col.title || col.field;\n            });\n            var columnWidths = columnTitles.map(textWidth);\n\n            // prepare data for a Sheet object's fromJSON method\n            var rows = data.map(function(row, rowIndex){\n                return {\n                    cells: columns.map(function(col, colIndex){\n                        var value = row[col.field];\n\n                        // NOTE: value might not be string.  I added option useGridFormat (default\n                        // true), which will use a column's format, if present, to convert the value\n                        // to a string, so that we can measure the width right now.\n                        if (options.useGridFormat) {\n                            if (value != null) {\n                                if (col.format) {\n                                    value = kendo.format(col.format, value);\n                                } else {\n                                    value += \"\";\n                                }\n                            }\n                            // adjust the column widths while we're at it\n                            columnWidths[colIndex] = Math.max(\n                                textWidth(value),\n                                columnWidths[colIndex]\n                            );\n                        }\n\n                        // if options.useGridFormat is false and col.format is present, pass it over\n                        // to the spreadsheet.  In that case we should calculate the widths after\n                        // the spreadsheet is created (XXX to be implemented when someone needs it).\n                        return mkCell({\n                            value: value,\n                            format: options.useGridFormat ? null : col.format,\n                            background: rowIndex % 2 ? options.evenBackground : options.oddBackground\n                        });\n                    })\n                };\n            });\n\n            // insert header line\n            rows.unshift({\n                cells: columnTitles.map(function(label){\n                    return mkCell({\n                        value: label,\n                        background: options.headerBackground,\n                        color: options.headerColor\n                    });\n                })\n            });\n\n            // init a Sheet object.  Note that we have to add one\n            // extra-row and column, because the very last ones can't\n            // have right/bottom borders (known limitation).\n            var sheet = new kendo.spreadsheet.Sheet(\n                rows.length + 1,        // rows\n                columns.length + 1,     // columns\n                options.rowHeight,      // row height\n                50,                     // column width\n                20,                     // header height\n                20,                     // header width,\n                {                       // default cell style\n                    fontFamily: options.fontFamily,\n                    fontSize: options.fontSize,\n                    verticalAlign: \"center\"\n                }\n            );\n\n            // load data\n            sheet.fromJSON({\n                name: \"Sheet1\",\n                rows: rows,\n                columns: columnWidths.map(function(w, i){\n                    return { index: i, width: w };\n                })\n            });\n\n            sheet.draw({\n                paperSize  : options.paperSize,\n                landscape  : options.landscape,\n                margin     : options.margin,\n                guidelines : false, // using borders instead (better contrast)\n                scale      : options.scale,\n                fitWidth   : options.fitWidth,\n                maxEmpty   : options.maxEmpty,\n                headerRows : 1\n            }, progress.resolve.bind(progress));\n        });\n\n        return promise;\n    }\n\n    var CACHE_CHAR_WIDTH = {};\n\n    var charWidthFunction = function(fontFamily, fontSize) {\n        var id = fontSize + \":\" + fontFamily;\n        var func = CACHE_CHAR_WIDTH[id];\n        if (!func) {\n            var span, div = document.createElement(\"div\");\n            div.style.position = \"fixed\";\n            div.style.left = \"-10000px\";\n            div.style.top = \"-10000px\";\n            div.style.fontFamily = fontFamily;\n            div.style.fontSize = fontSize + \"px\";\n            div.style.whiteSpace = \"pre\";\n            for (var i = 32; i < 128; ++i) {\n                span = document.createElement(\"span\");\n                span.appendChild(document.createTextNode(String.fromCharCode(i)));\n                div.appendChild(span);\n            }\n            document.body.appendChild(div);\n            var widths = {};\n            for (i = 32, span = div.firstChild; i < 128 && span; ++i, span = span.nextSibling) {\n                widths[i] = span.offsetWidth;\n            }\n            while ((span = div.firstChild)) {\n                div.removeChild(span);\n            }\n            func = CACHE_CHAR_WIDTH[id] = function(ch) {\n                var code = ch.charCodeAt(0);\n                var width = widths[code];\n                if (width == null) {\n                    // probably not an ASCII character, let's cache its width as well\n                    span = document.createElement(\"span\");\n                    span.appendChild(document.createTextNode(String.fromCharCode(code)));\n                    div.appendChild(span);\n                    width = widths[code] = span.offsetWidth;\n                    div.removeChild(span);\n                }\n                return width;\n            };\n        }\n        return func;\n    };\n\n    kendo.spreadsheet.drawTabularData = drawTabularData;\n","import \"../kendo.core.js\";\nimport \"../kendo.spreadsheet.common.js\";\nimport \"../kendo.popup.js\";\nimport \"../kendo.calendar.js\";\nimport \"../kendo.listview.js\";\n\n(function(kendo) {\n\n    \"use strict\";\n\n\n    let registerEditor = kendo.spreadsheet.registerEditor;\n    var $ = kendo.jQuery;\n\n    registerEditor(\"_validation_date\", function(){\n        var context, calendar, popup;\n\n        function create() {\n            if (!calendar) {\n                calendar = $(\"<div>\").kendoCalendar();\n                popup = $(\"<div>\").kendoPopup();\n                calendar.appendTo(popup);\n                calendar = calendar.getKendoCalendar();\n                popup = popup.getKendoPopup();\n\n                calendar.bind(\"change\", function(){\n                    popup.close();\n                    var date = calendar.value();\n                    if (!context.range.format()) {\n                        context.range.format(\"yyyy-mm-dd\");\n                    }\n                    context.callback(kendo.spreadsheet.dateToNumber(date));\n                });\n            }\n            popup.setOptions({\n                anchor: context.view.element.querySelector(\".k-spreadsheet-editor-button\"),\n                origin: context.alignLeft ? \"bottom right\" : \"bottom left\",\n                position: context.alignLeft ? \"top right\" : \"top left\"\n            });\n        }\n\n        function open() {\n            create();\n\n            var date = context.range.value();\n            var sheet = context.range.sheet();\n            if (date != null) {\n                calendar.value(kendo.spreadsheet.numberToDate(date));\n            } else {\n                calendar.value(null);\n            }\n            var val = context.validation;\n            if (val) {\n                var min = kendo.ui.Calendar.fn.options.min;\n                var max = kendo.ui.Calendar.fn.options.max;\n                var fromValidation = val.from;\n                var toValidation = val.to;\n                var formula = kendo.spreadsheet.calc.runtime.Formula;\n\n                if (/^(?:greaterThan|between)/.test(val.comparerType)) {\n                    if(fromValidation instanceof formula && _rowAndColPresent(fromValidation.value)) {\n                        min = kendo.spreadsheet.numberToDate(sheet.range(fromValidation.value.row, fromValidation.value.col).value());\n                    } else {\n                        min = kendo.spreadsheet.numberToDate(fromValidation.value);\n                    }\n                }\n                if (val.comparerType == \"between\") {\n                    if(toValidation instanceof formula && _rowAndColPresent(toValidation.value)) {\n                        max = kendo.spreadsheet.numberToDate(sheet.range(toValidation.value.row, toValidation.value.col).value());\n                    } else {\n                        max = kendo.spreadsheet.numberToDate(val.to.value);\n                    }\n                }\n                if (val.comparerType == \"lessThan\" || val.comparerType == \"lessThanOrEqualTo\") {\n                    if(fromValidation instanceof formula && _rowAndColPresent(fromValidation.value)) {\n                        max = kendo.spreadsheet.numberToDate(sheet.range(fromValidation.value.row, fromValidation.value.col).value());\n                    } else {\n                        max = kendo.spreadsheet.numberToDate(val.from.value);\n                    }\n                }\n                calendar.setOptions({\n                    disableDates: function(date) {\n                        var from, to;\n\n                        if(fromValidation && fromValidation instanceof formula && _rowAndColPresent(fromValidation.value)) {\n                            from = sheet.range(fromValidation.value.row, fromValidation.value.col).value();\n                        } else {\n                            from = fromValidation ? fromValidation.value|0 : 0;\n                        }\n\n                        if(toValidation && toValidation instanceof formula && _rowAndColPresent(toValidation.value)) {\n                            to = sheet.range(toValidation.value.row, toValidation.value.col).value();\n                        } else {\n                            to = toValidation ? toValidation.value|0 : 0;\n                        }\n\n                        date = kendo.spreadsheet.dateToNumber(date) | 0;\n                        return !kendo.spreadsheet.validation\n                            .validationComparers[val.comparerType](date, from, to);\n                    },\n                    min: min,\n                    max: max\n                });\n            } else {\n                calendar.setOptions({ disableDates: null, min: null, max: null });\n            }\n            popup.open();\n        }\n\n        function _rowAndColPresent(value) {\n            return (value && value.row !== null && value.col !== null && value.row > -1 && value.col > -1);\n        }\n\n        return {\n            edit: function(options) {\n                context = options;\n                open();\n            },\n            icon: \"calendar\"\n        };\n    });\n\n    registerEditor(\"_validation_list\", function(){\n        var context, list, popup;\n        function create() {\n            if (!list) {\n                list = $(\"<ul class='k-list k-reset'/>\").kendoStaticList({\n                    template   : \"#:value#\",\n                    selectable : true,\n                    autoBind   : false\n                });\n                popup = $(\"<div class='k-spreadsheet-list-popup'>\").kendoPopup();\n                list.appendTo(popup);\n                popup = popup.getKendoPopup();\n                list = list.getKendoStaticList();\n\n                list.bind(\"change\", function(){\n                    popup.close();\n                    var item = list.value()[0];\n                    if (item) {\n                        context.callback(item.value);\n                    }\n                });\n            }\n            popup.setOptions({\n                anchor: context.view.element.querySelector(\".k-spreadsheet-editor-button\"),\n                origin: context.alignLeft ? \"bottom right\" : \"bottom left\",\n                position: context.alignLeft ? \"top right\" : \"top left\"\n            });\n        }\n        function open() {\n            create();\n            var items = context.validation.from.value;\n            var data = [], add = function(el){ data.push({ value: el }); };\n            if (items instanceof kendo.spreadsheet.calc.runtime.Matrix) {\n                items.each(add);\n            } else {\n                // actually Excel expects a simple string for list\n                // validation (comma-separated labels).\n                (items+\"\").split(/\\s*,\\s*/).forEach(add);\n            }\n            var dataSource = new kendo.data.DataSource({ data: data });\n            list.setDataSource(dataSource);\n            dataSource.read();\n            popup.open();\n        }\n        return {\n            edit: function(options) {\n                context = options;\n                open();\n            },\n            icon: \"caret-alt-down\"\n        };\n    });\n\n})(window.kendo);\n","import \"../kendo.core.js\";\nimport \"../kendo.dom.js\";\nimport \"../kendo.sortable.js\";\nimport \"../kendo.icons.js\";\n\n    (function(kendo) {\n\n        var $ = kendo.jQuery;\n        var outerWidth = kendo._outerWidth;\n        var DOT = \".\";\n        var EMPTYCHAR = \" \";\n        var sheetsBarClassNames = {\n            sheetsBarWrapper: \"k-spreadsheet-sheets-bar\",\n            sheetsBarSheetsWrapper: \"k-tabstrip k-tabstrip-bottom\",\n            sheetsBarAdd: \"k-spreadsheet-sheet-add\",\n            sheetsBarSheetsMenu: \"k-spreadsheet-sheets-menu\",\n            sheetsBarRemove: \"k-spreadsheet-sheets-remove\",\n            sheetsBarItems: \"k-spreadsheet-sheets\",\n            sheetsBarEditor: \"k-spreadsheet-sheets-editor\",\n            sheetsBarScrollable: \"k-tabstrip-scrollable\",\n            sheetsBarNext: \"k-tabstrip-next\",\n            sheetsBarPrev: \"k-tabstrip-prev\",\n            sheetsBarKItem: \"k-item\",\n            sheetsBarKTabstripItem: \"k-tabstrip-item\",\n            sheetsBarKActive: \"k-active\",\n            sheetsBarKTextbox: \"k-textbox\",\n            sheetsBarKLink: \"k-link\",\n            sheetsBarKLinkText: \"k-link-text\",\n            sheetsBarKIcon: \"k-icon\",\n            sheetsBarKFontIcon: \"k-icon\",\n            sheetsBarKButton: \"k-button k-icon-button\",\n            sheetsBarKButtonDefaults: \"\",\n            sheetsBarKButtonBare: \"k-button-flat\",\n            sheetsBarArrowWIcon: \"caret-alt-left\",\n            sheetsBarArrowEIcon: \"caret-alt-right\",\n            sheetsBarKReset: \"k-reset k-tabstrip-items k-tabstrip-items-start\",\n            sheetsBarXIcon: \"x\",\n            sheetsBarMoreIcon: \"caret-alt-down\",\n            sheetsBarKSprite: \"k-sprite\",\n            sheetsBarPlusIcon: \"plus\",\n            sheetsBarMenuIcon: \"menu\",\n            sheetsBarHintWrapper: \"k-widget k-tabstrip k-tabstrip-bottom k-spreadsheet-sheets-items-hint\",\n            sheetsBarKResetItems: \"k-reset k-tabstrip-items k-tabstrip-items-start\"\n        };\n\n        var SheetsBar = kendo.ui.Widget.extend({\n            init: function(element, options) {\n                var classNames = SheetsBar.classNames;\n\n                kendo.ui.Widget.call(this, element, options);\n\n                element = this.element;\n\n                element.addClass(classNames.sheetsBarWrapper);\n\n                this._openDialog = options.openDialog;\n\n                this._addButton();\n                this._menuButton();\n                this._tree = new kendo.dom.Tree(element[0]);\n\n                this._tree.render([this._createSheetsWrapper([])]);\n                this._initSheetDropDownButtons();\n\n                this._toggleScrollEvents(true);\n\n                this._createSortable();\n\n                this._sortable.bind(\"start\", this._onSheetReorderStart.bind(this));\n\n                this._sortable.bind(\"end\", this._onSheetReorderEnd.bind(this));\n\n                element.on(\"click\", \"[ref-sheetsbar-more-button]\", this._onSheetContextMenu.bind(this));\n\n                element.on(\"click\", \"li\", this._onSheetSelect.bind(this));\n\n                element.on(\"dblclick\", \"li\" + DOT + classNames.sheetsBarKItem + DOT + classNames.sheetsBarKItem, this._createEditor.bind(this));\n            },\n\n            options: {\n                name: \"SheetsBar\",\n                scrollable: {\n                    distance: 200\n                }\n            },\n\n            events: [\n                \"select\",\n                \"reorder\",\n                \"rename\"\n            ],\n\n            _createEditor: function() {\n                if (this._editor) {\n                    return;\n                }\n\n                this._renderSheets(this._sheets, this._selectedIndex, true);\n                this._editor = this.element\n                    .find(kendo.format(\"input{0}{1}\", DOT, SheetsBar.classNames.sheetsBarEditor))\n                    .trigger(\"focus\")\n                    .on(\"keydown\", this._onEditorKeydown.bind(this))\n                    .on(\"blur\", this._onEditorBlur.bind(this));\n            },\n\n            _destroyEditor: function(canceled) {\n                var newSheetName = canceled ? null : this._editor.val();\n                this._editor.off();\n                this._editor = null;\n                this._renderSheets(this._sheets, this._selectedIndex, false);\n                this._onSheetRename(newSheetName);\n            },\n\n            renderSheets: function(sheets, selectedIndex) {\n                if (!sheets || selectedIndex < 0) {\n                    return;\n                }\n\n                this._renderSheets(sheets, selectedIndex, false);\n            },\n\n            _renderSheets: function(sheets, selectedIndex, isInEditMode) {\n                var that = this;\n                var classNames = SheetsBar.classNames;\n\n                that._isRtl = kendo.support.isRtl(that.element);\n                that._sheets = sheets;\n                that._selectedIndex = selectedIndex;\n\n                that._renderHtml(isInEditMode, true);\n\n                if (!that._scrollableAllowed()) {\n                    return;\n                }\n\n                var sheetsWrapper = that._sheetsWrapper();\n\n                sheetsWrapper.addClass(classNames.sheetsBarScrollable + EMPTYCHAR + classNames.sheetsBarSheetsWrapper);\n\n                that._toggleScrollButtons();\n            },\n\n            _toggleScrollButtons: function(toggle) {\n                var that = this;\n                var ul = that._sheetsGroup();\n                var wrapper = that._sheetsWrapper();\n                var scrollLeft = kendo.scrollLeft(ul);\n                var prev = wrapper.find(DOT + SheetsBar.classNames.sheetsBarPrev);\n                var next = wrapper.find(DOT + SheetsBar.classNames.sheetsBarNext);\n\n                if (toggle === false) {\n                    prev.addClass('k-disabled');\n                    next.addClass('k-disabled');\n                } else {\n                    prev.toggleClass('k-disabled', !(that._isRtl ? scrollLeft < ul[0].scrollWidth - ul[0].offsetWidth - 1 : scrollLeft !== 0));\n                    next.toggleClass('k-disabled', !(that._isRtl ? scrollLeft !== 0 : scrollLeft < ul[0].scrollWidth - ul[0].offsetWidth - 1));\n                }\n\n            },\n\n            _toggleScrollEvents: function(toggle) {\n                var that = this;\n                var classNames = SheetsBar.classNames;\n                var options = that.options;\n                var scrollPrevButton;\n                var scrollNextButton;\n                var sheetsWrapper = that._sheetsWrapper();\n                scrollPrevButton = sheetsWrapper.find(DOT + classNames.sheetsBarPrev);\n                scrollNextButton = sheetsWrapper.find(DOT + classNames.sheetsBarNext);\n\n                if (toggle) {\n                    scrollPrevButton.on(\"mousedown\", function(event) {\n                        event.preventDefault();\n                        event.stopPropagation();\n                        that._nowScrollingSheets = true;\n                        that._scrollSheetsByDelta(options.scrollable.distance * (that._isRtl ? 1 : -1));\n                    });\n\n                    scrollNextButton.on(\"mousedown\", function(event) {\n                        event.preventDefault();\n                        event.stopPropagation();\n                        that._nowScrollingSheets = true;\n                        that._scrollSheetsByDelta(options.scrollable.distance * (that._isRtl ? -1 : 1));\n                    });\n\n                    scrollPrevButton.add(scrollNextButton).on(\"mouseup\", function() {\n                        that._nowScrollingSheets = false;\n                    });\n                } else {\n                    scrollPrevButton.off();\n                    scrollNextButton.off();\n                }\n            },\n\n            _renderHtml: function(isInEditMode, renderScrollButtons) {\n                var idx;\n                var sheetElements = [];\n                var dom = kendo.dom;\n                var element = dom.element;\n                var sheets = this._sheets;\n                var selectedIndex = this._selectedIndex;\n                var classNames = SheetsBar.classNames;\n\n                for (idx = 0; idx < sheets.length; idx++) {\n                    var sheet = sheets[idx];\n\n                    var isSelectedSheet = (idx === selectedIndex);\n                    var attr = { className: classNames.sheetsBarKItem + EMPTYCHAR + classNames.sheetsBarKTabstripItem + EMPTYCHAR, role: \"tab\" };\n                    var elementContent = [];\n                    if (sheet.state() !== 'visible') {\n                        attr.className += \"k-hidden \";\n                    }\n\n                    if (isSelectedSheet) {\n                        attr.className += classNames.sheetsBarKActive;\n                    }\n\n                    if (isSelectedSheet && isInEditMode) {\n                        elementContent.push(element(\"input\", {\n                            type: \"text\",\n                            value: sheet.name(),\n                            className: classNames.sheetsBarKTextbox + EMPTYCHAR + classNames.sheetsBarEditor,\n                            maxlength: 50\n                        }, []));\n                    } else {\n                        elementContent.push(element(\"span\", {\n                            className: classNames.sheetsBarKLink,\n                            title: sheet.name()\n                        }, [element(\"span\", { className: classNames.sheetsBarKLinkText }, [dom.text(sheet.name())])]));\n\n                        let contextMenuButton = element($(kendo.html.renderButton($(`<button ref-sheetsbar-more-button data-sheet-name=\"${sheet.name()}\" class=\"k-menu-button\"></button>`), {\n                            icon: classNames.sheetsBarMoreIcon,\n                            fillMode: \"flat\"\n                        }))[0]);\n\n                        elementContent.push(element(\"span\", {\n                            className: \"k-item-actions\",\n                            'data-type': 'context-menu',\n                        }, [contextMenuButton]));\n                    }\n\n                    sheetElements.push(element(\"li\", attr, elementContent));\n                }\n\n                kendo.destroy(this._sheetsWrapper());\n                this._addButton();\n                this._menuButton();\n                this._tree.render([ this._createSheetsWrapper(sheetElements, renderScrollButtons)]);\n                this._initSheetDropDownButtons();\n            },\n            _initSheetDropDownButtons: function() {\n                let that = this;\n                this.element.find(\"[ref-sheetsbar-more-button]\").each(function(ind, btnEl){\n                    let el = $(btnEl);\n                    let allSheets = that._sheets || [];\n                    let visibleSheets = allSheets.filter(sheet => sheet.state() === 'visible');\n                    let isSingleVisibleSheet = !that._sheets || that._sheets && visibleSheets.length < 2;\n                    let sheetName = el.data(\"sheetName\");\n                    let shouldAllowMoveRight = !(isSingleVisibleSheet || (that._sheets && ind == allSheets.length - 1));\n                    let shouldAllowMoveLeft = !(isSingleVisibleSheet || (that._sheets && ind === 0));\n                    el.kendoDropDownButton({\n                        icon: SheetsBar.classNames.sheetsBarMoreIcon,\n                        fillMode: \"flat\",\n                        items: [\n                            { text: \"Delete\", icon: \"trash\", attributes: { \"data-command\": \"delete\", \"data-sheet-name\": sheetName }, enabled: !isSingleVisibleSheet },\n                            { text: \"Duplicate\", icon: \"copy\", attributes: { \"data-command\": \"duplicate\", \"data-sheet-name\": sheetName } },\n                            { text: \"Rename\", icon: \"pencil\", attributes: { \"data-command\": \"rename\", \"data-sheet-name\": sheetName } },\n                            { text: \"Hide\", icon: \"eye-slash\", attributes: { \"data-command\": \"hide\", \"data-sheet-name\": sheetName }, enabled: !isSingleVisibleSheet },\n                            { text: \"Move Right\", icon: \"arrow-right\", attributes: { \"data-command\": \"move-right\", \"data-sheet-name\": sheetName }, enabled: shouldAllowMoveRight },\n                            { text: \"Move Left\", icon: \"arrow-left\", attributes: { \"data-command\": \"move-left\", \"data-sheet-name\": sheetName }, enabled: shouldAllowMoveLeft },\n                        ],\n                        click: that._onSheetContextMenu.bind(that)\n                    });\n                })\n            },\n            _createSheetsWrapper: function(sheetElements, renderScrollButtons) {\n                var element = kendo.dom.element;\n                var classNames = SheetsBar.classNames;\n                var itemsWrapper = element('div', { className: 'k-tabstrip-items-wrapper k-hstack' });\n                var childrenElements = [element(\"ul\", {\n                    className: classNames.sheetsBarKReset,\n                    role: \"tablist\"\n                }, sheetElements), null, null];\n\n                renderScrollButtons = true;\n\n                if (renderScrollButtons) {\n                    var baseButtonClass = classNames.sheetsBarKButton + EMPTYCHAR + classNames.sheetsBarKButtonBare + EMPTYCHAR;\n\n                    childrenElements[1] = (element(\"span\", { ariaHidden: \"true\", tabIndex: -1, className: baseButtonClass + classNames.sheetsBarPrev }, [\n                        element($(kendo.ui.icon({ icon: classNames.sheetsBarArrowWIcon, iconClass: \"k-button-icon\" }))[0])\n                    ]));\n\n                    childrenElements[2] = (element(\"span\", { ariaHidden: \"true\", tabIndex: -1, className: baseButtonClass + classNames.sheetsBarNext }, [\n                        element($(kendo.ui.icon({ icon: classNames.sheetsBarArrowEIcon, iconClass: \"k-button-icon\" }))[0])\n                    ]));\n                }\n\n                itemsWrapper.children = childrenElements;\n\n                return element(\"div\", { className: classNames.sheetsBarItems }, [itemsWrapper]);\n            },\n\n            _createSortable: function() {\n                var classNames = SheetsBar.classNames;\n                this._sortable = new kendo.ui.Sortable(this.element, {\n                    filter: `ul li.${classNames.sheetsBarKItem}`,\n                    container: DOT + classNames.sheetsBarItems,\n                    axis: \"x\",\n                    animation: false,\n                    ignore: \"input\",\n                    end: function() {\n                        if (this.draggable.hint) {\n                            this.draggable.hint.remove();\n                        }\n                    },\n                    hint: function(element) {\n                        var hint = $(element).clone().attr(\"ref-sheetsbar-sortable-hint\", \"\");\n                        return hint.wrap(\"<div class='\" + classNames.sheetsBarHintWrapper + \"'><ul class='\" + classNames.sheetsBarKResetItems + \"'></ul></div>\").closest(\"div\");\n                    }\n                });\n            },\n\n            _onEditorKeydown: function(e) {\n                if (this._editor) {\n                    if (e.which === 13) {\n                        this._destroyEditor();\n                    }\n\n                    if (e.which === 27) {\n                        this._destroyEditor(true);\n                    }\n                }\n            },\n\n            _onEditorBlur: function() {\n                if (this._editor) {\n                    this._destroyEditor();\n                }\n            },\n\n            _onSheetReorderEnd: function(e) {\n                e.preventDefault();\n                this.trigger(\"reorder\", { oldIndex: e.oldIndex, newIndex: e.newIndex });\n            },\n\n            _onSheetReorderStart: function(e) {\n                if (this._editor) {\n                    e.preventDefault();\n                }\n            },\n            _onSheetContextMenu: function(e) {\n                let sheetName = $(e.target).closest(\"li\").data(\"sheetName\");\n                let command = $(e.target).closest(\"li\").data(\"command\");\n\n                if (this._editor) {\n                    this._destroyEditor();\n                }\n\n                if (sheetName && command) {\n                    switch(command) {\n                        case \"delete\":\n                            this._onSheetRemove(e);\n                            break;\n                        case \"duplicate\":\n                            this._onSheetDuplicate(sheetName);\n                            break;\n                        case \"rename\":\n                            this._renamePrompt(sheetName);\n                            break;\n                        case \"hide\":\n                            this._hideSheet(sheetName);\n                            break;\n                        case \"move-right\":\n                            this._moveSheet(sheetName, 1);\n                            break;\n                        case \"move-left\":\n                            this._moveSheet(sheetName, -1);\n                            break;\n                    }\n                }\n            },\n            _onSheetDuplicate: function(sheetName) {\n                this.trigger(\"duplicate\", { name: sheetName });\n            },\n            _renamePrompt: function(sheetName) {\n                let renameSheetIndex = this._sheets.findIndex(sh => sh.name() == sheetName);\n                let closeCallback = function(e) {\n                    let dlg = e.sender;\n                    if (dlg._newSheetName && dlg._newSheetName !== sheetName) {\n                        this.trigger(\"rename\", { name: dlg._newSheetName, sheetIndex: renameSheetIndex });\n                    }\n                }.bind(this);\n\n                this._openDialog(\"renameSheet\", {\n                    close: closeCallback,\n                    _oldSheetName: sheetName\n                });\n            },\n            _hideSheet: function(sheetName) {\n                this.trigger(\"hide\", { name: sheetName });\n            },\n            _moveSheet: function(sheetName, direction) {\n                let sheetIndex = this._sheets.findIndex(sheet => sheet.name() === sheetName);\n                let newSheetIndex = sheetIndex + direction;\n                if (newSheetIndex < 0 || newSheetIndex >= this._sheets.length) {\n                    return;\n                }\n\n                this.trigger(\"reorder\", { oldIndex: sheetIndex, newIndex: newSheetIndex });\n            },\n            _onSheetRemove: function(e) {\n                var removedSheetName = $(e.target).closest(\"li\").data(\"sheetName\");\n\n                if (this._editor) {\n                    this._destroyEditor();\n                }\n\n                var closeCallback = function(e) {\n                    var dlg = e.sender;\n\n                    if (dlg.isConfirmed()) {\n                        this.trigger(\"remove\", { name: removedSheetName, confirmation: true });\n                    }\n                }.bind(this);\n\n                this._openDialog(\"confirmation\", {\n                    close: closeCallback\n                });\n            },\n\n            _onSheetSelect: function(e) {\n                var selectedSheetText = $(e.target).text();\n\n                if ($(e.target).is(DOT + SheetsBar.classNames.sheetsBarEditor) || !selectedSheetText) {\n                    e.preventDefault();\n                    return;\n                }\n\n                if (this._editor) {\n                    this._destroyEditor();\n                }\n\n                this._scrollSheetsToItem($(e.target).closest(\"li\"));\n                this.trigger(\"select\", { name: selectedSheetText, isAddButton: false });\n            },\n\n            _onSheetRename: function(newSheetName) {\n                if (this._sheets[this._selectedIndex].name() === newSheetName || newSheetName === null) {\n                    return;\n                }\n\n                this.trigger(\"rename\", { name: newSheetName, sheetIndex: this._selectedIndex });\n            },\n\n            _onAddSelect: function(ev) {\n                ev.sender.element.removeClass(\"k-focus\");\n                this.trigger(\"select\", { isAddButton: true });\n            },\n\n            _onMenuSelect: function(ev) {\n                let sheetName = $(ev.target).closest(\"li\").data(\"sheetName\");\n                if (sheetName) {\n                    this.trigger(\"show\", { name: sheetName });\n                }\n            },\n\n            _addButton: function() {\n                var classNames = SheetsBar.classNames;\n                let addButton = this.element.find(\".\" + classNames.sheetsBarAdd);\n                if (!addButton.length) {\n                    addButton = $(`<button class=\"${classNames.sheetsBarAdd}\" aria-label=\"Add new sheet\"></button>`).appendTo(this.element);\n                } else {\n                    kendo.destroy(addButton);\n                }\n\n                addButton.kendoButton({\n                    icon: classNames.sheetsBarPlusIcon,\n                    fillMode: \"flat\",\n                    click: this._onAddSelect.bind(this)\n                });\n            },\n            _menuButton: function() {\n                var classNames = SheetsBar.classNames;\n                let menuButton = this.element.find(\".\" + classNames.sheetsBarSheetsMenu);\n                if (!menuButton.length) {\n                    menuButton = $(`<button class=\"${classNames.sheetsBarSheetsMenu}\"></button>`).appendTo(this.element);\n                } else {\n                    kendo.destroy(menuButton);\n                }\n\n                menuButton.kendoDropDownButton({\n                    icon: classNames.sheetsBarMenuIcon,\n                    fillMode: \"flat\",\n                    items: (this._sheets || []).map(sheet => ({\n                        text: sheet.name(),\n                        attributes: { 'data-sheet-name': sheet.name() },\n                        icon: sheet.state() === 'visible' ? 'eye' : 'eye-slash',\n                        cssClass: classNames\n                    })),\n                    click: this._onMenuSelect.bind(this)\n                });\n            },\n\n            destroy: function() {\n                this._sortable.destroy();\n            },\n\n            _scrollableAllowed: function() {\n                var options = this.options;\n                return options.scrollable && !isNaN(options.scrollable.distance);\n            },\n\n            _scrollSheetsToItem: function(item) {\n                var that = this;\n                var sheetsGroup = that._sheetsGroup();\n                var currentScrollOffset = kendo.scrollLeft(sheetsGroup);\n                var itemWidth = outerWidth(item);\n                var itemOffset = that._isRtl ? item.position().left : item.position().left - sheetsGroup.children().first().position().left;\n                var sheetsGroupWidth = sheetsGroup[0].offsetWidth;\n                var itemPosition;\n\n                if (that._isRtl) {\n                    if (itemOffset < 0) {\n                        itemPosition = currentScrollOffset + itemOffset - (sheetsGroupWidth - currentScrollOffset);\n                    } else if (itemOffset + itemWidth > sheetsGroupWidth) {\n                        itemPosition = currentScrollOffset + itemOffset - itemWidth;\n                    }\n                } else {\n                    if (currentScrollOffset + sheetsGroupWidth < itemOffset + itemWidth) {\n                        itemPosition = itemOffset + itemWidth - sheetsGroupWidth;\n                    } else if (currentScrollOffset > itemOffset) {\n                        itemPosition = itemOffset;\n                    }\n                }\n\n                sheetsGroup.finish().animate({ \"scrollLeft\": itemPosition }, \"fast\", \"linear\", function() {\n                    that._toggleScrollButtons();\n                });\n            },\n\n            _sheetsGroup: function() {\n                return this._sheetsWrapper().find(\"ul\");\n            },\n\n            _sheetsWrapper: function() {\n                return this.element.find(DOT + SheetsBar.classNames.sheetsBarItems);\n            },\n\n            _scrollSheetsByDelta: function(delta) {\n                var that = this;\n                var sheetsGroup = that._sheetsGroup();\n                var scrLeft = kendo.scrollLeft(sheetsGroup);\n\n                sheetsGroup.finish().animate({ \"scrollLeft\": scrLeft + delta }, \"fast\", \"linear\", function() {\n                    if (that._nowScrollingSheets) {\n                        that._scrollSheetsByDelta(delta);\n                    } else {\n                        that._toggleScrollButtons();\n                    }\n                });\n            }\n        });\n\n        kendo.spreadsheet.SheetsBar = SheetsBar;\n        $.extend(true, SheetsBar, { classNames: sheetsBarClassNames });\n    })(window.kendo);\n","import \"../kendo.core.js\";\nimport \"../kendo.popup.js\";\nimport \"../kendo.treeview.js\";\nimport \"../kendo.numerictextbox.js\";\nimport \"../kendo.datepicker.js\";\nimport \"../kendo.datetimepicker.js\";\nimport \"../kendo.icons.js\";\n\n    (function(kendo) {\n\n        var $ = kendo.jQuery;\n        var Widget = kendo.ui.Widget;\n        var classNames = {\n            details: \"k-details\",\n            button: \"k-button\",\n            detailsSummary: \"k-details-summary\",\n            detailsContent: \"k-details-content\",\n            icon: \"k-icon\",\n            iconCollapseName: \"caret-br\",\n            iconExpandName: \"caret-alt-right\",\n            iconSearchName: \"search\",\n            textbox: \"k-textbox\",\n            wrapper: \"k-spreadsheet-filter-menu\",\n            filterByCondition: \"k-spreadsheet-condition-filter\",\n            filterByValue: \"k-spreadsheet-value-filter\",\n            valuesTreeViewWrapper: \"k-spreadsheet-value-treeview-wrapper\",\n            actionButtons: \"k-actions\"\n        };\n\n        kendo.spreadsheet.messages.filterMenu = {\n            all: \"All\",\n            sortAscending: \"Sort range A to Z\",\n            sortDescending: \"Sort range Z to A\",\n            filterByValue: \"Filter by value\",\n            filterByCondition: \"Filter by condition\",\n            apply: \"Apply\",\n            search: \"Search\",\n            addToCurrent: \"Add to current selection\",\n            clear: \"Clear\",\n            blanks: \"(Blanks)\",\n            operatorNone: \"None\",\n            and: \"AND\",\n            or: \"OR\",\n            operators: {\n                string: {\n                    contains: \"Text contains\",\n                    doesnotcontain: \"Text does not contain\",\n                    startswith: \"Text starts with\",\n                    endswith: \"Text ends with\",\n                    matches: \"Text matches\",\n                    doesnotmatch: \"Text does not match\"\n                },\n                date: {\n                    eq:  \"Date is\",\n                    neq: \"Date is not\",\n                    lt:  \"Date is before\",\n                    gt:  \"Date is after\"\n                },\n                number: {\n                    eq: \"Is equal to\",\n                    neq: \"Is not equal to\",\n                    gte: \"Is greater than or equal to\",\n                    gt: \"Is greater than\",\n                    lte: \"Is less than or equal to\",\n                    lt: \"Is less than\"\n                }\n            }\n        };\n\n        var Details = Widget.extend({\n            init: function(element, options) {\n                Widget.fn.init.call(this, element, options);\n\n                this.element.addClass(FilterMenu.classNames.details);\n\n                this._summary = this.element.find(\".\" + FilterMenu.classNames.detailsSummary)\n                    .on(\"click\", this._toggle.bind(this));\n\n                var iconName = options.expanded ? FilterMenu.classNames.iconCollapseName : FilterMenu.classNames.iconExpandName;\n                this._icon = $(kendo.ui.icon(iconName))\n                    .prependTo(this._summary);\n\n                this._container = kendo.wrap(this._summary.next(), true);\n\n                if (!options.expanded) {\n                    this._container.hide();\n                }\n            },\n            options: {\n                name: \"Details\"\n            },\n            events: [ \"toggle\" ],\n            visible: function() {\n                return this.options.expanded;\n            },\n            toggle: function(show) {\n                var animation = kendo.fx(this._container).expand(\"vertical\");\n\n                animation.stop()[show ? \"reverse\" : \"play\"]();\n                kendo.ui.icon(this._icon, { icon: show ? FilterMenu.classNames.iconExpandName : FilterMenu.classNames.iconCollapseName });\n\n                this.options.expanded = !show;\n            },\n            _toggle: function() {\n                var show = this.visible();\n                this.toggle(show);\n                this.trigger(\"toggle\", { show: show });\n            }\n        });\n\n        kendo.data.binders.spreadsheetFilterValue = kendo.data.Binder.extend({\n            init: function(element, bindings, options) {\n                kendo.data.Binder.fn.init.call(this, element, bindings, options);\n\n                this._change = this.change.bind(this);\n                $(this.element).on(\"change\", this._change);\n            },\n            refresh: function() {\n                var that = this,\n                    value = that.bindings.spreadsheetFilterValue.get(); //get the value from the View-Model\n\n                $(that.element).val(value instanceof Date ? \"\" : value);\n            },\n            change: function() {\n                var value = this.element.value;\n                this.bindings.spreadsheetFilterValue.set(value); //update the View-Model\n            }\n        });\n\n        kendo.data.binders.widget.spreadsheetFilterValue = kendo.data.Binder.extend({\n            init: function(widget, bindings, options) {\n                kendo.data.Binder.fn.init.call(this, widget.element[0], bindings, options);\n\n                this.widget = widget;\n                this._change = this.change.bind(this);\n                this.widget.first(\"change\", this._change);\n            },\n            refresh: function() {\n                var binding = this.bindings.spreadsheetFilterValue,\n                    value = binding.get(),\n                    type = $(this.widget.element).data(\"filterType\");\n\n                if ((type === \"date\" && value instanceof Date) || (type === \"number\" && !isNaN(value))) {\n                    this.widget.value(value);\n                } else {\n                    this.widget.value(null);\n                }\n            },\n            change: function() {\n                var value = this.widget.value(),\n                    binding = this.bindings.spreadsheetFilterValue;\n\n                binding.set(value);\n            }\n        });\n\n        var templates = {\n            filterByValue: (data) =>\n                `<div class='${classNames.detailsSummary}'>${data.messages.filterByValue}</div>` +\n                `<div class='${classNames.detailsContent}'>` +\n                    \"<div class='k-searchbox k-input'>\" +\n                        kendo.ui.icon({ icon: \"search\", iconClass: \"k-input-icon\" }) +\n                        `<input class='k-input-inner' autocomplete='off' placeholder='${data.messages.search}' data-${data.ns}bind='events: { input: filterValues }' />` +\n                    \"</div>\" +\n                    `<div data-${data.ns}bind='visible: hasActiveSearch'><input class='k-checkbox' type='checkbox' data-${data.ns}bind='checked: appendToSearch' id='_${data.guid}'/><label class='k-checkbox-label' for='_${data.guid}'>${data.messages.addToCurrent}</label></div>` +\n                    `<div class='${classNames.valuesTreeViewWrapper}'>` +\n                        `<div data-${data.ns}role='treeview' ` +\n                            `bind:data-${data.ns}checkboxes='checkboxesConfig' `+\n                            `data-${data.ns}bind='source: valuesDataSource, events: { check: valuesChange, select: valueSelect }' `+\n                            \"></div>\" +\n                    \"</div>\" +\n                \"</div>\",\n            filterByCondition: (data) =>\n                `<div class='${classNames.detailsSummary}'>${data.messages.filterByCondition}</div>` +\n                `<div class='${classNames.detailsContent}'>` +\n                    '<div>' +\n                        '<select ' +\n                            `aria-label=\"${data.messages.filterByCondition}\" ` +\n                            `data-${data.ns}role=\"dropdownlist\"` +\n                            `data-${data.ns}bind=\"value: operator, source: operators, events: { change: operatorChange } \"` +\n                            `data-${data.ns}value-primitive=\"false\"` +\n                            `data-${data.ns}option-label=\"${data.messages.operatorNone}\"` +\n                            `data-${data.ns}height=\"auto\"` +\n                            `data-${data.ns}text-field=\"text\"` +\n                            `data-${data.ns}value-field=\"unique\">`+\n                        '</select>'+\n                    '</div>' +\n\n                    `<div data-${data.ns}bind=\"visible: isString\">` +\n                        `<input aria-label=\"string-value\" data-filter-type=\"string\" data-${data.ns}bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" class=\"k-textbox\" />`+\n                    '</div>' +\n\n                    `<div data-${data.ns}bind=\"visible: isNumber\">` +\n                        `<input aria-label=\"number-value\" data-filter-type=\"number\" data-${data.ns}role=\"numerictextbox\" data-${data.ns}bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" />`+\n                    '</div>' +\n\n                    `<div data-${data.ns}bind=\"visible: isDate\">` +\n                        `<input aria-label=\"date-value\" data-filter-type=\"date\" data-${data.ns}role=\"datepicker\" data-${data.ns}bind=\"spreadsheetFilterValue: customFilter.criteria[0].value\" />`+\n                    '</div>' +\n                \"</div>\",\n            menuItem: (data) =>\n                `<li data-command='${data.command}' data-dir='${data.dir}'>` +\n                    `${kendo.ui.icon(data.iconClass)}${data.text}` +\n                \"</li>\",\n            actionButtons: (data) =>\n                `<button data-${data.ns}bind='click: apply' class='k-button k-button-primary'><span class='k-button-text'>${data.messages.apply}</span></button>` +\n                `<button data-${data.ns}bind='click: clear' class='k-button'><span class='k-button-text'>${data.messages.clear}</span></button>`\n        };\n\n        function distinctValues(values) {\n            var hash = {};\n            var result = [];\n\n            for (var i = 0; i < values.length; i++) {\n                if (!hash[values[i].value]) {\n                    hash[values[i].value] = values[i];\n                    result.push(values[i]);\n                } else if (!hash[values[i].value].checked && values[i].checked) {\n                    hash[values[i].value].checked = true;\n                }\n            }\n\n            return result;\n        }\n\n        function filter(dataSource, query) {\n            var hasVisibleChildren = false;\n            var data = dataSource instanceof kendo.data.HierarchicalDataSource && dataSource.data();\n            var valuesFilter = this;\n            var values = this.values;\n            for (var i = 0; i < data.length; i++) {\n                var item = data[i];\n                var text = item.text.toString().toLocaleLowerCase(kendo.culture().name);\n                var itemVisible = query === true || query === \"\" || text.indexOf(query) >= 0;\n                var filterSpread = filter.bind(valuesFilter);\n                var anyVisibleChildren = filterSpread(item.children, query); // pass true if parent matches\n\n                hasVisibleChildren = hasVisibleChildren || anyVisibleChildren || itemVisible;\n                item.hidden = !itemVisible && !anyVisibleChildren;\n\n                if (query.length || (values && !values.length)) {\n                    item.checked = !item.hidden;\n                } else if (values && values.indexOf(item.text) != -1){\n                    item.checked = true;\n                }\n            }\n\n            if (data) {\n                // re-apply filter on children\n                dataSource.filter({ field: \"hidden\", operator: \"neq\", value: true });\n            }\n\n            return hasVisibleChildren;\n        }\n\n        function uncheckAll(dataSource) {\n            var data = dataSource instanceof kendo.data.HierarchicalDataSource && dataSource.data();\n\n            for (var i = 0; i < data.length; i++) {\n                var item = data[i];\n                item.checked = false;\n\n                if (item.hasChildren) {\n                    uncheckAll(item.children);\n                }\n            }\n        }\n\n        var FilterMenuViewModel = kendo.spreadsheet.FilterMenuViewModel = kendo.data.ObservableObject.extend({\n            valuesChange: function(e) {\n                var dataSource = e ? e.sender.dataSource : this.valuesDataSource;\n                var checked = function(item) {\n                    return item.checked;\n                };\n                var value = function(item) {\n                    return item.dataType === \"date\" ? kendo.spreadsheet.dateToNumber(item.value) : item.value;\n                };\n                var unique = function(value, index, array) {\n                    return array.lastIndexOf(value) === index;\n                };\n                var data = dataSource.data();\n                var values = data.toJSON()[0].items;\n                var blanks = values.filter(function(item) {\n                    return item.dataType === \"blank\";\n                });\n\n                blanks = blanks.length ? blanks[0].checked : false;\n                values = values.filter(checked).map(value);\n\n                if (this.appendToSearch && this.valueFilter && this.valueFilter.values.length) {\n                    values = values.concat(this.valueFilter.values.toJSON()).sort().filter(unique);\n                }\n\n                this.set(\"valueFilter\", {\n                    values: values,\n                    blanks: blanks\n                });\n            },\n            valueSelect: function(e) {\n                e.preventDefault();\n\n                var node = e.sender.dataItem(e.node);\n                node.set(\"checked\", !node.checked);\n            },\n            hasActiveSearch: false,\n            appendToSearch: false,\n            filterValues: function(e) {\n                var query = typeof e == \"string\" ? e : $(e.target).val().toLocaleLowerCase(kendo.culture().name);\n                var dataSource = this.valuesDataSource;\n\n                this.set(\"hasActiveSearch\", !!query);\n\n                var filterSpread = filter.bind(this.valueFilter);\n                uncheckAll(dataSource);\n                filterSpread(dataSource, query);\n            },\n            reset: function() {\n                this.set(\"customFilter\", { logic: \"and\", criteria: [ { operator: null, value: null } ] });\n                this.set(\"valueFilter\", { values: [] });\n            },\n            operatorChange: function(e) {\n                var dataItem = e.sender.dataItem();\n                this.set(\"operatorType\", dataItem.type);\n\n                // https://github.com/telerik/kendo-ui-core/issues/3317 - when switching from Value\n                // filter to “filter by condition”, the customFilter property is lost.\n                if (!this.get(\"customFilter\")) {\n                    this.reset();\n                }\n\n                this.set(\"customFilter.criteria[0].operator\", dataItem.value);\n            },\n            isNone: function() {\n                return this.get(\"operatorType\") === undefined;\n            },\n            isString: function() {\n                return this.get(\"operatorType\") === \"string\";\n            },\n            isNumber: function() {\n                return this.get(\"operatorType\") === \"number\";\n            },\n            isDate: function() {\n                return this.get(\"operatorType\") === \"date\";\n            }\n        });\n\n        function flattenOperators(operators) {\n            var messages = kendo.spreadsheet.messages.filterMenu.operators;\n            var result = [];\n            for (var type in operators) {\n                if (!operators.hasOwnProperty(type)) {\n                    continue;\n                }\n\n                for (var operator in operators[type]) {\n                    if (!operators[type].hasOwnProperty(operator)) {\n                        continue;\n                    }\n\n                    result.push({\n                        text: messages[type][operator],\n                        value: operator,\n                        unique: type + \"_\" + operator,\n                        type: type\n                    });\n                }\n            }\n            return result;\n        }\n\n        var FilterMenuController = kendo.spreadsheet.FilterMenuController = {\n            valuesTree: function(range, column) {\n                return [{\n                    text: kendo.spreadsheet.messages.filterMenu.all,\n                    expanded: true,\n                    checked: false,\n                    items: this.values(range.resize({ top: 1 }), column)\n                }];\n            },\n            values: function(range, column) {\n                var values = [];\n                var messages = kendo.spreadsheet.messages.filterMenu;\n                var columnRange = range.column(column);\n                var sheet = range.sheet();\n\n                columnRange.forEachCell(function(row, col, cell) {\n                    var checked = true;\n                    if (sheet.isHiddenRow(row)) {\n                        checked = false;\n                    }\n\n                    var value = cell.value;\n                    var dataType = cell.dataType;\n                    var text = cell.text;\n\n                    if (value === undefined) {\n                        dataType = \"blank\";\n                    } else if (cell.format) {\n                        dataType = kendo.spreadsheet.formatting.type(value, cell.format);\n                    } else {\n                        dataType = typeof value;\n                    }\n\n                    if (value !== null && cell.format) {\n                        text = kendo.spreadsheet.formatting.text(value, cell.format);\n                    } else {\n                        text = dataType == \"blank\" ? messages.blanks : value;\n                    }\n\n                    if (dataType === \"percent\" || dataType === \"currency\") { //treat percent as number\n                        dataType = \"number\";\n                    }\n\n                    if (dataType === \"date\") {\n                        value = kendo.spreadsheet.numberToDate(value);\n                    }\n\n                    values.push({\n                        dataType: dataType,\n                        value: value,\n                        text: text,\n                        checked: checked\n                    });\n                });\n\n                values = distinctValues(values);\n\n                values.sort(function(a, b) {\n                    if (a.dataType === b.dataType) {\n                        return 0;\n                    }\n\n                    if (a.dataType === \"blank\" || b.dataType === \"blank\") {\n                        return a.dataType === \"blank\" ? -1 : 1;\n                    }\n\n                    if (a.dataType === \"number\" || b.dataType === \"number\") {\n                        return a.dataType === \"number\" ? -1 : 1;\n                    }\n\n                    if (a.dataType === \"date\" || b.dataType === \"date\") {\n                        return a.dataType === \"date\" ? -1 : 1;\n                    }\n\n                    return 0;\n                });\n\n                return values;\n            },\n\n            filterType: function(range, column) {\n                // 1. try to infer type from current filter\n                var sheet = range.sheet();\n                var filter = this.filterForColumn(column, sheet);\n                var type;\n\n                filter = filter && filter.filter.toJSON();\n\n                if (filter && filter.filter == \"custom\") {\n                    var value = filter.criteria[0].value;\n\n                    if (value instanceof Date) {\n                        type = \"date\";\n                    } else if (typeof value == \"string\") {\n                        type = \"string\";\n                    } else if (typeof value == \"number\") {\n                        type = \"number\";\n                    }\n                }\n\n                if (!type) {\n                    // 2. try to infer type from column data\n                    var topValue = this.values(range.row(1), column)[0];\n                    type = topValue && topValue.dataType;\n\n                    if (type == \"blank\") {\n                        type = null;\n                    }\n                }\n\n                return type;\n            },\n\n            filterForColumn: function(column, sheet) {\n                var allFilters = sheet.filter();\n                var filters;\n\n                if (allFilters) {\n                    filters =  allFilters.columns.filter(function(item) {\n                        return item.index === column;\n                    })[0];\n                }\n\n                return filters;\n            },\n\n            filter: function(column, sheet) {\n                var columnFilters = this.filterForColumn(column, sheet);\n\n                if (!columnFilters) {\n                    return;\n                }\n\n                var options = columnFilters.filter.toJSON();\n                var type = options.filter;\n\n                delete options.filter;\n\n                var result = {\n                    type: type,\n                    options: options\n                };\n\n                var criteria = options.criteria;\n                if (criteria && criteria.length) {\n                    result.operator = criteria[0].operator;\n                }\n\n                return result;\n            }\n        };\n\n        var FilterMenu = Widget.extend({\n            init: function(element, options) {\n                Widget.call(this, element, options);\n\n                this.element.addClass(FilterMenu.classNames.wrapper);\n\n                this.viewModel = new FilterMenuViewModel({\n                    active: \"value\",\n                    checkboxesConfig: { checkChildren: true },\n                    operator: null,\n                    operators: flattenOperators(this.options.operators),\n                    clear: this.clear.bind(this),\n                    apply: this.apply.bind(this)\n                });\n\n                this._filterInit();\n                this._popup();\n                this._sort();\n                this._filterByCondition();\n                this._filterByValue();\n                this._actionButtons();\n            },\n\n            options: {\n                name: \"FilterMenu\",\n                column: 0,\n                range: null,\n                operators: {\n                    string: {\n                        contains: \"Text contains\",\n                        doesnotcontain: \"Text does not contain\",\n                        startswith: \"Text starts with\",\n                        endswith: \"Text ends with\",\n                        matches: \"Text matches\",\n                        doesnotmatch: \"Text does not match\"\n                    },\n                    date: {\n                        eq:  \"Date is\",\n                        neq: \"Date is not\",\n                        lt:  \"Date is before\",\n                        gt:  \"Date is after\"\n                    },\n                    number: {\n                        eq: \"Is equal to\",\n                        neq: \"Is not equal to\",\n                        gte: \"Is greater than or equal to\",\n                        gt: \"Is greater than\",\n                        lte: \"Is less than or equal to\",\n                        lt: \"Is less than\"\n                    }\n                }\n            },\n\n            events: [\n                \"action\"\n            ],\n\n            destroy: function() {\n                Widget.fn.destroy.call(this);\n\n                this.menu.destroy();\n                this.valuesTreeView.destroy();\n                this.popup.destroy();\n            },\n\n            openFor: function(anchor, event) {\n                if ($(anchor).hasClass(\"k-spreadsheet-view-size\")) {\n                    // on touch devices this element will sit above to\n                    // enable scrolling; it's not useful as an anchor,\n                    // use event coords instead.\n                    this.popup.open(event.pageX, event.pageY);\n                } else {\n                    this.popup.setOptions({ anchor: anchor });\n                    this.popup.open();\n                }\n            },\n\n            close: function() {\n                this.popup.close();\n            },\n\n            clear: function() {\n                this.action({\n                    command: \"ClearFilterCommand\",\n                    options: {\n                        column: this.options.column\n                    }\n                });\n                this.viewModel.reset();\n                this.close();\n            },\n\n            apply: function() {\n                this._active();\n\n                var options = {\n                    operatingRange: this.options.range,\n                    column: this.options.column\n                };\n\n                var valueFilter;\n                var customFilter;\n\n                if (this.viewModel.active === \"value\") {\n                    this.viewModel.valuesChange({ sender: this.valuesTreeView });\n                    valueFilter = this.viewModel.valueFilter.toJSON();\n\n                    if (valueFilter.blanks || (valueFilter.values && valueFilter.values.length)) {\n                        options.valueFilter = valueFilter;\n                    }\n                } else if (this.viewModel.active === \"custom\") {\n                    customFilter = this.viewModel.customFilter.toJSON();\n\n                    if (customFilter.criteria.length && customFilter.criteria[0].value !== null) {\n                        options.customFilter = customFilter;\n                    }\n                }\n\n                if (options.valueFilter || options.customFilter) {\n                    this.action({ command: \"ApplyFilterCommand\", options: options });\n                }\n            },\n\n            action: function(options) {\n                this.trigger(\"action\", $.extend({ }, options));\n            },\n\n            _filterInit: function() {\n                var column = this.options.column;\n                var range = this.options.range;\n                var sheet = range.sheet();\n                var activeFilter = FilterMenuController.filter(column, sheet);\n\n                if (activeFilter) {\n                    var filterType = FilterMenuController.filterType(range, column);\n\n                    this.viewModel.set(\"active\", activeFilter.type);\n                    this.viewModel.set(activeFilter.type + \"Filter\", activeFilter.options);\n\n                    if (activeFilter.type == \"custom\") {\n                        this.viewModel.set(\"operator\", filterType + \"_\" + activeFilter.operator);\n                        this.viewModel.set(\"operatorType\", filterType);\n                    }\n                } else {\n                    this.viewModel.reset();\n                }\n            },\n\n            _popup: function() {\n                this.popup = this.element.kendoPopup({\n                    copyAnchorStyles: false\n                }).data(\"kendoPopup\");\n            },\n\n            _sort: function() {\n                var template = kendo.template(FilterMenu.templates.menuItem);\n                var messages = kendo.spreadsheet.messages.filterMenu;\n                var items = [\n                    { command: \"sort\", dir: \"asc\", text: messages.sortAscending, iconClass: \"sort-asc\" },\n                    { command: \"sort\", dir: \"desc\", text: messages.sortDescending, iconClass: \"sort-desc\" }\n                ];\n\n                var ul = $(\"<ul></ul>\", {\n                    \"html\": kendo.render(template, items)\n                }).appendTo(this.element);\n\n                this.menu = ul.kendoMenu({\n                    orientation: \"vertical\",\n                    select: function(e) {\n                        var dir = $(e.item).data(\"dir\");\n                        var range = this.options.range.resize({ top: 1 });\n                        var options = {\n                            value: dir,\n                            sheet: false,\n                            operatingRange: range,\n                            column: this.options.column\n                        };\n\n                        this.action({ command: \"SortCommand\", options: options });\n                    }.bind(this)\n                }).data(\"kendoMenu\");\n            },\n\n            _appendTemplate: function(template, className, details, expanded) {\n                var compiledTemplate = kendo.template(template);\n                var wrapper = $(\"<div class='\" + className + \"'/>\").html(compiledTemplate({\n                    messages: kendo.spreadsheet.messages.filterMenu,\n                    guid: kendo.guid(),\n                    ns: kendo.ns\n                }));\n\n                this.element.append(wrapper);\n\n                if (details) {\n                    details = new Details(wrapper, { expanded: expanded, toggle: this._detailToggle.bind(this) });\n                }\n\n                kendo.bind(wrapper, this.viewModel);\n\n                return wrapper;\n            },\n\n            _detailToggle: function(e) {\n                this.element\n                    .find(\"[\" + kendo.attr(\"role\") + \"=details]\")\n                    .not(e.sender.element)\n                    .data(\"kendoDetails\")\n                    .toggle(!e.show);\n            },\n\n            _filterByCondition: function() {\n                var isExpanded = this.viewModel.active === \"custom\";\n                this._appendTemplate(FilterMenu.templates.filterByCondition, FilterMenu.classNames.filterByCondition, true, isExpanded);\n            },\n\n            _filterByValue: function() {\n                var isExpanded = this.viewModel.active === \"value\";\n                var wrapper = this._appendTemplate(FilterMenu.templates.filterByValue, FilterMenu.classNames.filterByValue, true, isExpanded);\n\n                this.valuesTreeView = wrapper.find(\"[\" + kendo.attr(\"role\") + \"=treeview]\").data(\"kendoTreeView\");\n\n                var values = FilterMenuController.valuesTree(this.options.range, this.options.column);\n\n                this.viewModel.set(\"valuesDataSource\", new kendo.data.HierarchicalDataSource({ data: values, accentFoldingFiltering: kendo.culture().name }));\n            },\n\n            _actionButtons: function() {\n                this._appendTemplate(FilterMenu.templates.actionButtons, FilterMenu.classNames.actionButtons, false);\n            },\n\n            _active: function() {\n                var activeContainer = this.element.find(\"[\" + kendo.attr(\"role\") + \"=details]\").filter(function(index, element) {\n                    return $(element).data(\"kendoDetails\").visible();\n                });\n\n                if (activeContainer.hasClass(FilterMenu.classNames.filterByValue)) {\n                    this.viewModel.set(\"active\", \"value\");\n                } else if (activeContainer.hasClass(FilterMenu.classNames.filterByCondition)) {\n                    this.viewModel.set(\"active\", \"custom\");\n                }\n            }\n        });\n\n        kendo.spreadsheet.FilterMenu = FilterMenu;\n        $.extend(true, FilterMenu, { classNames: classNames, templates: templates });\n\n    })(window.kendo);\n","(function(kendo) {\n\n    kendo.spreadsheet.messages.workbook = {\n        defaultSheetName: \"Sheet\"\n    };\n\n    kendo.spreadsheet.messages.view = {\n        nameBox: \"Name Box\",\n        formulaInput: \"Formula Input\",\n        errors: {\n            openUnsupported: \"Unsupported format. Please select an .xlsx file.\",\n            shiftingNonblankCells: \"Cannot insert cells due to data loss possibility. Select another insert location or delete the data from the end of your worksheet.\",\n            insertColumnWhenRowIsSelected: \"Cannot insert column when all columns are selected.\",\n            insertRowWhenColumnIsSelected: \"Cannot insert row when all rows are selected.\",\n            filterRangeContainingMerges: \"Cannot create a filter within a range containing merges\",\n            sortRangeContainingMerges: \"Cannot sort a range containing merges\",\n            cantSortMultipleSelection: \"Cannot sort multiple selection\",\n            cantSortNullRef: \"Cannot sort empty selection\",\n            cantSortMixedCells: \"Cannot sort range containing cells of mixed shapes\",\n            validationError: \"The value that you entered violates the validation rules set on the cell.\",\n            cannotModifyDisabled: \"Cannot modify disabled cells.\",\n            insertRowBelowLastRow: \"Cannot insert row below the last row.\",\n            insertColAfterLastCol: \"Cannot insert column to the right of the last column.\"\n        },\n        tabs: {\n            file: \"File\",\n            home: \"Home\",\n            insert: \"Insert\",\n            format: \"Format\",\n            data: \"Data\",\n            view: \"View\"\n        }\n    };\n\n    kendo.spreadsheet.messages.menus = {\n        \"cut\": \"Cut\",\n        \"copy\": \"Copy\",\n        \"paste\": \"Paste\",\n        \"merge\": \"Merge\",\n        \"unmerge\": \"Unmerge\",\n        \"delete\": \"Delete\",\n        \"hide\": \"Hide\",\n        \"unhide\": \"Unhide\",\n        \"bringToFront\": \"Bring to front\",\n        \"sendToBack\": \"Send to back\"\n    };\n})(window.kendo);\n","import \"../kendo.core.js\";\nimport \"../kendo.ooxml.js\";\n\n(function(kendo) {\n    let $ = kendo.jQuery;\n\n    if (kendo.PDFMixin) {\n        let override_drawPDF = function(options) {\n            var result = new $.Deferred();\n            var callback = function(group) {\n                result.resolve(group);\n            };\n            switch(options.area) {\n            case \"workbook\":\n                options.workbook.draw(options, callback);\n                break;\n            case \"sheet\":\n                options.workbook.activeSheet().draw(options, callback);\n                break;\n            case \"selection\":\n                options.workbook.activeSheet().selection().draw(options, callback);\n                break;\n            }\n\n            return result.promise();\n        };\n\n         let overrideSaveAsPDF = function(options) {\n            if (this.events.indexOf(\"pdfExport\") === -1) {\n                kendo.PDFMixin.extend(this);\n                this.saveAsPDF = overrideSaveAsPDF;\n                this._drawPDF = override_drawPDF;\n            }\n\n            var progress = new $.Deferred();\n            var promise = progress.promise();\n            var args = { promise: promise };\n            if (this.trigger(\"pdfExport\", args)) {\n                return;\n            }\n\n            this._drawPDF(options, progress)\n            .then(function(root) {\n                let pdfResultPromise = options.forceProxy\n                    ? kendo.pdf.exportPDF(root) // produce data URI for proxy\n                    : kendo.pdf.exportPDFToBlob(root);\n                return kendo.convertPromiseToDeferred(pdfResultPromise);\n            })\n            .done(function(dataURI) {\n                kendo.saveAs({\n                    dataURI: dataURI,\n                    fileName: options.fileName,\n                    proxyURL: options.proxyURL,\n                    forceProxy: options.forceProxy,\n                    proxyTarget: options.proxyTarget\n                });\n\n                progress.resolve();\n            })\n            .fail(function(err) {\n                progress.reject(err);\n            });\n\n            return promise;\n        };\n\n        kendo.spreadsheet.Workbook.prototype.saveAsPDF = overrideSaveAsPDF\n\n        kendo.spreadsheet.Workbook.prototype._drawPDF = override_drawPDF\n    }\n})(kendo);\n","import \"./kendo.excel.js\";\nimport \"./kendo.progressbar.js\";\nimport \"./kendo.pdf.js\";\nimport \"./kendo.toolbar.js\";\nimport \"./kendo.list.js\";\nimport \"./kendo.spreadsheet.common.js\";\nimport \"./spreadsheet/dialogs.js\";\nimport \"./spreadsheet/toolbar.js\";\nimport \"./spreadsheet/print.js\";\nimport \"./spreadsheet/customeditors.js\";\nimport \"./spreadsheet/sheetsbar.js\";\nimport \"./spreadsheet/filtermenu.js\";\nimport \"./spreadsheet/messages.js\";\nimport \"./spreadsheet/workbook.js\";\n\nexport const __meta__ = {\n    id: \"spreadsheet\",\n    name: \"Spreadsheet\",\n    category: \"web\",\n    description: \"Spreadsheet component\",\n    depends: [\n        \"core\", \"binder\", \"colorpicker\", \"combobox\", \"data\", \"dom\", \"dropdownlist\",\n        \"menu\", \"ooxml\", \"popup\", \"sortable\", \"toolbar\", \"treeview\",\n        \"window\", \"validator\", \"excel\", \"pdf\", \"drawing\", \"list\", \"spreadsheet.common\"]\n};\n\n(function(kendo, undefined) {\n    if (kendo.support.browser.msie && kendo.support.browser.version < 9) {\n        return;\n    }\n\n    const K_ACTIVE = \"k-active\";\n    let $ = kendo.jQuery;\n    let Widget = kendo.ui.Widget;\n    let NS = \".kendoSpreadsheet\";\n    let DOT = \".\";\n    let commonEngine = kendo.spreadsheet.commonEngine;\n    let FormulaInput = kendo.spreadsheet.FormulaInput;\n    let SheetsBar = kendo.spreadsheet.SheetsBar;\n\n    function toActionSelector(selectors) {\n        return selectors.map(function(action) {\n            return '[data-action=\"' + action + '\"]';\n        }).join(\",\");\n    }\n\n    function convertSpreadsheetDeferredToJQueryDeferred(spreadsheetDeferred) {\n        const deferred = $.Deferred();\n\n        spreadsheetDeferred.then(\n            function(value) { deferred.resolve(value); },\n            function(reason) { deferred.reject(reason); }\n        );\n\n        if (typeof spreadsheetDeferred.progress === \"function\") {\n            spreadsheetDeferred.progress(function(val) {\n                deferred.notify(val);\n            });\n        }\n\n        const promise = deferred.promise();\n        promise.progress = function(fn) {\n            deferred.progress(fn);\n            return promise;\n        };\n        return promise;\n    }\n\n    function removeEventsFromOptions(options, eventNames) {\n        const sanitized = {};\n        for (let key in options) {\n            if (options.hasOwnProperty(key) && eventNames.indexOf(key) === -1) {\n                sanitized[key] = options[key];\n            }\n        }\n        return sanitized;\n    }\n\n    let COMPOSITE_UNAVAILABLE_ACTION_SELECTORS = toActionSelector(['cut', 'copy', 'paste', 'insert-left', 'insert-right', 'insert-above', 'insert-below']);\n    let UNHIDE_ACTION_SELECTORS = toActionSelector(['unhide-row', 'unhide-column']);\n    let classNames = {\n        wrapper: \"k-spreadsheet\"\n    };\n\n    let viewClassNames = commonEngine.View.classNames;\n\n    const SPREADSHEET_CONTENT_HTML_TEMPLATE = ({ messages }) => `\n                            <div ref-header-container class=\"k-spreadsheet-header\"><div ref-header-menu></div><div ref-header-toolbar></div></div>\n                            <div class=\"k-spreadsheet-action-bar\">\n                                <div class=\"k-spreadsheet-name-editor\">\n                                    <input ref-namebox-input title=\"${messages.nameBox || \"Name Box\"}\" aria-label=\"${messages.nameBox || \"Name Box\"}\"></input>\n                                </div>\n                                <div class=\"k-spreadsheet-formula-bar\">\n                                    ${kendo.ui.icon(\"formula-fx\")}\n                                    <div class=\"k-spreadsheet-formula-input\"\n                                        role=\"combobox\"\n                                        title=\"${messages.view.formulaInput}\"\n                                        aria-haspopup=\"menu\"\n                                        aria-expanded=\"false\"\n                                        contentEditable=\"true\"\n                                        spellCheck=\"false\">\n                                    </div>\n                                </div>\n                            </div>\n                            <div class=\"k-spreadsheet-view\">\n                                <div class=\"k-spreadsheet-fixed-container\"></div>\n                                <div class=\"k-spreadsheet-scroller\">\n                                    <div class=\"k-spreadsheet-view-size\"></div>\n                                </div>\n                                <div tabIndex=\"0\" class=\"k-spreadsheet-clipboard\" contentEditable=\"true\" ></div>\n                                <div contentEditable=\"true\"\n                                    spellCheck=\"false\"\n                                    role=\"combobox\"\n                                    title=\"${messages.view.formulaInput}\"\n                                    aria-haspopup=\"menu\"\n                                    aria-expanded=\"false\"\n                                    class=\"k-spreadsheet-formula-input k-spreadsheet-cell-editor\">\n                                </div>\n                            </div>\n                            <div ref-sheets-bar></div>`;\n\n    const CELL_CONTEXT_MENU = ({ messages }) => `\n                    <ul class=\"${viewClassNames.cellContextMenu}\">\n                        <li data-action=\"cut\">${messages.menus.cut}</li>\n                        <li data-action=\"copy\">${messages.menus.copy}</li>\n                        <li data-action=\"paste\">${messages.menus.paste}</li>\n                        <li class=\"k-separator\"></li>\n                        <li data-action=\"merge\">${messages.menus.merge}</li>\n                        <li data-action=\"unmerge\">${messages.menus.unmerge}</li>\n                    </ul>`;\n\n    const ROW_HEADER_CONTEXT_MENU = ({ messages }) => `\n                    <ul class=\"${viewClassNames.rowHeaderContextMenu}\">\n                        <li data-action=\"cut\">${messages.menus.cut}</li>\n                        <li data-action=\"copy\">${messages.menus.copy}</li>\n                        <li data-action=\"paste\">${messages.menus.paste}</li>\n                        <li class=\"k-separator\"></li>\n                        <li data-action=\"delete-row\">${messages.menus.delete}</li>\n                        <li data-action=\"hide-row\">${messages.menus.hide}</li>\n                        <li data-action=\"unhide-row\">${messages.menus.unhide}</li>\n                    </ul>`;\n\n    const COL_HEADER_CONTEXT_MENU = ({ messages }) => `\n                    <ul class=\"${viewClassNames.colHeaderContextMenu}\">\n                        <li data-action=\"cut\">${messages.menus.cut}</li>\n                        <li data-action=\"copy\">${messages.menus.copy}</li>\n                        <li data-action=\"paste\">${messages.menus.paste}</li>\n                        <li class=\"k-separator\"></li>\n                        <li data-action=\"delete-column\">${messages.menus.delete}</li>\n                        <li data-action=\"hide-column\">${messages.menus.hide}</li>\n                        <li data-action=\"unhide-column\">${messages.menus.unhide}</li>\n                    </ul>`;\n\n    const DRAWING_CONTEXT_MENU = ({ messages }) => `\n                    <ul class=\"${viewClassNames.drawingContextMenu}\">\n                        <li data-action=\"bring-to-front\">${messages.menus.bringToFront}</li>\n                        <li data-action=\"send-to-back\">${messages.menus.sendToBack}</li>\n                        <li class=\"k-separator\"></li>\n                        <li data-action=\"delete-drawing\">${messages.menus.delete}</li>\n                    </ul>`;\n\n    kendo.spreadsheet.ContextMenu = kendo.ui.ContextMenu;\n\n    let FormulaInputStaticList = kendo.ui.StaticList.extend({\n        data: function(d) {\n            return this.dataSource.data(d);\n        },\n        itemClick: function(handler) {\n            this.bind(\"change\", function(ev) { handler(this.value()[0]); });\n        }\n    });\n\n    class FormulaInputRefArgs {\n        constructor({ list, popup }) {\n            this.current = { list, popup };\n            this.clone = function clone() {\n                return this;\n            };\n        }\n    }\n\n    class NameBoxRefArgs {\n        constructor({ nameEditor, container }) {\n            let combo = this.initializeComboBox(container, nameEditor);\n            this.current = {\n                value: (val) => {\n                    if (val === undefined) {\n                        const item = combo.value();\n                        return item ? (item.name || item) : item;\n                    } else {\n                        combo.value(val || '');\n                    }\n                }\n            };\n\n            this.nameEditor = nameEditor;\n\n            this.clone = function clone() {\n                return this;\n            };\n        }\n\n        initializeComboBox(container) {\n            let that = this;\n            let dataSource = new kendo.data.DataSource({\n                transport: {\n                    read: function(options) {\n                        let data = that.nameEditor()?.readData() || [];\n                        options.success(data);\n                    },\n                    cache: false\n                }\n            });\n\n            let combo = $(container).kendoComboBox({\n                clearButton: false,\n                dataTextField: \"name\",\n                dataValueField: \"name\",\n                template: ({ name }) => `${kendo.htmlEncode(name)}<a role='button' class='k-button-delete' href='\\\\#'>${kendo.ui.icon(\"x\")}</a>`,\n                dataSource: dataSource,\n                autoBind: false,\n                ignoreCase: true,\n                change: that.onChange.bind(that),\n                noDataTemplate: () => \"<div></div>\",\n                open: function() {\n                    dataSource.read();\n                }\n            }).data(\"kendoComboBox\");\n\n            combo.input\n                .on(\"keydown\", that.onKeyDown.bind(this));\n            combo.popup.element\n                .addClass(\"k-spreadsheet-names-popup\")\n\n                .on(\"mousemove\", function(ev) {\n                    // XXX: should remove this when we find a better\n                    // solution for the popup closing as we hover the\n                    // resize handles.\n                    ev.stopPropagation();\n                })\n\n                .on(\"click\", \".k-button-delete\", function(ev) {\n                    ev.preventDefault();\n                    ev.stopPropagation();\n                    let item = $(ev.target).closest(\".k-list-item\");\n                    item = combo.dataItem(item);\n                    that.onDelete(item.name);\n                });\n\n            return combo;\n        }\n\n        // Event: Handle change in ComboBox\n        onChange(event) {\n            const editor = this.nameEditor();\n            if (editor && event.sender.value()) {\n                editor.trigger(\"select\", { name: event.sender.value() });\n            }\n        }\n\n        // Event: Delete button click within item\n        onDelete(name) {\n            this.nameEditor()?.trigger(\"delete\", { name });\n        }\n\n        // Handling keyboard events like Enter, Escape\n        onKeyDown(event) {\n            const editor = this.nameEditor();\n            if (editor) {\n                if (event.key === 'Enter') {\n                    const name = event.target.value;\n                    editor.trigger(\"enter\", { value: name });\n                } else if (event.key === 'Escape') {\n                    editor.trigger(\"cancel\");\n                }\n            }\n        }\n    }\n\n    let Spreadsheet = kendo.ui.Widget.extend({\n        _renderInnerContent: function(element) {\n            $(element).append(SPREADSHEET_CONTENT_HTML_TEMPLATE(this.options));\n        },\n        init: function(element, options) {\n            let that = this;\n            Widget.fn.init.call(this, element, options);\n\n            this.options.messages = $.extend(true, {\n                view: kendo.spreadsheet.messages.view,\n                tabs: kendo.spreadsheet.messages.view.tabs,\n                menus: kendo.spreadsheet.messages.menus,\n                workbook: {\n                    defaultSheetName: \"Sheet\",\n                }\n            }, this.options.messages);\n\n            this.element.addClass(Spreadsheet.classNames.wrapper);\n            this.element.attr(\"role\", \"application\");\n            this._renderInnerContent(this.element);\n\n            this._createFormulaInputs();\n\n            that.spreadsheetRef = this._initSpreadsheetWidget();\n\n            this._bindWorkbookEvents();\n\n            const activeSheet = this.activeSheet();\n            this._onUpdateTools({ range: activeSheet.range(activeSheet.activeCell()) });\n\n            this._resizeHandler = function() { that.resize(); };\n            $(window).on(\"resize\" + NS, this._resizeHandler);\n\n            if (this._showWatermarkOverlay) {\n                this._showWatermarkOverlay(this.element[0]);\n            }\n        },\n        _initSpreadsheetWidget: function() {\n            const that = this;\n            const options = removeEventsFromOptions(that.options, that.events);\n\n            let widgetOptions = $.extend({},\n                options, {\n                sheetsbar: that.options.sheetsbar != false ? that.options.sheetsbar : {},\n                formulaBarInputRef: new FormulaInputRefArgs({\n                    list: this._formulaBarInputRefList,\n                    popup: this._formulaBarInputRefPopup\n                }),\n                formulaCellInputRef: new FormulaInputRefArgs({\n                    list: this._formulaCellInputRefList,\n                    popup: this._formulaCellInputRefPopup\n                }),\n                nameBoxRef: new NameBoxRefArgs({\n                    container: that.element.find('.k-spreadsheet-name-editor [ref-namebox-input]'),\n                    nameEditor: function() {\n                        return that.spreadsheetRef?.view.nameEditor;\n                    }\n                }),\n                createFilterMenu: function(options) {\n                    let element = $(\"<div></div>\").appendTo(that.element);\n                    return new kendo.spreadsheet.FilterMenu(element, options);\n                },\n                createTabStrip: function(options) {\n                    if (that.options.toolbar) {\n                        that._initHeader();\n\n                        return {\n                            focus: function() { that.menu.wrapper.trigger(\"focus\"); },\n                            select: function(name) { that.menu.element.find(`li[ref-tab-name=\"${name}\"]`).click(); },\n                            destroy: function() { that.menu.destroy(); }\n                        };\n                    }\n                },\n                createSheetEditor: function(options) {\n                    that.sheetsBar._createEditor();\n                },\n                createSheetBar: function(openDialogCallback) {\n                    that._sheetsBar(openDialogCallback);\n                },\n                createContextMenus: function(options) {\n                    that._dialogs = [];\n                    that._initContextMenus();\n                },\n                createSheetDataSource: function(dataSource) {\n                    return kendo.data.DataSource.create(dataSource);\n                },\n                getWorkbookCommand: function(commandName, commandOptions) {\n                    return new kendo.spreadsheet[commandName](commandOptions);\n                },\n                getIconHTMLString: function(iconName) {\n                    return $(kendo.ui.icon(iconName))[0];\n                },\n                update: function(e) {\n                    that._onUpdateTools(e);\n                    if (e.reason.sheetSelection && that.sheetsBar) {\n                        that.sheetsBar.renderSheets(e.sender.sheets(), e.sender.sheetIndex(e.sheet));\n                    }\n                },\n                message: (args) => {\n                    // exclude these properties from the options\n                    let { sender, name, ref, range, ...dialogOptions } = args;\n                    let opts = $.extend({}, { pdfExport: that.options.pdf, excelExport: that.options.excel }, dialogOptions);\n                    let dialog = kendo.spreadsheet.dialogs.create(args.name, opts);\n                    const saveAsCallback = function(data, fileName, exportOptions) {\n                        kendo.saveAs({ dataURI: data, fileName, ...exportOptions });\n                    };\n\n\n                    if (dialog) {\n                        dialog.bind(\"action\", function(args) {\n                            if (args.command == \"SaveAsCommand\") {\n                                let { sender, ...commandArgs } = args;\n                                let fileName = args.options.name + args.options.extension;\n                                if (args.options.extension === \".xlsx\") {\n                                    return that.spreadsheetRef.saveAsExcel($.extend(commandArgs, {\n                                        fileName: fileName,\n                                        Workbook: kendo.ooxml.Workbook,\n                                        saveAs: saveAsCallback\n                                    }));\n                                } else if (this.options.extension === \".pdf\") {\n                                    return that.spreadsheetRef.saveAsPDF($.extend(args.options.pdf, { workbook: this.options.workbook, fileName: fileName }));\n                                }\n                            }\n\n                            that.spreadsheetRef.executeCommand(args);\n                        });\n\n                        dialog.bind(\"deactivate\", () => {\n                            dialog.destroy();\n                            that._dialogs.pop();\n                        });\n\n                        that._dialogs.push(dialog);\n\n                        dialog.open(args.range, args);\n                        args.dialog = dialog;\n                    }\n                },\n                contextmenu: (e) => {\n                    const { objectRef, targetType, showUnhide, showUnmerge, originalEvent, isComposite } = e;\n                    const selection = e.sender.activeSheet().select();\n                    const { topLeft, bottomRight } = selection;\n\n                    this._cellContextMenu.close();\n                    this._colHeaderContextMenu.close();\n                    this._rowHeaderContextMenu.close();\n                    this._drawingContextMenu.close();\n\n                    let menu;\n\n                    if (targetType == \"columnheader\") {\n                        menu = this._colHeaderContextMenu;\n                    } else if (targetType == \"rowheader\") {\n                        menu = this._rowHeaderContextMenu;\n                    } else if (targetType == \"drawing\") {\n                        menu = this._drawingContextMenu;\n                    } else {\n                        menu = this._cellContextMenu;\n                    }\n\n                    menu.element.find(COMPOSITE_UNAVAILABLE_ACTION_SELECTORS).toggle(!isComposite);\n                    menu.element.find(UNHIDE_ACTION_SELECTORS).toggle(showUnhide);\n                    menu.element.find('[data-action=unmerge]').toggle(showUnmerge);\n\n                    // avoid the immediate close\n                    setTimeout(function() {\n                        menu.open(e.originalEvent.pageX, e.originalEvent.pageY);\n                    });\n                },\n                locale: kendo.cultures.current.name,\n                intl: kendo.kendoCultureToIntl(),\n            });\n\n            return new kendo.spreadsheet.commonEngine.SpreadsheetWidget(this.element[0], widgetOptions);\n        },\n        _createFormulaInputs: function() {\n            let formulaBarInputRefElement = this.element.find('.k-spreadsheet-action-bar .k-spreadsheet-formula-input');\n            let formulaBarInputRefListId = kendo.guid();\n            formulaBarInputRefElement.attr(\"aria-controls\", formulaBarInputRefListId);\n\n            this._formulaBarInputRefList = new FormulaInputStaticList($(`<ul id=\"${formulaBarInputRefListId}\" />`)\n                .addClass(FormulaInput.classNames.listWrapper)\n                .insertAfter(formulaBarInputRefElement), {\n                aria: {\n                    role: 'menu',\n                    itemRole: 'menuitem'\n                },\n                autoBind: false,\n                selectable: true,\n                dataTextField: \"text\",\n                dataValueField: \"value\",\n                template: ({ text, value }) => `${text || value}`\n            });\n\n            this._formulaBarInputRefList.element.on(\"mousedown\", function(e) {\n                e.preventDefault();\n            });\n\n            this._formulaBarInputRefPopup = new kendo.ui.Popup(this._formulaBarInputRefList.element, {\n                anchor: this.element.find(\".k-spreadsheet-formula-input:not(.k-spreadsheet-cell-editor)\"),\n                open: function(ev) { formulaBarInputRefElement.attr(\"aria-expanded\", true); },\n                close: function(ev) { formulaBarInputRefElement.attr(\"aria-expanded\", false); }\n            });\n\n            let formulaCellInputRefElement = this.element.find('.k-spreadsheet-cell-editor');\n            let formulaCellInputRefListId = kendo.guid();\n            formulaCellInputRefElement.attr(\"aria-controls\", formulaCellInputRefListId);\n\n            this._formulaCellInputRefList = new FormulaInputStaticList($(`<ul id=\"${formulaCellInputRefListId}\" />`)\n                .addClass(FormulaInput.classNames.listWrapper)\n                .insertAfter(formulaCellInputRefElement), {\n                aria: {\n                    role: 'menu',\n                    itemRole: 'menuitem'\n                },\n                autoBind: false,\n                selectable: true,\n                dataValueField: \"value\",\n                dataTextField: \"text\",\n                template: ({ text, value }) => `${text || value}`\n\n            });\n\n            this._formulaCellInputRefList.element.on(\"mousedown\", function(e) {\n                e.preventDefault();\n            });\n\n            this._formulaCellInputRefPopup = new kendo.ui.Popup(this._formulaCellInputRefList.element, {\n                anchor: this.element.find(DOT + commonEngine.View.classNames.cellEditor),\n                open: function(ev) { formulaCellInputRefElement.attr(\"aria-expanded\", true); },\n                close: function(ev) { formulaCellInputRefElement.attr(\"aria-expanded\", false); }\n            });\n        },\n        _initContextMenus: function() {\n            let that = this;\n\n            let contextMenuConfig = {\n                target: this.element,\n                animation: false,\n                showOn: \"never\" // this is just an invalid event name to prevent the show\n            };\n\n            this._cellContextMenu = new kendo.spreadsheet.ContextMenu($(CELL_CONTEXT_MENU(that.options)).appendTo(that.element), contextMenuConfig);\n\n            this._colHeaderContextMenu = new kendo.spreadsheet.ContextMenu($(COL_HEADER_CONTEXT_MENU(that.options)).appendTo(that.element), contextMenuConfig);\n\n            this._rowHeaderContextMenu = new kendo.spreadsheet.ContextMenu($(ROW_HEADER_CONTEXT_MENU(that.options)).appendTo(that.element), contextMenuConfig);\n\n            this._drawingContextMenu = new kendo.spreadsheet.ContextMenu($(DRAWING_CONTEXT_MENU(that.options)).appendTo(that.element), contextMenuConfig);\n\n            this._cellContextMenu.bind(\"select\", this.onContextMenuSelect.bind(this));\n            this._rowHeaderContextMenu.bind(\"select\", this.onContextMenuSelect.bind(this));\n            this._colHeaderContextMenu.bind(\"select\", this.onContextMenuSelect.bind(this));\n            this._drawingContextMenu.bind(\"select\", this.onContextMenuSelect.bind(this));\n        },\n        onContextMenuSelect: function(e) {\n            let that = this;\n            let action = $(e.item).data(\"action\");\n            let command;\n            switch (action) {\n                case \"cut\":\n                    command = { command: \"ToolbarCutCommand\", options: { workbook: this.spreadsheetRef.workbook } };\n                    break;\n                case \"copy\":\n                    command = { command: \"ToolbarCopyCommand\", options: { workbook: this.spreadsheetRef.workbook } };\n                    break;\n                case \"paste\":\n                    command = { command: \"ToolbarPasteCommand\", options: { workbook: this.spreadsheetRef.workbook } };\n                    break;\n                case \"delete-drawing\":\n                    command = { command: \"DeleteDrawingCommand\", options: { drawing: this.spreadsheetRef._controller.navigator._sheet._activeDrawing } };\n                    break;\n                case \"bring-to-front\":\n                    command = { command: \"BringToFrontCommand\", options: { drawing: this.spreadsheetRef._controller.navigator._sheet._activeDrawing } };\n                    break;\n                case \"send-to-back\":\n                    command = { command: \"SendToBackCommand\", options: { drawing: this.spreadsheetRef._controller.navigator._sheet._activeDrawing } };\n                    break;\n                case \"unmerge\":\n                    command = { command: \"MergeCellCommand\", options: { value: \"unmerge\" } };\n                    break;\n                case \"merge\":\n                    this.spreadsheetRef.openDialog(\"merge\");\n                    break;\n                case \"hide-row\":\n                    command = { command: \"HideLineCommand\", options: { axis: \"row\" } };\n                    break;\n                case \"hide-column\":\n                    command = { command: \"HideLineCommand\", options: { axis: \"column\" } };\n                    break;\n                case \"unhide-row\":\n                    command = { command: \"UnHideLineCommand\", options: { axis: \"row\" } };\n                    break;\n                case \"unhide-column\":\n                    command = { command: \"UnHideLineCommand\", options: { axis: \"column\" } };\n                    break;\n                case \"delete-row\":\n                    command = { command: \"DeleteRowCommand\" };\n                    break;\n                case \"delete-column\":\n                    command = { command: \"DeleteColumnCommand\" };\n                    break;\n            }\n\n            if (command) {\n                that.spreadsheetRef.executeCommand(command);\n            }\n        },\n        _onUpdateTools: function(e) {\n            let reason = e.reason;\n            if (reason && (reason.overElement || reason.comment)) {\n                return;\n            }\n            this.toolbar?.refresh(e.range);\n        },\n        _getCopyRegex: function(sheetName) {\n            const newName = sheetName.replaceAll('(', '\\\\(').replaceAll(')', '\\\\)');\n            const st = `(${newName})\\\\s?\\\\(`;\n            return new RegExp(st, 's');\n        },\n        _sheetsBar: function(openDialogCallback) {\n            let that = this;\n\n            if (that.options.sheetsbar) {\n                let sheetsbarOptions = $.extend(true, {\n                    openDialog: openDialogCallback,\n                }, that.options.sheetsbar);\n\n                that.sheetsBar = new SheetsBar(that.element[0].querySelector('[ref-sheets-bar]'), sheetsbarOptions);\n\n                that.sheetsBar.bind(\"select\", function onSheetSelect(ev) {\n                    if (ev.isAddButton) {\n                        that.spreadsheetRef.view.sheetsbar.onAddSelect();\n                    } else {\n                        that.spreadsheetRef.view.sheetsbar.onSheetSelect(ev.name);\n                    }\n                });\n\n                that.sheetsBar.bind(\"reorder\", function onSheetReorderEnd(ev) {\n                    that.spreadsheetRef.view.sheetsbar.onSheetReorderEnd(ev);\n                });\n\n                that.sheetsBar.bind(\"rename\", function onSheetRename(ev) {\n                    that.spreadsheetRef.view.sheetsbar.onSheetRename(ev.name, ev.sheetIndex);\n                });\n\n                that.sheetsBar.bind(\"duplicate\", function onSheetDuplicate(ev) {\n                    let name = ev.name;\n                    let sheetToCopy = that.sheetByName(name);\n                    let sheetIndex = that.sheetIndex(sheetToCopy);\n                    let copies = 0;\n                    const regex = that._getCopyRegex(name);\n                    that.sheets().forEach(sheet => {\n                        const isPresent = regex.test(sheet.name());\n                        if (isPresent) {\n                            copies += 1;\n                        }\n                    });\n\n                    const newName = `${name} (${copies + 1})`;\n                    that.insertSheet({ data: { ...sheetToCopy.toJSON(), name: newName }, index: sheetIndex + 1 });\n                    that.spreadsheetRef.view.sheetsbar.onSheetSelect(newName);\n                });\n\n                that.sheetsBar.bind(\"remove\", function onSheetBarRemove(ev) {\n                    that.spreadsheetRef.view.sheetsbar.onSheetRemove(ev.name);\n                });\n\n                that.sheetsBar.bind(\"hide\", function onSheetBarHide(ev) {\n                    let sheetName = ev.name;\n                    let sheetToHide = that.sheetByName(sheetName);\n                    let visibleSheets = that.sheets().filter(x=> x.state() === \"visible\");\n                    let visibleSheetIndex = visibleSheets.findIndex(x=> x.name() === sheetName);\n                    let nextVisibleSheet = visibleSheets[visibleSheetIndex + 1] || visibleSheets[visibleSheetIndex - 1];\n                    sheetToHide._state('hidden');\n\n                    that.spreadsheetRef.workbook._sheetsSearchCache = {};\n                    that.spreadsheetRef.view.sheetsbar.onSheetSelect(nextVisibleSheet.name());\n                });\n\n                that.sheetsBar.bind(\"show\", function onSheetBarShow(ev) {\n                    let sheetName = ev.name;\n                    that.sheetByName(sheetName)._state('visible');\n                    that.spreadsheetRef.workbook._sheetsSearchCache = {};\n                    that.spreadsheetRef.view.sheetsbar.onSheetSelect(ev.name);\n                });\n            }\n        },\n        _createToolBar: function(options, tabs, toolbarId) {\n            let that = this;\n\n            if (that.toolbar) {\n                that.toolbar.destroy();\n                that.toolbar.element.empty();\n            }\n\n            let activeTabIndex = tabs.findIndex((item) => item.id === toolbarId);\n            let activeToolbar = tabs[activeTabIndex];\n            let tools = options[activeToolbar.id];\n\n            that._activeToolBar = activeToolbar.text;\n\n            that.toolbar = new kendo.spreadsheet.ToolBar(this.element.find(\"[ref-header-toolbar]\"), {\n                tools: typeof tools === \"boolean\" ? undefined : tools,\n                overflow: $.isPlainObject(options.overflow) ? options.overflow : undefined,\n                toolbarName: activeToolbar.id,\n                fillMode: \"flat\",\n                action: function(args) {\n                    if (args.command === 'undo' || args.command === 'redo') {\n                        that.spreadsheetRef.workbook.undoRedoStack[args.command]();\n                        return;\n                    }\n\n                    if (args.command == \"OpenCommand\") {\n                        args.options.file = args.options.value;\n                    } else if (args.command === \"BorderChangeCommand\") {\n                        args.options.border = args.options.border || args.options.value.type;\n                        args.options.style = args.options.style || args.options.value.style || { color: args.options.value.color, size: 1 };\n                    }\n\n                    that.spreadsheetRef.executeCommand(args);\n                },\n                dialog: function(args) {\n                    that.spreadsheetRef.openDialog(args.name, args.options);\n                }\n            });\n            that.toolbar.element.attr(\"aria-label\", activeToolbar.text);\n        },\n\n        _initHeader: function() {\n            let that = this;\n            let messages = this.options.messages.tabs;\n            let options = $.extend(true, { file: true, home: true, insert: true, format: true, data: true, view: true }, this.options.toolbar);\n            let tabs = [];\n\n            if (this.menu) {\n                this.menu.destroy();\n                this.menu.empty();\n            }\n\n            if (this.toolbar) {\n                this.toolbar.destroy();\n                this.toolbar.empty();\n            }\n\n            for (let name in options) {\n                if (options[name] === true || options[name] instanceof Array) {\n                    tabs.push({ id: name, text: messages[name], content: \"\", attr: { \"ref-tab-name\": name } });\n                }\n            }\n\n            this.menu = new kendo.spreadsheet.Menu(this.element.find(\"[ref-header-menu]\"), {\n                dataSource: tabs,\n                toolbarOptions: options,\n                select: function(e) {\n                    let text = $(e.item).text();\n                    if (that._activeToolBar !== text) {\n                        $(e.item).addClass(K_ACTIVE)\n                            .siblings(\"li\").removeClass(K_ACTIVE);\n\n                        that._createToolBar(options, tabs, tabs.find((item) => item.text === text).id);\n                        const activeSheet = that.activeSheet();\n                        that._onUpdateTools({ range: activeSheet.range(activeSheet.activeCell()) });\n                    }\n                }\n            });\n\n            if (tabs.length) {\n                let defaultTab = tabs.find((item)=> item.id === \"home\");\n                this.menu.element.find(`li[ref-tab-name=\"home\"]`).addClass(K_ACTIVE);\n                that._createToolBar(options, tabs, defaultTab ? defaultTab.id : tabs[0].id);\n            }\n        },\n\n        executeCommand(options) {\n            return this.spreadsheetRef.executeCommand(options);\n        },\n\n        _resize: function() {\n            this.refresh({ layout: true });\n        },\n\n        _workbookRender: function(e) {\n            if (this.trigger(\"render\", e)) {\n                e.preventDefault();\n            }\n        },\n\n        _workbookChanging: function(e) {\n            if (this.trigger(\"changing\", e)) {\n                e.preventDefault();\n            }\n        },\n\n        _workbookChange: function(e) {\n            if (this.trigger(\"change\", { range: e.range })) {\n                e.preventDefault();\n            }\n        },\n\n        _workbookCut: function(e) {\n            this.trigger(\"cut\", e);\n        },\n\n        _workbookCopy: function(e) {\n            this.trigger(\"copy\", e);\n        },\n\n        _workbookPaste: function(e) {\n            this.trigger(\"paste\", e);\n        },\n\n        activeSheet: function(sheet) {\n            return this.spreadsheetRef.activeSheet(sheet);\n        },\n\n        moveSheetToIndex: function(sheet, index) {\n            return this.spreadsheetRef.moveSheetToIndex(sheet, index);\n        },\n\n        insertSheet: function(options) {\n            return this.spreadsheetRef.insertSheet(options);\n        },\n\n        sheets: function() {\n            return this.spreadsheetRef.sheets();\n        },\n\n        removeSheet: function(sheet) {\n            return this.spreadsheetRef.removeSheet(sheet);\n        },\n\n        sheetByName: function(sheetName) {\n            return this.spreadsheetRef.sheetByName(sheetName);\n        },\n\n        sheetIndex: function(sheet) {\n            return this.spreadsheetRef.sheetIndex(sheet);\n        },\n\n        sheetByIndex: function(index) {\n            return this.spreadsheetRef.sheetByIndex(index);\n        },\n\n        renameSheet: function(sheet, newSheetName) {\n            return this.spreadsheetRef.renameSheet(sheet, newSheetName);\n        },\n\n        refresh: function(reason) {\n            this.spreadsheetRef.refresh(reason);\n\n            return this;\n        },\n\n        openDialog: function(name, options) {\n            return this.spreadsheetRef.openDialog(name, options);\n        },\n\n        autoRefresh: function(value) {\n            if (value !== undefined) {\n                this._autoRefresh = value;\n\n                if (value === true) {\n                    this.refresh();\n                }\n\n                return this;\n            }\n\n            return this._autoRefresh;\n        },\n\n        toJSON: function() {\n            return this.spreadsheetRef.toJSON();\n        },\n\n        fromJSON: function(json) {\n            this.spreadsheetRef.fromJSON(json);\n        },\n\n        saveJSON: function() {\n            return this.spreadsheetRef.saveJSON();\n        },\n\n        fromFile: function(blob, name) {\n            return this.spreadsheetRef.fromFile(blob, name);\n        },\n\n        saveAsPDF: function(options) {\n            this.spreadsheetRef.saveAsPDF(\n                $.extend({}, this.options.pdf, options, { workbook: this.spreadsheetRef._workbook })\n            );\n        },\n\n        saveAsExcel: function(options) {\n            const exportOps = $.extend({}, this.options.excel, options, {\n                Workbook: kendo.ooxml.Workbook,\n                saveAs: function(data, fileName, exportOptions) {\n                    kendo.saveAs({ dataURI: data, fileName, ...exportOptions });\n                }\n            });\n            this.spreadsheetRef.saveAsExcel(exportOps);\n        },\n\n        draw: function(options, callback) {\n            this.spreadsheetRef.draw(options, callback);\n        },\n\n        _workbookExcelExport: function(e) {\n            if (this.trigger(\"excelExport\", e)) {\n                e.preventDefault();\n            }\n        },\n\n        _workbookExcelImport: function(e) {\n            const eventData = {\n                file: e.file,\n                sender: e.sender,\n                preventDefault: e.preventDefault,\n                isDefaultPrevented: e.isDefaultPrevented,\n                promise: convertSpreadsheetDeferredToJQueryDeferred(e.deferred),\n                _defaultPrevented: e._defaultPrevented,\n            };\n\n            if (this.trigger(\"excelImport\", eventData)) {\n                e.preventDefault();\n            } else {\n                this._initProgress(e.deferred);\n            }\n        },\n\n        _initProgress: function(deferred) {\n            let loading =\n                $(\"<div class='k-loading-mask' \" +\n                    \"style='width: 100%; height: 100%; top: 0;'>\" +\n                    \"<div class='k-loading-color'></div>\" +\n                    \"</div>\")\n                    .appendTo(this.element);\n\n            let pb = $(\"<div class='k-loading-progress'>\")\n                .appendTo(loading)\n                .kendoProgressBar({\n                    type: \"chunk\", chunkCount: 10,\n                    min: 0, max: 1, value: 0\n                }).data(\"kendoProgressBar\");\n\n            deferred.progress(function(e) {\n                pb.value(e.progress);\n            })\n                .promise.finally(function() {\n                    kendo.destroy(loading);\n                    loading.remove();\n                });\n        },\n\n        _workbookPdfExport: function(e) {\n            if (this.trigger(\"pdfExport\", e)) {\n                e.preventDefault();\n            }\n        },\n\n        _workbookInsertSheet: function(e) {\n            if (this.trigger(\"insertSheet\", e)) {\n                e.preventDefault();\n            }\n        },\n\n        _workbookRemoveSheet: function(e) {\n            if (this.trigger(\"removeSheet\", e)) {\n                e.preventDefault();\n            }\n        },\n\n        _workbookSelectSheet: function(e) {\n            if (this.trigger(\"selectSheet\", e)) {\n                e.preventDefault();\n            }\n        },\n\n        _workbookRenameSheet: function(e) {\n            if (this.trigger(\"renameSheet\", e)) {\n                e.preventDefault();\n            }\n        },\n\n        _workbookInsertRow: function(e) {\n            if (this.trigger(\"insertRow\", e)) {\n                e.preventDefault();\n            }\n        },\n\n        _workbookInsertColumn: function(e) {\n            if (this.trigger(\"insertColumn\", e)) {\n                e.preventDefault();\n            }\n        },\n\n        _workbookDeleteRow: function(e) {\n            if (this.trigger(\"deleteRow\", e)) {\n                e.preventDefault();\n            }\n        },\n\n        _workbookDeleteColumn: function(e) {\n            if (this.trigger(\"deleteColumn\", e)) {\n                e.preventDefault();\n            }\n        },\n\n        _workbookHideRow: function(e) {\n            if (this.trigger(\"hideRow\", e)) {\n                e.preventDefault();\n            }\n        },\n\n        _workbookHideColumn: function(e) {\n            if (this.trigger(\"hideColumn\", e)) {\n                e.preventDefault();\n            }\n        },\n\n        _workbookUnhideRow: function(e) {\n            if (this.trigger(\"unhideRow\", e)) {\n                e.preventDefault();\n            }\n        },\n\n        _workbookUnhideColumn: function(e) {\n            if (this.trigger(\"unhideColumn\", e)) {\n                e.preventDefault();\n            }\n        },\n\n        _workbookSelect: function(e) {\n            this.trigger(\"select\", e);\n        },\n\n        _workbookChangeFormat: function(e) {\n            this.trigger(\"changeFormat\", e);\n        },\n\n        _workbookDataBinding: function(e) {\n            if (this.trigger(\"dataBinding\", e)) {\n                e.preventDefault();\n            }\n        },\n\n        _workbookDataBound: function(e) {\n            this.trigger(\"dataBound\", e);\n        },\n\n        _workbookProgress: function(e) {\n            kendo.ui.progress(this.element, e.toggle);\n        },\n\n        _bindWorkbookEvents: function() {\n            this.spreadsheetRef.bind(\"render\", this._workbookRender.bind(this));\n            this.spreadsheetRef.bind(\"cut\", this._workbookCut.bind(this));\n            this.spreadsheetRef.bind(\"copy\", this._workbookCopy.bind(this));\n            this.spreadsheetRef.bind(\"paste\", this._workbookPaste.bind(this));\n            this.spreadsheetRef.bind(\"changing\", this._workbookChanging.bind(this));\n            this.spreadsheetRef.bind(\"change\", this._workbookChange.bind(this));\n            this.spreadsheetRef.bind(\"excelExport\", this._workbookExcelExport.bind(this));\n            this.spreadsheetRef.bind(\"excelImport\", this._workbookExcelImport.bind(this));\n            this.spreadsheetRef.bind(\"pdfExport\", this._workbookPdfExport.bind(this));\n            this.spreadsheetRef.bind(\"insertSheet\", this._workbookInsertSheet.bind(this));\n            this.spreadsheetRef.bind(\"removeSheet\", this._workbookRemoveSheet.bind(this));\n            this.spreadsheetRef.bind(\"selectSheet\", this._workbookSelectSheet.bind(this));\n            this.spreadsheetRef.bind(\"renameSheet\", this._workbookRenameSheet.bind(this));\n            this.spreadsheetRef.bind(\"insertRow\", this._workbookInsertRow.bind(this));\n            this.spreadsheetRef.bind(\"insertColumn\", this._workbookInsertColumn.bind(this));\n            this.spreadsheetRef.bind(\"deleteRow\", this._workbookDeleteRow.bind(this));\n            this.spreadsheetRef.bind(\"deleteColumn\", this._workbookDeleteColumn.bind(this));\n            this.spreadsheetRef.bind(\"hideRow\", this._workbookHideRow.bind(this));\n            this.spreadsheetRef.bind(\"hideColumn\", this._workbookHideColumn.bind(this));\n            this.spreadsheetRef.bind(\"unhideRow\", this._workbookUnhideRow.bind(this));\n            this.spreadsheetRef.bind(\"unhideColumn\", this._workbookUnhideColumn.bind(this));\n            this.spreadsheetRef.bind(\"select\", this._workbookSelect.bind(this));\n            this.spreadsheetRef.bind(\"changeFormat\", this._workbookChangeFormat.bind(this));\n            this.spreadsheetRef.bind(\"dataBinding\", this._workbookDataBinding.bind(this));\n            this.spreadsheetRef.bind(\"dataBound\", this._workbookDataBound.bind(this));\n            this.spreadsheetRef.bind(\"progress\", this._workbookProgress.bind(this));\n        },\n\n        destroy: function() {\n            kendo.ui.Widget.fn.destroy.call(this);\n\n            this._formulaBarInputRefPopup?.destroy();\n            this._formulaCellInputRefPopup?.destroy();\n            this._formulaBarInputRefList?.destroy();\n            this._formulaCellInputRefList?.destroy();\n\n            this._formulaBarInputRefList = this._formulaCellInputRefList = null;\n            this._formulaBarInputRefPopup = this._formulaCellInputRefPopup = null;\n\n            if (this.menu) {\n                this.menu.destroy();\n            }\n\n            if (this.toolbar) {\n                this.toolbar.destroy();\n            }\n\n            if (this.sheetsBar) {\n                this.sheetsBar.destroy();\n            }\n\n            this._dialogs?.forEach(function(dialog) {\n                dialog?.destroy();\n            });\n\n            this.spreadsheetRef?.destroy();\n\n            this._cellContextMenu?.destroy();\n\n            this._rowHeaderContextMenu?.destroy();\n            this._colHeaderContextMenu?.destroy();\n            this._drawingContextMenu?.destroy();\n\n            this._cellContextMenu = this._rowHeaderContextMenu =\n                this._colHeaderContextMenu =\n                this._drawingContextMenu = null;\n\n            if (this._resizeHandler) {\n                $(window).off(\"resize\" + NS, this._resizeHandler);\n            }\n\n            kendo.destroy(this.element);\n        },\n\n        options: {\n            name: \"Spreadsheet\",\n            toolbar: true,\n            sheetsbar: true,\n            rows: 200,\n            columns: 50,\n            rowHeight: 30,\n            columnWidth: 64,\n            headerHeight: 30,\n            headerWidth: 32,\n            excel: {\n                proxyURL: \"\",\n                fileName: \"Workbook.xlsx\"\n            },\n            messages: {},\n            pdf: {\n                // which part of the workbook to be exported\n                area: \"workbook\",\n                fileName: \"Workbook.pdf\",\n                proxyURL: \"\",\n                // paperSize can be an usual name, i.e. \"A4\", or an array of two Number-s specifying the\n                // width/height in points (1pt = 1/72in), or strings including unit, i.e. \"10mm\".  Supported\n                // units are \"mm\", \"cm\", \"in\" and \"pt\".  The default \"auto\" means paper size is determined\n                // by content.\n                paperSize: \"a4\",\n                // True to reverse the paper dimensions if needed such that width is the larger edge.\n                landscape: true,\n                // An object containing { left, top, bottom, right } margins with units.\n                margin: null,\n                // Optional information for the PDF Info dictionary; all strings except for the date.\n                title: null,\n                author: null,\n                subject: null,\n                keywords: null,\n                creator: \"Kendo UI PDF Generator v.\" + kendo.version,\n                // Creation Date; defaults to new Date()\n                date: null\n            },\n            defaultCellStyle: {\n                fontFamily: \"Arial\",\n                fontSize: 12\n            },\n            useCultureDecimals: false\n        },\n\n        defineName: function(name, value, hidden) {\n            return this.spreadsheetRef.defineName(name, value, hidden);\n        },\n\n        undefineName: function(name) {\n            return this.spreadsheetRef.undefineName(name);\n        },\n\n        nameValue: function(name) {\n            return this.spreadsheetRef.nameValue(name);\n        },\n\n        forEachName: function(func) {\n            return this.spreadsheetRef.forEachName(func);\n        },\n\n        cellContextMenu: function() {\n            return this._cellContextMenu;\n        },\n\n        rowHeaderContextMenu: function() {\n            return this._rowHeaderContextMenu;\n        },\n\n        colHeaderContextMenu: function() {\n            return this._colHeaderContextMenu;\n        },\n\n        addImage: function(image) {\n            return this.spreadsheetRef.addImage(image);\n        },\n\n        cleanupImages: function() {\n            return this.spreadsheetRef.cleanupImages();\n        },\n\n        events: [\n            \"cut\",\n            \"copy\",\n            \"paste\",\n            \"pdfExport\",\n            \"excelExport\",\n            \"excelImport\",\n            \"changing\",\n            \"change\",\n            \"render\",\n            \"removeSheet\",\n            \"selectSheet\",\n            \"renameSheet\",\n            \"insertRow\",\n            \"insertColumn\",\n            \"deleteRow\",\n            \"insertSheet\",\n            \"deleteColumn\",\n            \"hideRow\",\n            \"hideColumn\",\n            \"unhideRow\",\n            \"unhideColumn\",\n            \"select\",\n            \"changeFormat\",\n            \"dataBinding\",\n            \"dataBound\"\n        ]\n    });\n\n    kendo.ui.plugin(Spreadsheet);\n    $.extend(true, Spreadsheet, { classNames: classNames });\n})(window.kendo);\nexport default kendo;\n\n"],"mappings":";29EAMC,SAAS,EAAO,CACb,IAAI,EAAI,EAAM,OACV,EAAmB,EAAM,KAAK,iBAE9B,EAAW,EAAM,YAAY,SAAS,QAAU,CAChD,MAAO,QACP,KAAM,OACN,OAAQ,SACR,OAAQ,SACR,MAAO,QACP,OAAQ,SACR,OAAQ,KACR,kBAAmB,CACf,MAAO,SACP,WAAY,CACR,OAAQ,SACR,SAAU,WACV,KAAM,OACT,CACJ,CACD,iBAAkB,CACd,MAAO,OACV,CACD,eAAgB,CACZ,MAAO,YACV,CACD,cAAe,CACX,MAAO,UACV,CACD,gBAAiB,CACb,MAAO,YACP,QAAS,CACL,YAAa,aACb,cAAe,SACf,aAAc,cACd,YAAa,UACb,SAAU,YACV,YAAa,eACb,YAAa,eAChB,CACJ,CACD,YAAa,CACT,MAAO,cACP,QAAS,CACL,WAAY,YACZ,kBAAmB,qBACnB,gBAAiB,mBACjB,QAAS,UACZ,CACJ,CACD,aAAc,CACV,MAAO,eACP,QAAS,CACL,YAAa,eACb,WAAY,cACZ,cAAe,iBACf,SAAU,iBACb,CACJ,CACD,mBAAoB,CAChB,KAAM,8CACN,MAAO,eACV,CACD,iBAAkB,CACd,MAAO,kBACP,YAAa,sCACb,UAAW,iBACX,SAAU,CACN,IAAK,YACL,OAAQ,SACR,KAAM,OACN,KAAM,OACN,OAAQ,iBACR,KAAM,OACT,CACD,UAAW,CACP,YAAa,eACb,SAAU,YACV,QAAS,UACT,WAAY,cACZ,QAAS,WACT,WAAY,eACZ,qBAAsB,2BACtB,kBAAmB,wBACtB,CACD,iBAAkB,CACd,YAAa,mBACb,SAAU,gBACV,QAAS,sBACT,WAAY,0BACZ,QAAS,eACT,WAAY,mBACZ,qBAAsB,+BACtB,kBAAmB,4BACnB,OAAQ,kCACX,CACD,OAAQ,CACJ,SAAU,WACV,SAAU,WACV,IAAK,MACL,IAAK,MACL,MAAO,QACP,MAAO,QACP,IAAK,MACL,cAAe,kBACf,YAAa,eACb,YAAa,eACb,SAAU,YACV,UAAW,aACX,YAAa,eACb,YAAa,eACb,eAAgB,8BAChB,mBAAoB,kCACvB,CACD,aAAc,CACV,UAAW,aACX,YAAa,eAChB,CACJ,CACD,eAAgB,CACZ,MAAO,YACP,gBAAiB,WACjB,KAAM,CACF,YAAa,yBAChB,CACD,IAAK,CACD,YAAa,kCACb,KAAM,CACF,SAAU,kBACV,MAAO,eACP,UAAW,YACd,CACD,MAAO,CACH,GAAY,uBACZ,GAAY,uBACZ,GAAY,uBACZ,GAAY,uBACZ,GAAY,uBACZ,GAAY,uBACZ,GAAY,uBACZ,MAAY,qBACZ,MAAY,qBACZ,OAAY,sBACZ,QAAY,sBACZ,UAAY,4BACf,CACD,OAAQ,CACJ,OAAQ,SACR,OAAQ,SACR,KAAM,OACT,CACJ,CACD,OAAQ,CACJ,MAAO,QACP,IAAK,cACL,SAAU,YACV,WAAY,eACZ,WAAY,SACZ,UAAW,aACX,QAAS,UACT,YAAa,cACb,MAAO,QACP,WAAY,aACZ,OAAQ,SACR,aAAc,eACd,WAAY,aACf,CACJ,CACD,mBAAoB,CAChB,aAAc,uCACjB,CACD,oBAAqB,CACjB,aAAc,6CACjB,CACD,sBAAuB,CACnB,aAAc,oCACjB,CACD,yBAA0B,CACtB,aAAc,sBACjB,CACD,sBAAuB,CACnB,aAAc,kCACjB,CACD,yBAA0B,CACtB,aAAc,uBACjB,CACD,eAAgB,CACZ,aAAc,0FACjB,CACD,kBAAmB,CACf,MAAO,sBACP,aAAc,+FACd,OAAQ,CACJ,QAAS,WACT,OAAQ,UACR,SAAU,YACb,CACJ,CACD,2BAA4B,CACxB,aAAc,yDACjB,CACD,WAAY,CACR,MAAO,YACP,OAAQ,CACJ,KAAM,OACN,IAAK,UACL,WAAY,cACf,CACJ,CACD,kBAAmB,CACf,MAAO,eACP,OAAQ,CACJ,KAAM,eACN,OAAQ,SACX,CACJ,CACD,oBAAqB,CACjB,MAAO,iBACP,OAAQ,CACJ,QAAS,UACT,cAAe,iBAClB,CACJ,CACD,kBAAmB,CACf,MAAO,eACP,KAAM,yCACN,UAAW,yCACd,CACJ,CAEG,EAAW,EAAE,CACjB,EAAM,YAAY,QAAU,CACxB,SAAU,SAAS,EAAM,EAAa,CAClC,EAAS,GAAQ,GAErB,WAAY,SAAS,EAAM,CACvB,MAAO,CAAC,CAAC,EAAS,IAEtB,OAAQ,SAAS,EAAM,EAAS,CAC5B,IAAI,EAAc,EAAS,GAE3B,GAAI,EACA,OAAO,IAAI,EAAY,EAAQ,EAG1C,CAED,IAAI,EAAoB,EAAM,YAAY,kBAAoB,EAAM,WAAW,OAAO,CAClF,KAAM,SAAS,EAAS,CACpB,EAAM,WAAW,GAAG,KAAK,KAAK,KAAM,EAAQ,CAE5C,KAAK,QAAU,EAAU,EAAE,OAAO,GAAM,EAAE,CAAE,KAAK,QAAS,EAAQ,CAAC,CAEnE,KAAK,KAAK,KAAK,OAAQ,EAAQ,EAEnC,OAAQ,CACJ,QACA,WACH,CACD,QAAS,CACL,UAAW,GACd,CACD,OAAQ,UAAW,CACf,GAAI,CAAC,KAAK,QAAS,CACf,IAAI,EAAU,CACV,UAAW,GACX,WAAY,GACZ,UAAW,GACX,MAAO,GACP,QAAS,GACT,MAAO,KAAK,QAAQ,OAAS,IAC7B,MAAO,KAAK,QAAQ,MACpB,KAAM,UAAW,CACb,KAAK,QAAQ,EAEjB,MAAO,KAAK,eAAe,KAAK,KAAK,CACrC,SAAU,KAAK,kBAAkB,KAAK,KAAK,CAC3C,WAAY,KAAK,oBAAoB,KAAK,KAAK,CAClD,CACD,KAAK,QAAU,EAAE,yEAAyE,CACrF,SAAS,KAAK,QAAQ,WAAa,GAAG,CACtC,OAAO,EAAM,SAAS,KAAK,QAAQ,SAAS,CAAC,CAC1C,SAAU,EAAM,YAAY,SAAS,SAAW,EAChD,GAAI,EAAM,GAKV,OAAQ,KAAK,QAAQ,OACxB,CAAC,CAAC,CACF,YAAY,EAAQ,CACpB,KAAK,cAAc,CAG5B,OAAO,KAAK,SAEhB,eAAgB,UAAW,CACvB,KAAK,QAAQ,QAAS,CAClB,OAAQ,KAAK,QAChB,CAAC,EAEN,kBAAmB,UAAW,CAC1B,KAAK,QAAQ,WAAW,EAE5B,oBAAqB,UAAW,CAC5B,KAAK,QAAQ,aAAa,CAC1B,KAAK,SAAS,EAElB,QAAS,UAAW,CAChB,AAEI,KAAK,WADL,KAAK,QAAQ,SAAS,CACP,OAGvB,KAAM,UAAW,CACb,KAAK,QAAQ,CAAC,MAAM,CACpB,KAAK,QAAQ,CAAC,QAAQ,KAAK,oBAAoB,CAAC,QAAQ,QAAQ,EAEpE,MAAO,UAAW,CACd,KAAK,OAAO,EAEhB,MAAO,UAAW,CACd,KAAK,QAAU,QAEf,KAAK,QAAQ,CAAC,OAAO,EAE5B,CAAC,CAEF,SAAS,EAAe,EAAO,EAAQ,CACnC,OAAO,EAAM,YAAY,WAAW,KAAK,EAAO,EAAO,CAG3D,IAAI,EAAuB,EAAM,YAAY,qBAAuB,EAAiB,OAAO,CACxF,KAAM,SAAS,EAAS,CACpB,EAAiB,GAAG,KAAK,KAAK,KAAM,EAAQ,CAE5C,KAAK,YAAY,KAAK,SAAS,EAEnC,YAAa,SAAS,EAAU,CAC5B,IAAI,EAAO,GAAY,EAAS,MAAQ,SACpC,EAAiB,GAAQ,WAE7B,KAAK,SAAW,EAEhB,KAAK,IAAI,qBAAsB,GAAkB,KAAK,WAAW,OAAS,EAAE,CAEvE,EAGD,KAAK,SAAS,KAAK,WAAW,GAAG,CAFjC,KAAK,IAAI,UAAW,KAAK,WAAW,EAAO,WAAW,CAK1D,KAAK,gBAAgB,EAEzB,eAAgB,UAAW,CACnB,KAAK,QAAQ,QACb,KAAK,IAAI,SAAU,KAAK,QAAQ,GAAG,MAAM,EAGjD,SAAU,SAAS,EAAU,CACzB,GAAI,IAAa,OAAW,CACxB,KAAK,UAAY,EAEjB,IAAI,EAAO,EAAS,MAChB,EAAU,CACV,CAAE,SAAU,EAAM,SAAU,GAAM,CAClC,CAAE,SAAU,EAAM,SAAU,GAAM,IAAK,GAAM,CAC7C,CAAE,SAAU,EAAM,SAAU,GAAO,CACtC,CAED,EAAU,EAAQ,IAAI,SAAS,EAAQ,CAGnC,MAFA,GAAS,EAAqB,QAAQ,SAAS,EAAO,CAE/C,CAAE,MAAO,EAAQ,KAAM,EAAe,IAAM,EAAO,CAAE,EAC9D,CAEF,KAAK,IAAI,UAAW,EAAQ,CAE5B,KAAK,gBAAgB,CAGzB,OAAO,KAAK,WAAa,KAAK,WAAW,IAE7C,eAAgB,SAAS,EAAU,CAK/B,OAJI,IAAa,QACb,KAAK,YAAY,EAAS,CAGvB,KAAK,UAEhB,QAAS,UAAW,CAChB,IAAI,EAAS,KAAK,IAAI,SAAS,CAC3B,EAAQ,KAAK,OAAS,EAKtB,OAHA,GAAU,EAAO,OACV,EAAe,EAAO,EAAO,CAE7B,GAGlB,CAAC,CAEF,EAAqB,QAAU,CAC3B,SAAU,SAAS,EAAS,CACxB,SAAS,EAAO,EAAO,EAAG,CACtB,OAAW,MAAM,EAAE,EAAE,CAAC,KAAK,EAAM,CAIrC,IAAI,EAAO,EAAQ,SACf,EAAS,EAAK,QAAQ,GAc1B,OAZI,EAAQ,WACR,EAAS,EAAO,QAAQ,KAAM,IAAM,EAAK,KAAO,EAAO,IAAK,EAAK,SAAS,CAAC,EAG/E,AAGI,EAHA,EAAQ,IACC,IAAM,EAAK,KAAO,KAAO,EAAO,QAAQ,YAAa,GAAG,CAExD,EAAO,QAAQ,MAAO,KAAK,UAAU,EAAK,OAAO,CAAC,CAG/D,EAAS,EAAO,QAAQ,KAAM,IAAI,CAE3B,GAEX,KAAM,SAAS,EAAQ,CAKnB,MAJK,MAAO,KAAK,EAAO,CACb,GAGJ,EAAO,aAAa,CAAC,QAAQ,MAAO,QAAQ,CAAC,QAAQ,KAAM,IAAI,EAE7E,CAED,SAAS,EAAS,EAAO,EAAO,CAI5B,IAAK,IAHD,EAAS,EAAE,CACX,EAAS,EAAE,CAEN,EAAI,EAAG,EAAI,EAAM,OAAQ,IAC1B,EAAE,QAAQ,EAAM,GAAG,GAAQ,EAAO,EAAI,KACtC,EAAO,KAAK,EAAM,GAAG,CACrB,EAAO,KAAK,EAAM,GAAG,GAAO,EAIpC,OAAO,EAGX,IAAI,EAAoB,EAAkB,OAAO,CAC7C,KAAM,SAAS,EAAS,CACpB,IAAI,EAAW,EAAM,YAAY,SAAS,QAAQ,mBAAqB,EACnE,EAAiB,CACjB,MAAO,EAAS,MAChB,WAAY,CACR,CAAE,KAAM,SAAU,KAAM,EAAS,WAAW,OAAQ,CACpD,CAAE,KAAM,WAAY,KAAM,EAAS,WAAW,SAAU,CACxD,CAAE,KAAM,OAAQ,KAAM,EAAS,WAAW,KAAM,CACnD,CACJ,CAED,EAAkB,GAAG,KAAK,KAAK,KAAM,EAAE,OAAO,EAAgB,EAAQ,CAAC,CAEvE,KAAK,kBAAkB,EAE3B,QAAS,CACL,UAAW,6BACX,SAAW,GAAS,CAChB,IAAI,EAKJ,MAJA,GAAe,oEAAoE,EAAM,WAAW,EAAK,GAAG,CAAC,uBAAuB,EAAM,WAAW,EAAK,GAAG,CAAC,yBAAyB,EAAM,WAAW,EAAK,GAAG,CAAC,wDAAwD,EAAM,WAAW,EAAK,GAAG,CAAC;8CACrQ,EAAM,WAAW,EAAK,GAAG,CAAC,0CAA0C,EAAM,WAAW,EAAK,GAAG,CAAC,mDAAmD,EAAM,WAAW,EAAK,GAAG,CAAC,gCAAgC,EAAM,WAAW,EAAK,GAAG,CAAC,gCAAgC,EAAM,WAAW,EAAK,GAAG,CAAC,4FAA4F,EAAM,WAAW,EAAK,GAAG,CAAC,8GAA8G,EAAM,WAAW,EAAK,GAAG,CAAC,qCAAqC,EAAM,WAAW,EAAK,GAAG,CAAC,8BAA8B,EAAM,WAAW,EAAK,GAAG,CAAC,2BAA2B,EAAM,WAAW,EAAK,GAAG,CAAC;4EAC3qB,EAAM,WAAW,EAAK,GAAG,CAAC,kDAAkD,EAAM,WAAW,EAAK,SAAS,MAAM,CAAC,gDAAgD,EAAM,WAAW,EAAK,GAAG,CAAC,kDAAkD,EAAM,WAAW,EAAK,SAAS,OAAO,CAAC;QAE1U,GAEd,CACD,iBAAkB,UAAW,CACzB,IAAI,EAAU,KAAK,QAenB,GAbA,AACI,EAAQ,aAAa,EAAkB,eAAe,EAAM,SAAS,CAGzE,AACI,EAAQ,gBAAgB,CACpB,CAAE,MAAO,QAAS,KAAM,UAAW,CACnC,CAAE,MAAO,KAAM,KAAM,OAAQ,CAC7B,CAAE,MAAO,OAAQ,KAAM,UAAW,CAClC,CAAE,MAAO,WAAY,KAAM,WAAY,CAC1C,CAGD,CAAC,EAAQ,YAAa,CACtB,IAAI,EAAmB,EAAM,SAAS,QAAQ,UAAU,SAAS,SAEjE,EAAQ,YAAc,EAAS,QAAS,EAAE,IAAI,EAAkB,SAAS,EAAQ,CAC7E,KAAS,EAAqB,QAAQ,KAAK,EAAO,CAE7C,EAIL,MAAO,CAAE,MAAO,EAAQ,KAAM,EAAe,WAAY,EAAO,CAAE,EACpE,CAAC,GAGX,KAAM,SAAS,EAAO,CAClB,IAAI,EAAU,KAAK,QACf,EAAQ,EAAM,OAAO,CACrB,EAAa,EAAQ,WAAW,MAAM,EAAE,CACxC,EAEJ,KAAK,UAAY,IAAI,EAAqB,CACtC,WAAY,EAAQ,WAAW,MAAM,EAAE,CACvC,WAAY,CACR,cAAe,EAAQ,cAAc,MAAM,EAAE,CAC7C,YAAa,EAAQ,YAAY,MAAM,EAAE,CAC5C,CACW,aACZ,OAAQ,EAAM,QAAQ,CACtB,SAAU,aAAiB,KAAO,EAAW,GAAK,EAAW,GAC7D,MAAO,KAAK,MAAM,KAAK,KAAK,CAC5B,MAAO,KAAK,MAAM,KAAK,KAAK,CACrB,QACP,mBAAqB,GAAS,EAAM,WAAW,EAAK,KAAK,CAC5D,CAAC,CAEF,EAAkB,GAAG,KAAK,KAAK,KAAK,CAEpC,EAAU,KAAK,QAAQ,CAAC,QAExB,EAAM,KAAK,EAAS,KAAK,UAAU,CAEnC,IAAI,EAAiB,EAAQ,KAAK,yBAAyB,CAAC,KAAK,oBAAoB,CAEjF,EAAQ,WAAW,OAAS,IAC5B,EAAe,WAAW,CAAE,OAAQ,WAAY,CAAC,CAGrD,EAAQ,KAAK,EAAM,aAAa,aAAa,CAAC,CAAC,QAAQ,CAAC,SAAS,iBAAiB,CAElF,EAAQ,KAAK,mBAAmB,CAAC,KAAK,gBAAiB,eAAe,EAE1E,MAAO,UAAW,CACd,IAAI,EAAS,KAAK,UAAU,OAE5B,EAAkB,GAAG,MAAM,KAAK,KAAK,CAErC,KAAK,QAAQ,SAAU,CACnB,QAAS,wBACT,QAAS,CACL,SAAU,SACV,MAAO,EACV,CACJ,CAAC,EAET,CAAC,CAEF,EAAkB,eAAiB,SAAU,EAAU,CACnD,OAAO,EAAS,cAAe,EAAE,IAAI,EAAU,SAAS,EAAS,EAAM,CAC7D,OAAK,KAAK,EAAK,CAIrB,KAAI,EAAW,EAAQ,aAAa,SAQpC,MAAO,CAAe,YAPJ,EAAM,OACpB,iBACA,EAAS,KACT,EAAS,KACT,EAAS,OACZ,CAEkC,MAAO,EAAU,GACtD,CAAC,EAGP,EAAM,YAAY,QAAQ,SAAS,cAAe,EAAkB,CAEpE,EAAM,YAAY,QAAQ,kBAAoB,EAE9C,IAAI,EAAgB,EAAkB,OAAO,CACzC,QAAS,CACL,UAAW,wBACX,MAAO,GACP,UAAW,GACX,KAAM,GACN,SAAW,GAAS,CAChB,IAAI,EAKJ,MAJA,GAAe,mDAAmD,EAAM,WAAW,EAAK,GAAG,CAAC;;eAE7F,EAAM,WAAW,EAAK,GAAG,CAAC;oCACL,EAAK,SAAS,OAAO,wBAClC,GAEd,CACD,KAAM,UAAW,CACb,EAAkB,GAAG,KAAK,KAAK,KAAK,CAEpC,IAAI,EAAU,KAAK,QACf,EAAO,EAAQ,KAEf,EAAQ,YACR,EAAO,EAAM,OAAO,EAAQ,UAAW,GAAK,CAAC,EAAM,YAAY,SAAS,QAAQ,EAGpF,EAAM,KAAK,KAAK,QAAQ,CAAC,QAAS,CACxB,OACN,MAAO,KAAK,MAAM,KAAK,KAAK,CAC/B,CAAC,EAET,CAAC,CAEF,EAAM,YAAY,QAAQ,SAAS,UAAW,EAAc,CAE5D,IAAI,EAAqB,EAAkB,OAAO,CAC9C,KAAM,SAAS,EAAS,CACpB,IAAI,EAAW,EAAM,YAAY,SAAS,QAAQ,oBAAsB,EACpE,EAAiB,CACjB,MAAO,EAAS,MAChB,KAAM,EAAS,KAClB,CAED,EAAkB,GAAG,KAAK,KAAK,KAAM,EAAE,OAAO,EAAgB,EAAQ,CAAC,EAE3E,QAAS,CACL,UAAW,wBACX,UAAW,GACX,SAAW,GAAS,CAChB,IAAI,EAQJ,MAPA,GAAe,mDAAmD,EAAM,WAAW,EAAK,GAAG,CAAC;;eAE7F,EAAM,WAAW,EAAK,GAAG,CAAC;oCACL,EAAK,SAAS,OAAO;;eAE1C,EAAM,WAAW,EAAK,GAAG,CAAC;oCACL,EAAK,SAAS,OAAO,wBAClC,GAEd,CACD,KAAM,UAAW,CACb,EAAkB,GAAG,KAAK,KAAK,KAAK,CAEpC,IAAI,EAAU,KAAK,QACf,EAAO,EAAQ,KAEf,EAAQ,YACR,EAAO,EAAM,OAAO,EAAQ,UAAW,GAAK,CAAC,EAAM,YAAY,SAAS,QAAQ,EAGpF,EAAM,KAAK,KAAK,QAAQ,CAAC,QAAS,CACxB,OACN,QAAS,KAAK,QAAQ,KAAK,KAAK,CAChC,OAAQ,KAAK,MAAM,KAAK,KAAK,CAChC,CAAC,EAEN,YAAa,UAAW,CACpB,OAAO,KAAK,YAEhB,QAAS,UAAW,CAChB,KAAK,WAAa,GAClB,KAAK,OAAO,EAEnB,CAAC,CAEF,EAAM,YAAY,QAAQ,SAAS,eAAgB,EAAmB,CAEtE,IAAI,EAAwB,EAAkB,OAAO,CACjD,QAAS,CACL,UAAW,wBACX,MAAO,GACP,UAAW,GACX,KAAM,GACN,SAAW,GAAS,CAChB,IAAI,EAEJ,MADA,GAAe,mDAAmD,EAAM,WAAW,EAAK,GAAG,CAAC,gGAAgG,EAAM,WAAW,EAAK,GAAG,CAAC,kDAAkD,EAAK,SAAS,MAAM,gDAAgD,EAAM,WAAW,EAAK,GAAG,CAAC,mDAAmD,EAAK,SAAS,OAAO,wBACva,GAEd,CACD,KAAM,UAAW,CACb,EAAkB,GAAG,KAAK,KAAK,KAAK,CAEpC,IAAI,EAAU,KAAK,QACf,EAAO,EAAQ,KAEf,EAAQ,YACR,EAAO,EAAM,OAAO,EAAQ,UAAW,GAAK,CAAC,EAAM,YAAY,SAAS,QAAQ,EAGpF,EAAM,KAAK,KAAK,QAAQ,CAAC,QAAS,CACxB,OACN,MAAO,KAAK,MAAM,KAAK,KAAK,CAC5B,OAAQ,KAAK,MAAM,KAAK,KAAK,CAChC,CAAC,EAEN,MAAO,UAAW,CACd,KAAK,OAAS,GACd,KAAK,OAAO,EAEnB,CAAC,CAEF,EAAM,YAAY,QAAQ,SAAS,kBAAmB,EAAsB,CAE5E,IAAI,EAAmB,EAAkB,OAAO,CAC5C,KAAM,SAAS,EAAS,CACpB,IAAI,EAAW,EAAM,YAAY,SAAS,QAAQ,kBAAoB,EAEtE,EAAkB,GAAG,KAAK,KAAK,KAAM,EAAE,OAAO,CAAE,MAAO,EAAS,MAAO,CAAE,EAAQ,CAAC,CAElF,KAAK,OAAO,EAEhB,QAAS,CACL,aAAgB,mCACnB,CACD,MAAO,UAAW,CACd,IAAI,EAAK,KAAK,QAAQ,CAAC,QAAQ,KAAK,KAAK,CACrC,EAAQ,KAAK,QAAQ,QACrB,EAAc,KAAK,QAAQ,QAE/B,KAAK,KAAO,IAAI,EAAM,GAAG,WAAW,EAAI,CACpC,WAAY,IAAI,EAAM,KAAK,WAAW,CAAE,KAAM,EAAO,CAAC,CACtD,SAAW,GAAS,EAAM,WAAW,EAAK,CAC1C,MAAO,EACP,OAAQ,KAAK,MAAM,KAAK,KAAK,CAChC,CAAC,CAEF,KAAK,KAAK,WAAW,OAAO,EAEhC,MAAO,SAAS,EAAG,CACf,EAAkB,GAAG,MAAM,KAAK,KAAK,CAErC,KAAK,QAAQ,SAAU,CACnB,QAAS,wBACT,QAAS,CACL,SAAU,aACV,MAAO,EAAE,OAAO,OAAO,CAAC,GAC3B,CACJ,CAAC,EAET,CAAC,CAEF,EAAM,YAAY,QAAQ,SAAS,aAAc,EAAiB,CAElE,IAAI,EAAiB,EAAkB,OAAO,CAC1C,KAAM,SAAS,EAAS,CACpB,IAAI,EAAW,EAAM,YAAY,SAAS,QAAQ,gBAAkB,EAEpE,EAAkB,GAAG,KAAK,KAAK,KAAM,EAAE,OAAO,CAAE,MAAO,EAAS,MAAO,CAAE,EAAQ,CAAC,CAElF,KAAK,OAAO,EAEhB,QAAS,CACL,aAAgB,mCACnB,CACD,MAAO,UAAW,CACd,IAAI,EAAK,KAAK,QAAQ,CAAC,QAAQ,KAAK,KAAK,CACrC,EAAQ,KAAK,QAAQ,QACrB,EAAc,KAAK,QAAQ,QAE/B,KAAK,KAAO,IAAI,EAAM,GAAG,WAAW,EAAI,CACpC,WAAY,IAAI,EAAM,KAAK,WAAW,CAAE,KAAM,EAAO,CAAC,CACtD,SAAW,GAAS,EAAM,WAAW,EAAK,CAC1C,MAAO,EACP,OAAQ,KAAK,MAAM,KAAK,KAAK,CAChC,CAAC,CAEF,KAAK,KAAK,WAAW,OAAO,EAEhC,MAAO,SAAS,EAAG,CACf,EAAkB,GAAG,MAAM,KAAK,KAAK,CAErC,KAAK,QAAQ,SAAU,CACnB,QAAS,wBACT,QAAS,CACL,SAAU,WACV,MAAO,EAAM,SAAS,EAAE,OAAO,OAAO,CAAC,GAAG,CAC7C,CACJ,CAAC,EAET,CAAC,CAEF,EAAM,YAAY,QAAQ,SAAS,WAAY,EAAe,CAE9D,IAAI,EAAgB,EAAkB,OAAO,CACzC,KAAM,SAAS,EAAS,CACpB,IAAI,EAAW,EAAM,YAAY,SAAS,QAAQ,eAAiB,EAEnE,EAAkB,GAAG,KAAK,KAAK,KAAM,EAAE,OAAO,CAAE,MAAO,EAAS,MAAO,CAAE,EAAQ,CAAC,CAElF,KAAK,QAAU,KAAK,QAAQ,CAAC,QAC7B,KAAK,gBAAgB,CAErB,KAAK,UAAY,EAAM,WAAW,CAC9B,MAAO,KAAK,MAAM,KAAK,KAAK,CAC5B,MAAO,KAAK,MAAM,KAAK,KAAK,CAC/B,CAAC,CAEF,EAAM,KAAK,KAAK,QAAQ,KAAK,aAAa,CAAE,KAAK,UAAU,EAE/D,QAAS,CACL,SAAW,GAAS,CAChB,IAAI,EAQJ,MAPA,GAAe;;eAEhB,EAAM,WAAW,EAAK,GAAG,CAAC;oCACL,EAAM,WAAW,EAAK,SAAS,MAAM,CAAC;;eAE3D,EAAM,WAAW,EAAK,GAAG,CAAC;oCACL,EAAM,WAAW,EAAK,SAAS,OAAO,CAAC,wBACpD,GAEd,CACD,MAAO,UAAW,CACd,EAAkB,GAAG,MAAM,KAAK,KAAK,CAErC,IAAI,EAAQ,KAAK,cAAc,OAAO,CAElC,EAAM,OAAS,EAAM,MACrB,KAAK,QAAQ,SAAU,CACnB,QAAS,sBACT,QAAS,CACL,OAAQ,EAAM,KACd,MAAO,CAAE,KAAM,EAAG,MAAO,EAAM,MAAO,CACzC,CACJ,CAAC,EAGV,eAAgB,UAAW,CACvB,IAAI,EAAU,KAAK,QAAQ,CAAC,QAAQ,KAAK,MAAM,CAAC,OAAO,CAEvD,KAAK,cAAgB,IAAI,EAAM,YAAY,cAAc,EAAS,CAC9D,OAAQ,KAAK,MAAM,KAAK,KAAK,CAChC,CAAC,EAEN,MAAO,SAAS,EAAO,CACnB,GAAI,IAAU,OACV,OAAO,KAAK,OAEZ,KAAK,OAAS,GAGzB,CAAC,CAEF,EAAM,YAAY,QAAQ,SAAS,UAAW,EAAc,CAE5D,IAAI,EAAe,EAAkB,OAAO,CACxC,KAAM,SAAS,EAAS,CACpB,EAAkB,GAAG,KAAK,KAAK,KAAM,EAAQ,CAE7C,KAAK,QAAU,KAAK,QAAQ,CAAC,QAC7B,KAAK,SAAW,EAAQ,SACxB,KAAK,QAAQ,MAAQ,EAAQ,MAE7B,KAAK,UAAY,EAAM,WAAW,CAC9B,MAAO,KAAK,MAAM,KAAK,KAAK,CAC5B,MAAO,KAAK,MAAM,KAAK,KAAK,CAC/B,CAAC,CAEF,EAAM,KAAK,KAAK,QAAQ,KAAK,aAAa,CAAE,KAAK,UAAU,EAE/D,QAAS,CACL,SAAW,GAAS,CAChB,IAAI,EAQJ,MAPA,GAAe;;eAEhB,EAAM,WAAW,EAAK,GAAG,CAAC;oCACL,EAAM,WAAW,EAAK,SAAS,MAAM,CAAC;;eAE3D,EAAM,WAAW,EAAK,GAAG,CAAC;oCACL,EAAM,WAAW,EAAK,SAAS,OAAO,CAAC,wBACpD,GAEd,CACD,MAAO,UAAW,CACd,EAAkB,GAAG,MAAM,KAAK,KAAK,CAErC,KAAK,QAAQ,SAAU,CACnB,QAAS,wBACT,QAAS,CACL,SAAU,KAAK,SACf,MAAO,KAAK,OAAO,CACtB,CACJ,CAAC,EAEN,MAAO,SAAS,EAAG,CACf,GAAI,IAAM,OACN,OAAO,KAAK,OAEZ,KAAK,OAAS,EAAE,OAG3B,CAAC,CAEE,EAAoB,EAAa,OAAO,CACxC,KAAM,SAAS,EAAS,CACpB,EAAQ,MAAQ,IAChB,EAAa,GAAG,KAAK,KAAK,KAAM,EAAQ,CACxC,KAAK,eAAe,EAExB,cAAe,UAAW,CAEtB,KAAK,aADS,KAAK,QAAQ,CAAC,QAAQ,KAAK,MAAM,CAAC,OAAO,CAC3B,kBAAkB,CAC1C,QAAS,4eAOR,CACD,OAAQ,KAAK,MAAM,KAAK,KAAK,CAChC,CAAC,CAAC,KAAK,oBAAoB,EAEnC,CAAC,CAEF,EAAM,YAAY,QAAQ,SAAS,cAAe,EAAkB,CAEpE,IAAI,EAAoB,EAAa,OAAO,CACxC,KAAM,SAAS,EAAS,CACpB,EAAQ,MAAQ,IAChB,EAAa,GAAG,KAAK,KAAK,KAAM,EAAQ,CACxC,KAAK,QAAQ,CAAC,WAAW,CAAE,UAAW,GAAO,CAAC,CAC9C,KAAK,QAAQ,CAAC,IAAI,WAAY,KAAK,aAAa,KAAK,KAAK,CAAC,EAE/D,aAAc,UAAW,CAErB,KAAK,YADS,KAAK,QAAQ,CAAC,QAAQ,KAAK,MAAM,CAAC,OAAO,CAC5B,qBAAqB,CAC5C,OAAQ,KAAK,MAAM,KAAK,KAAK,CAChC,CAAC,CAAC,KAAK,uBAAuB,EAEtC,CAAC,CAEF,EAAM,YAAY,QAAQ,SAAS,cAAe,EAAkB,CAEpE,IAAI,EAAkB,EAAkB,OAAO,CAC3C,KAAM,SAAS,EAAS,CACpB,IAAI,EAAW,EAAM,YAAY,SAAS,QAAQ,iBAAmB,EACjE,EAAiB,CACjB,MAAO,EAAS,MAChB,QAAS,CACL,CAAE,SAAU,YAAiB,MAAO,OAAW,UAAW,aAAgB,KAAM,EAAS,QAAQ,YAAa,CAC9G,CAAE,SAAU,YAAiB,MAAO,SAAW,UAAW,eAAgB,KAAM,EAAS,QAAQ,cAAe,CAChH,CAAE,SAAU,YAAiB,MAAO,QAAW,UAAW,cAAgB,KAAM,EAAS,QAAQ,aAAc,CAC/G,CAAE,SAAU,YAAiB,MAAO,UAAW,UAAW,gBAAmB,KAAM,EAAS,QAAQ,YAAa,CACjH,CAAE,SAAU,gBAAiB,MAAO,MAAW,UAAW,YAAkB,KAAM,EAAS,QAAQ,SAAU,CAC7G,CAAE,SAAU,gBAAiB,MAAO,SAAW,UAAW,eAAkB,KAAM,EAAS,QAAQ,YAAa,CAChH,CAAE,SAAU,gBAAiB,MAAO,SAAW,UAAW,eAAkB,KAAM,EAAS,QAAQ,YAAa,CACnH,CACJ,CAED,EAAkB,GAAG,KAAK,KAAK,KAAM,EAAE,OAAO,EAAgB,EAAQ,CAAC,CAEvE,KAAK,OAAO,EAEhB,QAAS,CACL,aAAgB,mCACnB,CACD,MAAO,UAAW,CACd,IAAI,EAAK,KAAK,QAAQ,CAAC,QAAQ,KAAK,KAAK,CAEzC,KAAK,KAAO,IAAI,EAAM,GAAG,WAAW,EAAI,CACpC,WAAY,IAAI,EAAM,KAAK,WAAW,CAAE,KAAM,KAAK,QAAQ,QAAS,CAAC,CACrE,SAAW,GAAS,2BAA2B,EAAK,KAAK,mBAAmB,EAAK,SAAS,gBAAgB,EAAK,MAAM;kCACnG,EAAM,GAAG,KAAK,EAAK,UAAU,CAAC,GAAG,EAAK,KAAK;iCAE7D,OAAQ,KAAK,MAAM,KAAK,KAAK,CAChC,CAAC,CAEF,KAAK,KAAK,WAAW,OAAO,EAEhC,MAAO,SAAS,EAAG,CACf,IAAI,EAAW,EAAE,OAAO,OAAO,CAAC,GAChC,EAAkB,GAAG,MAAM,KAAK,KAAK,CAErC,KAAK,QAAQ,SAAU,CACnB,QAAS,wBACT,QAAS,CACL,SAAU,EAAS,SACnB,MAAO,EAAS,MACnB,CACJ,CAAC,EAET,CAAC,CAEF,EAAM,YAAY,QAAQ,SAAS,YAAa,EAAgB,CAEhE,IAAI,EAAc,EAAkB,OAAO,CACvC,KAAM,SAAS,EAAS,CACpB,IAAI,EAAW,EAAM,YAAY,SAAS,QAAQ,aAAe,EAC7D,EAAiB,CACjB,MAAO,EAAS,MAChB,QAAS,CACL,CAAE,MAAO,QAAgB,UAAW,cAAsB,KAAM,EAAS,QAAQ,WAAY,CAC7F,CAAE,MAAO,eAAgB,UAAW,2BAA4B,KAAM,EAAS,QAAQ,kBAAmB,CAC1G,CAAE,MAAO,aAAgB,UAAW,yBAA4B,KAAM,EAAS,QAAQ,gBAAiB,CACxG,CAAE,MAAO,UAAgB,UAAW,gBAAsB,KAAM,EAAS,QAAQ,QAAS,CAC7F,CACJ,CAED,EAAkB,GAAG,KAAK,KAAK,KAAM,EAAE,OAAO,EAAgB,EAAQ,CAAC,CAEvE,KAAK,OAAO,EAEhB,QAAS,CACL,aAAgB,mCACnB,CACD,MAAO,UAAW,CACd,IAAI,EAAK,KAAK,QAAQ,CAAC,QAAQ,KAAK,KAAK,CAEzC,KAAK,KAAO,IAAI,EAAM,GAAG,WAAW,EAAI,CACpC,WAAY,IAAI,EAAM,KAAK,WAAW,CAAE,KAAM,KAAK,QAAQ,QAAS,CAAC,CACrE,SAAW,GAAS,2BAA2B,EAAK,KAAK,gBAAgB,EAAK,MAAM,IACrE,EAAM,GAAG,KAAK,EAAK,UAAU,GAAG,EAAK,WAEpD,OAAQ,KAAK,MAAM,KAAK,KAAK,CAChC,CAAC,CAEF,KAAK,KAAK,WAAW,OAAO,EAEhC,MAAO,SAAS,EAAG,CACf,IAAI,EAAW,EAAE,OAAO,OAAO,CAAC,GAChC,EAAkB,GAAG,MAAM,KAAK,KAAK,CAErC,KAAK,QAAQ,SAAU,CACnB,QAAS,mBACT,QAAS,CACL,MAAO,EAAS,MACnB,CACJ,CAAC,EAET,CAAC,CAEF,EAAM,YAAY,QAAQ,SAAS,QAAS,EAAY,CAExD,IAAI,EAAe,EAAkB,OAAO,CACxC,KAAM,SAAS,EAAS,CACpB,IAAI,EAAW,EAAM,YAAY,SAAS,QAAQ,cAAgB,EAC9D,EAAiB,CACjB,MAAO,EAAS,MAChB,QAAS,CACL,CAAE,MAAO,QAAY,UAAW,cAAgB,KAAM,EAAS,QAAQ,YAAa,CACpF,CAAE,MAAO,OAAY,UAAW,aAAiB,KAAM,EAAS,QAAQ,WAAY,CACpF,CAAE,MAAO,UAAY,UAAW,gBAAoB,KAAM,EAAS,QAAQ,cAAe,CAC1F,CAAE,MAAO,WAAY,UAAW,gBAAiB,KAAM,EAAS,QAAQ,SAAU,CACrF,CACJ,CAED,EAAkB,GAAG,KAAK,KAAK,KAAM,EAAE,OAAO,EAAgB,EAAQ,CAAC,CAEvE,KAAK,OAAO,EAEhB,QAAS,CACL,aAAgB,mCACnB,CACD,MAAO,UAAW,CACd,IAAI,EAAK,KAAK,QAAQ,CAAC,QAAQ,KAAK,KAAK,CAEzC,KAAK,KAAO,IAAI,EAAM,GAAG,WAAW,EAAI,CACpC,WAAY,IAAI,EAAM,KAAK,WAAW,CAAE,KAAM,KAAK,QAAQ,QAAS,CAAC,CACrE,SAAW,GAAS,2BAA2B,EAAK,KAAK,gBAAgB,EAAK,MAAM,IACrE,EAAM,GAAG,KAAK,EAAK,UAAU,GAAG,EAAK,WAEpD,OAAQ,KAAK,MAAM,KAAK,KAAK,CAChC,CAAC,CAEF,KAAK,KAAK,WAAW,OAAO,EAEhC,MAAO,SAAS,EAAG,CACf,IAAI,EAAW,EAAE,OAAO,OAAO,CAAC,GAChC,EAAkB,GAAG,MAAM,KAAK,KAAK,CAErC,KAAK,QAAQ,SAAU,CACnB,QAAS,qBACT,QAAS,CACL,MAAO,EAAS,MACnB,CACJ,CAAC,EAET,CAAC,CAEF,EAAM,YAAY,QAAQ,SAAS,SAAU,EAAa,CAE1D,IAAI,EAAsB,EAAM,YAAY,yBAA2B,EAAiB,OAAO,CAC3F,KAAM,SAAS,EAAS,CACpB,EAAiB,GAAG,KAAK,KAAK,KAAM,EAAQ,CAE5C,KAAK,KAAK,UAAW,SAAS,EAAG,CAEzB,EAAE,QAAU,cACZ,KAAK,OAAO,EAER,KAAK,YAAc,UAAY,KAAK,YAAc,SAClD,KAAK,wBAAwB,EAIjC,EAAE,QAAU,YACZ,KAAK,wBAAwB,EAG5B,EAAE,OAAS,eAAiB,EAAE,OAAS,cAAgB,CAAC,KAAK,QAC9D,KAAK,YAAc,KAGlB,EAAE,OAAS,QAAU,EAAE,OAAS,MAAQ,EAAE,OAAS,uBAAyB,EAAE,OAAS,SAAW,KAAK,aACxG,KAAK,eAAe,GAEzB,KAAK,KAAK,CAAC,CAEd,KAAK,OAAO,EAEhB,cAAe,UAAW,CACtB,KAAK,MAAQ,GACb,KAAK,IAAI,YAAa,KAAK,kBAAoB,EAAM,OAAO,KAAK,kBAAmB,KAAK,KAAK,CAAG,GAAG,CACpG,KAAK,IAAI,cAAe,KAAK,oBAAsB,EAAM,OAAO,KAAK,oBAAqB,KAAK,KAAM,KAAK,GAAG,CAAG,GAAG,CACnH,KAAK,MAAQ,IAEjB,MAAO,UAAW,CACd,KAAK,cAAc,CACnB,KAAK,IAAI,WAAY,KAAK,UAAU,GAAG,KAAK,CAC5C,KAAK,IAAI,OAAQ,KAAK,CACtB,KAAK,IAAI,KAAM,KAAK,CAEpB,KAAK,IAAI,oBAAqB,GAAM,CAEpC,KAAK,YAAc,GAEnB,KAAK,kBAAoB,KAAK,iBAC9B,KAAK,eAAe,EAGxB,aAAc,UAAW,CACrB,IAAI,EAAM,KAAK,iBACX,EAAY,EAAE,CAElB,GAAI,KAAK,YAAc,OAEnB,IAAK,IADD,EAAiB,CAAC,UAAW,aAAa,CACrC,EAAM,EAAG,EAAM,EAAI,OAAQ,IAC5B,EAAe,IAAM,EAAI,GAAK,OAC9B,EAAU,KAAK,EAAI,GAAK,CACxB,EAAe,OAAO,OAI9B,EAAY,EAAI,OAAO,CAG3B,KAAK,IAAI,YAAa,EAAU,EAEpC,uBAAwB,UAAW,CAC5B,KAAK,YAAc,UAAY,KAAK,YAAc,OAClD,KAAK,IAAI,sBAAuB,EAAM,OAAO,KAAK,mBAAoB,KAAK,UAAW,KAAK,iBAAiB,KAAK,UAAU,CAAC,EAE5H,KAAK,IAAI,sBAAuB,GAAG,CACnC,KAAK,IAAI,cAAe,GAAG,GAGlC,MAAO,UAAW,CACd,OAAO,KAAK,IAAI,YAAY,GAAK,OAErC,SAAU,UAAW,CACjB,OAAO,KAAK,IAAI,YAAY,GAAK,UAErC,gBAAiB,UAAW,CACxB,OAAO,KAAK,QAAQ,EAAI,KAAK,UAAU,EAE3C,cAAe,UAAW,CACtB,OAAO,KAAK,QAAQ,EAAI,KAAK,QAAQ,EAEzC,OAAQ,UAAW,CACf,OAAO,KAAK,IAAI,YAAY,GAAK,QAErC,OAAQ,UAAW,CACf,OAAO,KAAK,IAAI,YAAY,GAAK,QAErC,OAAQ,UAAW,CACf,OAAO,KAAK,IAAI,YAAY,GAAK,QAErC,SAAU,UAAW,CACjB,OAAO,KAAK,IAAI,YAAY,GAAK,UAErC,WAAY,UAAW,CACnB,OAAO,KAAK,IAAI,gBAAgB,EAEpC,OAAQ,UAAW,CACf,OAAO,KAAK,IAAI,WAAW,EAAI,WAAa,KAAK,IAAI,WAAW,EAAI,cAExE,OAAQ,SAAS,EAAY,CACzB,KAAK,IAAI,gBAAiB,CAAC,CAAC,EAAW,CAEnC,GACA,KAAK,qBAAqB,EAAW,EAG7C,qBAAsB,SAAS,EAAY,CACvC,KAAK,IAAI,YAAa,EAAW,SAAS,CAC1C,KAAK,IAAI,WAAY,EAAW,aAAa,CAC7C,KAAK,IAAI,OAAQ,EAAW,KAAK,CACjC,KAAK,IAAI,KAAM,EAAW,GAAG,CAC7B,KAAK,IAAI,OAAQ,EAAW,KAAK,CACjC,KAAK,IAAI,cAAe,EAAW,WAAW,CAC9C,KAAK,IAAI,aAAc,EAAW,WAAW,CAEzC,EAAW,iBAAmB,EAAW,eACzC,KAAK,oBAAsB,EAAW,gBACtC,KAAK,YAAc,EAAW,gBAC9B,KAAK,kBAAoB,EAAW,cACpC,KAAK,UAAY,EAAW,cAC5B,KAAK,kBAAoB,GACzB,KAAK,eAAe,EAEpB,KAAK,kBAAoB,IAGjC,mBAAoB,UAAW,CAC3B,GAAI,KAAK,YAAc,MACnB,OAAO,KAGX,IAAI,EAAU,CACV,KAAM,KAAK,KACX,SAAU,KAAK,UACf,aAAc,KAAK,SACnB,KAAM,KAAK,KACX,GAAI,KAAK,GACT,WAAY,KAAK,YACjB,WAAY,KAAK,WACpB,CAOD,OALI,KAAK,oBACL,EAAQ,gBAAkB,KAAK,YAAc,KAAK,oBAAsB,KAAK,YAC7E,EAAQ,cAAgB,KAAK,WAG1B,GAEd,CAAC,CAEE,EAAmB,EAAkB,OAAO,CAC5C,KAAM,SAAS,EAAS,CACpB,IAAI,EAAW,EAAM,YAAY,SAAS,QAAQ,kBAAoB,EAClE,EAAiB,CACjB,MAAO,EAAS,MAChB,YAAa,EAAS,YACtB,UAAW,EAAS,UACpB,SAAU,CACN,CAAE,KAAM,MAAO,KAAM,EAAS,SAAS,IAAK,CAC5C,CAAE,KAAM,SAAU,KAAM,EAAS,SAAS,OAAQ,CAClD,CAAE,KAAM,OAAQ,KAAM,EAAS,SAAS,KAAM,CAC9C,CAAE,KAAM,OAAQ,KAAM,EAAS,SAAS,KAAM,CAC9C,CAAE,KAAM,SAAU,KAAM,EAAS,SAAS,OAAQ,CAClD,CAAE,KAAM,OAAQ,KAAM,EAAS,SAAS,KAAM,CACjD,CACD,UAAW,CACP,CAAE,KAAM,cAAe,KAAM,EAAS,UAAU,YAAa,CAC7D,CAAE,KAAM,WAAe,KAAM,EAAS,UAAU,SAAU,CAC1D,CAAE,KAAM,UAAe,KAAM,EAAS,UAAU,QAAS,CACzD,CAAE,KAAM,aAAe,KAAM,EAAS,UAAU,WAAY,CAC5D,CAAE,KAAM,UAAe,KAAM,EAAS,UAAU,QAAS,CACzD,CAAE,KAAM,aAAe,KAAM,EAAS,UAAU,WAAY,CAC5D,CAAE,KAAM,uBAAwB,KAAM,EAAS,UAAU,qBAAsB,CAC/E,CAAE,KAAM,oBAAwB,KAAM,EAAS,UAAU,kBAAmB,CAC/E,CACD,iBAAkB,EAAS,iBAC9B,CAED,EAAkB,GAAG,KAAK,KAAK,KAAM,EAAE,OAAO,EAAgB,EAAQ,CAAC,EAE3E,QAAS,CACL,MAAO,IACP,UAAW,MACX,KAAM,SACN,YAAa,GACb,WAAY,GACZ,kBAAmB,GACnB,cAAgB,GACZ;sBACM,EAAM,GAAG,KAAK,CAAE,KAAM,qBAAsB,UAAW,iBAAkB,CAAC,CAAC;sDAC3C,EAAK,QAAQ;;wBAGvD,SAAW,GAAS,CAChB,IAAI,EAoDJ,MAnDA,GAAe;sEACuC,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,SAAS,CAAC;2EAC5D,EAAM,WAAW,EAAK,GAAG,CAAC,6BAA6B,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,SAAS,CAAC,SAAS,EAAM,WAAW,EAAK,GAAG,CAAC,yBAAyB,EAAM,WAAW,EAAK,GAAG,CAAC,0BAA0B,EAAM,WAAW,EAAK,GAAG,CAAC;gCAC7S,EAAM,WAAW,EAAK,GAAG,CAAC;6EACmB,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,SAAS,CAAC;kFAC5D,EAAM,WAAW,EAAK,GAAG,CAAC,6BAA6B,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,SAAS,CAAC,SAAS,EAAM,WAAW,EAAK,GAAG,CAAC,yBAAyB,EAAM,WAAW,EAAK,GAAG,CAAC,0BAA0B,EAAM,WAAW,EAAK,GAAG,CAAC;0EAC1Q,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,IAAI,CAAC;+GACvB,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,IAAI,CAAC,WAAW,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,IAAI,CAAC,qDAAqD,EAAM,WAAW,EAAK,GAAG,CAAC;gCACjS,EAAM,WAAW,EAAK,GAAG,CAAC;0EACgB,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,IAAI,CAAC;+GACvB,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,IAAI,CAAC,WAAW,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,IAAI,CAAC,sDAAsD,EAAM,WAAW,EAAK,GAAG,CAAC;;sCAE5R,EAAM,WAAW,EAAK,GAAG,CAAC;2EACW,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,SAAS,CAAC;gFAC5D,EAAM,WAAW,EAAK,GAAG,CAAC,6BAA6B,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,SAAS,CAAC,SAAS,EAAM,WAAW,EAAK,GAAG,CAAC,yBAAyB,EAAM,WAAW,EAAK,GAAG,CAAC,0BAA0B,EAAM,WAAW,EAAK,GAAG,CAAC;iFACjQ,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,MAAM,CAAC;sHACzB,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,MAAM,CAAC,WAAW,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,MAAM,CAAC,+BAA+B,EAAM,WAAW,EAAK,GAAG,CAAC;sCAChR,EAAM,WAAW,EAAK,GAAG,CAAC;2EACW,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,SAAS,CAAC;gFAC5D,EAAM,WAAW,EAAK,GAAG,CAAC,6BAA6B,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,SAAS,CAAC,SAAS,EAAM,WAAW,EAAK,GAAG,CAAC,yBAAyB,EAAM,WAAW,EAAK,GAAG,CAAC,0BAA0B,EAAM,WAAW,EAAK,GAAG,CAAC;iFACjQ,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,MAAM,CAAC;sHACzB,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,MAAM,CAAC,WAAW,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,MAAM,CAAC,+BAA+B,EAAM,WAAW,EAAK,GAAG,CAAC;gCACtR,EAAM,WAAW,EAAK,GAAG,CAAC;+EACqB,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,IAAI,CAAC;oHACvB,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,IAAI,CAAC,WAAW,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,IAAI,CAAC,+BAA+B,EAAM,WAAW,EAAK,GAAG,CAAC;4CACpQ,EAAM,WAAW,EAAK,GAAG,CAAC;mFACa,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,MAAM,CAAC;wHACzB,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,MAAM,CAAC,WAAW,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,MAAM,CAAC,+BAA+B,EAAM,WAAW,EAAK,GAAG,CAAC;sCAClR,EAAM,WAAW,EAAK,GAAG,CAAC;iFACiB,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,MAAM,CAAC;sHACzB,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,MAAM,CAAC,WAAW,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,MAAM,CAAC,+BAA+B,EAAM,WAAW,EAAK,GAAG,CAAC;sCAChR,EAAM,WAAW,EAAK,GAAG,CAAC;qIACqE,EAAM,WAAW,EAAK,GAAG,CAAC,qFAAqF,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,eAAe,CAAC;sCACrR,EAAM,WAAW,EAAK,GAAG,CAAC;qIACqE,EAAM,WAAW,EAAK,GAAG,CAAC,qFAAqF,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,mBAAmB,CAAC;sCACzR,EAAM,WAAW,EAAK,GAAG,CAAC;8EACc,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,YAAY,CAAC,gEAAgE,EAAM,WAAW,EAAK,GAAG,CAAC,mFAAmF,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,YAAY,CAAC;sCAC7V,EAAM,WAAW,EAAK,GAAG,CAAC;;uDAET,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,cAAc,CAAC;2EAClD,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,YAAY,CAAC,wEAAwE,EAAM,WAAW,EAAK,GAAG,CAAC,iGAAiG,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,YAAY,CAAC,sCAAsC,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,YAAY,CAAC,0EAA0E,EAAM,WAAW,EAAK,GAAG,CAAC,kGAAkG,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,YAAY,CAAC;sCACpuB,EAAM,WAAW,EAAK,GAAG,CAAC;8EACc,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,SAAS,CAAC,4EAA4E,EAAM,WAAW,EAAK,GAAG,CAAC,+FAA+F,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,SAAS,CAAC;gCACrX,EAAM,WAAW,EAAK,GAAG,CAAC;wEACc,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,UAAU,CAAC;sJACY,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,UAAU,CAAC,iBAAiB,EAAM,WAAW,EAAK,SAAS,iBAAiB,aAAa,UAAU,CAAC,SAAS,EAAM,WAAW,EAAK,GAAG,CAAC;0EAC1Q,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,YAAY,CAAC;sIACR,EAAM,WAAW,EAAK,SAAS,iBAAiB,OAAO,YAAY,CAAC,iBAAiB,EAAM,WAAW,EAAK,SAAS,iBAAiB,aAAa,YAAY,CAAC,SAAS,EAAM,WAAW,EAAK,GAAG,CAAC;;2EAE7P,EAAM,WAAW,EAAK,GAAG,CAAC,wEAAwE,EAAM,WAAW,EAAK,SAAS,OAAO,CAAC,iEAAiE,EAAM,WAAW,EAAK,GAAG,CAAC,kDAAkD,EAAM,WAAW,EAAK,SAAS,MAAM,CAAC,gDAAgD,EAAM,WAAW,EAAK,GAAG,CAAC,kDAAkD,EAAM,WAAW,EAAK,SAAS,OAAO,CAAC;4BAEnhB,GAEd,CACD,KAAM,SAAS,EAAO,CAClB,IAAI,EAAU,KAAK,QACf,EAEJ,KAAK,UAAY,IAAI,EAAoB,CACrC,KAAM,EAAQ,KACd,mBAAoB,EAAQ,YAC5B,iBAAkB,EAAQ,UAC1B,iBAAkB,EAAQ,UAAU,MAAM,EAAE,CAC5C,iBAAkB,EAAQ,iBAC1B,SAAU,EAAQ,SAAS,MAAM,EAAE,CACnC,UAAW,EAAQ,UACnB,YAAa,EAAQ,YACrB,WAAY,EAAQ,WACpB,MAAO,KAAK,MAAM,KAAK,KAAK,CAC5B,MAAO,KAAK,MAAM,KAAK,KAAK,CAC5B,OAAQ,KAAK,OAAO,KAAK,KAAK,CACjC,CAAC,CAEF,KAAK,UAAU,OAAO,EAAM,YAAY,CAAC,CAEzC,EAAkB,GAAG,KAAK,KAAK,KAAK,CAEpC,EAAU,KAAK,QAAQ,CAAC,QAEpB,KAAK,aACL,KAAK,YAAY,SAAS,CAG9B,EAAM,KAAK,EAAS,KAAK,UAAU,CAEnC,KAAK,YAAc,IAAI,EAAM,GAAG,UAAU,EAAQ,KAAK,yBAAyB,CAAE,CAC9E,eAAgB,GAChB,cAAe,KAAK,QAAQ,eAAiB,OAChD,CAAC,EAEN,MAAO,UAAW,CAEV,KAAK,YAAY,UAAU,GAC3B,EAAkB,GAAG,MAAM,KAAK,KAAK,CAErC,KAAK,QAAQ,SAAU,CACnB,QAAS,wBACT,QAAS,CACL,MAAO,KAAK,UAAU,oBAAoB,CAC7C,CACJ,CAAC,GAGV,OAAQ,UAAW,CACf,KAAK,UAAU,IAAI,YAAa,MAAM,CACtC,KAAK,OAAO,EAEnB,CAAC,CAEF,EAAM,YAAY,QAAQ,SAAS,aAAc,EAAiB,CAClE,EAAM,YAAY,QAAQ,iBAAmB,EAE7C,SAAS,EAAe,EAAM,CAC1B,MAAO,CACH,MAAO,EACP,KAAM,EAAK,4BAA8B,EAAK,CACjD,CAGL,IAAI,EAAiB,EAAkB,OAAO,CAC1C,KAAM,SAAS,EAAS,CACpB,EAAkB,GAAG,KAAK,KAAK,KAAM,EAAQ,CAC7C,EAAU,KAAK,QAEf,KAAK,UAAY,EAAM,WAAW,CAC9B,MAAO,EAAQ,MACf,KAAM,EAAQ,KACd,UAAW,EAAQ,UACnB,YAAY,EAAQ,YACpB,MAAO,EAAQ,YACf,IAAK,CACD,SAAU,EAAQ,UAAU,SAC5B,WAAY,EAAQ,UAAU,WAC9B,MAAO,EAAQ,UAAU,MACzB,OAAQ,EAAQ,UAAU,OAC1B,UAAW,EAAQ,UAAU,UAC7B,QAAS,EAAQ,UAAU,QAC3B,SAAU,EAAQ,UAAU,SAC5B,QAAS,EAAQ,UAAU,QAC3B,KAAM,EAAQ,UAAU,KAExB,SAAU,EAAQ,IAAI,SACtB,KAAM,EAAQ,IAAI,KAClB,MAAO,EAAQ,IAAI,MACnB,UAAW,EAAQ,IAAI,UACvB,WAAY,EAAQ,IAAI,WACxB,OAAQ,EAAQ,IAAI,OACpB,QAAS,EAAQ,IAAI,QACrB,UAAW,EAAQ,IAAI,UACvB,WAAY,EAAQ,IAAI,WACxB,QAAS,EAAQ,IAAI,QACrB,QAAS,EAAQ,IAAI,QACxB,CACD,MAAO,KAAK,MAAM,KAAK,KAAK,CAC5B,MAAO,KAAK,MAAM,KAAK,KAAK,CAC/B,CAAC,CAEF,IAAI,EAAS,KAAK,QAAQ,CAC1B,KAAK,UAAU,KAAK,SAAU,SAAS,EAAG,CAClC,EAAE,QAAU,cACZ,KAAK,IAAI,iBAAkB,KAAK,YAAc,OAAsB,CACpE,EAAO,QAAQ,GAErB,CAEF,EAAM,KAAK,EAAO,QAAS,KAAK,UAAU,EAE9C,QAAS,CACL,MAAO,EAAK,uBAAwB,YAAY,CAChD,KAAM,EAAK,iCAAkC,WAAW,CACxD,UAAW,QACX,YAAa,CAAC,CACV,YAAa,EAAK,kCAAmC,yBAAyB,CAC9E,UAAW,QACd,CAAE,CACC,YAAa,EAAK,iCAAkC,kCAAkC,CACtF,UAAW,OACd,CAAC,CACF,IAAK,CACD,SAAU,GACV,KAAM,WACN,MAAO,CAAC,CACJ,KAAM,WACN,KAAM,EAAK,mCAAoC,kBAAkB,CACpE,CAAC,CACE,KAAM,QACN,KAAM,EAAK,gCAAiC,eAAe,CAC9D,CAAC,CACE,KAAM,YACN,KAAM,EAAK,oCAAqC,YAAY,CAC/D,CAAC,CACF,UAAW,KACX,WAAY,CACR,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,QAAS,QAAS,SAAU,UAAW,YACpF,CAAC,IAAI,EAAe,CACrB,OAAQ,CAAC,OAAQ,SAAU,KAAM,QAAS,MAAO,QAAS,IAAK,SAAS,CACxE,QAAS,CACL,CAAE,MAAO,CAAE,OAAQ,SAAU,KAAM,QAAS,MAAO,QAAS,IAAK,SAAU,CACzE,KAAM,EAAK,mCAAoC,SAAS,CACzD,CACD,CAAE,MAAO,CAAE,OAAQ,SAAU,KAAM,SAAU,MAAO,SAAU,IAAK,SAAU,CAC3E,KAAM,EAAK,mCAAoC,SAAS,CACzD,CACD,CAAE,MAAO,CAAE,OAAQ,MAAO,KAAM,MAAO,MAAO,MAAO,IAAK,MAAO,CAC/D,KAAM,EAAK,iCAAkC,OAAO,CACrD,CACJ,CACD,UAAW,GACX,WAAY,GACZ,QAAS,GACT,QAAS,GACZ,CACD,MAAO,IACP,SAAW,GAAS,CAChB,IAAI,EAwCJ,MAvCA,GAAe,oDAAoD,EAAM,WAAW,EAAK,SAAS,eAAe,OAAO,SAAS,CAAC;+IACH,EAAM,WAAW,EAAK,GAAG,CAAC;;iFAExF,EAAM,WAAW,EAAK,SAAS,eAAe,OAAO,WAAW,CAAC;oGAC9C,EAAM,WAAW,EAAK,GAAG,CAAC,iDAAiD,EAAM,WAAW,EAAK,GAAG,CAAC,gCAAgC,EAAM,WAAW,EAAK,GAAG,CAAC,+BAA+B,EAAM,WAAW,EAAK,GAAG,CAAC;;wDAEpQ,EAAM,WAAW,EAAK,GAAG,CAAC;;8EAEJ,EAAM,WAAW,EAAK,SAAS,eAAe,OAAO,WAAW,CAAC;iGAC9C,EAAM,WAAW,EAAK,GAAG,CAAC,iDAAiD,EAAM,WAAW,EAAK,GAAG,CAAC,yBAAyB,EAAM,WAAW,EAAK,GAAG,CAAC,0BAA0B,EAAM,WAAW,EAAK,GAAG,CAAC;6EAChO,EAAM,WAAW,EAAK,SAAS,eAAe,OAAO,UAAU,CAAC;gGAC7C,EAAM,WAAW,EAAK,GAAG,CAAC,iDAAiD,EAAM,WAAW,EAAK,GAAG,CAAC,yBAAyB,EAAM,WAAW,EAAK,GAAG,CAAC,2BAA2B,EAAM,WAAW,EAAK,GAAG,CAAC;0EACnO,EAAM,WAAW,EAAK,SAAS,eAAe,OAAO,QAAQ,CAAC;6FAC3C,EAAM,WAAW,EAAK,GAAG,CAAC,iDAAiD,EAAM,WAAW,EAAK,GAAG,CAAC,6BAA6B,EAAM,WAAW,EAAK,GAAG,CAAC,yBAAyB,EAAM,WAAW,EAAK,GAAG,CAAC,2BAA2B,EAAM,WAAW,EAAK,GAAG,CAAC;uDAC1S,EAAM,WAAW,EAAK,SAAS,eAAe,OAAO,YAAY,CAAC;;;sIAGa,EAAM,WAAW,EAAK,GAAG,CAAC,sBAAsB,EAAM,WAAW,EAAK,GAAG,CAAC;;4BAEpL,EAAM,GAAG,KAAK,CAAE,KAAM,OAAQ,UAAW,gBAAiB,CAAC,CAAC;;wIAEgD,EAAM,WAAW,EAAK,GAAG,CAAC,sBAAsB,EAAM,WAAW,EAAK,GAAG,CAAC;;4BAEtL,EAAM,GAAG,KAAK,CAAE,KAAM,kBAAmB,UAAW,gBAAiB,CAAC,CAAC;;;;uDAI5C,EAAM,WAAW,EAAK,SAAS,eAAe,OAAO,MAAM,CAAC;+GACJ,EAAM,WAAW,EAAK,GAAG,CAAC,mFAAmF,EAAM,WAAW,EAAK,SAAS,eAAe,OAAO,WAAW,CAAC;uDACtO,EAAM,WAAW,EAAK,SAAS,eAAe,OAAO,MAAM,CAAC;6GACN,EAAM,WAAW,EAAK,GAAG,CAAC,+EAA+E,EAAM,WAAW,EAAK,SAAS,eAAe,OAAO,IAAI,CAAC;uDACzN,EAAM,WAAW,EAAK,SAAS,eAAe,OAAO,OAAO,CAAC;4GACR,EAAM,WAAW,EAAK,GAAG,CAAC,6EAA6E,EAAM,WAAW,EAAK,SAAS,eAAe,OAAO,aAAa,CAAC,sEAAsE,EAAM,WAAW,EAAK,GAAG,CAAC,6EAA6E,EAAM,WAAW,EAAK,SAAS,eAAe,OAAO,WAAW,CAAC;;yBAE3e,EAAM,GAAG,KAAK,EAAE,cAAc,EAAK,GAAG,yCAAyC,CAAE,CAAE,KAAM,OAAQ,CAAC,CAAC;yBACnG,EAAM,GAAG,KAAK,EAAE,cAAc,EAAK,GAAG,uCAAuC,CAAE,CAAE,KAAM,kBAAmB,CAAC,CAAC;;;4FAGzC,EAAM,WAAW,EAAK,GAAG,CAAC,kDAAkD,EAAM,WAAW,EAAK,SAAS,KAAK,CAAC,gDAAgD,EAAM,WAAW,EAAK,GAAG,CAAC,kDAAkD,EAAM,WAAW,EAAK,SAAS,OAAO,CAAC,wBACzV,GAEd,CACD,MAAO,UAAW,CACd,EAAkB,GAAG,MAAM,KAAK,KAAK,CAErC,KAAK,QAAQ,SAAU,CACnB,QAAS,gBACT,QAAS,KAAK,UACjB,CAAC,EAET,CAAC,CACF,EAAM,YAAY,QAAQ,SAAS,WAAY,EAAe,CAE9D,SAAS,EAAiB,EAAI,EAAK,CAC/B,EAAM,YAAY,QAAQ,SACtB,EACA,EAAc,OAAO,CACjB,QAAS,CAAE,UAAW,EAAK,CAC9B,CAAC,CACL,CAGL,EAAiB,eAAgB,kCAAkC,CACnE,EAAiB,gBAAiB,mCAAmC,CACrE,EAAiB,kBAAmB,qCAAqC,CACzE,EAAiB,WAAY,8BAA8B,CAC3D,EAAiB,uBAAwB,0CAA0C,CACnF,EAAiB,qBAAsB,wCAAwC,CAC/E,EAAiB,kBAAmB,qCAAqC,CACzE,EAAiB,qBAAsB,wCAAwC,CAE/E,IAAI,EAAoB,EAAc,OAAO,CACzC,QAAS,CACL,MAAO,IACP,MAAO,mBACP,SAAW,GAAS,CAChB,IAAI,EACE,EAAS,EAAK,OACpB,EAAe,wHAAwH,EAAO,OAAO,sNACrJ,IAAK,IAAI,EAAI,EAAG,EAAI,EAAO,OAAQ,EAAE,EAAG,CACpC,GAAgB,GAAI,IAAI,EAAM,EAAO,GACrC,GAAgB,WAAW,EAAM,WAAW,EAAI,QAAQ,CAAC,WAAW,EAAM,WAAW,EAAI,MAAM,CAAC,YAGpG,MADA,IAAgB,6FAA6F,EAAM,WAAW,EAAK,GAAG,CAAC,kDAAkD,EAAM,WAAW,EAAK,SAAS,OAAO,CAAC,wBACzN,GAEd,CACJ,CAAC,CAEF,EAAM,YAAY,QAAQ,SAAS,cAAe,EAAkB,CAEpE,IAAI,EAAoB,EAAc,OAAO,CACzC,QAAS,CACL,MAAO,EAAK,0BAA2B,sBAAsB,CAC7D,SAAW,GAAS,CAChB,IAAI,EAQJ,MAPA,GAAe,GAAG,EAAM,WAAW,EAAK,SAAS,kBAAkB,aAAa,CAAC;8BACnE,EAAM,WAAW,EAAK,SAAS,kBAAkB,OAAO,QAAQ,CAAC;8BACjE,EAAM,WAAW,EAAK,SAAS,kBAAkB,OAAO,OAAO,CAAC;8BAChE,EAAM,WAAW,EAAK,SAAS,kBAAkB,OAAO,SAAS,CAAC;;+BAEjE,EAAM,WAAW,EAAK,GAAG,CAAC;oDACL,EAAK,SAAS,OAAO,wBAClD,GAEd,CACJ,CAAC,CAEF,EAAM,YAAY,QAAQ,SAAS,cAAe,EAAkB,CAEpE,IAAI,EAAkB,EAAkB,OAAO,CAC3C,QAAS,CACL,MAAO,EAAK,mBAAoB,YAAY,CAC5C,SAAW,GAAS,CAChB,IAAI,EAcJ,MAbA,GAAe,mDAAmD,EAAM,WAAW,EAAK,SAAS,WAAW,OAAO,IAAI,CAAC;;yCAE/F,EAAM,WAAW,EAAK,GAAG,CAAC;qBAC9C,EAAM,WAAW,EAAK,SAAS,WAAW,OAAO,IAAI,CAAC;;eAE5D,EAAM,WAAW,EAAK,GAAG,CAAC;oCACL,EAAK,SAAS,WAAW,OAAO,WAAW;;eAEhE,EAAM,WAAW,EAAK,GAAG,CAAC;oCACL,EAAK,SAAS,OAAO;;eAE1C,EAAM,WAAW,EAAK,GAAG,CAAC;oCACL,EAAK,SAAS,OAAO,wBAClC,GAEX,UAAW,GACd,CACD,KAAM,SAAS,EAAO,CAClB,IAAI,EAAO,KACX,EAAkB,GAAG,KAAK,MAAM,EAAM,UAAU,CAChD,IAAI,EAAU,EAAK,QAAQ,CAAC,QACxB,EAAQ,EAAM,WAAW,CACzB,IAAK,EAAM,MAAM,CACjB,MAAO,UAAW,CACT,KAAK,KAAK,EAAM,IAAI,GACrB,EAAM,IAAM,MAEhB,EAAK,QAAQ,SAAU,CACnB,QAAS,mBACT,QAAS,CACL,KAAM,EAAM,IACf,CACJ,CAAC,CACF,EAAK,OAAO,EAEhB,OAAQ,UAAW,CACf,EAAM,IAAM,KACZ,EAAM,OAAO,EAEjB,OAAQ,EAAK,MAAM,KAAK,EAAK,CAChC,CAAC,CACF,EAAM,KAAK,EAAS,EAAM,CAK1B,EAAQ,KAAK,QAAQ,CAChB,QAAQ,QAAQ,CAChB,GAAG,UAAW,SAAS,EAAG,CACnB,EAAG,SAAW,IACd,EAAM,IAAM,EAAE,KAAK,CAAC,KAAK,CACzB,EAAG,iBAAiB,CACpB,EAAG,gBAAgB,CACnB,EAAM,OAAO,EACN,EAAG,SAAW,KACrB,EAAG,iBAAiB,CACpB,EAAG,gBAAgB,CACnB,EAAM,QAAQ,GAEpB,EAEb,CAAC,CAEF,EAAM,YAAY,QAAQ,SAAS,YAAa,EAAgB,CAEhE,IAAI,EAAoB,EAAkB,OAAO,CAC7C,QAAS,CACL,MAAO,EAAK,0BAA2B,eAAe,CACtD,SAAW,GAAS,CAChB,IAAI,EAWJ,MAVA,GAAe,0DAA0D,EAAM,WAAW,EAAK,SAAS,kBAAkB,OAAO,KAAK,CAAC;;yCAE9G,EAAM,WAAW,EAAK,GAAG,CAAC;qBAC9C,EAAM,WAAW,EAAK,SAAS,kBAAkB,OAAO,KAAK,CAAC;;eAEpE,EAAM,WAAW,EAAK,GAAG,CAAC;oCACL,EAAK,SAAS,kBAAkB,OAAO,OAAO;;eAEnE,EAAM,WAAW,EAAK,GAAG,CAAC;oCACL,EAAK,SAAS,OAAO,wBAClC,GAEX,UAAW,GACd,CACD,KAAM,SAAS,EAAO,EAAM,CACxB,IAAI,EAAQ,EAAM,OAAO,CACrB,EAAO,KACX,EAAkB,GAAG,KAAK,MAAM,EAAM,UAAU,CAChD,IAAI,EAAU,EAAK,QAAQ,CAAC,QACxB,EAAQ,EAAM,WAAW,CACzB,UAAW,GAAM,eAAiB,EAAM,MAAM,CAC9C,MAAO,UAAW,CACd,EAAK,cAAgB,EAAM,UAC3B,EAAK,OAAO,EAEhB,OAAQ,EAAK,MAAM,KAAK,EAAK,CAChC,CAAC,CACF,EAAM,KAAK,EAAS,EAAM,CAE1B,EAAQ,KAAK,QAAQ,CAChB,QAAQ,QAAQ,CAChB,GAAG,UAAW,SAAS,EAAG,CACnB,EAAG,SAAW,IACd,EAAM,UAAY,EAAE,KAAK,CAAC,KAAK,CAC/B,EAAG,iBAAiB,CACpB,EAAG,gBAAgB,CACnB,EAAM,OAAO,EACN,EAAG,SAAW,KACrB,EAAG,iBAAiB,CACpB,EAAG,gBAAgB,CACnB,EAAM,QAAQ,GAEpB,EAEb,CAAC,CAEF,EAAM,YAAY,QAAQ,SAAS,cAAe,EAAkB,CAEpE,IAAI,EAAsB,EAAkB,OAAO,CAC/C,QAAS,CACL,UAAW,+BACX,SAAW,GAAS,CAChB,IAAI,EAcJ,MAbA,GAAe,uDAAuD,EAAM,WAAW,EAAK,SAAS,oBAAoB,OAAO,QAAQ,CAAC;;;2BAG9H,EAAM,WAAW,EAAK,GAAG,CAAC;;2BAE1B,EAAM,WAAW,EAAK,GAAG,CAAC;4CACT,EAAM,WAAW,EAAK,SAAS,oBAAoB,OAAO,cAAc,CAAC;;2BAE1F,EAAM,WAAW,EAAK,GAAG,CAAC;4CACT,EAAM,WAAW,EAAK,SAAS,OAAO,CAAC;;2BAExD,EAAM,WAAW,EAAK,GAAG,CAAC;4CACT,EAAK,SAAS,OAAO,wBAC1C,GAEX,MAAO,EAAK,4BAA6B,iBAAiB,CAC1D,UAAW,GACX,MAAO,IACV,CACD,KAAM,SAAS,EAAO,CAClB,IAAI,EAAO,KACX,EAAkB,GAAG,KAAK,MAAM,EAAM,UAAU,CAChD,IAAI,EAAU,EAAK,QAAQ,CAAC,QACxB,EAAQ,EAAM,WAAW,CACzB,QAAS,EAAM,SAAS,CACxB,MAAO,UAAW,CACT,KAAK,KAAK,EAAM,QAAQ,GACzB,EAAM,QAAU,MAEpB,EAAK,QAAQ,SAAU,CACnB,QAAS,uBACT,QAAS,CACL,MAAO,EAAM,QAChB,CACJ,CAAC,CACF,EAAK,OAAO,EAEhB,OAAQ,UAAW,CACf,EAAM,QAAU,KAChB,EAAM,OAAO,EAEjB,OAAQ,EAAK,MAAM,KAAK,EAAK,CAChC,CAAC,CACF,EAAM,KAAK,EAAS,EAAM,CAE1B,EAAQ,KAAK,WAAW,CAAC,QAAQ,QAAQ,EAEhD,CAAC,CAEF,EAAM,YAAY,QAAQ,SAAS,gBAAiB,EAAoB,CAExE,IAAI,EAAoB,EAAkB,OAAO,CAC7C,QAAS,CACL,SAAW,GAAS,CAChB,IAAI,EAaJ,MAZA,GAAe;eAChB,EAAM,WAAW,EAAK,GAAG,CAAC;oBACrB,EAAM,WAAW,EAAK,GAAG,CAAC;kCACZ,EAAM,WAAW,EAAK,GAAG,CAAC;;;;eAI7C,EAAM,WAAW,EAAK,GAAG,CAAC;oCACL,EAAM,WAAW,EAAK,SAAS,OAAO,CAAC;;eAE5D,EAAM,WAAW,EAAK,GAAG,CAAC;oCACL,EAAK,SAAS,OAAO,wBAClC,GAEX,MAAO,EAAK,0BAA2B,eAAe,CACtD,MAAO,OACV,CACD,KAAM,UAAW,CACb,IAAI,EAAO,KACX,EAAkB,GAAG,KAAK,MAAM,EAAM,UAAU,CAChD,IAAI,EAAU,EAAK,QAAQ,CAAC,QACxB,EAAQ,EAAM,WAAW,CACzB,UAAW,GACX,KAAM,EAAM,YAAY,SAAS,QAAQ,kBAAkB,KAC3D,SAAU,GACV,SAAU,GACV,UAAW,GACX,KAAM,KACN,OAAQ,KACR,MAAO,UAAW,CACd,OAAO,IAAI,gBAAgB,EAAM,KAAK,CACtC,EAAK,QAAQ,SAAU,CACnB,QAAS,qBACT,QAAS,CACL,KAAS,EAAM,OACf,MAAS,EAAM,OACf,OAAS,EAAM,QAClB,CACJ,CAAC,CACF,EAAK,OAAO,EAEhB,OAAQ,EAAK,MAAM,KAAK,EAAK,CAC7B,UAAW,SAAS,EAAI,CACpB,EAAG,iBAAiB,CACpB,EAAG,gBAAgB,EAEvB,KAAM,SAAS,EAAI,CACf,EAAM,UAAU,EAAG,CACnB,EAAM,WAAW,EAAG,cAAc,aAAa,MAAM,CACrD,EAAM,IAAI,YAAa,GAAM,EAEjC,UAAW,SAAS,EAAI,CACpB,EAAM,UAAU,EAAG,CACnB,EAAM,IAAI,YAAa,GAAK,EAEhC,UAAW,SAAS,EAAI,CACpB,EAAM,UAAU,EAAG,CACnB,EAAM,IAAI,YAAa,GAAM,EAEjC,OAAQ,SAAS,EAAI,CACjB,EAAM,WAAW,EAAG,OAAO,MAAM,EAErC,WAAY,SAAS,EAAO,CAExB,IAAK,IADD,EACK,EAAI,EAAG,EAAI,EAAM,OAAQ,EAAE,EAChC,GAAI,YAAY,KAAK,EAAM,GAAG,KAAK,CAAE,CACjC,EAAQ,EAAM,GACd,MAMR,GAHI,EAAM,MACN,OAAO,IAAI,gBAAgB,EAAM,KAAK,CAEtC,EAAO,CACP,EAAM,OAAS,EACf,EAAM,KAAO,OAAO,IAAI,gBAAgB,EAAM,CAC9C,IAAI,EAAM,IAAI,MACd,EAAI,IAAM,EAAM,KAChB,EAAI,OAAS,UAAW,CACpB,EAAM,OAAS,EAAI,MACnB,EAAM,QAAU,EAAI,OACpB,EAAM,IAAI,OAAQ,EAAM,YAAY,SAAS,QAAQ,kBAAkB,KAAK,CAC5E,EAAM,IAAI,YAAa,GAAK,CAC5B,EAAM,IAAI,WAAY,QAAU,EAAM,KAAO,KAAK,CAClD,EAAM,IAAI,WAAY,GAAK,OAG/B,EAAM,OAAS,KACf,EAAM,IAAI,OAAQ,EAAM,YAAY,SAAS,QAAQ,kBAAkB,UAAU,CACjF,EAAM,IAAI,YAAa,GAAM,CAC7B,EAAM,IAAI,WAAY,GAAG,CACzB,EAAM,IAAI,WAAY,GAAM,EAGvC,CAAC,CACF,EAAM,KAAK,EAAS,EAAM,EAEjC,CAAC,CAEF,EAAM,YAAY,QAAQ,SAAS,cAAe,EAAkB,CAEpE,SAAS,EAAY,EAAM,EAAK,CAC5B,KAAK,KAAO,EAAK,MAAM,IAAI,CAC3B,KAAK,IAAM,EAGf,EAAY,UAAU,MAAQ,UAAW,CAErC,IAAK,IADD,EAAM,EAAM,YAAY,SAAS,QAC5B,EAAI,EAAG,EAAI,KAAK,KAAK,OAAQ,EAAE,EAEpC,GADA,EAAM,EAAI,KAAK,KAAK,IAChB,CAAC,EACD,OAAO,KAAK,IAGpB,OAAO,GAGX,SAAS,EAAK,EAAM,EAAK,CACrB,OAAO,IAAI,EAAY,EAAM,EAAI,CAGrC,SAAS,EAAU,EAAO,CAatB,OAZI,aAAiB,EACV,EAAM,OAAO,CAEf,MAAM,QAAQ,EAAM,CAClB,EAAM,IAAI,EAAU,CAEL,OAAO,GAAS,UAAjC,EACE,OAAO,KAAK,EAAM,CAAC,OAAO,SAAS,EAAK,EAAI,CAE/C,MADA,GAAI,GAAO,EAAU,EAAM,GAAK,CACzB,GACR,EAAE,CAAC,CAEH,KAGZ,OAAO,MAAM,ECx4DX,SAAS,EAAO,CAEb,IAAI,EAAI,EAAM,OACV,EAAe,CACf,aACA,gBACA,0BACA,wBACA,iBACA,aACA,YACA,cACA,eACA,YACH,CACG,EAAqB,CACtB,WAAY,aACZ,cAAe,gBACf,wBAAyB,0BACzB,sBAAuB,wBACvB,eAAgB,iBAChB,WAAY,aACZ,UAAW,YACX,YAAa,cACb,aAAc,eACd,UAAW,cACb,CAEG,EAA0B,EAAM,YAAY,SAAS,cAAgB,CACrE,WAAY,cACZ,cAAe,iBACf,wBAAyB,4BACzB,sBAAuB,0BACvB,eAAgB,kBAChB,WAAY,cACZ,UAAW,aACX,YAAa,eACb,aAAc,gBACd,UAAW,YACd,CAEG,EAAqB,4eAOxB,CAEG,EAAgB,EAAM,GAAG,OAAO,OAAO,CACvC,KAAM,SAAS,EAAS,EAAS,CAC7B,EAAM,GAAG,OAAO,KAAK,KAAM,EAAS,EAAQ,CAE5C,KAAK,QAAU,EACf,KAAK,MAAQ,OAEb,KAAK,QAAQ,SAAS,sBAAsB,CAE5C,KAAK,oBAAoB,CACzB,KAAK,qBAAqB,EAG9B,QAAS,CACL,KAAM,gBACT,CAED,OAAQ,CACJ,SACH,CAED,QAAS,UAAW,CAChB,KAAK,aAAa,SAAS,CAC3B,EAAM,QAAQ,KAAK,QAAQ,KAAK,qCAAqC,CAAC,EAG1E,MAAO,UAAW,CACd,MAAO,CAAE,KAAM,KAAK,KAAM,MAAO,KAAK,MAAO,EAGjD,mBAAoB,UAAW,CAC3B,IAAI,EAAO,KACP,EAAW,EAEX,EAAU,EAAE,UAAW,CACvB,MAAS,oCACZ,CAAC,CAEF,EAAE,mHAAmH,CAAC,SAAS,KAAK,QAAQ,CAE5I,EAAQ,SAAS,KAAK,QAAQ,CAE9B,EAAa,IAAI,SAAS,EAAM,CAC5B,EAAE,kBAAoB,EAAS,GAAQ,iBAAmB,EAAS,GAAQ,uBAAyB,EAAO,KAAK,CAC3G,SAAS,EAAQ,CACjB,kBAAkB,CACf,KAAM,EAAM,UAAU,EAAmB,GAAM,CAC/C,OAAQ,EAAK,QAAQ,KAAK,EAAK,CAClC,CAAC,EACR,EAGN,oBAAqB,UAAW,CAC5B,IAAI,EAAU,EAAE,UAAW,CACvB,MAAS,qCACZ,CAAC,CAEF,EAAE,oHAAoH,CAAC,SAAS,KAAK,QAAQ,CAC7I,EAAQ,SAAS,KAAK,QAAQ,CAE9B,KAAK,aAAe,IAAI,EAAM,GAAG,gBAAgB,EAAS,CACtD,QAAS,CAAC,KAAK,QAAQ,OACvB,MAAO,KAAK,MACZ,KAAM,UACN,QAAS,EACT,MAAO,GACP,OAAQ,KAAK,QAAQ,KAAK,KAAK,CAClC,CAAC,CAEF,KAAK,aAAa,QAAQ,KAAK,uBAAuB,CAAC,GAAG,QAAS,KAAK,OAAO,KAAK,KAAK,CAAC,CAC1F,KAAK,aAAa,QAAQ,KAAK,wBAAwB,CAAC,GAAG,QAAS,KAAK,QAAQ,KAAK,KAAK,CAAC,EAGhG,QAAS,UAAW,CAChB,KAAK,MAAQ,KAAK,aAAa,OAAO,EAG1C,QAAS,SAAS,EAAG,CACjB,IAAI,EAAO,EAAE,OAAO,KAAK,aAAa,CAClC,EAAW,EAAE,OAAO,SAAS,cAAc,CAAC,KAAK,oBAAoB,CAErE,EAAE,UAAY,IACV,GACA,EAAS,OAAO,GAAM,CAG1B,KAAK,KAAO,GAEZ,KAAK,KAAO,MAIpB,OAAQ,UAAW,CACf,KAAK,QAAQ,SAAU,CAAE,KAAM,KAAK,KAAM,MAAO,KAAK,MAAO,CAAC,EAGlE,QAAS,UAAW,CAChB,KAAK,QAAQ,SAAU,CAAE,KAAM,KAAM,MAAO,KAAM,CAAC,EAE1D,CAAC,CAEF,EAAM,YAAY,cAAgB,IAEnC,OAAO,MAAM,ECrJnB,SAAS,EAAO,CACb,IAAI,EAAI,EAAM,OAEd,SAAS,EAAsB,EAAe,CAC1C,MAAO,yBAAyB,EAAM,GAAG,KAAK,CAAE,KAAM,EAAe,UAAW,gBAAiB,CAAC,CAAC,8BAA8B,EAAM,GAAG,KAAK,iBAAiB,CAAC,kBAGrK,IAAI,EAAU,EAAM,GAAG,QAEnB,EAAW,EAAM,YAAY,SAAS,QAAU,CAChD,cAAe,kBACf,eAAgB,mBAChB,YAAa,gBACb,YAAa,gBACb,UAAW,YACX,iBAAkB,CACd,YAAa,aACb,cAAe,SACf,aAAc,cACd,YAAa,UACb,SAAU,YACV,YAAa,eACb,YAAa,eAChB,CACD,gBAAiB,aACjB,iBAAkB,qBAClB,iBAAkB,qBAClB,KAAM,OACN,QAAS,UACT,KAAM,OACN,IAAK,MACL,aAAc,gBACd,UAAW,aACX,OAAQ,SACR,WAAY,OACZ,SAAU,YACV,OAAQ,mBACR,mBAAoB,CAChB,OAAQ,WACR,QAAS,SACT,UAAW,aACX,SAAU,YACV,KAAM,YACN,KAAM,aACN,SAAU,oBACV,SAAU,YACb,CACD,YAAa,CACT,UAAW,YACX,KAAM,OACN,OAAQ,SACR,QAAS,UACT,UAAW,YACX,SAAU,WACV,KAAM,OACN,KAAM,OACN,SAAU,YACV,SAAU,WACV,YAAa,kBAChB,CACD,sBAAuB,mBACvB,sBAAuB,mBACvB,OAAQ,eACR,cAAe,CACX,YAAa,eACb,WAAY,cACZ,cAAe,iBACf,SAAU,iBACb,CACD,cAAe,iBACf,YAAa,eACb,OAAQ,SACR,MAAO,cACP,aAAc,CACV,WAAY,YACZ,kBAAmB,qBACnB,gBAAiB,mBACjB,QAAS,UACZ,CACD,KAAM,UACN,MAAO,QACP,KAAM,OACN,KAAM,OACN,SAAU,YACV,gBAAiB,mBACjB,KAAM,OACN,YAAa,CAGT,aAAc,oBACd,cAAe,oBAClB,CACD,UAAW,aACX,SAAU,YACV,UAAW,YACX,WAAY,qBACZ,UAAW,OACd,CAEG,EAAe,CACf,KAAM,CACF,OACA,WACH,CACD,OAAQ,CACJ,SACA,wBACA,wBACH,CACD,KAAM,CACF,CAAC,OAAQ,OAAO,CAChB,YACA,CAAC,MAAO,OAAQ,QAAQ,CACxB,YACA,aAAc,WAAY,mBAAoB,mBAC9C,YACA,CAAC,OAAQ,SAAU,YAAY,CAC/B,YACA,YACA,YACA,kBACA,UACA,YACA,YACA,WACH,CACD,OAAQ,CACJ,gBACA,YACA,YACA,YACA,cACA,YACA,CAAC,gBAAiB,iBAAkB,cAAe,cAAc,CACjE,YACA,CAAC,eAAgB,YAAY,CAChC,CACD,KAAM,CACF,OACA,YACA,SACA,YACA,aACH,CACD,KAAM,CACF,SACA,QACA,kBACH,CACJ,CAEG,EAAiB,EAAM,YAAY,QAAU,CAC7C,UAAW,KACX,KAAM,IACN,OAAQ,SACR,QAAS,QACT,UAAW,2DACX,SAAU,2BACV,KAAM,WACN,KAAM,gBACN,SAAU,gBACV,SAAU,YACb,CAEG,EAAqB,4eAOxB,CAEG,EAAwB,EAAM,YAAY,SAAS,YAAc,CACjE,MAAO,cACP,YAAa,kBACb,MAAO,QACP,OAAQ,SACX,CAED,SAAS,GAAkB,CACvB,MAAO,CACP,KAAM,CACH,KAAM,SACN,KAAM,OACN,KAAM,OACN,QAAS,OACX,CACD,KAAM,CACH,KAAM,SACN,KAAM,OACN,KAAM,OACN,QAAS,OACX,CACD,UAAW,CAAE,KAAM,YAAa,CAEhC,KAAM,CACF,KAAM,OACN,KAAM,OACN,KAAM,cACN,WAAY,QACZ,QAAS,cACZ,CACD,SAAU,CACN,KAAM,SACN,KAAM,WACN,OAAQ,WACR,SAAU,QACV,KAAM,WACT,CACD,KAAM,CACF,KAAM,SACN,QAAS,wBACT,SAAU,OACV,MAAO,GACP,KAAM,OACN,UAAW,GACd,CACD,OAAQ,CACJ,KAAM,SACN,QAAS,wBACT,SAAU,SACV,MAAO,GACP,KAAM,SACN,UAAW,GACd,CACD,UAAW,CACP,KAAM,SACN,QAAS,wBACT,SAAU,YACV,MAAO,GACP,KAAM,YACN,UAAW,GACd,CACD,sBAAuB,CACnB,KAAM,SACN,KAAM,wBACN,QAAS,wBACT,MAAO,GACP,KAAM,mBACT,CACD,sBAAuB,CACnB,KAAM,SACN,KAAM,wBACN,QAAS,wBACT,MAAO,EACP,KAAM,mBACT,CACD,SAAU,CACN,KAAM,SACN,KAAM,WACN,QAAS,kBACT,SAAU,OACV,MAAO,GACP,KAAM,YACN,UAAW,GACd,CACD,IAAK,CACD,KAAM,SACN,KAAM,MACN,QAAS,oBACT,KAAM,MACT,CACD,KAAM,CACF,KAAM,SACN,KAAM,OACN,QAAS,qBACT,KAAM,OACT,CACD,MAAO,CACH,KAAM,SACN,KAAM,QACN,QAAS,sBACT,KAAM,YACT,CACD,UAAW,CACP,KAAM,YACN,KAAM,YACN,SAAU,YACV,UAAW,iBACX,QAAS,EAAsB,aAAa,CAC5C,kBAAmB,CACf,KAAM,SACN,OAAQ,YACR,KAAM,aACT,CACD,iBAAkB,CACd,SAAU,OACV,MAAO,CACH,CAAE,WAAY,CAAE,aAAc,OAAQ,gBAAiB,YAAa,eAAgB,wBAAyB,CAAE,KAAM,aAAc,KAAM,EAAS,iBAAiB,YAAa,CAChL,CAAE,WAAY,CAAE,aAAc,SAAU,gBAAiB,YAAa,eAAgB,wBAAyB,CAAE,KAAM,eAAgB,KAAM,EAAS,iBAAiB,cAAe,CACtL,CAAE,WAAY,CAAE,aAAc,QAAS,gBAAiB,YAAa,eAAgB,wBAAyB,CAAE,KAAM,cAAe,KAAM,EAAS,iBAAiB,aAAc,CACnL,CAAE,WAAY,CAAE,aAAc,UAAW,gBAAiB,YAAa,eAAgB,wBAAyB,CAAE,KAAM,gBAAiB,KAAM,EAAS,iBAAiB,YAAa,CACtL,CAAE,WAAY,CAAE,MAAO,cAAe,CAAE,CACxC,CAAE,WAAY,CAAE,aAAc,MAAO,gBAAiB,gBAAiB,eAAgB,wBAAyB,CAAE,KAAM,YAAa,KAAM,EAAS,iBAAiB,SAAU,CAC/K,CAAE,WAAY,CAAE,aAAc,SAAU,gBAAiB,gBAAiB,eAAgB,wBAAyB,CAAE,KAAM,eAAgB,KAAM,EAAS,iBAAiB,YAAa,CACxL,CAAE,WAAY,CAAE,aAAc,SAAU,gBAAiB,gBAAiB,eAAgB,wBAAyB,CAAE,KAAM,eAAgB,KAAM,EAAS,iBAAiB,YAAa,CAC3L,CACD,UAAW,QACd,CACJ,CACD,gBAAiB,CACb,KAAM,YACN,KAAM,kBACN,UAAW,SACX,QAAS,wBACT,SAAU,aACV,UAAW,cACX,iBAAkB,CACd,KAAM,UACN,SAAU,UACV,SAAU,OACV,QAAS,EACT,YAAa,GACb,SAAU,EACV,MAAO,GACP,UAAW,SACd,CACD,kBAAmB,CACf,KAAM,SACN,OAAQ,cACR,KAAM,UACN,SAAU,aACb,CACJ,CACD,UAAW,CACP,KAAM,YACN,KAAM,YACN,UAAW,SACX,QAAS,wBACT,SAAU,QACV,UAAW,cACX,iBAAkB,CACd,KAAM,UACN,SAAU,OACV,SAAU,mBACV,QAAS,EACT,YAAa,GACb,SAAU,EACV,MAAO,GACP,UAAW,SACd,CACD,kBAAmB,CACf,KAAM,SACN,OAAQ,cACR,KAAM,mBACN,SAAU,QACb,CACJ,CACD,WAAY,CACR,KAAM,YACN,KAAM,aACN,QAAS,wBACT,SAAU,aACV,UAAW,eACX,kBAAmB,CACf,KAAM,SACN,OAAQ,aACR,KAAM,cACT,CACD,iBAAkB,CACd,WAAY,CAAC,QAAS,cAAe,UAAW,kBAAmB,eAAgB,UAAU,CAC7F,MAAO,QACP,SAAU,OACV,UAAW,SACd,CACJ,CACD,SAAU,CACN,KAAM,YACN,KAAM,WACN,QAAS,wBACT,SAAU,WACV,UAAW,WACX,kBAAmB,CACf,KAAM,SACN,OAAQ,WACR,KAAM,YACT,CACD,iBAAkB,CACd,WAAY,CAAC,EAAG,EAAG,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAG,CAC9E,MAAO,GACP,SAAU,OACV,UAAW,SACd,CACJ,CACD,iBAAkB,CACd,KAAM,SACN,KAAM,mBACN,QAAS,mBACT,SAAU,WACV,KAAM,YACT,CACD,iBAAkB,CACd,KAAM,SACN,KAAM,mBACN,QAAS,mBACT,SAAU,WACV,KAAM,cACT,CACD,OAAQ,CACJ,KAAM,YACN,KAAM,SACN,UAAW,iBACX,QAAS,EAAsB,gBAAgB,CAC/C,kBAAmB,CACf,KAAM,SACN,OAAQ,cACR,KAAM,gBACT,CACD,iBAAkB,CACd,SAAU,OACV,MAAO,CACH,CAAE,WAAY,CAAE,aAAc,EAAe,UAAW,eAAgB,wBAAyB,gBAAiB,SAAU,CAAE,KAAM,EAAS,YAAY,UAAW,CACpK,CAAE,WAAY,CAAE,aAAc,EAAe,KAAM,eAAgB,wBAAyB,gBAAiB,SAAU,CAAE,KAAM,EAAS,YAAY,KAAM,CAC1J,CAAE,WAAY,CAAE,aAAc,EAAe,OAAQ,eAAgB,wBAAyB,gBAAiB,SAAU,CAAE,KAAM,EAAS,YAAY,OAAQ,OAAQ,EAAS,mBAAmB,OAAQ,CAC1M,CAAE,WAAY,CAAE,aAAc,EAAe,QAAS,eAAgB,wBAAyB,gBAAiB,SAAU,CAAE,KAAM,EAAS,YAAY,QAAS,OAAQ,EAAS,mBAAmB,QAAS,CAC7M,CAAE,WAAY,CAAE,aAAc,EAAe,UAAW,eAAgB,wBAAyB,gBAAiB,SAAU,CAAE,KAAM,EAAS,YAAY,UAAW,OAAQ,EAAS,mBAAmB,UAAW,CACnN,CAAE,WAAY,CAAE,aAAc,EAAe,SAAU,eAAgB,wBAAyB,gBAAiB,SAAU,CAAE,KAAM,EAAS,YAAY,SAAU,OAAQ,EAAS,mBAAmB,SAAU,CAChN,CAAE,WAAY,CAAE,aAAc,EAAe,KAAM,eAAgB,wBAAyB,gBAAiB,SAAU,CAAE,KAAM,EAAS,YAAY,KAAM,OAAQ,EAAS,mBAAmB,KAAM,CACpM,CAAE,WAAY,CAAE,aAAc,EAAe,KAAM,eAAgB,wBAAyB,gBAAiB,SAAU,CAAE,KAAM,EAAS,YAAY,KAAM,OAAQ,EAAS,mBAAmB,KAAM,CACpM,CAAE,WAAY,CAAE,aAAc,EAAe,SAAU,eAAgB,wBAAyB,gBAAiB,SAAU,CAAE,KAAM,EAAS,YAAY,SAAU,OAAQ,EAAS,mBAAmB,SAAU,CAChN,CAAE,WAAY,CAAE,aAAc,EAAe,SAAU,eAAgB,wBAAyB,gBAAiB,SAAU,CAAE,KAAM,EAAS,YAAY,SAAU,OAAQ,EAAS,mBAAmB,SAAU,CAChN,CAAE,WAAY,CAAE,aAAc,QAAS,aAAc,cAAe,CAAE,KAAM,EAAS,YAAY,YAAa,CACjH,CACD,aAAe,GAAS,CACpB,IAAI,EACW,mEAGf,OAHuF,EAAK,SAC5F,GAAgB,sCAAsC,EAAM,WAAW,EAAK,OAAO,CAAC,WACpF,GAAgB,GAAG,EAAM,WAAW,EAAK,KAAK,CAAC,gBACxC,GAEX,UAAW,QACd,CACJ,CACD,OAAQ,CACJ,KAAM,SACN,KAAM,SACN,SAAU,YACV,KAAM,SACN,QAAS,gBACT,UAAW,GACX,OAAQ,GACX,CACD,MAAO,CACH,KAAM,YACN,KAAM,QACN,UAAW,iBACX,QAAS,EAAsB,cAAc,CAC7C,kBAAmB,CACf,KAAM,SACN,OAAQ,QACR,KAAM,cACT,CACD,iBAAkB,CACd,SAAU,OACV,MAAO,CACH,CAAE,WAAY,CAAE,aAAc,QAAS,eAAgB,mBAAoB,CAAE,KAAM,cAAe,KAAM,EAAS,aAAa,WAAY,CAC1I,CAAE,WAAY,CAAE,aAAc,eAAgB,eAAgB,mBAAoB,CAAE,KAAM,2BAA4B,KAAM,EAAS,aAAa,kBAAmB,CACrK,CAAE,WAAY,CAAE,aAAc,aAAc,eAAgB,mBAAoB,CAAE,KAAM,yBAA0B,KAAM,EAAS,aAAa,gBAAiB,CAC/J,CAAE,WAAY,CAAE,aAAc,UAAW,eAAgB,mBAAoB,CAAE,KAAM,gBAAiB,KAAM,EAAS,aAAa,QAAS,CAC9I,CACD,UAAW,QACd,CACJ,CACD,OAAQ,CACJ,KAAM,YACN,KAAM,SACN,UAAW,iBACX,QAAS,EAAsB,cAAc,CAC7C,kBAAmB,CACf,KAAM,SACN,OAAQ,SACR,KAAM,cACT,CACD,iBAAkB,CACd,SAAU,OACV,MAAO,CACH,CAAE,WAAY,CAAE,aAAc,QAAS,eAAgB,qBAAsB,CAAE,KAAM,cAAe,KAAM,EAAS,cAAc,YAAa,CAC9I,CAAE,WAAY,CAAE,aAAc,OAAQ,eAAgB,qBAAsB,CAAE,KAAM,aAAc,KAAM,EAAS,cAAc,WAAY,CAC3I,CAAE,WAAY,CAAE,aAAc,UAAW,eAAgB,qBAAsB,CAAE,KAAM,gBAAiB,KAAM,EAAS,cAAc,cAAe,CACpJ,CAAE,WAAY,CAAE,aAAc,WAAY,eAAgB,qBAAsB,CAAE,KAAM,gBAAiB,KAAM,EAAS,cAAc,SAAU,CACnJ,CACD,UAAW,QACd,CACJ,CACD,QAAS,CACL,KAAM,cACN,KAAM,UACN,KAAM,cACN,eAAgB,EAAM,YAAY,cAClC,UAAW,SACX,QAAS,sBACT,kBAAmB,CACf,KAAM,SACN,OAAQ,UACX,CACJ,CACD,YAAa,CACT,KAAM,SACN,OAAQ,cACR,SAAU,QACb,CACD,UAAW,CACP,KAAM,SACN,KAAM,YACN,OAAQ,YACR,KAAM,OACT,CACD,gBAAiB,CACb,KAAM,SACN,KAAM,kBACN,QAAS,yBACT,SAAU,YACV,MAAO,GACP,KAAM,eACN,UAAW,GACX,SAAU,GACb,CACD,cAAe,CACX,KAAM,SACN,KAAM,gBACN,OAAQ,gBACR,SAAU,UACV,UAAW,GACX,KAAM,UACT,CACD,YAAa,CACT,KAAM,SACN,KAAM,cACN,OAAQ,cACR,KAAM,QACT,CAGD,cAAe,CACX,KAAM,SACN,KAAM,gBACN,QAAS,mBACT,MAAO,OACP,KAAM,2BACT,CACD,eAAgB,CACZ,KAAM,SACN,KAAM,iBACN,QAAS,mBACT,MAAO,QACP,KAAM,4BACT,CACD,YAAa,CACT,KAAM,SACN,KAAM,cACN,QAAS,gBACT,MAAO,QACP,KAAM,yBACT,CACD,YAAa,CACT,KAAM,SACN,KAAM,cACN,QAAS,gBACT,MAAO,QACP,KAAM,yBACT,CACD,aAAc,CACV,KAAM,SACN,KAAM,eACN,QAAS,sBACT,KAAM,sBACT,CACD,UAAW,CACP,KAAM,SACN,KAAM,YACN,QAAS,mBACT,KAAM,mBACT,CAGD,KAAM,CACF,KAAM,YACN,KAAM,OACN,UAAW,iBACX,QAAS,EAAsB,YAAY,CAC3C,kBAAmB,CACf,KAAM,SACN,OAAQ,OACR,KAAM,YACT,CACD,iBAAkB,CACd,SAAU,OACV,MAAO,CACH,CAAE,WAAY,CAAE,aAAc,MAAO,eAAgB,cAAe,CAAE,MAAO,GAAO,KAAM,EAAS,YAAY,aAAc,KAAM,WAAY,CAC/I,CAAE,WAAY,CAAE,aAAc,OAAQ,eAAgB,cAAe,CAAE,MAAO,GAAO,KAAM,EAAS,YAAY,cAAe,KAAM,YAAa,CACrJ,CACD,UAAW,QACd,CACJ,CACD,WAAY,CACR,KAAM,SACN,KAAM,aACN,OAAQ,aACR,KAAM,qBACT,CACJ,CAGD,IAAI,EAAqB,EAAQ,OAAO,CACpC,KAAM,SAAS,EAAS,EAAS,CAC7B,IAAI,EAAe,GAAiB,CACpC,OAAO,KAAK,EAAa,CAAC,QAAS,GAAM,CACjC,IAAM,eACN,EAAa,GAAG,SAAW,aAEjC,CAEF,EAAQ,MAAQ,EAAQ,OAAS,EAAmB,UAAU,QAAQ,MAAM,EAAQ,aACpF,EAAQ,eAAiB,EACzB,EAAQ,aAAe,EAEvB,EAAQ,GAAG,KAAK,KAAK,KAAM,EAAS,EAAQ,CAC5C,IAAI,EAAc,KAAK,OAAO,KAAK,KAAK,CAExC,KAAK,QAAQ,SAAS,wBAAwB,CAE9C,KAAK,KAAK,CACN,MAAO,EACP,OAAQ,EACR,OAAQ,EACX,CAAC,EAEN,OAAQ,SAAS,EAAG,CAChB,IAAI,EAAS,EAAE,OACX,EAAW,EAAO,KAAK,WAAW,CAClC,EAAQ,EAAE,OAAS,EAAO,KAAK,QAAQ,EAAI,EAAE,OAAO,KAAK,CACzD,EAAc,EAAO,KAAK,UAAU,CACpC,EAAS,EAAO,KAAK,SAAS,CAC9B,EAAU,EAAO,KAAK,UAAU,EAAI,EAAE,CAoB1C,GAlBI,IAAU,UAEV,EAAS,EAAO,KAAK,QAAQ,EAG7B,IAAgB,qBAChB,EAAc,wBACd,KAGA,IAAgB,qBAChB,EAAc,wBACd,KAGJ,EAAQ,SAAW,GAAY,KAC/B,EAAQ,MAAQ,GAAS,KAErB,EAAQ,CACR,KAAK,OAAO,CACR,KAAM,EACG,UACZ,CAAC,CACF,OAGC,KAIL,KAAI,EAAO,CACP,QAAS,EACA,UACZ,CAEG,OAAO,EAAK,QAAQ,OAAU,YAC9B,EAAK,QAAQ,MAAQ,EAAE,QAAU,GAAO,MAG5C,KAAK,OAAO,EAAK,GAErB,OAAQ,CACJ,SACA,SACH,CACD,QAAS,CACL,KAAM,qBACN,UAAW,GACX,MAAO,EACP,SAAU,OACb,CACD,OAAQ,SAAS,EAAM,CACnB,KAAK,QAAQ,SAAU,EAAK,EAEhC,OAAQ,SAAS,EAAM,CACnB,KAAK,QAAQ,SAAU,EAAK,EAEhC,QAAS,SAAS,EAAY,CAI1B,IAAK,IAHD,EAAQ,EACR,EAAQ,KAAK,QAAQ,CAEhB,EAAI,EAAG,EAAI,EAAM,OAAQ,IAAK,CACnC,IAAI,EAAW,EAAM,GAAG,SACpB,EAAO,EAAM,GAAG,KAChB,EAAQ,EAAM,WAAW,EAAM,GAAU,CAAG,EAAM,IAAW,CAAG,EAEhE,GAAY,cAEZ,EAAQ,EAAM,OAAO,CAAC,eAAe,EAGzC,KAAK,YAAY,EAAM,EAAO,EAAU,EAAM,CAGlD,KAAK,OAAO,GAAK,EAErB,OAAQ,UAAW,CACf,OAAO,KAAK,QAAQ,KAAK,kBAAkB,CAAC,SAAS,CAAC,IAAI,SAAS,EAAS,CAExE,MADA,GAAU,EAAE,EAAQ,CACb,CACH,SAAU,EAAQ,KAAK,gBAAgB,CACvC,KAAM,KAAK,SAAS,EAAQ,CAC/B,EACH,KAAK,KAAK,CAAC,EAEjB,YAAa,SAAS,EAAM,EAAO,EAAU,EAAO,CAChD,IAAI,EAAY,EAAK,UACjB,EAAY,EAAK,UACjB,EAAS,EAAM,eAAe,EAAU,KAAK,cAAc,CAAC,CAC5D,EAAW,EAAK,SAChB,EAAS,GACT,EAAU,EAAM,EAAM,EAAW,EAAS,EAE9C,GAAI,IAAa,YACb,EAAY,EAAM,OAAO,CAAC,WAAW,CAEjC,GAAa,EAAU,MAAQ,EAAU,KAAK,SAC9C,EAAU,GAAS,EAAU,KAAK,QAAQ,CAAG,EAE7C,KAAK,OAAO,EAAW,EAAQ,UAE5B,IAAa,YACpB,EAAW,EAAM,eAAe,CAChC,EAAO,EAAM,WAAW,CACxB,EAAO,EAAU,KAAK,QAEtB,EAAK,KAAK,kBAAkB,CAAC,YAAY,aAAa,CACtD,EAAK,KAAK,+CAAiD,EAAO,YAAY,CAAC,SAAS,aAAa,CACrG,EAAK,KAAK,mDAAqD,EAAW,YAAY,CAAC,SAAS,aAAa,SACtG,IAAa,cAAgB,IAAa,QACjD,EAAO,MAAM,EAAM,SACZ,IAAa,cAAgB,IAAa,WAAY,CAC7D,GAAI,EAAU,GAAG,SAAS,CAAE,CACxB,EAAU,KAAK,aAAc,EAAM,CACnC,EAAU,KAAK,QAAS,EAAM,CAC9B,OAEJ,EAAQ,EAAS,KAAK,oBAAoB,CAAC,MAAM,CAAC,MAAM,IAAI,CAAC,GAAG,MAAM,CACtE,EAAS,KAAK,oBAAoB,CAAC,KAAK,EAAQ,KAAO,EAAQ,QAAQ,CACvE,EAAO,MAAM,EAAM,CAGnB,GAAa,EAAU,SACnB,OAAO,GAAU,UACjB,EAAS,CAAC,CAAC,EACJ,OAAO,GAAU,WACxB,AAKI,EALA,EAAU,KAAK,QAAQ,CACd,EAAU,KAAK,QAAQ,GAAK,EAI5B,GAAS,MAI1B,KAAK,OAAO,EAAW,EAAO,GAGzC,CAAC,CAEF,EAAM,cAAc,mBAAmB,mBAAwB,EAAM,cAAc,mBAAmB,QAEtG,EAAM,YAAY,QAAU,EAE5B,EAAM,YAAY,KAAO,EAAM,GAAG,OAEnC,OAAO,MAAM,CCpxBZ,SAAS,EAAM,EAAM,EAAQ,CAOzB,MANA,CACI,IAAS,EAAE,CAEX,OAAO,OACA,OAAO,OAAO,EAAQ,EAAK,CAE/B,OAAO,KAAK,EAAK,CAAC,OAAO,SAAS,EAAM,EAAK,CAEhD,MADA,GAAK,GAAO,EAAK,GACV,GACR,EAAO,CAGd,SAAS,EAAgB,EAAS,CAC9B,IAAI,EAAW,IAAI,EAAE,SACjB,EAAU,EAAS,SAAS,CAEhC,EAAU,EAAM,EAAS,CACrB,WAAmB,KACnB,WAAmB,GACnB,WAAmB,OACnB,QAAmB,KACnB,iBAAmB,OACnB,YAAmB,OACnB,cAAmB,KACnB,eAAmB,KACnB,WAAmB,QACnB,SAAmB,GACnB,UAAmB,KACnB,OAAmB,MACnB,UAAmB,GACnB,SAAmB,GACnB,MAAmB,EACnB,UAAmB,GACnB,SAAmB,EACnB,cAAmB,GACtB,CAAC,CAGF,MAAM,QAAQ,IAAI,WACd,MAAM,QAAQ,QAAQ,aAAa,SAAS,CAC/C,CAED,IAAI,EAAY,EAAkB,EAAQ,WAAY,EAAQ,SAAS,CAEvE,SAAS,EAAU,EAAO,CACtB,GAAI,GAAS,KAAM,CAEf,IAAK,IADD,EAAQ,GACH,EAAI,EAAM,OAAQ,EAAE,GAAK,GAC9B,GAAS,EAAU,EAAM,OAAO,EAAE,CAAC,CAEvC,OAAO,EAEX,MAAO,GAGX,IAAI,EAAS,EAAQ,WAAa,CAAE,KAAM,EAAG,MAAO,EAAQ,WAAY,CAAG,KAE3E,SAAS,EAAO,EAAM,CAIlB,OAHK,EAGE,EAAM,EAAM,CACf,WAAY,EACZ,UAAW,EACX,YAAa,EACb,aAAc,EACjB,CAAC,CAPS,EAkHf,OAxGA,EAAQ,WAAW,MAAM,UAAU,CAC/B,IAAI,EAAO,EAAQ,WAAW,MAAM,CACpC,GAAI,CAAC,EAAK,OACN,OAAO,EAAS,OAAO,gBAAgB,CAI3C,IAAI,EAAU,EAAQ,QAAQ,IAAI,SAAS,EAAI,CAIvC,OAHA,OAAO,GAAO,SACP,CAAE,MAAO,EAAK,MAAO,EAAK,CAE1B,GAEb,CACE,EAAe,EAAQ,IAAI,SAAS,EAAI,CACxC,OAAO,EAAI,OAAS,EAAI,OAC1B,CACE,EAAe,EAAa,IAAI,EAAU,CAG1C,EAAO,EAAK,IAAI,SAAS,EAAK,EAAS,CACvC,MAAO,CACH,MAAO,EAAQ,IAAI,SAAS,EAAK,EAAS,CACtC,IAAI,EAAQ,EAAI,EAAI,OAuBpB,OAlBI,EAAQ,gBACJ,GAAS,OACL,EAAI,OACJ,EAAQ,MAAM,OAAO,EAAI,OAAQ,EAAM,CAEvC,GAAS,IAIjB,EAAa,GAAY,KAAK,IAC1B,EAAU,EAAM,CAChB,EAAa,GAChB,EAME,EAAO,CACH,QACP,OAAQ,EAAQ,cAAgB,KAAO,EAAI,OAC3C,WAAY,EAAW,EAAI,EAAQ,eAAiB,EAAQ,cAC/D,CAAC,EACJ,CACL,EACH,CAGF,EAAK,QAAQ,CACT,MAAO,EAAa,IAAI,SAAS,EAAM,CACnC,OAAO,EAAO,CACV,MAAO,EACP,WAAY,EAAQ,iBACpB,MAAO,EAAQ,YAClB,CAAC,EACJ,CACL,CAAC,CAKF,IAAI,EAAQ,IAAI,MAAM,YAAY,MAC9B,EAAK,OAAS,EACd,EAAQ,OAAS,EACjB,EAAQ,UACR,GACA,GACA,GACA,CACI,WAAY,EAAQ,WACpB,SAAU,EAAQ,SAClB,cAAe,SAClB,CACJ,CAGD,EAAM,SAAS,CACX,KAAM,SACA,OACN,QAAS,EAAa,IAAI,SAAS,EAAG,EAAE,CACpC,MAAO,CAAE,MAAO,EAAG,MAAO,EAAG,EAC/B,CACL,CAAC,CAEF,EAAM,KAAK,CACP,UAAa,EAAQ,UACrB,UAAa,EAAQ,UACrB,OAAa,EAAQ,OACrB,WAAa,GACb,MAAa,EAAQ,MACrB,SAAa,EAAQ,SACrB,SAAa,EAAQ,SACrB,WAAa,EAChB,CAAE,EAAS,QAAQ,KAAK,EAAS,CAAC,EACrC,CAEK,EAGX,IAAI,EAAmB,EAAE,CAErB,EAAoB,SAAS,EAAY,EAAU,CACnD,IAAI,EAAK,EAAW,IAAM,EACtB,EAAO,EAAiB,GAC5B,GAAI,CAAC,EAAM,CACP,IAAI,EAAM,EAAM,SAAS,cAAc,MAAM,CAC7C,EAAI,MAAM,SAAW,QACrB,EAAI,MAAM,KAAO,WACjB,EAAI,MAAM,IAAM,WAChB,EAAI,MAAM,WAAa,EACvB,EAAI,MAAM,SAAW,EAAW,KAChC,EAAI,MAAM,WAAa,MACvB,IAAK,IAAI,EAAI,GAAI,EAAI,IAAK,EAAE,EACxB,EAAO,SAAS,cAAc,OAAO,CACrC,EAAK,YAAY,SAAS,eAAe,OAAO,aAAa,EAAE,CAAC,CAAC,CACjE,EAAI,YAAY,EAAK,CAEzB,SAAS,KAAK,YAAY,EAAI,CAC9B,IAAI,EAAS,EAAE,CACf,IAAK,EAAI,GAAI,EAAO,EAAI,WAAY,EAAI,KAAO,EAAM,EAAE,EAAG,EAAO,EAAK,YAClE,EAAO,GAAK,EAAK,YAErB,KAAQ,EAAO,EAAI,YACf,EAAI,YAAY,EAAK,CAEzB,EAAO,EAAiB,GAAM,SAAS,EAAI,CACvC,IAAI,EAAO,EAAG,WAAW,EAAE,CACvB,EAAQ,EAAO,GASnB,OARI,IAEA,EAAO,SAAS,cAAc,OAAO,CACrC,EAAK,YAAY,SAAS,eAAe,OAAO,aAAa,EAAK,CAAC,CAAC,CACpE,EAAI,YAAY,EAAK,CACrB,EAAQ,EAAO,GAAQ,EAAK,YAC5B,EAAI,YAAY,EAAK,EAElB,GAGf,OAAO,GAGX,MAAM,YAAY,gBAAkB,GCzNvC,SAAS,EAAO,CAEb,aAGA,IAAI,EAAiB,EAAM,YAAY,eACvC,IAAI,EAAI,EAAM,OAEd,EAAe,mBAAoB,UAAU,CACzC,IAAI,EAAS,EAAU,EAEvB,SAAS,GAAS,CACT,IACD,EAAW,EAAE,QAAQ,CAAC,eAAe,CACrC,EAAQ,EAAE,QAAQ,CAAC,YAAY,CAC/B,EAAS,SAAS,EAAM,CACxB,EAAW,EAAS,kBAAkB,CACtC,EAAQ,EAAM,eAAe,CAE7B,EAAS,KAAK,SAAU,UAAU,CAC9B,EAAM,OAAO,CACb,IAAI,EAAO,EAAS,OAAO,CACtB,EAAQ,MAAM,QAAQ,EACvB,EAAQ,MAAM,OAAO,aAAa,CAEtC,EAAQ,SAAS,EAAM,YAAY,aAAa,EAAK,CAAC,EACxD,EAEN,EAAM,WAAW,CACb,OAAQ,EAAQ,KAAK,QAAQ,cAAc,+BAA+B,CAC1E,OAAQ,EAAQ,UAAY,eAAiB,cAC7C,SAAU,EAAQ,UAAY,YAAc,WAC/C,CAAC,CAGN,SAAS,GAAO,CACZ,GAAQ,CAER,IAAI,EAAO,EAAQ,MAAM,OAAO,CAC5B,EAAQ,EAAQ,MAAM,OAAO,CAC7B,GAAQ,KAGR,EAAS,MAAM,KAAK,CAFpB,EAAS,MAAM,EAAM,YAAY,aAAa,EAAK,CAAC,CAIxD,IAAI,EAAM,EAAQ,WAClB,GAAI,EAAK,CACL,IAAI,EAAM,EAAM,GAAG,SAAS,GAAG,QAAQ,IACnC,EAAM,EAAM,GAAG,SAAS,GAAG,QAAQ,IACnC,EAAiB,EAAI,KACrB,EAAe,EAAI,GACnB,EAAU,EAAM,YAAY,KAAK,QAAQ,QAEzC,2BAA2B,KAAK,EAAI,aAAa,GACjD,AAGI,EAHD,aAA0B,GAAW,EAAkB,EAAe,MAAM,CACrE,EAAM,YAAY,aAAa,EAAM,MAAM,EAAe,MAAM,IAAK,EAAe,MAAM,IAAI,CAAC,OAAO,CAAC,CAEvG,EAAM,YAAY,aAAa,EAAe,MAAM,EAG9D,EAAI,cAAgB,YACpB,AAGI,EAHD,aAAwB,GAAW,EAAkB,EAAa,MAAM,CACjE,EAAM,YAAY,aAAa,EAAM,MAAM,EAAa,MAAM,IAAK,EAAa,MAAM,IAAI,CAAC,OAAO,CAAC,CAEnG,EAAM,YAAY,aAAa,EAAI,GAAG,MAAM,GAGtD,EAAI,cAAgB,YAAc,EAAI,cAAgB,uBACtD,AAGI,EAHD,aAA0B,GAAW,EAAkB,EAAe,MAAM,CACrE,EAAM,YAAY,aAAa,EAAM,MAAM,EAAe,MAAM,IAAK,EAAe,MAAM,IAAI,CAAC,OAAO,CAAC,CAEvG,EAAM,YAAY,aAAa,EAAI,KAAK,MAAM,EAG5D,EAAS,WAAW,CAChB,aAAc,SAAS,EAAM,CACzB,IAAI,EAED,GAAkB,aAA0B,GAAW,EAAkB,EAAe,MAAM,CACtF,EAAM,MAAM,EAAe,MAAM,IAAK,EAAe,MAAM,IAAI,CAAC,OAAO,CAEvE,EAAiB,EAAe,MAAM,EAAI,EAL3C,EAQP,GAAgB,aAAwB,GAAW,EAAkB,EAAa,MAAM,CAClF,EAAM,MAAM,EAAa,MAAM,IAAK,EAAa,MAAM,IAAI,CAAC,OAAO,CAEnE,EAAe,EAAa,MAAM,EAAI,EAI/C,MADA,GAAO,EAAM,YAAY,aAAa,EAAK,CAAG,EACvC,CAAC,EAAM,YAAY,WACrB,oBAAoB,EAAI,cAAc,EAAM,EAAM,EAAG,EAEzD,MACA,MACR,CAAC,MAEF,EAAS,WAAW,CAAE,aAAc,KAAM,IAAK,KAAM,IAAK,KAAM,CAAC,CAErE,EAAM,MAAM,CAGhB,SAAS,EAAkB,EAAO,CAC9B,OAAQ,GAAS,EAAM,MAAQ,MAAQ,EAAM,MAAQ,MAAQ,EAAM,IAAM,IAAM,EAAM,IAAM,GAG/F,MAAO,CACH,KAAM,SAAS,EAAS,CACpB,EAAU,EACV,GAAM,EAEV,KAAM,WACT,EACH,CAEF,EAAe,mBAAoB,UAAU,CACzC,IAAI,EAAS,EAAM,EACnB,SAAS,GAAS,CACT,IACD,EAAO,EAAE,+BAA+B,CAAC,gBAAgB,CACrD,SAAa,WACb,WAAa,GACb,SAAa,GAChB,CAAC,CACF,EAAQ,EAAE,yCAAyC,CAAC,YAAY,CAChE,EAAK,SAAS,EAAM,CACpB,EAAQ,EAAM,eAAe,CAC7B,EAAO,EAAK,oBAAoB,CAEhC,EAAK,KAAK,SAAU,UAAU,CAC1B,EAAM,OAAO,CACb,IAAI,EAAO,EAAK,OAAO,CAAC,GACpB,GACA,EAAQ,SAAS,EAAK,MAAM,EAElC,EAEN,EAAM,WAAW,CACb,OAAQ,EAAQ,KAAK,QAAQ,cAAc,+BAA+B,CAC1E,OAAQ,EAAQ,UAAY,eAAiB,cAC7C,SAAU,EAAQ,UAAY,YAAc,WAC/C,CAAC,CAEN,SAAS,GAAO,CACZ,GAAQ,CACR,IAAI,EAAQ,EAAQ,WAAW,KAAK,MAChC,EAAO,EAAE,CAAE,EAAM,SAAS,EAAG,CAAE,EAAK,KAAK,CAAE,MAAO,EAAI,CAAC,EACvD,aAAiB,EAAM,YAAY,KAAK,QAAQ,OAChD,EAAM,KAAK,EAAI,EAId,EAAM,IAAI,MAAM,UAAU,CAAC,QAAQ,EAAI,CAE5C,IAAI,EAAa,IAAI,EAAM,KAAK,WAAW,CAAQ,OAAM,CAAC,CAC1D,EAAK,cAAc,EAAW,CAC9B,EAAW,MAAM,CACjB,EAAM,MAAM,CAEhB,MAAO,CACH,KAAM,SAAS,EAAS,CACpB,EAAU,EACV,GAAM,EAEV,KAAM,iBACT,EACH,GAEH,OAAO,MAAM,EC1KX,SAAS,EAAO,CAEb,IAAI,EAAI,EAAM,OACV,EAAa,EAAM,YACnB,EAAM,IACN,EAAY,IACZ,EAAsB,CACtB,iBAAkB,2BAClB,uBAAwB,+BACxB,aAAc,0BACd,oBAAqB,4BACrB,gBAAiB,8BACjB,eAAgB,uBAChB,gBAAiB,8BACjB,oBAAqB,wBACrB,cAAe,kBACf,cAAe,kBACf,eAAgB,SAChB,uBAAwB,kBACxB,iBAAkB,WAClB,kBAAmB,YACnB,eAAgB,SAChB,mBAAoB,cACpB,eAAgB,SAChB,mBAAoB,SACpB,iBAAkB,yBAClB,yBAA0B,GAC1B,qBAAsB,gBACtB,oBAAqB,iBACrB,oBAAqB,kBACrB,gBAAiB,kDACjB,eAAgB,IAChB,kBAAmB,iBACnB,iBAAkB,WAClB,kBAAmB,OACnB,kBAAmB,OACnB,qBAAsB,wEACtB,qBAAsB,kDACzB,CAEG,EAAY,EAAM,GAAG,OAAO,OAAO,CACnC,KAAM,SAAS,EAAS,EAAS,CAC7B,IAAI,EAAa,EAAU,WAE3B,EAAM,GAAG,OAAO,KAAK,KAAM,EAAS,EAAQ,CAE5C,EAAU,KAAK,QAEf,EAAQ,SAAS,EAAW,iBAAiB,CAE7C,KAAK,YAAc,EAAQ,WAE3B,KAAK,YAAY,CACjB,KAAK,aAAa,CAClB,KAAK,MAAQ,IAAI,EAAM,IAAI,KAAK,EAAQ,GAAG,CAE3C,KAAK,MAAM,OAAO,CAAC,KAAK,qBAAqB,EAAE,CAAC,CAAC,CAAC,CAClD,KAAK,2BAA2B,CAEhC,KAAK,oBAAoB,GAAK,CAE9B,KAAK,iBAAiB,CAEtB,KAAK,UAAU,KAAK,QAAS,KAAK,qBAAqB,KAAK,KAAK,CAAC,CAElE,KAAK,UAAU,KAAK,MAAO,KAAK,mBAAmB,KAAK,KAAK,CAAC,CAE9D,EAAQ,GAAG,QAAS,8BAA+B,KAAK,oBAAoB,KAAK,KAAK,CAAC,CAEvF,EAAQ,GAAG,QAAS,KAAM,KAAK,eAAe,KAAK,KAAK,CAAC,CAEzD,EAAQ,GAAG,WAAY,KAAO,EAAM,EAAW,eAAiB,EAAM,EAAW,eAAgB,KAAK,cAAc,KAAK,KAAK,CAAC,EAGnI,QAAS,CACL,KAAM,YACN,WAAY,CACR,SAAU,IACb,CACJ,CAED,OAAQ,CACJ,SACA,UACA,SACH,CAED,cAAe,UAAW,CAClB,AAKJ,KAAK,WADL,KAAK,cAAc,KAAK,QAAS,KAAK,eAAgB,GAAK,CAC5C,KAAK,QACf,KAAK,EAAM,OAAO,cAAe,EAAK,EAAU,WAAW,gBAAgB,CAAC,CAC5E,QAAQ,QAAQ,CAChB,GAAG,UAAW,KAAK,iBAAiB,KAAK,KAAK,CAAC,CAC/C,GAAG,OAAQ,KAAK,cAAc,KAAK,KAAK,CAAC,GAGlD,eAAgB,SAAS,EAAU,CAC/B,IAAI,EAAe,EAAW,KAAO,KAAK,QAAQ,KAAK,CACvD,KAAK,QAAQ,KAAK,CAClB,KAAK,QAAU,KACf,KAAK,cAAc,KAAK,QAAS,KAAK,eAAgB,GAAM,CAC5D,KAAK,eAAe,EAAa,EAGrC,aAAc,SAAS,EAAQ,EAAe,CACtC,CAAC,GAAU,EAAgB,GAI/B,KAAK,cAAc,EAAQ,EAAe,GAAM,EAGpD,cAAe,SAAS,EAAQ,EAAe,EAAc,CACzD,IAAI,EAAO,KACP,EAAa,EAAU,WAE3B,EAAK,OAAS,EAAM,QAAQ,MAAM,EAAK,QAAQ,CAC/C,EAAK,QAAU,EACf,EAAK,eAAiB,EAEtB,EAAK,YAAY,EAAc,GAAK,CAE/B,EAAK,oBAAoB,GAIV,EAAK,gBAAgB,CAE3B,SAAS,EAAW,oBAAsB,EAAY,EAAW,uBAAuB,CAEtG,EAAK,sBAAsB,GAG/B,qBAAsB,SAAS,EAAQ,CACnC,IAAI,EAAO,KACP,EAAK,EAAK,cAAc,CACxB,EAAU,EAAK,gBAAgB,CAC/B,EAAa,EAAM,WAAW,EAAG,CACjC,EAAO,EAAQ,KAAK,EAAM,EAAU,WAAW,cAAc,CAC7D,EAAO,EAAQ,KAAK,EAAM,EAAU,WAAW,cAAc,CAE7D,IAAW,IACX,EAAK,SAAS,aAAa,CAC3B,EAAK,SAAS,aAAa,GAE3B,EAAK,YAAY,aAAc,EAAE,EAAK,OAAS,EAAa,EAAG,GAAG,YAAc,EAAG,GAAG,YAAc,EAAI,IAAe,GAAG,CAC1H,EAAK,YAAY,aAAc,EAAE,EAAK,OAAS,IAAe,EAAI,EAAa,EAAG,GAAG,YAAc,EAAG,GAAG,YAAc,GAAG,GAKlI,oBAAqB,SAAS,EAAQ,CAClC,IAAI,EAAO,KACP,EAAa,EAAU,WACvB,EAAU,EAAK,QACf,EACA,EACA,EAAgB,EAAK,gBAAgB,CACzC,EAAmB,EAAc,KAAK,EAAM,EAAW,cAAc,CACrE,EAAmB,EAAc,KAAK,EAAM,EAAW,cAAc,CAEjE,GACA,EAAiB,GAAG,YAAa,SAAS,EAAO,CAC7C,EAAM,gBAAgB,CACtB,EAAM,iBAAiB,CACvB,EAAK,oBAAsB,GAC3B,EAAK,qBAAqB,EAAQ,WAAW,UAAY,EAAK,OAAS,EAAI,IAAI,EACjF,CAEF,EAAiB,GAAG,YAAa,SAAS,EAAO,CAC7C,EAAM,gBAAgB,CACtB,EAAM,iBAAiB,CACvB,EAAK,oBAAsB,GAC3B,EAAK,qBAAqB,EAAQ,WAAW,UAAY,EAAK,OAAS,GAAK,GAAG,EACjF,CAEF,EAAiB,IAAI,EAAiB,CAAC,GAAG,UAAW,UAAW,CAC5D,EAAK,oBAAsB,IAC7B,GAEF,EAAiB,KAAK,CACtB,EAAiB,KAAK,GAI9B,YAAa,SAAS,EAAc,EAAqB,CACrD,IAAI,EACA,EAAgB,EAAE,CAClB,EAAM,EAAM,IACZ,EAAU,EAAI,QACd,EAAS,KAAK,QACd,EAAgB,KAAK,eACrB,EAAa,EAAU,WAE3B,IAAK,EAAM,EAAG,EAAM,EAAO,OAAQ,IAAO,CACtC,IAAI,EAAQ,EAAO,GAEf,EAAmB,IAAQ,EAC3B,EAAO,CAAE,UAAW,EAAW,eAAiB,EAAY,EAAW,uBAAyB,EAAW,KAAM,MAAO,CACxH,EAAiB,EAAE,CASvB,GARI,EAAM,OAAO,GAAK,YAClB,EAAK,WAAa,aAGlB,IACA,EAAK,WAAa,EAAW,kBAG7B,GAAmB,EACnB,EAAe,KAAK,EAAQ,QAAS,CACjC,KAAM,OACN,MAAO,EAAM,MAAM,CACnB,UAAW,EAAW,kBAAoB,EAAY,EAAW,gBACjE,UAAW,GACd,CAAE,EAAE,CAAC,CAAC,KACJ,CACH,EAAe,KAAK,EAAQ,OAAQ,CAChC,UAAW,EAAW,eACtB,MAAO,EAAM,MAAM,CACtB,CAAE,CAAC,EAAQ,OAAQ,CAAE,UAAW,EAAW,mBAAoB,CAAE,CAAC,EAAI,KAAK,EAAM,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAE9F,IAAI,EAAoB,EAAQ,EAAE,EAAM,KAAK,aAAa,EAAE,sDAAsD,EAAM,MAAM,CAAC,mCAAmC,CAAE,CAChK,KAAM,EAAW,kBACjB,SAAU,OACb,CAAC,CAAC,CAAC,GAAG,CAEP,EAAe,KAAK,EAAQ,OAAQ,CAChC,UAAW,iBACX,YAAa,eAChB,CAAE,CAAC,EAAkB,CAAC,CAAC,CAG5B,EAAc,KAAK,EAAQ,KAAM,EAAM,EAAe,CAAC,CAG3D,EAAM,QAAQ,KAAK,gBAAgB,CAAC,CACpC,KAAK,YAAY,CACjB,KAAK,aAAa,CAClB,KAAK,MAAM,OAAO,CAAE,KAAK,qBAAqB,EAAe,EAAoB,CAAC,CAAC,CACnF,KAAK,2BAA2B,EAEpC,0BAA2B,UAAW,CAClC,IAAI,EAAO,KACX,KAAK,QAAQ,KAAK,8BAA8B,CAAC,KAAK,SAAS,EAAK,EAAM,CACtE,IAAI,EAAK,EAAE,EAAM,CACb,EAAY,EAAK,SAAW,EAAE,CAC9B,EAAgB,EAAU,OAAO,GAAS,EAAM,OAAO,GAAK,UAAU,CACtE,EAAuB,CAAC,EAAK,SAAW,EAAK,SAAW,EAAc,OAAS,EAC/E,EAAY,EAAG,KAAK,YAAY,CAChC,EAAuB,EAAE,GAAyB,EAAK,SAAW,GAAO,EAAU,OAAS,GAC5F,EAAsB,EAAE,GAAyB,EAAK,SAAW,IAAQ,GAC7E,EAAG,oBAAoB,CACnB,KAAM,EAAU,WAAW,kBAC3B,SAAU,OACV,MAAO,CACH,CAAE,KAAM,SAAU,KAAM,QAAS,WAAY,CAAE,eAAgB,SAAU,kBAAmB,EAAW,CAAE,QAAS,CAAC,EAAsB,CACzI,CAAE,KAAM,YAAa,KAAM,OAAQ,WAAY,CAAE,eAAgB,YAAa,kBAAmB,EAAW,CAAE,CAC9G,CAAE,KAAM,SAAU,KAAM,SAAU,WAAY,CAAE,eAAgB,SAAU,kBAAmB,EAAW,CAAE,CAC1G,CAAE,KAAM,OAAQ,KAAM,YAAa,WAAY,CAAE,eAAgB,OAAQ,kBAAmB,EAAW,CAAE,QAAS,CAAC,EAAsB,CACzI,CAAE,KAAM,aAAc,KAAM,cAAe,WAAY,CAAE,eAAgB,aAAc,kBAAmB,EAAW,CAAE,QAAS,EAAsB,CACtJ,CAAE,KAAM,YAAa,KAAM,aAAc,WAAY,CAAE,eAAgB,YAAa,kBAAmB,EAAW,CAAE,QAAS,EAAqB,CACrJ,CACD,MAAO,EAAK,oBAAoB,KAAK,EAAK,CAC7C,CAAC,EACJ,EAEN,qBAAsB,SAAS,EAAe,EAAqB,CAC/D,IAAI,EAAU,EAAM,IAAI,QACpB,EAAa,EAAU,WACvB,EAAe,EAAQ,MAAO,CAAE,UAAW,oCAAqC,CAAC,CACjF,EAAmB,CAAC,EAAQ,KAAM,CAClC,UAAW,EAAW,gBACtB,KAAM,UACT,CAAE,EAAc,CAAE,KAAM,KAAK,CAI9B,GAFA,EAAsB,GAElB,EAAqB,CACrB,IAAI,EAAkB,EAAW,iBAAmB,EAAY,EAAW,qBAAuB,EAElG,EAAiB,GAAM,EAAQ,OAAQ,CAAE,WAAY,OAAQ,SAAU,GAAI,UAAW,EAAkB,EAAW,cAAe,CAAE,CAChI,EAAQ,EAAE,EAAM,GAAG,KAAK,CAAE,KAAM,EAAW,oBAAqB,UAAW,gBAAiB,CAAC,CAAC,CAAC,GAAG,CACrG,CAAC,CAEF,EAAiB,GAAM,EAAQ,OAAQ,CAAE,WAAY,OAAQ,SAAU,GAAI,UAAW,EAAkB,EAAW,cAAe,CAAE,CAChI,EAAQ,EAAE,EAAM,GAAG,KAAK,CAAE,KAAM,EAAW,oBAAqB,UAAW,gBAAiB,CAAC,CAAC,CAAC,GAAG,CACrG,CAAC,CAKN,MAFA,GAAa,SAAW,EAEjB,EAAQ,MAAO,CAAE,UAAW,EAAW,eAAgB,CAAE,CAAC,EAAa,CAAC,EAGnF,gBAAiB,UAAW,CACxB,IAAI,EAAa,EAAU,WAC3B,KAAK,UAAY,IAAI,EAAM,GAAG,SAAS,KAAK,QAAS,CACjD,OAAQ,SAAS,EAAW,iBAC5B,UAAW,EAAM,EAAW,eAC5B,KAAM,IACN,UAAW,GACX,OAAQ,QACR,IAAK,UAAW,CACR,KAAK,UAAU,MACf,KAAK,UAAU,KAAK,QAAQ,EAGpC,KAAM,SAAS,EAAS,CAEpB,OADW,EAAE,EAAQ,CAAC,OAAO,CAAC,KAAK,8BAA+B,GAAG,CACzD,KAAK,eAAiB,EAAW,qBAAuB,gBAAkB,EAAW,qBAAuB,gBAAgB,CAAC,QAAQ,MAAM,EAE9J,CAAC,EAGN,iBAAkB,SAAS,EAAG,CACtB,KAAK,UACD,EAAE,QAAU,IACZ,KAAK,gBAAgB,CAGrB,EAAE,QAAU,IACZ,KAAK,eAAe,GAAK,GAKrC,cAAe,UAAW,CAClB,KAAK,SACL,KAAK,gBAAgB,EAI7B,mBAAoB,SAAS,EAAG,CAC5B,EAAE,gBAAgB,CAClB,KAAK,QAAQ,UAAW,CAAE,SAAU,EAAE,SAAU,SAAU,EAAE,SAAU,CAAC,EAG3E,qBAAsB,SAAS,EAAG,CAC1B,KAAK,SACL,EAAE,gBAAgB,EAG1B,oBAAqB,SAAS,EAAG,CAC7B,IAAI,EAAY,EAAE,EAAE,OAAO,CAAC,QAAQ,KAAK,CAAC,KAAK,YAAY,CACvD,EAAU,EAAE,EAAE,OAAO,CAAC,QAAQ,KAAK,CAAC,KAAK,UAAU,CAMvD,GAJI,KAAK,SACL,KAAK,gBAAgB,CAGrB,GAAa,EACb,OAAO,EAAP,CACI,IAAK,SACD,KAAK,eAAe,EAAE,CACtB,MACJ,IAAK,YACD,KAAK,kBAAkB,EAAU,CACjC,MACJ,IAAK,SACD,KAAK,cAAc,EAAU,CAC7B,MACJ,IAAK,OACD,KAAK,WAAW,EAAU,CAC1B,MACJ,IAAK,aACD,KAAK,WAAW,EAAW,EAAE,CAC7B,MACJ,IAAK,YACD,KAAK,WAAW,EAAW,GAAG,CAC9B,QAIhB,kBAAmB,SAAS,EAAW,CACnC,KAAK,QAAQ,YAAa,CAAE,KAAM,EAAW,CAAC,EAElD,cAAe,SAAS,EAAW,CAC/B,IAAI,EAAmB,KAAK,QAAQ,UAAU,GAAM,EAAG,MAAM,EAAI,EAAU,CACvE,EAAgB,SAAS,EAAG,CAC5B,IAAI,EAAM,EAAE,OACR,EAAI,eAAiB,EAAI,gBAAkB,GAC3C,KAAK,QAAQ,SAAU,CAAE,KAAM,EAAI,cAAe,WAAY,EAAkB,CAAC,EAEvF,KAAK,KAAK,CAEZ,KAAK,YAAY,cAAe,CAC5B,MAAO,EACP,cAAe,EAClB,CAAC,EAEN,WAAY,SAAS,EAAW,CAC5B,KAAK,QAAQ,OAAQ,CAAE,KAAM,EAAW,CAAC,EAE7C,WAAY,SAAS,EAAW,EAAW,CACvC,IAAI,EAAa,KAAK,QAAQ,UAAU,GAAS,EAAM,MAAM,GAAK,EAAU,CACxE,EAAgB,EAAa,EAC7B,EAAgB,GAAK,GAAiB,KAAK,QAAQ,QAIvD,KAAK,QAAQ,UAAW,CAAE,SAAU,EAAY,SAAU,EAAe,CAAC,EAE9E,eAAgB,SAAS,EAAG,CACxB,IAAI,EAAmB,EAAE,EAAE,OAAO,CAAC,QAAQ,KAAK,CAAC,KAAK,YAAY,CAE9D,KAAK,SACL,KAAK,gBAAgB,CAGzB,IAAI,EAAgB,SAAS,EAAG,CAClB,EAAE,OAEJ,aAAa,EACjB,KAAK,QAAQ,SAAU,CAAE,KAAM,EAAkB,aAAc,GAAM,CAAC,EAE5E,KAAK,KAAK,CAEZ,KAAK,YAAY,eAAgB,CAC7B,MAAO,EACV,CAAC,EAGN,eAAgB,SAAS,EAAG,CACxB,IAAI,EAAoB,EAAE,EAAE,OAAO,CAAC,MAAM,CAE1C,GAAI,EAAE,EAAE,OAAO,CAAC,GAAG,EAAM,EAAU,WAAW,gBAAgB,EAAI,CAAC,EAAmB,CAClF,EAAE,gBAAgB,CAClB,OAGA,KAAK,SACL,KAAK,gBAAgB,CAGzB,KAAK,oBAAoB,EAAE,EAAE,OAAO,CAAC,QAAQ,KAAK,CAAC,CACnD,KAAK,QAAQ,SAAU,CAAE,KAAM,EAAmB,YAAa,GAAO,CAAC,EAG3E,eAAgB,SAAS,EAAc,CAC/B,KAAK,QAAQ,KAAK,gBAAgB,MAAM,GAAK,GAAgB,IAAiB,MAIlF,KAAK,QAAQ,SAAU,CAAE,KAAM,EAAc,WAAY,KAAK,eAAgB,CAAC,EAGnF,aAAc,SAAS,EAAI,CACvB,EAAG,OAAO,QAAQ,YAAY,UAAU,CACxC,KAAK,QAAQ,SAAU,CAAE,YAAa,GAAM,CAAC,EAGjD,cAAe,SAAS,EAAI,CACxB,IAAI,EAAY,EAAE,EAAG,OAAO,CAAC,QAAQ,KAAK,CAAC,KAAK,YAAY,CACxD,GACA,KAAK,QAAQ,OAAQ,CAAE,KAAM,EAAW,CAAC,EAIjD,WAAY,UAAW,CACnB,IAAI,EAAa,EAAU,WAC3B,IAAI,EAAY,KAAK,QAAQ,KAAK,IAAM,EAAW,aAAa,CAC3D,EAAU,OAGX,EAAM,QAAQ,EAAU,CAFxB,EAAY,EAAE,kBAAkB,EAAW,aAAa,wCAAwC,CAAC,SAAS,KAAK,QAAQ,CAK3H,EAAU,YAAY,CAClB,KAAM,EAAW,kBACjB,SAAU,OACV,MAAO,KAAK,aAAa,KAAK,KAAK,CACtC,CAAC,EAEN,YAAa,UAAW,CACpB,IAAI,EAAa,EAAU,WAC3B,IAAI,EAAa,KAAK,QAAQ,KAAK,IAAM,EAAW,oBAAoB,CACnE,EAAW,OAGZ,EAAM,QAAQ,EAAW,CAFzB,EAAa,EAAE,kBAAkB,EAAW,oBAAoB,aAAa,CAAC,SAAS,KAAK,QAAQ,CAKxG,EAAW,oBAAoB,CAC3B,KAAM,EAAW,kBACjB,SAAU,OACV,OAAQ,KAAK,SAAW,EAAE,EAAE,IAAI,IAAU,CACtC,KAAM,EAAM,MAAM,CAClB,WAAY,CAAE,kBAAmB,EAAM,MAAM,CAAE,CAC/C,KAAM,EAAM,OAAO,GAAK,UAAY,MAAQ,YAC5C,SAAU,EACb,EAAE,CACH,MAAO,KAAK,cAAc,KAAK,KAAK,CACvC,CAAC,EAGN,QAAS,UAAW,CAChB,KAAK,UAAU,SAAS,EAG5B,mBAAoB,UAAW,CAC3B,IAAI,EAAU,KAAK,QACnB,OAAO,EAAQ,YAAc,CAAC,MAAM,EAAQ,WAAW,SAAS,EAGpE,oBAAqB,SAAS,EAAM,CAChC,IAAI,EAAO,KACP,EAAc,EAAK,cAAc,CACjC,EAAsB,EAAM,WAAW,EAAY,CACnD,EAAY,EAAW,EAAK,CAC5B,EAAa,EAAK,OAAS,EAAK,UAAU,CAAC,KAAO,EAAK,UAAU,CAAC,KAAO,EAAY,UAAU,CAAC,OAAO,CAAC,UAAU,CAAC,KACnH,EAAmB,EAAY,GAAG,YAClC,EAEA,EAAK,OACD,EAAa,EACb,EAAe,EAAsB,GAAc,EAAmB,GAC/D,EAAa,EAAY,IAChC,EAAe,EAAsB,EAAa,GAGlD,EAAsB,EAAmB,EAAa,EACtD,EAAe,EAAa,EAAY,EACjC,EAAsB,IAC7B,EAAe,GAIvB,EAAY,QAAQ,CAAC,QAAQ,CAAE,WAAc,EAAc,CAAE,OAAQ,SAAU,UAAW,CACtF,EAAK,sBAAsB,EAC7B,EAGN,aAAc,UAAW,CACrB,OAAO,KAAK,gBAAgB,CAAC,KAAK,KAAK,EAG3C,eAAgB,UAAW,CACvB,OAAO,KAAK,QAAQ,KAAK,EAAM,EAAU,WAAW,eAAe,EAGvE,qBAAsB,SAAS,EAAO,CAClC,IAAI,EAAO,KACP,EAAc,EAAK,cAAc,CACjC,EAAU,EAAM,WAAW,EAAY,CAE3C,EAAY,QAAQ,CAAC,QAAQ,CAAE,WAAc,EAAU,EAAO,CAAE,OAAQ,SAAU,UAAW,CACrF,EAAK,oBACL,EAAK,qBAAqB,EAAM,CAEhC,EAAK,sBAAsB,EAEjC,EAET,CAAC,CAEF,EAAM,YAAY,UAAY,EAC9B,EAAE,OAAO,GAAM,EAAW,CAAE,WAAY,EAAqB,CAAC,GAC/D,OAAO,MAAM,EC9iBf,SAAS,EAAO,CAEb,IAAI,EAAI,EAAM,OACV,EAAS,EAAM,GAAG,OAClB,EAAa,CACb,QAAS,YACT,OAAQ,WACR,eAAgB,oBAChB,eAAgB,oBAChB,KAAM,SACN,iBAAkB,WAClB,eAAgB,kBAChB,eAAgB,SAChB,QAAS,YACT,QAAS,4BACT,kBAAmB,iCACnB,cAAe,6BACf,sBAAuB,uCACvB,cAAe,YAClB,CAED,EAAM,YAAY,SAAS,WAAa,CACpC,IAAK,MACL,cAAe,oBACf,eAAgB,oBAChB,cAAe,kBACf,kBAAmB,sBACnB,MAAO,QACP,OAAQ,SACR,aAAc,2BACd,MAAO,QACP,OAAQ,WACR,aAAc,OACd,IAAK,MACL,GAAI,KACJ,UAAW,CACP,OAAQ,CACJ,SAAU,gBACV,eAAgB,wBAChB,WAAY,mBACZ,SAAU,iBACV,QAAS,eACT,aAAc,sBACjB,CACD,KAAM,CACF,GAAK,UACL,IAAK,cACL,GAAK,iBACL,GAAK,gBACR,CACD,OAAQ,CACJ,GAAI,cACJ,IAAK,kBACL,IAAK,8BACL,GAAI,kBACJ,IAAK,2BACL,GAAI,eACP,CACJ,CACJ,CAED,IAAI,EAAU,EAAO,OAAO,CACxB,KAAM,SAAS,EAAS,EAAS,CAC7B,EAAO,GAAG,KAAK,KAAK,KAAM,EAAS,EAAQ,CAE3C,KAAK,QAAQ,SAAS,EAAW,WAAW,QAAQ,CAEpD,KAAK,SAAW,KAAK,QAAQ,KAAK,IAAM,EAAW,WAAW,eAAe,CACxE,GAAG,QAAS,KAAK,QAAQ,KAAK,KAAK,CAAC,CAEzC,IAAI,EAAW,EAAQ,SAAW,EAAW,WAAW,iBAAmB,EAAW,WAAW,eACjG,KAAK,MAAQ,EAAE,EAAM,GAAG,KAAK,EAAS,CAAC,CAClC,UAAU,KAAK,SAAS,CAE7B,KAAK,WAAa,EAAM,KAAK,KAAK,SAAS,MAAM,CAAE,GAAK,CAEnD,EAAQ,UACT,KAAK,WAAW,MAAM,EAG9B,QAAS,CACL,KAAM,UACT,CACD,OAAQ,CAAE,SAAU,CACpB,QAAS,UAAW,CAChB,OAAO,KAAK,QAAQ,UAExB,OAAQ,SAAS,EAAM,CACH,EAAM,GAAG,KAAK,WAAW,CAAC,OAAO,WAAW,CAElD,MAAM,CAAC,EAAO,UAAY,SAAS,CAC7C,EAAM,GAAG,KAAK,KAAK,MAAO,CAAE,KAAM,EAAO,EAAW,WAAW,eAAiB,EAAW,WAAW,iBAAkB,CAAC,CAEzH,KAAK,QAAQ,SAAW,CAAC,GAE7B,QAAS,UAAW,CAChB,IAAI,EAAO,KAAK,SAAS,CACzB,KAAK,OAAO,EAAK,CACjB,KAAK,QAAQ,SAAU,CAAQ,OAAM,CAAC,EAE7C,CAAC,CAEF,EAAM,KAAK,QAAQ,uBAAyB,EAAM,KAAK,OAAO,OAAO,CACjE,KAAM,SAAS,EAAS,EAAU,EAAS,CACvC,EAAM,KAAK,OAAO,GAAG,KAAK,KAAK,KAAM,EAAS,EAAU,EAAQ,CAEhE,KAAK,QAAU,KAAK,OAAO,KAAK,KAAK,CACrC,EAAE,KAAK,QAAQ,CAAC,GAAG,SAAU,KAAK,QAAQ,EAE9C,QAAS,UAAW,CAChB,IAAI,EAAO,KACP,EAAQ,EAAK,SAAS,uBAAuB,KAAK,CAEtD,EAAE,EAAK,QAAQ,CAAC,IAAI,aAAiB,KAAO,GAAK,EAAM,EAE3D,OAAQ,UAAW,CACf,IAAI,EAAQ,KAAK,QAAQ,MACzB,KAAK,SAAS,uBAAuB,IAAI,EAAM,EAEtD,CAAC,CAEF,EAAM,KAAK,QAAQ,OAAO,uBAAyB,EAAM,KAAK,OAAO,OAAO,CACxE,KAAM,SAAS,EAAQ,EAAU,EAAS,CACtC,EAAM,KAAK,OAAO,GAAG,KAAK,KAAK,KAAM,EAAO,QAAQ,GAAI,EAAU,EAAQ,CAE1E,KAAK,OAAS,EACd,KAAK,QAAU,KAAK,OAAO,KAAK,KAAK,CACrC,KAAK,OAAO,MAAM,SAAU,KAAK,QAAQ,EAE7C,QAAS,UAAW,CAChB,IACI,EADU,KAAK,SAAS,uBACR,KAAK,CACrB,EAAO,EAAE,KAAK,OAAO,QAAQ,CAAC,KAAK,aAAa,CAE/C,IAAS,QAAU,aAAiB,MAAU,IAAS,UAAY,CAAC,MAAM,EAAM,CACjF,KAAK,OAAO,MAAM,EAAM,CAExB,KAAK,OAAO,MAAM,KAAK,EAG/B,OAAQ,UAAW,CACf,IAAI,EAAQ,KAAK,OAAO,OAAO,CACjB,KAAK,SAAS,uBAEpB,IAAI,EAAM,EAEzB,CAAC,CAEF,IAAI,EAAY,CACZ,cAAgB,GACZ,eAAe,EAAW,eAAe,IAAI,EAAK,SAAS,cAAc,oBAC1D,EAAW,eAAe,qCAEjC,EAAM,GAAG,KAAK,CAAE,KAAM,SAAU,UAAW,eAAgB,CAAC,CAC5D,gEAAgE,EAAK,SAAS,OAAO,SAAS,EAAK,GAAG,2DAE7F,EAAK,GAAG,iFAAiF,EAAK,GAAG,sCAAsC,EAAK,KAAK,2CAA2C,EAAK,KAAK,IAAI,EAAK,SAAS,aAAa,4BACnO,EAAW,sBAAsB,cAC/B,EAAK,GAAG,4BACJ,EAAK,GAAG,qCACb,EAAK,GAAG,2GAIhC,kBAAoB,GAChB,eAAe,EAAW,eAAe,IAAI,EAAK,SAAS,kBAAkB,oBAC9D,EAAW,eAAe,6BAGd,EAAK,SAAS,kBAAkB,SACvC,EAAK,GAAG,0BACR,EAAK,GAAG,qFACR,EAAK,GAAG,8BACR,EAAK,GAAG,gBAAgB,EAAK,SAAS,aAAa,QACnD,EAAK,GAAG,oBACR,EAAK,GAAG,wBACR,EAAK,GAAG,gDAIX,EAAK,GAAG,2FACkD,EAAK,GAAG,oGAGlE,EAAK,GAAG,2FACkD,EAAK,GAAG,6BAA6B,EAAK,GAAG,kFAGvG,EAAK,GAAG,qFAC8C,EAAK,GAAG,yBAAyB,EAAK,GAAG,8EAGpH,SAAW,GACP,qBAAqB,EAAK,QAAQ,cAAc,EAAK,IAAI,IAClD,EAAM,GAAG,KAAK,EAAK,UAAU,GAAG,EAAK,YAEhD,cAAgB,GACZ,gBAAgB,EAAK,GAAG,oFAAoF,EAAK,SAAS,MAAM,+BAChH,EAAK,GAAG,mEAAmE,EAAK,SAAS,MAAM,kBACtH,CAED,SAAS,EAAe,EAAQ,CAI5B,IAAK,IAHD,EAAO,EAAE,CACT,EAAS,EAAE,CAEN,EAAI,EAAG,EAAI,EAAO,OAAQ,IAC1B,EAAK,EAAO,GAAG,OAGT,CAAC,EAAK,EAAO,GAAG,OAAO,SAAW,EAAO,GAAG,UACnD,EAAK,EAAO,GAAG,OAAO,QAAU,KAHhC,EAAK,EAAO,GAAG,OAAS,EAAO,GAC/B,EAAO,KAAK,EAAO,GAAG,EAM9B,OAAO,EAGX,SAAS,EAAO,EAAY,EAAO,CAK/B,IAAK,IAJD,EAAqB,GACrB,EAAO,aAAsB,EAAM,KAAK,wBAA0B,EAAW,MAAM,CACnF,EAAe,KACf,EAAS,KAAK,OACT,EAAI,EAAG,EAAI,EAAK,OAAQ,IAAK,CAClC,IAAI,EAAO,EAAK,GACZ,EAAO,EAAK,KAAK,UAAU,CAAC,kBAAkB,EAAM,SAAS,CAAC,KAAK,CACnE,EAAc,IAAU,IAAQ,IAAU,IAAM,EAAK,QAAQ,EAAM,EAAI,EAEvE,EADe,EAAO,KAAK,EAAa,CACN,EAAK,SAAU,EAAM,CAE3D,EAAqB,GAAsB,GAAsB,EACjE,EAAK,OAAS,CAAC,GAAe,CAAC,EAE3B,EAAM,QAAW,GAAU,CAAC,EAAO,OACnC,EAAK,QAAU,CAAC,EAAK,OACd,GAAU,EAAO,QAAQ,EAAK,KAAK,EAAI,KAC9C,EAAK,QAAU,IASvB,OALI,GAEA,EAAW,OAAO,CAAE,MAAO,SAAU,SAAU,MAAO,MAAO,GAAM,CAAC,CAGjE,EAGX,SAAS,EAAW,EAAY,CAG5B,IAAK,IAFD,EAAO,aAAsB,EAAM,KAAK,wBAA0B,EAAW,MAAM,CAE9E,EAAI,EAAG,EAAI,EAAK,OAAQ,IAAK,CAClC,IAAI,EAAO,EAAK,GAChB,EAAK,QAAU,GAEX,EAAK,aACL,EAAW,EAAK,SAAS,EAKrC,IAAI,EAAsB,EAAM,YAAY,oBAAsB,EAAM,KAAK,iBAAiB,OAAO,CACjG,aAAc,SAAS,EAAG,CACtB,IAAI,EAAa,EAAI,EAAE,OAAO,WAAa,KAAK,iBAC5C,EAAU,SAAS,EAAM,CACzB,OAAO,EAAK,SAEZ,EAAQ,SAAS,EAAM,CACvB,OAAO,EAAK,WAAa,OAAS,EAAM,YAAY,aAAa,EAAK,MAAM,CAAG,EAAK,OAEpF,EAAS,SAAS,EAAO,EAAO,EAAO,CACvC,OAAO,EAAM,YAAY,EAAM,GAAK,GAGpC,EADO,EAAW,MAAM,CACV,QAAQ,CAAC,GAAG,MAC1B,EAAS,EAAO,OAAO,SAAS,EAAM,CACtC,OAAO,EAAK,WAAa,SAC3B,CAEF,EAAS,EAAO,OAAS,EAAO,GAAG,QAAU,GAC7C,EAAS,EAAO,OAAO,EAAQ,CAAC,IAAI,EAAM,CAEtC,KAAK,gBAAkB,KAAK,aAAe,KAAK,YAAY,OAAO,SACnE,EAAS,EAAO,OAAO,KAAK,YAAY,OAAO,QAAQ,CAAC,CAAC,MAAM,CAAC,OAAO,EAAO,EAGlF,KAAK,IAAI,cAAe,CACZ,SACA,SACX,CAAC,EAEN,YAAa,SAAS,EAAG,CACrB,EAAE,gBAAgB,CAElB,IAAI,EAAO,EAAE,OAAO,SAAS,EAAE,KAAK,CACpC,EAAK,IAAI,UAAW,CAAC,EAAK,QAAQ,EAEtC,gBAAiB,GACjB,eAAgB,GAChB,aAAc,SAAS,EAAG,CACtB,IAAI,EAAQ,OAAO,GAAK,SAAW,EAAI,EAAE,EAAE,OAAO,CAAC,KAAK,CAAC,kBAAkB,EAAM,SAAS,CAAC,KAAK,CAC5F,EAAa,KAAK,iBAEtB,KAAK,IAAI,kBAAmB,CAAC,CAAC,EAAM,CAEpC,IAAI,EAAe,EAAO,KAAK,KAAK,YAAY,CAChD,EAAW,EAAW,CACtB,EAAa,EAAY,EAAM,EAEnC,MAAO,UAAW,CACd,KAAK,IAAI,eAAgB,CAAE,MAAO,MAAO,SAAU,CAAE,CAAE,SAAU,KAAM,MAAO,KAAM,CAAE,CAAE,CAAC,CACzF,KAAK,IAAI,cAAe,CAAE,OAAQ,EAAE,CAAE,CAAC,EAE3C,eAAgB,SAAS,EAAG,CACxB,IAAI,EAAW,EAAE,OAAO,UAAU,CAClC,KAAK,IAAI,eAAgB,EAAS,KAAK,CAIlC,KAAK,IAAI,eAAe,EACzB,KAAK,OAAO,CAGhB,KAAK,IAAI,oCAAqC,EAAS,MAAM,EAEjE,OAAQ,UAAW,CACf,OAAO,KAAK,IAAI,eAAe,GAAK,QAExC,SAAU,UAAW,CACjB,OAAO,KAAK,IAAI,eAAe,GAAK,UAExC,SAAU,UAAW,CACjB,OAAO,KAAK,IAAI,eAAe,GAAK,UAExC,OAAQ,UAAW,CACf,OAAO,KAAK,IAAI,eAAe,GAAK,QAE3C,CAAC,CAEF,SAAS,EAAiB,EAAW,CACjC,IAAI,EAAW,EAAM,YAAY,SAAS,WAAW,UACjD,EAAS,EAAE,CACf,IAAK,IAAI,KAAQ,EACR,KAAU,eAAe,EAAK,CAInC,IAAK,IAAI,KAAY,EAAU,GACtB,EAAU,GAAM,eAAe,EAAS,EAI7C,EAAO,KAAK,CACR,KAAM,EAAS,GAAM,GACrB,MAAO,EACP,OAAQ,EAAO,IAAM,EACf,OACT,CAAC,CAGV,OAAO,EAGX,IAAI,EAAuB,EAAM,YAAY,qBAAuB,CAChE,WAAY,SAAS,EAAO,EAAQ,CAChC,MAAO,CAAC,CACJ,KAAM,EAAM,YAAY,SAAS,WAAW,IAC5C,SAAU,GACV,QAAS,GACT,MAAO,KAAK,OAAO,EAAM,OAAO,CAAE,IAAK,EAAG,CAAC,CAAE,EAAO,CACvD,CAAC,EAEN,OAAQ,SAAS,EAAO,EAAQ,CAC5B,IAAI,EAAS,EAAE,CACX,EAAW,EAAM,YAAY,SAAS,WACtC,EAAc,EAAM,OAAO,EAAO,CAClC,EAAQ,EAAM,OAAO,CAgEzB,OA9DA,EAAY,YAAY,SAAS,EAAK,EAAK,EAAM,CAC7C,IAAI,EAAU,GACV,EAAM,YAAY,EAAI,GACtB,EAAU,IAGd,IAAI,EAAQ,EAAK,MACb,EAAW,EAAK,SAChB,EAAO,EAAK,KAEhB,AAKI,EALA,IAAU,OACC,QACJ,EAAK,OACD,EAAM,YAAY,WAAW,KAAK,EAAO,EAAK,OAAO,CAErD,OAAO,EAGtB,AAGI,EAHA,IAAU,MAAQ,EAAK,OAChB,EAAM,YAAY,WAAW,KAAK,EAAO,EAAK,OAAO,CAErD,GAAY,QAAU,EAAS,OAAS,GAG/C,IAAa,WAAa,IAAa,cACvC,EAAW,UAGX,IAAa,SACb,EAAQ,EAAM,YAAY,aAAa,EAAM,EAGjD,EAAO,KAAK,CACE,WACH,QACD,OACG,UACZ,CAAC,EACJ,CAEF,EAAS,EAAe,EAAO,CAE/B,EAAO,KAAK,SAAS,EAAG,EAAG,CAiBvB,OAhBI,EAAE,WAAa,EAAE,SACV,EAGP,EAAE,WAAa,SAAW,EAAE,WAAa,QAClC,EAAE,WAAa,QAAU,GAAK,EAGrC,EAAE,WAAa,UAAY,EAAE,WAAa,SACnC,EAAE,WAAa,SAAW,GAAK,EAGtC,EAAE,WAAa,QAAU,EAAE,WAAa,OACjC,EAAE,WAAa,OAAS,GAAK,EAGjC,GACT,CAEK,GAGX,WAAY,SAAS,EAAO,EAAQ,CAEhC,IAAI,EAAQ,EAAM,OAAO,CACrB,EAAS,KAAK,gBAAgB,EAAQ,EAAM,CAC5C,EAIJ,GAFA,IAAmB,EAAO,OAAO,QAAQ,CAErC,GAAU,EAAO,QAAU,SAAU,CACrC,IAAI,EAAQ,EAAO,SAAS,GAAG,MAE3B,aAAiB,KACjB,EAAO,OACA,OAAO,GAAS,SACvB,EAAO,SACA,OAAO,GAAS,WACvB,EAAO,UAIf,GAAI,CAAC,EAAM,CAEP,IAAI,EAAW,KAAK,OAAO,EAAM,IAAI,EAAE,CAAE,EAAO,CAAC,GACjD,EAAO,GAAY,EAAS,SAExB,GAAQ,UACR,EAAO,MAIf,OAAO,GAGX,gBAAiB,SAAS,EAAQ,EAAO,CACrC,IAAI,EAAa,EAAM,QAAQ,CAC3B,EAQJ,OANI,IACA,EAAW,EAAW,QAAQ,OAAO,SAAS,EAAM,CAChD,OAAO,EAAK,QAAU,GACxB,CAAC,IAGA,GAGX,OAAQ,SAAS,EAAQ,EAAO,CAC5B,IAAI,EAAgB,KAAK,gBAAgB,EAAQ,EAAM,CAElD,KAIL,KAAI,EAAU,EAAc,OAAO,QAAQ,CACvC,EAAO,EAAQ,OAEnB,OAAO,EAAQ,OAEf,IAAI,EAAS,CACH,OACG,UACZ,CAEG,EAAW,EAAQ,SAKvB,OAJI,GAAY,EAAS,SACrB,EAAO,SAAW,EAAS,GAAG,UAG3B,IAEd,CAEG,EAAa,EAAO,OAAO,CAC3B,KAAM,SAAS,EAAS,EAAS,CAC7B,EAAO,KAAK,KAAM,EAAS,EAAQ,CAEnC,KAAK,QAAQ,SAAS,EAAW,WAAW,QAAQ,CAEpD,KAAK,UAAY,IAAI,EAAoB,CACrC,OAAQ,QACR,iBAAkB,CAAE,cAAe,GAAM,CACzC,SAAU,KACV,UAAW,EAAiB,KAAK,QAAQ,UAAU,CACnD,MAAO,KAAK,MAAM,KAAK,KAAK,CAC5B,MAAO,KAAK,MAAM,KAAK,KAAK,CAC/B,CAAC,CAEF,KAAK,aAAa,CAClB,KAAK,QAAQ,CACb,KAAK,OAAO,CACZ,KAAK,oBAAoB,CACzB,KAAK,gBAAgB,CACrB,KAAK,gBAAgB,EAGzB,QAAS,CACL,KAAM,aACN,OAAQ,EACR,MAAO,KACP,UAAW,CACP,OAAQ,CACJ,SAAU,gBACV,eAAgB,wBAChB,WAAY,mBACZ,SAAU,iBACV,QAAS,eACT,aAAc,sBACjB,CACD,KAAM,CACF,GAAK,UACL,IAAK,cACL,GAAK,iBACL,GAAK,gBACR,CACD,OAAQ,CACJ,GAAI,cACJ,IAAK,kBACL,IAAK,8BACL,GAAI,kBACJ,IAAK,2BACL,GAAI,eACP,CACJ,CACJ,CAED,OAAQ,CACJ,SACH,CAED,QAAS,UAAW,CAChB,EAAO,GAAG,QAAQ,KAAK,KAAK,CAE5B,KAAK,KAAK,SAAS,CACnB,KAAK,eAAe,SAAS,CAC7B,KAAK,MAAM,SAAS,EAGxB,QAAS,SAAS,EAAQ,EAAO,CACzB,EAAE,EAAO,CAAC,SAAS,0BAA0B,CAI7C,KAAK,MAAM,KAAK,EAAM,MAAO,EAAM,MAAM,EAEzC,KAAK,MAAM,WAAW,CAAU,SAAQ,CAAC,CACzC,KAAK,MAAM,MAAM,GAIzB,MAAO,UAAW,CACd,KAAK,MAAM,OAAO,EAGtB,MAAO,UAAW,CACd,KAAK,OAAO,CACR,QAAS,qBACT,QAAS,CACL,OAAQ,KAAK,QAAQ,OACxB,CACJ,CAAC,CACF,KAAK,UAAU,OAAO,CACtB,KAAK,OAAO,EAGhB,MAAO,UAAW,CACd,KAAK,SAAS,CAEd,IAAI,EAAU,CACV,eAAgB,KAAK,QAAQ,MAC7B,OAAQ,KAAK,QAAQ,OACxB,CAEG,EACA,EAEA,KAAK,UAAU,SAAW,SAC1B,KAAK,UAAU,aAAa,CAAE,OAAQ,KAAK,eAAgB,CAAC,CAC5D,EAAc,KAAK,UAAU,YAAY,QAAQ,EAE7C,EAAY,QAAW,EAAY,QAAU,EAAY,OAAO,UAChE,EAAQ,YAAc,IAEnB,KAAK,UAAU,SAAW,WACjC,EAAe,KAAK,UAAU,aAAa,QAAQ,CAE/C,EAAa,SAAS,QAAU,EAAa,SAAS,GAAG,QAAU,OACnE,EAAQ,aAAe,KAI3B,EAAQ,aAAe,EAAQ,eAC/B,KAAK,OAAO,CAAE,QAAS,qBAA+B,UAAS,CAAC,EAIxE,OAAQ,SAAS,EAAS,CACtB,KAAK,QAAQ,SAAU,EAAE,OAAO,EAAG,CAAE,EAAQ,CAAC,EAGlD,YAAa,UAAW,CACpB,IAAI,EAAS,KAAK,QAAQ,OACtB,EAAQ,KAAK,QAAQ,MACrB,EAAQ,EAAM,OAAO,CACrB,EAAe,EAAqB,OAAO,EAAQ,EAAM,CAE7D,GAAI,EAAc,CACd,IAAI,EAAa,EAAqB,WAAW,EAAO,EAAO,CAE/D,KAAK,UAAU,IAAI,SAAU,EAAa,KAAK,CAC/C,KAAK,UAAU,IAAI,EAAa,KAAO,SAAU,EAAa,QAAQ,CAElE,EAAa,MAAQ,WACrB,KAAK,UAAU,IAAI,WAAY,EAAa,IAAM,EAAa,SAAS,CACxE,KAAK,UAAU,IAAI,eAAgB,EAAW,OAGlD,KAAK,UAAU,OAAO,EAI9B,OAAQ,UAAW,CACf,KAAK,MAAQ,KAAK,QAAQ,WAAW,CACjC,iBAAkB,GACrB,CAAC,CAAC,KAAK,aAAa,EAGzB,MAAO,UAAW,CACd,IAAI,EAAW,EAAM,SAAS,EAAW,UAAU,SAAS,CACxD,EAAW,EAAM,YAAY,SAAS,WACtC,EAAQ,CACR,CAAE,QAAS,OAAQ,IAAK,MAAO,KAAM,EAAS,cAAe,UAAW,WAAY,CACpF,CAAE,QAAS,OAAQ,IAAK,OAAQ,KAAM,EAAS,eAAgB,UAAW,YAAa,CAC1F,CAMD,KAAK,KAJI,EAAE,YAAa,CACpB,KAAQ,EAAM,OAAO,EAAU,EAAM,CACxC,CAAC,CAAC,SAAS,KAAK,QAAQ,CAEV,UAAU,CACrB,YAAa,WACb,OAAQ,SAAS,EAAG,CAGhB,IAAI,EAAU,CACV,MAHM,EAAE,EAAE,KAAK,CAAC,KAAK,MAAM,CAI3B,MAAO,GACP,eAJQ,KAAK,QAAQ,MAAM,OAAO,CAAE,IAAK,EAAG,CAAC,CAK7C,OAAQ,KAAK,QAAQ,OACxB,CAED,KAAK,OAAO,CAAE,QAAS,cAAwB,UAAS,CAAC,EAC3D,KAAK,KAAK,CACf,CAAC,CAAC,KAAK,YAAY,EAGxB,gBAAiB,SAAS,EAAU,EAAW,EAAS,EAAU,CAC9D,IAAI,EAAmB,EAAM,SAAS,EAAS,CAC3C,EAAU,EAAE,eAAiB,EAAY,MAAM,CAAC,KAAK,EAAiB,CACtE,SAAU,EAAM,YAAY,SAAS,WACrC,KAAM,EAAM,MAAM,CAClB,GAAI,EAAM,GACb,CAAC,CAAC,CAUH,OARA,KAAK,QAAQ,OAAO,EAAQ,CAE5B,AACI,IAAU,IAAI,EAAQ,EAAS,CAAY,WAAU,OAAQ,KAAK,cAAc,KAAK,KAAK,CAAE,CAAC,CAGjG,EAAM,KAAK,EAAS,KAAK,UAAU,CAE5B,GAGX,cAAe,SAAS,EAAG,CACvB,KAAK,QACA,KAAK,IAAM,EAAM,KAAK,OAAO,CAAG,YAAY,CAC5C,IAAI,EAAE,OAAO,QAAQ,CACrB,KAAK,eAAe,CACpB,OAAO,CAAC,EAAE,KAAK,EAGxB,mBAAoB,UAAW,CAC3B,IAAI,EAAa,KAAK,UAAU,SAAW,SAC3C,KAAK,gBAAgB,EAAW,UAAU,kBAAmB,EAAW,WAAW,kBAAmB,GAAM,EAAW,EAG3H,eAAgB,UAAW,CACvB,IAAI,EAAa,KAAK,UAAU,SAAW,QAG3C,KAAK,eAFS,KAAK,gBAAgB,EAAW,UAAU,cAAe,EAAW,WAAW,cAAe,GAAM,EAAW,CAE/F,KAAK,IAAM,EAAM,KAAK,OAAO,CAAG,aAAa,CAAC,KAAK,gBAAgB,CAEjG,IAAI,EAAS,EAAqB,WAAW,KAAK,QAAQ,MAAO,KAAK,QAAQ,OAAO,CAErF,KAAK,UAAU,IAAI,mBAAoB,IAAI,EAAM,KAAK,uBAAuB,CAAE,KAAM,EAAQ,uBAAwB,EAAM,SAAS,CAAC,KAAM,CAAC,CAAC,EAGjJ,eAAgB,UAAW,CACvB,KAAK,gBAAgB,EAAW,UAAU,cAAe,EAAW,WAAW,cAAe,GAAM,EAGxG,QAAS,UAAW,CAChB,IAAI,EAAkB,KAAK,QAAQ,KAAK,IAAM,EAAM,KAAK,OAAO,CAAG,YAAY,CAAC,OAAO,SAAS,EAAO,EAAS,CAC5G,OAAO,EAAE,EAAQ,CAAC,KAAK,eAAe,CAAC,SAAS,EAClD,CAEE,EAAgB,SAAS,EAAW,WAAW,cAAc,CAC7D,KAAK,UAAU,IAAI,SAAU,QAAQ,CAC9B,EAAgB,SAAS,EAAW,WAAW,kBAAkB,EACxE,KAAK,UAAU,IAAI,SAAU,SAAS,EAGjD,CAAC,CAEF,EAAM,YAAY,WAAa,EAC/B,EAAE,OAAO,GAAM,EAAY,CAAc,aAAuB,YAAW,CAAC,GAE7E,OAAO,MAAM,EChwBnB,SAAS,EAAO,CAEb,EAAM,YAAY,SAAS,SAAW,CAClC,iBAAkB,QACrB,CAED,EAAM,YAAY,SAAS,KAAO,CAC9B,QAAS,WACT,aAAc,gBACd,OAAQ,CACJ,gBAAiB,mDACjB,sBAAuB,sIACvB,8BAA+B,sDAC/B,8BAA+B,gDAC/B,4BAA6B,0DAC7B,0BAA2B,wCAC3B,0BAA2B,iCAC3B,gBAAiB,8BACjB,mBAAoB,qDACpB,gBAAiB,4EACjB,qBAAsB,gCACtB,sBAAuB,wCACvB,sBAAuB,wDAC1B,CACD,KAAM,CACF,KAAM,OACN,KAAM,OACN,OAAQ,SACR,OAAQ,SACR,KAAM,OACN,KAAM,OACT,CACJ,CAED,EAAM,YAAY,SAAS,MAAQ,CAC/B,IAAO,MACP,KAAQ,OACR,MAAS,QACT,MAAS,QACT,QAAW,UACX,OAAU,SACV,KAAQ,OACR,OAAU,SACV,aAAgB,iBAChB,WAAc,eACjB,GACF,OAAO,MAAM,EC3Cf,SAAS,EAAO,CACb,IAAI,EAAI,EAAM,OAEd,GAAI,EAAM,SAAU,CAChB,IAAI,EAAmB,SAAS,EAAS,CACrC,IAAI,EAAS,IAAI,EAAE,SACf,EAAW,SAAS,EAAO,CAC3B,EAAO,QAAQ,EAAM,EAEzB,OAAO,EAAQ,KAAf,CACA,IAAK,WACD,EAAQ,SAAS,KAAK,EAAS,EAAS,CACxC,MACJ,IAAK,QACD,EAAQ,SAAS,aAAa,CAAC,KAAK,EAAS,EAAS,CACtD,MACJ,IAAK,YACD,EAAQ,SAAS,aAAa,CAAC,WAAW,CAAC,KAAK,EAAS,EAAS,CAClE,MAGJ,OAAO,EAAO,SAAS,EAGtB,EAAoB,SAAS,EAAS,CACnC,KAAK,OAAO,QAAQ,YAAY,GAAK,KACrC,EAAM,SAAS,OAAO,KAAK,CAC3B,KAAK,UAAY,EACjB,KAAK,SAAW,GAGpB,IAAI,EAAW,IAAI,EAAE,SACjB,EAAU,EAAS,SAAS,CAC5B,EAAO,CAAW,UAAS,CAC3B,SAAK,QAAQ,YAAa,EAAK,CA0BnC,OAtBA,KAAK,SAAS,EAAS,EAAS,CAC/B,KAAK,SAAS,EAAM,CACjB,IAAI,EAAmB,EAAQ,WACzB,EAAM,IAAI,UAAU,EAAK,CACzB,EAAM,IAAI,gBAAgB,EAAK,CACrC,OAAO,EAAM,yBAAyB,EAAiB,EACzD,CACD,KAAK,SAAS,EAAS,CACpB,EAAM,OAAO,CACA,UACT,SAAU,EAAQ,SAClB,SAAU,EAAQ,SAClB,WAAY,EAAQ,WACpB,YAAa,EAAQ,YACxB,CAAC,CAEF,EAAS,SAAS,EACpB,CACD,KAAK,SAAS,EAAK,CAChB,EAAS,OAAO,EAAI,EACtB,CAEK,GAGX,EAAM,YAAY,SAAS,UAAU,UAAY,EAEjD,EAAM,YAAY,SAAS,UAAU,SAAW,KAErD,MAAM,CCvDT,IAAa,EAAW,CACpB,GAAI,cACJ,KAAM,cACN,SAAU,MACV,YAAa,wBACb,QAAS,CACL,OAAQ,SAAU,cAAe,WAAY,OAAQ,MAAO,eAC5D,OAAQ,QAAS,QAAS,WAAY,UAAW,WACjD,SAAU,YAAa,QAAS,MAAO,UAAW,OAAQ,qBAAqB,CACtF,EAEA,SAAS,EAAO,EAAW,CACxB,GAAI,EAAM,QAAQ,QAAQ,MAAQ,EAAM,QAAQ,QAAQ,QAAU,EAC9D,OAGJ,IAAM,EAAW,WACb,EAAI,EAAM,OACV,EAAS,EAAM,GAAG,OAClB,EAAK,oBAEL,EAAe,EAAM,YAAY,aACjC,EAAe,EAAM,YAAY,aACjC,EAAY,EAAM,YAAY,UAElC,SAAS,EAAiB,EAAW,CACjC,OAAO,EAAU,IAAI,SAAS,EAAQ,CAClC,MAAO,iBAAmB,EAAS,MACrC,CAAC,KAAK,IAAI,CAGhB,SAAS,EAA2C,EAAqB,CACrE,IAAM,EAAW,EAAE,UAAU,CAE7B,EAAoB,KAChB,SAAS,EAAO,CAAE,EAAS,QAAQ,EAAM,EACzC,SAAS,EAAQ,CAAE,EAAS,OAAO,EAAO,EAC7C,CAEG,OAAO,EAAoB,UAAa,YACxC,EAAoB,SAAS,SAAS,EAAK,CACvC,EAAS,OAAO,EAAI,EACtB,CAGN,IAAM,EAAU,EAAS,SAAS,CAKlC,MAJA,GAAQ,SAAW,SAAS,EAAI,CAE5B,OADA,EAAS,SAAS,EAAG,CACd,GAEJ,EAGX,SAAS,EAAwB,EAAS,EAAY,CAClD,IAAM,EAAY,EAAE,CACpB,IAAK,IAAI,KAAO,EACR,EAAQ,eAAe,EAAI,EAAI,EAAW,QAAQ,EAAI,GAAK,KAC3D,EAAU,GAAO,EAAQ,IAGjC,OAAO,EAGX,IAAI,EAAyC,EAAiB,CAAC,MAAO,OAAQ,QAAS,cAAe,eAAgB,eAAgB,eAAe,CAAC,CAClJ,EAA0B,EAAiB,CAAC,aAAc,gBAAgB,CAAC,CAC3E,EAAa,CACb,QAAS,gBACZ,CAEG,EAAiB,EAAa,KAAK,WAEjC,GAAqC,CAAE,cAAe;;;;sEAIM,EAAS,SAAW,WAAW,gBAAgB,EAAS,SAAW,WAAW;;;sCAG9G,EAAM,GAAG,KAAK,aAAa,CAAC;;;iDAGjB,EAAS,KAAK,aAAa;;;;;;;;;;;;;;;;;6CAiB/B,EAAS,KAAK,aAAa;;;;;;wDAQ9D,GAAqB,CAAE,cAAe;iCACf,EAAe,gBAAgB;gDAChB,EAAS,MAAM,IAAI;iDAClB,EAAS,MAAM,KAAK;kDACnB,EAAS,MAAM,MAAM;;kDAErB,EAAS,MAAM,MAAM;oDACnB,EAAS,MAAM,QAAQ;2BAGjE,GAA2B,CAAE,cAAe;iCACrB,EAAe,qBAAqB;gDACrB,EAAS,MAAM,IAAI;iDAClB,EAAS,MAAM,KAAK;kDACnB,EAAS,MAAM,MAAM;;uDAEhB,EAAS,MAAM,OAAO;qDACxB,EAAS,MAAM,KAAK;uDAClB,EAAS,MAAM,OAAO;2BAGnE,GAA2B,CAAE,cAAe;iCACrB,EAAe,qBAAqB;gDACrB,EAAS,MAAM,IAAI;iDAClB,EAAS,MAAM,KAAK;kDACnB,EAAS,MAAM,MAAM;;0DAEb,EAAS,MAAM,OAAO;wDACxB,EAAS,MAAM,KAAK;0DAClB,EAAS,MAAM,OAAO;2BAGtE,GAAwB,CAAE,cAAe;iCAClB,EAAe,mBAAmB;2DACR,EAAS,MAAM,aAAa;yDAC9B,EAAS,MAAM,WAAW;;2DAExB,EAAS,MAAM,OAAO;2BAG7E,EAAM,YAAY,YAAc,EAAM,GAAG,YAEzC,IAAI,EAAyB,EAAM,GAAG,WAAW,OAAO,CACpD,KAAM,SAAS,EAAG,CACd,OAAO,KAAK,WAAW,KAAK,EAAE,EAElC,UAAW,SAAS,EAAS,CACzB,KAAK,KAAK,SAAU,SAAS,EAAI,CAAE,EAAQ,KAAK,OAAO,CAAC,GAAG,EAAI,EAEtE,CAAC,CAEF,MAAM,CAAoB,CACtB,YAAY,CAAE,OAAM,SAAS,CACzB,KAAK,QAAU,CAAE,OAAM,QAAO,CAC9B,KAAK,MAAQ,UAAiB,CAC1B,OAAO,OAKnB,MAAM,CAAe,CACjB,YAAY,CAAE,aAAY,aAAa,CACnC,IAAI,EAAQ,KAAK,mBAAmB,EAAW,EAAW,CAC1D,KAAK,QAAU,CACX,MAAQ,GAAQ,CACZ,GAAI,IAAQ,EAAW,CACnB,IAAM,EAAO,EAAM,OAAO,CAC1B,OAAO,IAAQ,EAAK,MAAQ,QAE5B,EAAM,MAAM,GAAO,GAAG,EAGjC,CAED,KAAK,WAAa,EAElB,KAAK,MAAQ,UAAiB,CAC1B,OAAO,MAIf,mBAAmB,EAAW,CAC1B,IAAI,EAAO,KACP,EAAa,IAAI,EAAM,KAAK,WAAW,CACvC,UAAW,CACP,KAAM,SAAS,EAAS,CACpB,IAAI,EAAO,EAAK,YAAY,EAAE,UAAU,EAAI,EAAE,CAC9C,EAAQ,QAAQ,EAAK,EAEzB,MAAO,GACV,CACJ,CAAC,CAEE,EAAQ,EAAE,EAAU,CAAC,cAAc,CACnC,YAAa,GACb,cAAe,OACf,eAAgB,OAChB,UAAW,CAAE,UAAW,GAAG,EAAM,WAAW,EAAK,CAAC,sDAAsD,EAAM,GAAG,KAAK,IAAI,CAAC,MAC/G,aACZ,SAAU,GACV,WAAY,GACZ,OAAQ,EAAK,SAAS,KAAK,EAAK,CAChC,mBAAsB,cACtB,KAAM,UAAW,CACb,EAAW,MAAM,EAExB,CAAC,CAAC,KAAK,gBAAgB,CAsBxB,OApBA,EAAM,MACD,GAAG,UAAW,EAAK,UAAU,KAAK,KAAK,CAAC,CAC7C,EAAM,MAAM,QACP,SAAS,4BAA4B,CAErC,GAAG,YAAa,SAAS,EAAI,CAI1B,EAAG,iBAAiB,EACtB,CAED,GAAG,QAAS,mBAAoB,SAAS,EAAI,CAC1C,EAAG,gBAAgB,CACnB,EAAG,iBAAiB,CACpB,IAAI,EAAO,EAAE,EAAG,OAAO,CAAC,QAAQ,eAAe,CAC/C,EAAO,EAAM,SAAS,EAAK,CAC3B,EAAK,SAAS,EAAK,KAAK,EAC1B,CAEC,EAIX,SAAS,EAAO,CACZ,IAAM,EAAS,KAAK,YAAY,CAC5B,GAAU,EAAM,OAAO,OAAO,EAC9B,EAAO,QAAQ,SAAU,CAAE,KAAM,EAAM,OAAO,OAAO,CAAE,CAAC,CAKhE,SAAS,EAAM,CACX,KAAK,YAAY,EAAE,QAAQ,SAAU,CAAE,OAAM,CAAC,CAIlD,UAAU,EAAO,CACb,IAAM,EAAS,KAAK,YAAY,CAChC,GAAI,EACA,GAAI,EAAM,MAAQ,QAAS,CACvB,IAAM,EAAO,EAAM,OAAO,MAC1B,EAAO,QAAQ,QAAS,CAAE,MAAO,EAAM,CAAC,MACjC,EAAM,MAAQ,UACrB,EAAO,QAAQ,SAAS,EAMxC,IAAI,EAAc,EAAM,GAAG,OAAO,OAAO,CACrC,oBAAqB,SAAS,EAAS,CACnC,EAAE,EAAQ,CAAC,OAAO,EAAkC,KAAK,QAAQ,CAAC,EAEtE,KAAM,SAAS,EAAS,EAAS,CAC7B,IAAI,EAAO,KACX,EAAO,GAAG,KAAK,KAAK,KAAM,EAAS,EAAQ,CAE3C,KAAK,QAAQ,SAAW,EAAE,OAAO,GAAM,CACnC,KAAM,EAAM,YAAY,SAAS,KACjC,KAAM,EAAM,YAAY,SAAS,KAAK,KACtC,MAAO,EAAM,YAAY,SAAS,MAClC,SAAU,CACN,iBAAkB,QACrB,CACJ,CAAE,KAAK,QAAQ,SAAS,CAEzB,KAAK,QAAQ,SAAS,EAAY,WAAW,QAAQ,CACrD,KAAK,QAAQ,KAAK,OAAQ,cAAc,CACxC,KAAK,oBAAoB,KAAK,QAAQ,CAEtC,KAAK,sBAAsB,CAE3B,EAAK,eAAiB,KAAK,wBAAwB,CAEnD,KAAK,qBAAqB,CAE1B,IAAM,EAAc,KAAK,aAAa,CACtC,KAAK,eAAe,CAAE,MAAO,EAAY,MAAM,EAAY,YAAY,CAAC,CAAE,CAAC,CAE3E,KAAK,eAAiB,UAAW,CAAE,EAAK,QAAQ,EAChD,EAAE,OAAO,CAAC,GAAG,SAAW,EAAI,KAAK,eAAe,CAE5C,KAAK,uBACL,KAAK,sBAAsB,KAAK,QAAQ,GAAG,EAGnD,uBAAwB,UAAW,CAC/B,IAAM,EAAO,KACP,EAAU,EAAwB,EAAK,QAAS,EAAK,OAAO,CAE9D,EAAgB,EAAE,OAAO,EAAE,CAC3B,EAAS,CACT,UAAW,EAAK,QAAQ,WAAa,EAAiC,EAAE,CAA3B,EAAK,QAAQ,UAC1D,mBAAoB,IAAI,EAAoB,CACxC,KAAM,KAAK,wBACX,MAAO,KAAK,yBACf,CAAC,CACF,oBAAqB,IAAI,EAAoB,CACzC,KAAM,KAAK,yBACX,MAAO,KAAK,0BACf,CAAC,CACF,WAAY,IAAI,EAAe,CAC3B,UAAW,EAAK,QAAQ,KAAK,iDAAiD,CAC9E,WAAY,UAAW,CACnB,OAAO,EAAK,gBAAgB,KAAK,YAExC,CAAC,CACF,iBAAkB,SAAS,EAAS,CAChC,IAAI,EAAU,EAAE,cAAc,CAAC,SAAS,EAAK,QAAQ,CACrD,OAAO,IAAI,EAAM,YAAY,WAAW,EAAS,EAAQ,EAE7D,eAAgB,SAAS,EAAS,CAC9B,GAAI,EAAK,QAAQ,QAGb,OAFA,EAAK,aAAa,CAEX,CACH,MAAO,UAAW,CAAE,EAAK,KAAK,QAAQ,QAAQ,QAAQ,EACtD,OAAQ,SAAS,EAAM,CAAE,EAAK,KAAK,QAAQ,KAAK,oBAAoB,EAAK,IAAI,CAAC,OAAO,EACrF,QAAS,UAAW,CAAE,EAAK,KAAK,SAAS,EAC5C,EAGT,kBAAmB,SAAS,EAAS,CACjC,EAAK,UAAU,eAAe,EAElC,eAAgB,SAAS,EAAoB,CACzC,EAAK,WAAW,EAAmB,EAEvC,mBAAoB,SAAS,EAAS,CAClC,EAAK,SAAW,EAAE,CAClB,EAAK,mBAAmB,EAE5B,sBAAuB,SAAS,EAAY,CACxC,OAAO,EAAM,KAAK,WAAW,OAAO,EAAW,EAEnD,mBAAoB,SAAS,EAAa,EAAgB,CACtD,OAAO,IAAI,EAAM,YAAY,GAAa,EAAe,EAE7D,kBAAmB,SAAS,EAAU,CAClC,OAAO,EAAE,EAAM,GAAG,KAAK,EAAS,CAAC,CAAC,IAEtC,OAAQ,SAAS,EAAG,CAChB,EAAK,eAAe,EAAE,CAClB,EAAE,OAAO,gBAAkB,EAAK,WAChC,EAAK,UAAU,aAAa,EAAE,OAAO,QAAQ,CAAE,EAAE,OAAO,WAAW,EAAE,MAAM,CAAC,EAGpF,QAAU,GAAS,CAEf,GAAI,CAAE,SAAQ,OAAM,MAAK,QAAO,GAAG,GAAkB,EACjD,EAAO,EAAE,OAAO,EAAE,CAAE,CAAE,UAAW,EAAK,QAAQ,IAAK,YAAa,EAAK,QAAQ,MAAO,CAAE,EAAc,CACpG,EAAS,EAAM,YAAY,QAAQ,OAAO,EAAK,KAAM,EAAK,CACxD,EAAiB,SAAS,EAAM,EAAU,EAAe,CAC3D,EAAM,OAAO,CAAE,QAAS,EAAM,WAAU,GAAG,EAAe,CAAC,EAI3D,IACA,EAAO,KAAK,SAAU,SAAS,EAAM,CACjC,GAAI,EAAK,SAAW,gBAAiB,CACjC,GAAI,CAAE,SAAQ,GAAG,GAAgB,EAC7B,EAAW,EAAK,QAAQ,KAAO,EAAK,QAAQ,UAChD,GAAI,EAAK,QAAQ,YAAc,QAC3B,OAAO,EAAK,eAAe,YAAY,EAAE,OAAO,EAAa,CAC/C,WACV,SAAU,EAAM,MAAM,SACtB,OAAQ,EACX,CAAC,CAAC,IACI,KAAK,QAAQ,YAAc,OAClC,OAAO,EAAK,eAAe,UAAU,EAAE,OAAO,EAAK,QAAQ,IAAK,CAAE,SAAU,KAAK,QAAQ,SAAoB,WAAU,CAAC,CAAC,CAIjI,EAAK,eAAe,eAAe,EAAK,EAC1C,CAEF,EAAO,KAAK,iBAAoB,CAC5B,EAAO,SAAS,CAChB,EAAK,SAAS,KAAK,EACrB,CAEF,EAAK,SAAS,KAAK,EAAO,CAE1B,EAAO,KAAK,EAAK,MAAO,EAAK,CAC7B,EAAK,OAAS,IAGtB,YAAc,GAAM,CAChB,GAAM,CAAE,YAAW,aAAY,aAAY,cAAa,gBAAe,eAAgB,EAEjF,CAAE,UAAS,eADC,EAAE,OAAO,aAAa,CAAC,QAAQ,CAGjD,KAAK,iBAAiB,OAAO,CAC7B,KAAK,sBAAsB,OAAO,CAClC,KAAK,sBAAsB,OAAO,CAClC,KAAK,oBAAoB,OAAO,CAEhC,IAAI,EAEJ,AAOI,EAPA,GAAc,eACP,KAAK,sBACL,GAAc,YACd,KAAK,sBACL,GAAc,UACd,KAAK,oBAEL,KAAK,iBAGhB,EAAK,QAAQ,KAAK,EAAuC,CAAC,OAAO,CAAC,EAAY,CAC9E,EAAK,QAAQ,KAAK,EAAwB,CAAC,OAAO,EAAW,CAC7D,EAAK,QAAQ,KAAK,wBAAwB,CAAC,OAAO,EAAY,CAG9D,WAAW,UAAW,CAClB,EAAK,KAAK,EAAE,cAAc,MAAO,EAAE,cAAc,MAAM,EACzD,EAEN,OAAQ,EAAM,SAAS,QAAQ,KAC/B,KAAM,EAAM,oBAAoB,CACnC,CAAC,CAEF,OAAO,IAAI,EAAM,YAAY,aAAa,kBAAkB,KAAK,QAAQ,GAAI,EAAc,EAE/F,qBAAsB,UAAW,CAC7B,IAAI,EAA4B,KAAK,QAAQ,KAAK,yDAAyD,CACvG,EAA2B,EAAM,MAAM,CAC3C,EAA0B,KAAK,gBAAiB,EAAyB,CAEzE,KAAK,wBAA0B,IAAI,EAAuB,EAAE,WAAW,EAAyB,MAAM,CACjG,SAAS,EAAa,WAAW,YAAY,CAC7C,YAAY,EAA0B,CAAE,CACzC,KAAM,CACF,KAAM,OACN,SAAU,WACb,CACD,SAAU,GACV,WAAY,GACZ,cAAe,OACf,eAAgB,QAChB,UAAW,CAAE,OAAM,WAAY,GAAG,GAAQ,IAC7C,CAAC,CAEF,KAAK,wBAAwB,QAAQ,GAAG,YAAa,SAAS,EAAG,CAC7D,EAAE,gBAAgB,EACpB,CAEF,KAAK,yBAA2B,IAAI,EAAM,GAAG,MAAM,KAAK,wBAAwB,QAAS,CACrF,OAAQ,KAAK,QAAQ,KAAK,+DAA+D,CACzF,KAAM,SAAS,EAAI,CAAE,EAA0B,KAAK,gBAAiB,GAAK,EAC1E,MAAO,SAAS,EAAI,CAAE,EAA0B,KAAK,gBAAiB,GAAM,EAC/E,CAAC,CAEF,IAAI,EAA6B,KAAK,QAAQ,KAAK,6BAA6B,CAC5E,EAA4B,EAAM,MAAM,CAC5C,EAA2B,KAAK,gBAAiB,EAA0B,CAE3E,KAAK,yBAA2B,IAAI,EAAuB,EAAE,WAAW,EAA0B,MAAM,CACnG,SAAS,EAAa,WAAW,YAAY,CAC7C,YAAY,EAA2B,CAAE,CAC1C,KAAM,CACF,KAAM,OACN,SAAU,WACb,CACD,SAAU,GACV,WAAY,GACZ,eAAgB,QAChB,cAAe,OACf,UAAW,CAAE,OAAM,WAAY,GAAG,GAAQ,IAE7C,CAAC,CAEF,KAAK,yBAAyB,QAAQ,GAAG,YAAa,SAAS,EAAG,CAC9D,EAAE,gBAAgB,EACpB,CAEF,KAAK,0BAA4B,IAAI,EAAM,GAAG,MAAM,KAAK,yBAAyB,QAAS,CACvF,OAAQ,KAAK,QAAQ,KAAK,IAAM,EAAa,KAAK,WAAW,WAAW,CACxE,KAAM,SAAS,EAAI,CAAE,EAA2B,KAAK,gBAAiB,GAAK,EAC3E,MAAO,SAAS,EAAI,CAAE,EAA2B,KAAK,gBAAiB,GAAM,EAChF,CAAC,EAEN,kBAAmB,UAAW,CAC1B,IAAI,EAAO,KAEP,EAAoB,CACpB,OAAQ,KAAK,QACb,UAAW,GACX,OAAQ,QACX,CAED,KAAK,iBAAmB,IAAI,EAAM,YAAY,YAAY,EAAE,EAAkB,EAAK,QAAQ,CAAC,CAAC,SAAS,EAAK,QAAQ,CAAE,EAAkB,CAEvI,KAAK,sBAAwB,IAAI,EAAM,YAAY,YAAY,EAAE,EAAwB,EAAK,QAAQ,CAAC,CAAC,SAAS,EAAK,QAAQ,CAAE,EAAkB,CAElJ,KAAK,sBAAwB,IAAI,EAAM,YAAY,YAAY,EAAE,EAAwB,EAAK,QAAQ,CAAC,CAAC,SAAS,EAAK,QAAQ,CAAE,EAAkB,CAElJ,KAAK,oBAAsB,IAAI,EAAM,YAAY,YAAY,EAAE,EAAqB,EAAK,QAAQ,CAAC,CAAC,SAAS,EAAK,QAAQ,CAAE,EAAkB,CAE7I,KAAK,iBAAiB,KAAK,SAAU,KAAK,oBAAoB,KAAK,KAAK,CAAC,CACzE,KAAK,sBAAsB,KAAK,SAAU,KAAK,oBAAoB,KAAK,KAAK,CAAC,CAC9E,KAAK,sBAAsB,KAAK,SAAU,KAAK,oBAAoB,KAAK,KAAK,CAAC,CAC9E,KAAK,oBAAoB,KAAK,SAAU,KAAK,oBAAoB,KAAK,KAAK,CAAC,EAEhF,oBAAqB,SAAS,EAAG,CAC7B,IAAI,EAAO,KACP,EAAS,EAAE,EAAE,KAAK,CAAC,KAAK,SAAS,CACjC,EACJ,OAAQ,EAAR,CACI,IAAK,MACD,EAAU,CAAE,QAAS,oBAAqB,QAAS,CAAE,SAAU,KAAK,eAAe,SAAU,CAAE,CAC/F,MACJ,IAAK,OACD,EAAU,CAAE,QAAS,qBAAsB,QAAS,CAAE,SAAU,KAAK,eAAe,SAAU,CAAE,CAChG,MACJ,IAAK,QACD,EAAU,CAAE,QAAS,sBAAuB,QAAS,CAAE,SAAU,KAAK,eAAe,SAAU,CAAE,CACjG,MACJ,IAAK,iBACD,EAAU,CAAE,QAAS,uBAAwB,QAAS,CAAE,QAAS,KAAK,eAAe,YAAY,UAAU,OAAO,eAAgB,CAAE,CACpI,MACJ,IAAK,iBACD,EAAU,CAAE,QAAS,sBAAuB,QAAS,CAAE,QAAS,KAAK,eAAe,YAAY,UAAU,OAAO,eAAgB,CAAE,CACnI,MACJ,IAAK,eACD,EAAU,CAAE,QAAS,oBAAqB,QAAS,CAAE,QAAS,KAAK,eAAe,YAAY,UAAU,OAAO,eAAgB,CAAE,CACjI,MACJ,IAAK,UACD,EAAU,CAAE,QAAS,mBAAoB,QAAS,CAAE,MAAO,UAAW,CAAE,CACxE,MACJ,IAAK,QACD,KAAK,eAAe,WAAW,QAAQ,CACvC,MACJ,IAAK,WACD,EAAU,CAAE,QAAS,kBAAmB,QAAS,CAAE,KAAM,MAAO,CAAE,CAClE,MACJ,IAAK,cACD,EAAU,CAAE,QAAS,kBAAmB,QAAS,CAAE,KAAM,SAAU,CAAE,CACrE,MACJ,IAAK,aACD,EAAU,CAAE,QAAS,oBAAqB,QAAS,CAAE,KAAM,MAAO,CAAE,CACpE,MACJ,IAAK,gBACD,EAAU,CAAE,QAAS,oBAAqB,QAAS,CAAE,KAAM,SAAU,CAAE,CACvE,MACJ,IAAK,aACD,EAAU,CAAE,QAAS,mBAAoB,CACzC,MACJ,IAAK,gBACD,EAAU,CAAE,QAAS,sBAAuB,CAC5C,MAGJ,GACA,EAAK,eAAe,eAAe,EAAQ,EAGnD,eAAgB,SAAS,EAAG,CACxB,IAAI,EAAS,EAAE,OACX,IAAW,EAAO,aAAe,EAAO,UAG5C,KAAK,SAAS,QAAQ,EAAE,MAAM,EAElC,cAAe,SAAS,EAAW,CAE/B,IAAM,EAAK,IADK,EAAU,WAAW,IAAK,MAAM,CAAC,WAAW,IAAK,MAAM,CAChD,UACvB,OAAO,IAAI,OAAO,EAAI,IAAI,EAE9B,WAAY,SAAS,EAAoB,CACrC,IAAI,EAAO,KAEX,GAAI,EAAK,QAAQ,UAAW,CACxB,IAAI,EAAmB,EAAE,OAAO,GAAM,CAClC,WAAY,EACf,CAAE,EAAK,QAAQ,UAAU,CAE1B,EAAK,UAAY,IAAI,EAAU,EAAK,QAAQ,GAAG,cAAc,mBAAmB,CAAE,EAAiB,CAEnG,EAAK,UAAU,KAAK,SAAU,SAAuB,EAAI,CACjD,EAAG,YACH,EAAK,eAAe,KAAK,UAAU,aAAa,CAEhD,EAAK,eAAe,KAAK,UAAU,cAAc,EAAG,KAAK,EAE/D,CAEF,EAAK,UAAU,KAAK,UAAW,SAA2B,EAAI,CAC1D,EAAK,eAAe,KAAK,UAAU,kBAAkB,EAAG,EAC1D,CAEF,EAAK,UAAU,KAAK,SAAU,SAAuB,EAAI,CACrD,EAAK,eAAe,KAAK,UAAU,cAAc,EAAG,KAAM,EAAG,WAAW,EAC1E,CAEF,EAAK,UAAU,KAAK,YAAa,SAA0B,EAAI,CAC3D,IAAI,EAAO,EAAG,KACV,EAAc,EAAK,YAAY,EAAK,CACpC,EAAa,EAAK,WAAW,EAAY,CACzC,EAAS,EACP,EAAQ,EAAK,cAAc,EAAK,CACtC,EAAK,QAAQ,CAAC,QAAQ,GAAS,CACT,EAAM,KAAK,EAAM,MAAM,CAAC,GAEtC,GAAU,IAEhB,CAEF,IAAM,EAAU,GAAG,EAAK,IAAI,EAAS,EAAE,GACvC,EAAK,YAAY,CAAE,KAAM,CAAE,GAAG,EAAY,QAAQ,CAAE,KAAM,EAAS,CAAE,MAAO,EAAa,EAAG,CAAC,CAC7F,EAAK,eAAe,KAAK,UAAU,cAAc,EAAQ,EAC3D,CAEF,EAAK,UAAU,KAAK,SAAU,SAA0B,EAAI,CACxD,EAAK,eAAe,KAAK,UAAU,cAAc,EAAG,KAAK,EAC3D,CAEF,EAAK,UAAU,KAAK,OAAQ,SAAwB,EAAI,CACpD,IAAI,EAAY,EAAG,KACf,EAAc,EAAK,YAAY,EAAU,CACzC,EAAgB,EAAK,QAAQ,CAAC,OAAO,GAAI,EAAE,OAAO,GAAK,UAAU,CACjE,EAAoB,EAAc,UAAU,GAAI,EAAE,MAAM,GAAK,EAAU,CACvE,EAAmB,EAAc,EAAoB,IAAM,EAAc,EAAoB,GACjG,EAAY,OAAO,SAAS,CAE5B,EAAK,eAAe,SAAS,mBAAqB,EAAE,CACpD,EAAK,eAAe,KAAK,UAAU,cAAc,EAAiB,MAAM,CAAC,EAC3E,CAEF,EAAK,UAAU,KAAK,OAAQ,SAAwB,EAAI,CACpD,IAAI,EAAY,EAAG,KACnB,EAAK,YAAY,EAAU,CAAC,OAAO,UAAU,CAC7C,EAAK,eAAe,SAAS,mBAAqB,EAAE,CACpD,EAAK,eAAe,KAAK,UAAU,cAAc,EAAG,KAAK,EAC3D,GAGV,eAAgB,SAAS,EAAS,EAAM,EAAW,CAC/C,IAAI,EAAO,KAEP,EAAK,UACL,EAAK,QAAQ,SAAS,CACtB,EAAK,QAAQ,QAAQ,OAAO,EAIhC,IAAI,EAAgB,EADC,EAAK,UAAW,GAAS,EAAK,KAAO,EAAU,EAEhE,EAAQ,EAAQ,EAAc,IAElC,EAAK,eAAiB,EAAc,KAEpC,EAAK,QAAU,IAAI,EAAM,YAAY,QAAQ,KAAK,QAAQ,KAAK,uBAAuB,CAAE,CACpF,MAAO,OAAO,GAAU,UAAY,EAAY,EAChD,SAAU,EAAE,cAAc,EAAQ,SAAS,CAAG,EAAQ,SAAW,EACjE,YAAa,EAAc,GAC3B,SAAU,OACV,OAAQ,SAAS,EAAM,CACnB,GAAI,EAAK,UAAY,QAAU,EAAK,UAAY,OAAQ,CACpD,EAAK,eAAe,SAAS,cAAc,EAAK,UAAU,CAC1D,OAGA,EAAK,SAAW,cAChB,EAAK,QAAQ,KAAO,EAAK,QAAQ,MAC1B,EAAK,UAAY,wBACxB,EAAK,QAAQ,OAAS,EAAK,QAAQ,QAAU,EAAK,QAAQ,MAAM,KAChE,EAAK,QAAQ,MAAQ,EAAK,QAAQ,OAAS,EAAK,QAAQ,MAAM,OAAS,CAAE,MAAO,EAAK,QAAQ,MAAM,MAAO,KAAM,EAAG,EAGvH,EAAK,eAAe,eAAe,EAAK,EAE5C,OAAQ,SAAS,EAAM,CACnB,EAAK,eAAe,WAAW,EAAK,KAAM,EAAK,QAAQ,EAE9D,CAAC,CACF,EAAK,QAAQ,QAAQ,KAAK,aAAc,EAAc,KAAK,EAG/D,YAAa,UAAW,CACpB,IAAI,EAAO,KACP,EAAW,KAAK,QAAQ,SAAS,KACjC,EAAU,EAAE,OAAO,GAAM,CAAE,KAAM,GAAM,KAAM,GAAM,OAAQ,GAAM,OAAQ,GAAM,KAAM,GAAM,KAAM,GAAM,CAAE,KAAK,QAAQ,QAAQ,CAC9H,EAAO,EAAE,CAYb,IAAK,IAAI,KAVL,KAAK,OACL,KAAK,KAAK,SAAS,CACnB,KAAK,KAAK,OAAO,EAGjB,KAAK,UACL,KAAK,QAAQ,SAAS,CACtB,KAAK,QAAQ,OAAO,EAGP,GACT,EAAQ,KAAU,IAAQ,EAAQ,aAAiB,QACnD,EAAK,KAAK,CAAE,GAAI,EAAM,KAAM,EAAS,GAAO,QAAS,GAAI,KAAM,CAAE,eAAgB,EAAM,CAAE,CAAC,CAoBlG,GAhBA,KAAK,KAAO,IAAI,EAAM,YAAY,KAAK,KAAK,QAAQ,KAAK,oBAAoB,CAAE,CAC3E,WAAY,EACZ,eAAgB,EAChB,OAAQ,SAAS,EAAG,CAChB,IAAI,EAAO,EAAE,EAAE,KAAK,CAAC,MAAM,CAC3B,GAAI,EAAK,iBAAmB,EAAM,CAC9B,EAAE,EAAE,KAAK,CAAC,SAAS,EAAS,CACvB,SAAS,KAAK,CAAC,YAAY,EAAS,CAEzC,EAAK,eAAe,EAAS,EAAM,EAAK,KAAM,GAAS,EAAK,OAAS,EAAK,CAAC,GAAG,CAC9E,IAAM,EAAc,EAAK,aAAa,CACtC,EAAK,eAAe,CAAE,MAAO,EAAY,MAAM,EAAY,YAAY,CAAC,CAAE,CAAC,GAGtF,CAAC,CAEE,EAAK,OAAQ,CACb,IAAI,EAAa,EAAK,KAAM,GAAQ,EAAK,KAAO,OAAO,CACvD,KAAK,KAAK,QAAQ,KAAK,0BAA0B,CAAC,SAAS,EAAS,CACpE,EAAK,eAAe,EAAS,EAAM,EAAa,EAAW,GAAK,EAAK,GAAG,GAAG,GAInF,eAAe,EAAS,CACpB,OAAO,KAAK,eAAe,eAAe,EAAQ,EAGtD,QAAS,UAAW,CAChB,KAAK,QAAQ,CAAE,OAAQ,GAAM,CAAC,EAGlC,gBAAiB,SAAS,EAAG,CACrB,KAAK,QAAQ,SAAU,EAAE,EACzB,EAAE,gBAAgB,EAI1B,kBAAmB,SAAS,EAAG,CACvB,KAAK,QAAQ,WAAY,EAAE,EAC3B,EAAE,gBAAgB,EAI1B,gBAAiB,SAAS,EAAG,CACrB,KAAK,QAAQ,SAAU,CAAE,MAAO,EAAE,MAAO,CAAC,EAC1C,EAAE,gBAAgB,EAI1B,aAAc,SAAS,EAAG,CACtB,KAAK,QAAQ,MAAO,EAAE,EAG1B,cAAe,SAAS,EAAG,CACvB,KAAK,QAAQ,OAAQ,EAAE,EAG3B,eAAgB,SAAS,EAAG,CACxB,KAAK,QAAQ,QAAS,EAAE,EAG5B,YAAa,SAAS,EAAO,CACzB,OAAO,KAAK,eAAe,YAAY,EAAM,EAGjD,iBAAkB,SAAS,EAAO,EAAO,CACrC,OAAO,KAAK,eAAe,iBAAiB,EAAO,EAAM,EAG7D,YAAa,SAAS,EAAS,CAC3B,OAAO,KAAK,eAAe,YAAY,EAAQ,EAGnD,OAAQ,UAAW,CACf,OAAO,KAAK,eAAe,QAAQ,EAGvC,YAAa,SAAS,EAAO,CACzB,OAAO,KAAK,eAAe,YAAY,EAAM,EAGjD,YAAa,SAAS,EAAW,CAC7B,OAAO,KAAK,eAAe,YAAY,EAAU,EAGrD,WAAY,SAAS,EAAO,CACxB,OAAO,KAAK,eAAe,WAAW,EAAM,EAGhD,aAAc,SAAS,EAAO,CAC1B,OAAO,KAAK,eAAe,aAAa,EAAM,EAGlD,YAAa,SAAS,EAAO,EAAc,CACvC,OAAO,KAAK,eAAe,YAAY,EAAO,EAAa,EAG/D,QAAS,SAAS,EAAQ,CAGtB,OAFA,KAAK,eAAe,QAAQ,EAAO,CAE5B,MAGX,WAAY,SAAS,EAAM,EAAS,CAChC,OAAO,KAAK,eAAe,WAAW,EAAM,EAAQ,EAGxD,YAAa,SAAS,EAAO,CAWzB,OAVI,IAAU,EAUP,KAAK,cATR,KAAK,aAAe,EAEhB,IAAU,IACV,KAAK,SAAS,CAGX,OAMf,OAAQ,UAAW,CACf,OAAO,KAAK,eAAe,QAAQ,EAGvC,SAAU,SAAS,EAAM,CACrB,KAAK,eAAe,SAAS,EAAK,EAGtC,SAAU,UAAW,CACjB,OAAO,KAAK,eAAe,UAAU,EAGzC,SAAU,SAAS,EAAM,EAAM,CAC3B,OAAO,KAAK,eAAe,SAAS,EAAM,EAAK,EAGnD,UAAW,SAAS,EAAS,CACzB,KAAK,eAAe,UAChB,EAAE,OAAO,EAAE,CAAE,KAAK,QAAQ,IAAK,EAAS,CAAE,SAAU,KAAK,eAAe,UAAW,CAAC,CACvF,EAGL,YAAa,SAAS,EAAS,CAC3B,IAAM,EAAY,EAAE,OAAO,EAAE,CAAE,KAAK,QAAQ,MAAO,EAAS,CACxD,SAAU,EAAM,MAAM,SACtB,OAAQ,SAAS,EAAM,EAAU,EAAe,CAC5C,EAAM,OAAO,CAAE,QAAS,EAAM,WAAU,GAAG,EAAe,CAAC,EAElE,CAAC,CACF,KAAK,eAAe,YAAY,EAAU,EAG9C,KAAM,SAAS,EAAS,EAAU,CAC9B,KAAK,eAAe,KAAK,EAAS,EAAS,EAG/C,qBAAsB,SAAS,EAAG,CAC1B,KAAK,QAAQ,cAAe,EAAE,EAC9B,EAAE,gBAAgB,EAI1B,qBAAsB,SAAS,EAAG,CAC9B,IAAM,EAAY,CACd,KAAM,EAAE,KACR,OAAQ,EAAE,OACV,eAAgB,EAAE,eAClB,mBAAoB,EAAE,mBACtB,QAAS,EAA2C,EAAE,SAAS,CAC/D,kBAAmB,EAAE,kBACxB,CAEG,KAAK,QAAQ,cAAe,EAAU,CACtC,EAAE,gBAAgB,CAElB,KAAK,cAAc,EAAE,SAAS,EAItC,cAAe,SAAS,EAAU,CAC9B,IAAI,EACA,EAAE,mHAGW,CACR,SAAS,KAAK,QAAQ,CAE3B,EAAK,EAAE,mCAAmC,CACzC,SAAS,EAAQ,CACjB,iBAAiB,CACd,KAAM,QAAS,WAAY,GAC3B,IAAK,EAAG,IAAK,EAAG,MAAO,EAC1B,CAAC,CAAC,KAAK,mBAAmB,CAE/B,EAAS,SAAS,SAAS,EAAG,CAC1B,EAAG,MAAM,EAAE,SAAS,EACtB,CACG,QAAQ,QAAQ,UAAW,CACxB,EAAM,QAAQ,EAAQ,CACtB,EAAQ,QAAQ,EAClB,EAGV,mBAAoB,SAAS,EAAG,CACxB,KAAK,QAAQ,YAAa,EAAE,EAC5B,EAAE,gBAAgB,EAI1B,qBAAsB,SAAS,EAAG,CAC1B,KAAK,QAAQ,cAAe,EAAE,EAC9B,EAAE,gBAAgB,EAI1B,qBAAsB,SAAS,EAAG,CAC1B,KAAK,QAAQ,cAAe,EAAE,EAC9B,EAAE,gBAAgB,EAI1B,qBAAsB,SAAS,EAAG,CAC1B,KAAK,QAAQ,cAAe,EAAE,EAC9B,EAAE,gBAAgB,EAI1B,qBAAsB,SAAS,EAAG,CAC1B,KAAK,QAAQ,cAAe,EAAE,EAC9B,EAAE,gBAAgB,EAI1B,mBAAoB,SAAS,EAAG,CACxB,KAAK,QAAQ,YAAa,EAAE,EAC5B,EAAE,gBAAgB,EAI1B,sBAAuB,SAAS,EAAG,CAC3B,KAAK,QAAQ,eAAgB,EAAE,EAC/B,EAAE,gBAAgB,EAI1B,mBAAoB,SAAS,EAAG,CACxB,KAAK,QAAQ,YAAa,EAAE,EAC5B,EAAE,gBAAgB,EAI1B,sBAAuB,SAAS,EAAG,CAC3B,KAAK,QAAQ,eAAgB,EAAE,EAC/B,EAAE,gBAAgB,EAI1B,iBAAkB,SAAS,EAAG,CACtB,KAAK,QAAQ,UAAW,EAAE,EAC1B,EAAE,gBAAgB,EAI1B,oBAAqB,SAAS,EAAG,CACzB,KAAK,QAAQ,aAAc,EAAE,EAC7B,EAAE,gBAAgB,EAI1B,mBAAoB,SAAS,EAAG,CACxB,KAAK,QAAQ,YAAa,EAAE,EAC5B,EAAE,gBAAgB,EAI1B,sBAAuB,SAAS,EAAG,CAC3B,KAAK,QAAQ,eAAgB,EAAE,EAC/B,EAAE,gBAAgB,EAI1B,gBAAiB,SAAS,EAAG,CACzB,KAAK,QAAQ,SAAU,EAAE,EAG7B,sBAAuB,SAAS,EAAG,CAC/B,KAAK,QAAQ,eAAgB,EAAE,EAGnC,qBAAsB,SAAS,EAAG,CAC1B,KAAK,QAAQ,cAAe,EAAE,EAC9B,EAAE,gBAAgB,EAI1B,mBAAoB,SAAS,EAAG,CAC5B,KAAK,QAAQ,YAAa,EAAE,EAGhC,kBAAmB,SAAS,EAAG,CAC3B,EAAM,GAAG,SAAS,KAAK,QAAS,EAAE,OAAO,EAG7C,oBAAqB,UAAW,CAC5B,KAAK,eAAe,KAAK,SAAU,KAAK,gBAAgB,KAAK,KAAK,CAAC,CACnE,KAAK,eAAe,KAAK,MAAO,KAAK,aAAa,KAAK,KAAK,CAAC,CAC7D,KAAK,eAAe,KAAK,OAAQ,KAAK,cAAc,KAAK,KAAK,CAAC,CAC/D,KAAK,eAAe,KAAK,QAAS,KAAK,eAAe,KAAK,KAAK,CAAC,CACjE,KAAK,eAAe,KAAK,WAAY,KAAK,kBAAkB,KAAK,KAAK,CAAC,CACvE,KAAK,eAAe,KAAK,SAAU,KAAK,gBAAgB,KAAK,KAAK,CAAC,CACnE,KAAK,eAAe,KAAK,cAAe,KAAK,qBAAqB,KAAK,KAAK,CAAC,CAC7E,KAAK,eAAe,KAAK,cAAe,KAAK,qBAAqB,KAAK,KAAK,CAAC,CAC7E,KAAK,eAAe,KAAK,YAAa,KAAK,mBAAmB,KAAK,KAAK,CAAC,CACzE,KAAK,eAAe,KAAK,cAAe,KAAK,qBAAqB,KAAK,KAAK,CAAC,CAC7E,KAAK,eAAe,KAAK,cAAe,KAAK,qBAAqB,KAAK,KAAK,CAAC,CAC7E,KAAK,eAAe,KAAK,cAAe,KAAK,qBAAqB,KAAK,KAAK,CAAC,CAC7E,KAAK,eAAe,KAAK,cAAe,KAAK,qBAAqB,KAAK,KAAK,CAAC,CAC7E,KAAK,eAAe,KAAK,YAAa,KAAK,mBAAmB,KAAK,KAAK,CAAC,CACzE,KAAK,eAAe,KAAK,eAAgB,KAAK,sBAAsB,KAAK,KAAK,CAAC,CAC/E,KAAK,eAAe,KAAK,YAAa,KAAK,mBAAmB,KAAK,KAAK,CAAC,CACzE,KAAK,eAAe,KAAK,eAAgB,KAAK,sBAAsB,KAAK,KAAK,CAAC,CAC/E,KAAK,eAAe,KAAK,UAAW,KAAK,iBAAiB,KAAK,KAAK,CAAC,CACrE,KAAK,eAAe,KAAK,aAAc,KAAK,oBAAoB,KAAK,KAAK,CAAC,CAC3E,KAAK,eAAe,KAAK,YAAa,KAAK,mBAAmB,KAAK,KAAK,CAAC,CACzE,KAAK,eAAe,KAAK,eAAgB,KAAK,sBAAsB,KAAK,KAAK,CAAC,CAC/E,KAAK,eAAe,KAAK,SAAU,KAAK,gBAAgB,KAAK,KAAK,CAAC,CACnE,KAAK,eAAe,KAAK,eAAgB,KAAK,sBAAsB,KAAK,KAAK,CAAC,CAC/E,KAAK,eAAe,KAAK,cAAe,KAAK,qBAAqB,KAAK,KAAK,CAAC,CAC7E,KAAK,eAAe,KAAK,YAAa,KAAK,mBAAmB,KAAK,KAAK,CAAC,CACzE,KAAK,eAAe,KAAK,WAAY,KAAK,kBAAkB,KAAK,KAAK,CAAC,EAG3E,QAAS,UAAW,CAChB,EAAM,GAAG,OAAO,GAAG,QAAQ,KAAK,KAAK,CAErC,KAAK,0BAA0B,SAAS,CACxC,KAAK,2BAA2B,SAAS,CACzC,KAAK,yBAAyB,SAAS,CACvC,KAAK,0BAA0B,SAAS,CAExC,KAAK,wBAA0B,KAAK,yBAA2B,KAC/D,KAAK,yBAA2B,KAAK,0BAA4B,KAE7D,KAAK,MACL,KAAK,KAAK,SAAS,CAGnB,KAAK,SACL,KAAK,QAAQ,SAAS,CAGtB,KAAK,WACL,KAAK,UAAU,SAAS,CAG5B,KAAK,UAAU,QAAQ,SAAS,EAAQ,CACpC,GAAQ,SAAS,EACnB,CAEF,KAAK,gBAAgB,SAAS,CAE9B,KAAK,kBAAkB,SAAS,CAEhC,KAAK,uBAAuB,SAAS,CACrC,KAAK,uBAAuB,SAAS,CACrC,KAAK,qBAAqB,SAAS,CAEnC,KAAK,iBAAmB,KAAK,sBACzB,KAAK,sBACL,KAAK,oBAAsB,KAE3B,KAAK,gBACL,EAAE,OAAO,CAAC,IAAI,SAAW,EAAI,KAAK,eAAe,CAGrD,EAAM,QAAQ,KAAK,QAAQ,EAG/B,QAAS,CACL,KAAM,cACN,QAAS,GACT,UAAW,GACX,KAAM,IACN,QAAS,GACT,UAAW,GACX,YAAa,GACb,aAAc,GACd,YAAa,GACb,MAAO,CACH,SAAU,GACV,SAAU,gBACb,CACD,SAAU,EAAE,CACZ,IAAK,CAED,KAAM,WACN,SAAU,eACV,SAAU,GAKV,UAAW,KAEX,UAAW,GAEX,OAAQ,KAER,MAAO,KACP,OAAQ,KACR,QAAS,KACT,SAAU,KACV,QAAS,4BAA8B,EAAM,QAE7C,KAAM,KACT,CACD,iBAAkB,CACd,WAAY,QACZ,SAAU,GACb,CACD,mBAAoB,GACvB,CAED,WAAY,SAAS,EAAM,EAAO,EAAQ,CACtC,OAAO,KAAK,eAAe,WAAW,EAAM,EAAO,EAAO,EAG9D,aAAc,SAAS,EAAM,CACzB,OAAO,KAAK,eAAe,aAAa,EAAK,EAGjD,UAAW,SAAS,EAAM,CACtB,OAAO,KAAK,eAAe,UAAU,EAAK,EAG9C,YAAa,SAAS,EAAM,CACxB,OAAO,KAAK,eAAe,YAAY,EAAK,EAGhD,gBAAiB,UAAW,CACxB,OAAO,KAAK,kBAGhB,qBAAsB,UAAW,CAC7B,OAAO,KAAK,uBAGhB,qBAAsB,UAAW,CAC7B,OAAO,KAAK,uBAGhB,SAAU,SAAS,EAAO,CACtB,OAAO,KAAK,eAAe,SAAS,EAAM,EAG9C,cAAe,UAAW,CACtB,OAAO,KAAK,eAAe,eAAe,EAG9C,OAAQ,CACJ,MACA,OACA,QACA,YACA,cACA,cACA,WACA,SACA,SACA,cACA,cACA,cACA,YACA,eACA,YACA,cACA,eACA,UACA,aACA,YACA,eACA,SACA,eACA,cACA,YACH,CACJ,CAAC,CAEF,EAAM,GAAG,OAAO,EAAY,CAC5B,EAAE,OAAO,GAAM,EAAa,CAAc,aAAY,CAAC,GACxD,OAAO,MAAM,CAChB,IAAA,EAAe"}