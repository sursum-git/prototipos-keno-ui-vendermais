{"version":3,"file":"kendo.inlineaiprompt.min.js","names":[],"sources":["../../src/utils/inline-ai-prompt-commands.js","../../src/kendo.inlineaiprompt.js"],"sourcesContent":["const defaultCommands = [\n                    {\n                        id: \"rewrite\",\n                        text: \"Rewrite\",\n                        icon: \"arrow-rotate-cw\",\n                        prompt: (selection) => `Rewrite the selected text while preserving its original meaning and intent.\n\n                                Selected Text:\n                                ${selection}`\n                    },\n                    {\n                        id: \"fix-spelling\",\n                        text: \"Fix spelling\",\n                        icon: \"spell-checker\",\n                        prompt: (selection) => `Correct any spelling, grammar, or punctuation mistakes in the selected text while preserving its original meaning and intent.\n\n                                Selected Text:\n                                ${selection}`\n                    },\n                    {\n                        id: \"change-tone\",\n                        text: \"Change tone\",\n                        icon: \"tell-a-friend\",\n                        items: [\n                            {\n                                id: \"change-tone-neutral\",\n                                text: \"Neutral\",\n                                prompt: (selection) => `Adjust the tone of the following text to be more neutral while preserving its original meaning and intent.\n\n                                        Selected Text:\n                                        ${selection}`\n                            },\n                            {\n                                id: \"change-tone-friendly\",\n                                text: \"Friendly\",\n                                prompt: (selection) => `Adjust the tone of the following text to be more friendly while preserving its original meaning and intent.\n\n                                        Selected Text:\n                                        ${selection}`\n                            },\n                            {\n                                id: \"change-tone-casual\",\n                                text: \"Casual\",\n                                prompt: (selection) => `Adjust the tone of the following text to be more casual while preserving its original meaning and intent.\n\n                                        Selected Text:\n                                        ${selection}`\n                            },\n                            {\n                                id: \"change-tone-formal\",\n                                text: \"Formal\",\n                                prompt: (selection) => `Adjust the tone of the following text to be more formal while preserving its original meaning and intent.\n\n                                        Selected Text:\n                                        ${selection}`\n                            }\n                        ]\n                    },\n                    {\n                        id: \"adjust-length\",\n                        text: \"Adjust length\",\n                        icon: \"col-resize\",\n                        items: [\n                            {\n                                id: \"adjust-length-shorten\",\n                                text: \"Shorten\",\n                                prompt: (selection) => `Shorten the following text while preserving its original meaning and intent.\n\n                                        Selected Text:\n                                        ${selection}`\n                            },\n                            {\n                                id: \"adjust-length-lengthen\",\n                                text: \"Lengthen\",\n                                prompt: (selection) => `Lengthen the following text while preserving its original meaning and intent.\n\n                                        Selected Text:\n                                        ${selection}`\n                            }\n                        ]\n                    }\n];\n\nexport {\n    defaultCommands\n};","import \"./kendo.core.js\";\nimport \"./kendo.data.js\";\nimport \"./kendo.icons.js\";\nimport \"./kendo.textarea.js\";\nimport \"./kendo.button.js\";\nimport \"./kendo.toolbar.js\";\nimport \"./kendo.popup.js\";\nimport \"./kendo.speechtotextbutton.js\";\nimport \"./kendo.skeletoncontainer.js\";\n\nimport { defaultCommands } from \"./utils/inline-ai-prompt-commands.js\";\n\nexport const __meta__ = {\n    id: \"inlineaiprompt\",\n    name: \"InlineAIPrompt\",\n    category: \"web\",\n    description: \"The InlineAIPrompt component simplifies the incorporation of external AI services into apps.\",\n    depends: [\"core\", \"icons\", \"textarea\", \"button\", \"toolbar\", \"popup\", \"data\", \"speechtotextbutton\", \"skeletoncontainer\"],\n};\n\n(function($) {\n    let kendo = window.kendo,\n        Widget = kendo.ui.Widget,\n        TextArea = kendo.ui.TextArea,\n        SpeechToTextButton = kendo.ui.SpeechToTextButton,\n        NS = \".kendoInlineAIPrompt\",\n        ui = kendo.ui,\n\n        PROMPT_REQUEST = \"promptRequest\",\n        PROMPT_RESPONSE = \"promptResponse\",\n        PROMPT_REQUEST_CANCEL = \"promptRequestCancel\",\n        COMMAND_EXECUTE = \"commandExecute\",\n        OUTPUT_ACTION = \"outputAction\",\n\n        SHOW = \"show\",\n        HIDE = \"hide\",\n\n        K_SPEECHTOTEXTBUTTON = \"k-speech-to-text-button\",\n        K_STOP_OUTPUT_RETRIEVAL = \"k-generating\",\n        K_DISABLED = \"k-disabled\",\n        K_PROMPT_SEND = \"k-prompt-send\",\n        K_ALIGN_ITEMS_START = \"!k-align-items-start\",\n        DEFAULT_PLACEHOLDER = \"Edit, generate or explain...\",\n\n        ARIA_LABEL = \"aria-label\",\n        ARIA_DISABLED = \"aria-disabled\",\n\n        DEFAULT_COMMANDS = defaultCommands,\n\n        FOCUS = \"focus\";\n\n        var extend = $.extend;\n\n    let InlineAIPrompt = Widget.extend({\n        init: function(element, options) {\n            let that = this;\n            options = options || {};\n\n            that.options.systemPrompt = options.systemPrompt || that.options.systemPrompt;\n            Widget.fn.init.call(that, element, options);\n\n            if (options.commands) {\n               that.options.commands = options.commands;\n            }\n\n            that.transport = new kendo.data.AiTransport({\n                service: that.options.service,\n                success: that._serviceSuccess.bind(that),\n                requestStart: (ev) => {\n                    that._progress(true);\n                }\n            });\n\n            that._initPopup();\n            that._initContextMenu();\n            that._bindEvents();\n\n            kendo.notify(that);\n        },\n\n        options: {\n            name: \"InlineAIPrompt\",\n            enable: true,\n            outputActions: null,\n            encodedPromptOutputs: true,\n            readonly: false,\n            placeholder: \"\",\n            speechToText: false,\n            service: null,\n            isStreaming: false,\n            systemPrompt: (context, prompt) => `You are an advanced AI language assistant.\n                                A user has selected a portion of their text and provided a query regarding how they want it modified.\n                                Your task is to accurately respond to their request while preserving the original intent of the text.\n                                Follow the instructions strictly and provide only the requested output unless explicitly asked to explain your changes.\n\n                                Selected Text:\n                                ${context}\n\n                                User's Request:\n                                ${prompt}\n\n                                Response:`,\n            commands: DEFAULT_COMMANDS,\n            messages: {\n                promptSend: \"Prompt Send\",\n                stopOutputRetrieval: \"Stop Output Retrieval\",\n                commandsMenu: \"Commands Menu\",\n                retryOutputAction: \"Retry\",\n                copyOutputAction: \"Copy\",\n                discardOutputAction: \"Discard\"\n            }\n        },\n\n        events: [\n            PROMPT_REQUEST,\n            PROMPT_RESPONSE,\n            PROMPT_REQUEST_CANCEL,\n            COMMAND_EXECUTE,\n            OUTPUT_ACTION,\n            SHOW,\n            HIDE\n        ],\n\n        value: function(value) {\n            let that = this;\n            that._textArea.value(value);\n            that._textArea.trigger(\"change\");\n            that._togglePromptSend();\n        },\n\n        enable: function(enable) {\n            let that = this;\n\n            if (typeof enable == \"boolean\" ) {\n                that._textArea.enable(enable);\n            }\n        },\n\n        readonly: function(readonly) {\n            let that = this;\n            if (typeof readonly == \"boolean\" ) {\n                that._textArea.readonly(readonly);\n            }\n        },\n\n        startStreaming: function() {\n            let that = this;\n            that._progress(true);\n        },\n\n        stopStreaming: function() {\n            let that = this;\n            that._progress(false);\n            that._togglePromptSend();\n            that._focusOutputActions();\n        },\n\n        updatePromptOutputContent: function(content) {\n            let that = this,\n                outputCard = that._popup.element.find('.k-card-body');\n\n                 const output = that.options.encodedPromptOutputs ?\n                       kendo.htmlEncode(content) :\n                       content;\n\n                 outputCard.html(output);\n        },\n\n        open: function(x, y) {\n             let that = this;\n\n                if (typeof x === \"number\" && typeof y === \"number\") {\n                    that._popup.open(x, y);\n                    return;\n                }\n\n                const originalAnchor = that._popup.options.anchor;\n                const originalOrigin = that._popup.options.origin;\n                const originalPosition = that._popup.options.position;\n\n                that._popup.options.anchor = that.element;\n                that._popup.options.origin = \"bottom center\";\n                that._popup.options.position = \"top center\";\n\n                that._popup.open();\n\n                that._popup.options.anchor = originalAnchor;\n                that._popup.options.origin = originalOrigin;\n                that._popup.options.position = originalPosition;\n\n                that._textArea.focus();\n        },\n\n        close: function() {\n            let that = this;\n            that._popup.close();\n        },\n\n        _serviceSuccess: function(response) {\n            const that = this,\n                  responseTemplate = that.options.responseTemplate,\n                  emptyResult = () => \"\";\n\n            if (kendo.isPresent(responseTemplate)) {\n                let template = kendo.isFunction(responseTemplate)\n                                 ?\n                                 responseTemplate(response)\n                                 :\n                                 kendo.template(responseTemplate || emptyResult)({ response: response });\n\n                that._popup.element.find('.k-card-body').html(template);\n            }\n            else {\n                const output = that.options.encodedPromptOutputs ?\n                      kendo.htmlEncode(response.output) :\n                      response.output;\n\n                that._popup.element.find('.k-card-body').html(output);\n            }\n\n            that._popup.element.find('.k-card').show();\n            that.trigger(PROMPT_RESPONSE, { response });\n            that._progress(false);\n            that._togglePromptSend();\n            that._focusOutputActions();\n        },\n\n        _initTextArea: function(element) {\n            const that = this,\n                  promptSendMessage = that.options.messages.promptSend;\n\n            let widget,\n                options = extend({}, {\n                     _isInInlineAIPrompt: true,\n                     enable: that.options.enable,\n                     readonly: that.options.readonly,\n                     overflow: \"auto\",\n                     placeholder: that.options.placeholder || DEFAULT_PLACEHOLDER,\n                     maxRows: 5,\n                     resize: \"auto\",\n                     layoutFlow: \"horizontal\",\n                     prefixOptions: {\n                        separator: false,\n                        template: () => `${that._renderPrefixTemplate()}`\n                     },\n                     suffixOptions: {\n                        separator: false,\n                        template: () => `\n                             ${kendo.html\n                                .renderButton(`<button role='button' class='${K_PROMPT_SEND} ${K_DISABLED}' ${ARIA_LABEL}='${promptSendMessage}' ${ARIA_DISABLED}='true'></button>`,\n                                { icon: \"paper-plane\", fillMode: \"flat\" })\n                             }`\n                     }\n                });\n\n             widget = new TextArea(element, options);\n\n            widget._prefixContainer\n                    .addClass(K_ALIGN_ITEMS_START);\n\n\n            widget._suffixContainer\n                    .addClass(K_ALIGN_ITEMS_START);\n\n            $(`<span class=\"k-input-separator k-input-separator-vertical\"></span>`).insertBefore($(widget.element));\n\n            if (that.options.speechToText || (that.options.speechToText && options.speechToText === undefined) ) {\n                let speechToTextElement = widget._prefixContainer.find(`.${K_SPEECHTOTEXTBUTTON}`);\n                that._initSpeechToTextButton(speechToTextElement);\n            }\n\n            return widget;\n        },\n\n        _renderPrefixTemplate: function() {\n            let that = this,\n                template = \"\";\n\n            const commandsMenuMessage = that.options.messages.commandsMenu;\n\n            let menuButton = kendo.html.renderButton(`<button role='button' title='${commandsMenuMessage}' ${ARIA_LABEL}='${commandsMenuMessage}'></button>`, { icon: \"menu\", fillMode: \"flat\" });\n\n            template = template + menuButton;\n            if (that.options.speechToText) {\n                let speechToTextElement = `<button role='button' title='Speech To Text' ${ARIA_LABEL}='Start speech recognition' class='${K_SPEECHTOTEXTBUTTON}' id='${kendo.guid()}'></button>`;\n                template = template + speechToTextElement;\n            }\n\n            return template;\n        },\n\n        _initSpeechToTextButton: function(element) {\n            const that = this;\n\n            let options = extend({}, {\n                    fillMode: \"flat\",\n                    integrationMode: that.options.speechToText.integrationMode || \"webSpeech\",\n                    lang: 'en-US',\n                    continuous: false,\n                    interimResults: false,\n                    maxAlternatives: 1,\n                    result: function(ev) {\n                        if (ev.isFinal && ev.alternatives && ev.alternatives.length > 0) {\n                                let currentValue = that._textArea.value() || \"\",\n                                    newValue = currentValue + (currentValue ? \" \" : \"\") + ev.alternatives[0].transcript;\n\n                                that._textArea.value(newValue);\n                                that._textArea.trigger(\"change\");\n                                that._togglePromptSend();\n                        }\n                    }\n                },\n                that.options.speechToText);\n\n            that._speechToTextButton = new SpeechToTextButton(element, options);\n        },\n\n        _togglePromptSend: function() {\n            let that = this,\n                textArea = that._textArea,\n                value = textArea.value() || \"\";\n\n            if (value.replace(/\\s/g, '').length) {\n                $(textArea._suffixContainer)\n                    .find(`.${K_PROMPT_SEND}`)\n                    .removeClass(K_DISABLED)\n                    .attr(ARIA_DISABLED, false);\n            }\n            else {\n                $(textArea._suffixContainer)\n                   .find(`.${K_PROMPT_SEND}`)\n                   .addClass(K_DISABLED)\n                   .attr(ARIA_DISABLED, true);\n            }\n        },\n\n        _initPopup: function() {\n            const that = this,\n                  html = $(that._template());\n\n            const options = that.options.popup;\n\n            if (kendo.isPresent(options)) {\n                if (options.width) {\n                    html.width(options.width);\n                }\n\n                if (options.height) {\n                    html.height(options.height);\n                }\n            }\n\n            html.css({ \"max-width\": \"98vw\" });\n\n            that._popup = new kendo.ui.Popup(html, {\n                anchor: that.element,\n                appendTo: options?.appendTo || document.body,\n                isRtl: kendo.support.isRtl(that.element),\n                animation: options?.animation || {\n                    open: {\n                        effects: \"zoom:in\",\n                        duration: 200\n                    },\n                    close: {\n                        effects: \"zoom:out\",\n                        duration: 200\n                    }\n                },\n                open: function(ev) {\n                    this.element.find('.k-card').hide();\n                    this.element.find('.k-card-body').empty();\n                    this.element.find('.k-input-inner').val('');\n\n                    that._textArea.value('');\n                    that._textArea.element\n                        .removeAttr(\"style\");\n\n                    that._togglePromptSend();\n\n                    that.trigger(SHOW, ev);\n                },\n                close: function(ev) {\n                    kendo.ui.progress(that._popup.element, false);\n                    that._aiContextMenu?.close();\n                    that.trigger(HIDE, ev);\n                }\n            });\n\n\n            let textAreaElement = that._popup.element\n                .find('textarea')\n                .first();\n\n            that._textArea = that._initTextArea(textAreaElement);\n        },\n\n        _input: function(e) {\n             let that = this,\n                 textArea = that._textArea,\n                 value = e.currentTarget.value,\n                 oldValue = that._textArea.value();\n\n             if (value != oldValue) {\n                textArea.value(value);\n                textArea.trigger(\"change\");\n                that._togglePromptSend();\n             }\n        },\n\n        _template: function() {\n            let that = this;\n            const textAreaHtml = `<textarea ${ARIA_LABEL}='Prompt' id='${kendo.guid()}'></textarea>`,\n                  template = `<div class=\"k-child-animation-container\">\n                    <div class=\"k-prompt-popup k-popup\">\n                        <div class=\"k-prompt\">\n                            <div class=\"k-prompt-content\">\n                                <div class=\"k-prompt-view\">\n                                    <div class=\"k-card\">\n                                        <div class=\"k-card-body\" style=\"max-height: 150px; overflow-y: auto;\"></div>\n                                        <div class=\"k-actions k-actions-start k-actions-horizontal k-card-actions\">\n                                            ${that._renderOutputActions()}\n                                        </div>\n                                    </div>\n                                   ${textAreaHtml}\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>`;\n\n            return template;\n        },\n\n        _renderOutputActions: function() {\n            let that = this,\n                options = that.options;\n\n                const copyMessage = that.options.messages.copyOutputAction,\n                      retryMessage = that.options.messages.retryOutputAction,\n                      discardMessage = that.options.messages.discardOutputAction;\n\n            if (!kendo.isPresent(options.outputActions) || !options.outputActions.length) {\n                if (that.options._isEditor) {\n                    let buttons = `\n                        ${kendo.html.renderButton(`<button role='button' title='${copyMessage}' ${ARIA_LABEL}='${copyMessage}' ${kendo.attr(\"action\")}='copy'>${copyMessage}</button>`, { icon: \"copy\", fillMode: \"flat\", themeColor: \"primary\" })}\n                        ${kendo.html.renderButton(`<button title='Insert' ${ARIA_LABEL}=\"Insert\" ${kendo.attr(\"action\")}='insert'>Insert</button>`, { icon: \"insert-bottom\", fillMode: \"flat\", themeColor: \"primary\" })}\n                        ${kendo.html.renderButton(`<button title='Replace' ${ARIA_LABEL}=\"Replace\" ${kendo.attr(\"action\")}='replace'>Replace</button>`, { icon: \"check\", fillMode: \"flat\", themeColor: \"primary\" })}\n                        ${kendo.html.renderButton(`<button title='Discard' ${ARIA_LABEL}='Discard' ${kendo.attr(\"action\")}='discard'>Discard</button>`, { icon: \"cancel-outline\", fillMode: \"flat\" })}\n                     `;\n                     return buttons;\n                }\n                else {\n                    let buttons = `\n                        ${kendo.html.renderButton(`<button role='button' title='${copyMessage}' ${ARIA_LABEL}='${copyMessage}' ${kendo.attr(\"action\")}='copy'>${copyMessage}</button>`, { icon: \"copy\", fillMode: \"flat\", themeColor: \"primary\" })}\n                        ${kendo.html.renderButton(`<button role='button' title='${retryMessage}' ${ARIA_LABEL}='${retryMessage}'  ${kendo.attr(\"action\")}='retry'>${retryMessage}</button>`, { icon: \"arrow-rotate-cw\", fillMode: \"flat\", themeColor: \"primary\" })}\n                        ${kendo.html.renderButton(`<button role='button' title='${discardMessage}' ${ARIA_LABEL}='${discardMessage}' ${kendo.attr(\"action\")}='discard'>${discardMessage}</button>`, { icon: \"cancel-outline\", fillMode: \"flat\" })}\n                    `;\n                    return buttons;\n                }\n            }\n            else {\n                let buttons = \"\";\n                options.outputActions.forEach(function(outputAction) {\n                    if (typeof outputAction == \"string\") {\n                        switch (outputAction) {\n                            case \"copy\":\n                                buttons = buttons + kendo.html.renderButton(`<button role='button' title='${copyMessage}' ${ARIA_LABEL}='${copyMessage}' ${kendo.attr(\"action\")}='copy'>${copyMessage}</button>`, { icon: \"copy\", fillMode: \"flat\", themeColor: \"primary\" });\n                                break;\n                            case \"retry\":\n                                buttons = buttons + kendo.html.renderButton(`<button role='button' title='${retryMessage}' ${ARIA_LABEL}='${retryMessage}'  ${kendo.attr(\"action\")}='retry'>${retryMessage}</button>`, { icon: \"arrow-rotate-cw\", fillMode: \"flat\", themeColor: \"primary\" });\n                                break;\n                            case \"discard\":\n                                buttons = buttons + kendo.html.renderButton(`<button role='button' title ='${discardMessage}' ${ARIA_LABEL}='${discardMessage}' ${kendo.attr(\"action\")}='discard'>${discardMessage}</button>`, { icon: \"cancel-outline\", fillMode: \"flat\" });\n                                break;\n                            default:\n                                break;\n                        }\n                    }\n                    else {\n                        buttons = buttons + kendo.html\n                        .renderButton(`<button role='button' ${outputAction?.title != undefined ? `title=${outputAction.title} ${ARIA_LABEL}=${outputAction.title}` : \"\"} ${kendo.attr(\"action\")}='${outputAction?.command}'>${outputAction?.text || (that._isDefaultOutputAction(outputAction?.command) ? that.options.messages[outputAction?.command + 'OutputAction'] || outputAction?.command : outputAction?.command)}</button>`,\n                        {\n                            rounded: outputAction?.rounded,\n                            icon: outputAction?.icon || that._renderDefaultOutputActionIcon(outputAction?.command),\n                            fillMode: outputAction?.fillMode || \"flat\",\n                            themeColor: outputAction?.themeColor || \"primary\",\n                        });\n                    }\n                });\n\n                return buttons;\n            }\n        },\n\n        _renderDefaultOutputActionIcon(command) {\n            let that = this;\n            if (that._isDefaultOutputAction(command)) {\n                switch (command) {\n                case \"copy\":\n                    return \"copy\";\n                case \"discard\":\n                    return \"cancel-outline\";\n                case \"retry\":\n                    return \"arrow-rotate-cw\";\n                default:\n                    return;\n                }\n            }\n        },\n\n        _isDefaultOutputAction(command) {\n            switch (command) {\n                case \"copy\":\n                    return true;\n                case \"discard\":\n                    return true;\n                case \"retry\":\n                    return true;\n                default:\n                    return false;\n            }\n        },\n\n        _initContextMenu: function() {\n            const that = this;\n            if (!that.options.commands || that.options.commands?.length === 0) {\n                that._popup.element.find('.k-input-prefix button').addClass('k-disabled');\n                return;\n            }\n\n            const itemsHtml = that.options.commands.map(command => that._createCommandHtml(command)).join('');\n            const html = $(`<ul>\n                                ${itemsHtml}\n                            </ul>`);\n\n            $('body').append(html);\n\n            that._aiContextMenu = html.kendoContextMenu({\n                target: that._popup.element,\n                anchor: that._popup.element,\n                showOn: 'click',\n                appendTo: $(document.body),\n                filter: '.invalid',\n                select: that._executeCommand.bind(that)\n            }).data('kendoContextMenu');\n        },\n\n        _createCommandHtml: function(command) {\n            const that = this;\n            const icon = that._renderCommandIcon(command.icon);\n            const text = command.text;\n            const items = command.items || [];\n            const itemsHtml = items.map(item => that._createCommandHtml(item)).join('');\n\n            return `<li ${kendo.attr(\"name\")}=${command.id}>${icon} ${text}${itemsHtml ? \"<ul>\" + itemsHtml + \"</ul>\" : \"\"}</li>`;\n        },\n\n        _renderCommandIcon: function(icon) {\n            if (kendo.isPresent(icon)) {\n                return kendo.isFunction(icon) ? icon() : kendo.html.renderIcon({ icon: icon });\n            }\n\n            return \"\";\n        },\n\n        _executeCommand: function(e) {\n            const that = this;\n            let command = that._findCommand(that.options.commands, e.item.getAttribute(kendo.attr(\"name\")));\n\n            let data = {\n                query: command.id,\n                selection: \"\"\n            };\n\n            that._clearSelectedCommands(that.options.commands);\n\n            if (kendo.isPresent(that._textArea)) {\n                const textAreaValue = that._textArea.value();\n\n                if (kendo.isPresent(textAreaValue) && textAreaValue != \"\") {\n                    data.selection = textAreaValue;\n                }\n            }\n\n            that.trigger(COMMAND_EXECUTE, data);\n\n            const selection = data.selection || data.context;\n\n            if (kendo.isPresent(command.prompt)) {\n                const prompt = command.prompt(selection);\n                that._requestService(prompt);\n                that._aiContextMenu?.close();\n            }\n            command.selected = true;\n        },\n\n        _clearSelectedCommands: function(commands) {\n            const that = this;\n\n            commands.forEach(function(command) {\n                if (kendo.isPresent(command.items) && command.items.length > 0) {\n                    that._clearSelectedCommands(command.items);\n                }\n                if (command.hasOwnProperty(\"selected\")) {\n                    delete command.selected;\n                }\n            });\n        },\n\n        _findCommand: function(commands, id, searchSelected = false) {\n            const that = this;\n\n            for (let command of commands) {\n                if (searchSelected && command.selected) {\n                    return command;\n                }\n\n                if (command.id === id) {\n                    return command;\n                }\n\n                if (command.items) {\n                    let found = that._findCommand(command.items, id, searchSelected);\n\n                    if (found) {\n                        return found;\n                    }\n                }\n            }\n        },\n\n        _bindEvents: function() {\n            const that = this,\n                  popup = that._popup,\n                  popupElement = popup.element;\n\n            that._textArea.element.on(\"input\" + NS, that._input.bind(that));\n\n            popupElement.find(`.k-input-prefix button[aria-label='${that.options.messages.commandsMenu}']`).on('click', function() {\n                that._aiContextMenu?.open();\n            });\n\n            that._textArea._suffixContainer.find(`.${K_PROMPT_SEND}`).on('click', function() {\n                 const prompt = that._textArea.value();\n                 that._requestService(prompt);\n            });\n\n            popupElement.find('.k-card-actions button').on('click', function(e) {\n                let contentElement = popupElement.find('.k-card-body'),\n                    contentText = contentElement.text(),\n                    prompt = kendo.isPresent(that._textArea) ? that._textArea.value() : \"\",\n                    previouslySelectedCommand = that._findCommand(that.options.commands, 0, true),\n                    query = kendo.isPresent(previouslySelectedCommand) ? previouslySelectedCommand.prompt(prompt) : prompt;\n\n                const action = $(e.currentTarget).attr(kendo.attr(\"action\"));\n\n                switch (action) {\n                    case \"copy\":\n                        navigator.clipboard.writeText(contentText);\n                        that.trigger(OUTPUT_ACTION, { action, content: contentText });\n                        break;\n                    case \"retry\":\n                        that._requestService(query);\n                        that.trigger(OUTPUT_ACTION, { action, content: contentText });\n                        break;\n                    case \"discard\":\n                        contentElement.empty();\n                        popupElement.find('.k-card').hide();\n                        popupElement.find('.k-input-inner').val('');\n                        that.trigger(OUTPUT_ACTION, { action, content: contentText });\n                        popup.close();\n                        break;\n                    default:\n                        that.trigger(OUTPUT_ACTION, { action, content: contentText });\n                        break;\n                }\n            });\n        },\n\n        _stopOutputRetrievalButton: function(toggle) {\n            let that = this;\n\n            if (toggle) {\n                let stopOutputRetrievalMessage = that.options.messages.stopOutputRetrieval,\n                    stopOutputRetrievalButton = kendo.html\n                .renderButton(`<button role='button' title='${stopOutputRetrievalMessage}' ${ARIA_LABEL}='${stopOutputRetrievalMessage}' class='${K_PROMPT_SEND} ${K_STOP_OUTPUT_RETRIEVAL}'></button>`,\n                    { icon: \"stop-sm\", fillMode: \"flat\" }\n                );\n\n                that._textArea._suffixContainer.find(`.${K_PROMPT_SEND}`)\n                    .replaceWith(stopOutputRetrievalButton);\n\n                that._textArea._suffixContainer.find(`.${K_STOP_OUTPUT_RETRIEVAL}`)\n                    .on('click', function(e) {\n                        that.trigger(PROMPT_REQUEST_CANCEL, that);\n                    });\n            }\n            else {\n                let promptSendMessage = that.options.messages.promptSend;\n                let promptSendButton = kendo.html\n                .renderButton(`<button role='button' title=\"${promptSendMessage}\" ${ARIA_LABEL}=${promptSendMessage} class='${K_PROMPT_SEND} ${K_DISABLED}'></button>`,\n                    { icon: \"paper-plane\", fillMode: \"flat\" }\n                );\n\n                 that._textArea._suffixContainer.find(`.${K_STOP_OUTPUT_RETRIEVAL}`)\n                    .replaceWith(promptSendButton);\n\n                 that._textArea._suffixContainer.find(`.${K_PROMPT_SEND}`)\n                    .on('click', function(e) {\n                         const prompt = that._textArea.value();\n                         that._requestService(prompt);\n                    });\n            }\n        },\n\n        _progress: function(toggle) {\n             let that = this;\n\n             that._stopOutputRetrievalButton(toggle);\n             that._toggleSkeleton(toggle);\n        },\n\n        _toggleSkeleton: function(toggle) {\n            let that = this;\n\n            if (that.skeleton) {\n                that.skeleton.remove();\n            }\n\n            if (toggle) {\n                that.skeleton = $(\"<span class='k-skeleton k-skeleton-pulse'></span>\").css({\n                    width: \"100%\",\n                    height: \"100%\"\n                });\n\n                that._textArea._suffixContainer\n                    .find(`.${K_STOP_OUTPUT_RETRIEVAL}`)\n                    .wrap(that.skeleton);\n            }\n\n            else {\n                that._textArea._suffixContainer\n                    .find(`.${K_PROMPT_SEND}`)\n                    .unwrap();\n            }\n        },\n\n        _requestService: function(query) {\n            const that = this;\n            const data = {\n                query,\n                context: \"\"\n            };\n\n            if (!query.trim()) {\n                return;\n            }\n\n            const context = data.context;\n            const prompt = that.options.systemPrompt(context, query);\n\n            that.trigger(PROMPT_REQUEST, { prompt: prompt });\n\n            if (that.options.isStreaming) {\n                that._popup.element.find('.k-card').show();\n            }\n\n            if (that.options.service) {\n                that.transport.read({ prompt, history: [], isRetry: false });\n            }\n        },\n\n        _focusOutputActions() {\n            let that = this,\n                outputActionsContainer = that._popup.element.find('.k-actions'),\n                outputActionsButtons = outputActionsContainer.children(\"button\");\n\n            if (!outputActionsContainer.find($(document.activeElement)).length) {\n                $(outputActionsButtons).first().focus();\n            }\n            else if (outputActionsButtons.length == 0) {\n                that._textArea.focus();\n            }\n        },\n\n        focus: function() {\n            let that = this;\n            that.element.trigger(FOCUS);\n        },\n\n        setOptions: function(options) {\n            let that = this;\n\n            that.destroy();\n            kendo.deepExtend(this.options, options);\n\n            that.init(that.element, options);\n        },\n\n        destroy: function() {\n            let that = this;\n\n            that._popup?.close();\n            that._textArea?.destroy();\n            that._speechToTextButton?.destroy();\n            that._aiContextMenu?.destroy();\n            that.toolbar?.destroy();\n            that._selectedView?.destroy();\n            that._popup?.destroy();\n\n            that.element.off(NS);\n\n            Widget.fn.destroy.call(that);\n        }\n    });\n\n    ui.plugin(InlineAIPrompt);\n\n})(window.kendo.jQuery);\nexport default kendo;\n"],"mappings":"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"}