{"version":3,"file":"kendo.aiprompt.min.js","names":[],"sources":["../../src/aiprompt/output-action-manager.js","../../src/aiprompt/template-builder.js","../../src/aiprompt/speech-manager.js","../../src/aiprompt/output-manager.js","../../src/aiprompt/views.js","../../src/kendo.aiprompt.js"],"sourcesContent":["// Button management abstraction for AIPrompt views\n(function($) {\n    const messageTypes = {\n        \"ai\": \"assistant\",\n        \"system\": \"system\",\n        \"user\": \"user\",\n        \"tool\": \"tool\"\n    };\n\n    class AIPromptOutputActionManager {\n        constructor(aiprompt, options = {}) {\n            this.aiprompt = aiprompt;\n            this.options = options;\n            this.buttonDefinitions = this._createButtonDefinitions();\n        }\n\n        static getBuiltInActionDefinitions() {\n            return {\n                copy: {\n                    command: \"copy\",\n                    icon: \"copy\",\n                    fillMode: \"flat\",\n                    themeColor: \"primary\",\n                    text: null\n                },\n                retry: {\n                    command: \"retry\",\n                    icon: \"arrow-rotate-cw\",\n                    fillMode: \"flat\",\n                    text: null\n                },\n                ratePositive: {\n                    command: \"ratePositive\",\n                    icon: \"thumb-up-outline\",\n                    fillMode: \"flat\",\n                    iconButton: true,\n                    text: null\n                },\n                rateNegative: {\n                    command: \"rateNegative\",\n                    icon: \"thumb-down-outline\",\n                    fillMode: \"flat\",\n                    iconButton: true,\n                    text: null\n                },\n                stop: {\n                    command: \"stop\",\n                    icon: \"stop\",\n                    fillMode: \"flat\",\n                    text: null\n                }\n            };\n        }\n\n        static processOutputActions(actions) {\n            if (!actions) {\n                return null;\n            }\n\n            const builtInActions = AIPromptOutputActionManager.getBuiltInActionDefinitions();\n\n            return actions.map(action => {\n                if (typeof action === \"string\") {\n                    if (action === \"rating\") {\n                        return [builtInActions.ratePositive, builtInActions.rateNegative];\n                    } else if (action === \"spacer\") {\n                        return { type: \"spacer\" };\n                    }\n\n                    return builtInActions[action] || { command: action, type: \"button\" };\n                }\n                if (kendo.isPresent(action.command) && action.command == \"rating\") {\n                    return [builtInActions.ratePositive, builtInActions.rateNegative];\n                }\n                return action;\n            }).flat();\n        }\n\n        _createButtonDefinitions() {\n            const that = this;\n            const baseDefinitions = AIPromptOutputActionManager.getBuiltInActionDefinitions();\n\n            return {\n                copy: {\n                    ...baseDefinitions.copy,\n                    getMessage: () => that.view.options.messages.copyOutput,\n                    handler: (e, promptOutput) => that._handleCopyAction(e, promptOutput)\n                },\n                retry: {\n                    ...baseDefinitions.retry,\n                    getMessage: () => that.view.options.messages.retryGeneration,\n                    handler: (e, promptOutput) => that._handleRetryAction(e, promptOutput)\n                },\n                ratePositive: {\n                    ...baseDefinitions.ratePositive,\n                    getMessage: () => that.view.options.messages.ratePositive,\n                    handler: (e, promptOutput) => that._handleRatePositiveAction(e, promptOutput)\n                },\n                rateNegative: {\n                    ...baseDefinitions.rateNegative,\n                    getMessage: () => that.view.options.messages.rateNegative,\n                    handler: (e, promptOutput) => that._handleRateNegativeAction(e, promptOutput)\n                },\n                stop: {\n                    ...baseDefinitions.stop,\n                    getMessage: () => that.view.options.messages.stopGeneration,\n                    handler: (e, promptOutput) => that._handleStopAction(e, promptOutput)\n                }\n            };\n        }\n\n        initializeButtons(container, actions = null) {\n            const that = this;\n\n            if (actions) {\n                actions.forEach(action => {\n                    if (action.type === 'spacer') {\n                        return;\n                    }\n\n                    const selector = `[data-action-command=\"${action.command}\"]`;\n                    that._initializeButton(container, selector, action);\n                });\n            }\n        }\n\n        _initializeButton(container, selector, action) {\n            const that = this;\n            const definition = that.buttonDefinitions[action.command];\n\n            container.find(selector).kendoButton({\n                icon: action.icon || definition?.icon,\n                fillMode: action.fillMode || definition?.fillMode || \"flat\",\n                themeColor: action.themeColor || definition?.themeColor,\n                rounded: action.rounded,\n                click: function(e) {\n                    const promptOutput = that.aiprompt.outputManager.getOutputFromElement(e.target);\n                    const eventArgs = {\n                        command: action.command,\n                        outputId: promptOutput.id,\n                        output: promptOutput.output || promptOutput.text || promptOutput || \"\",\n                        prompt: promptOutput.prompt || \"\",\n                        button: e.sender.element\n                    };\n\n                    if (definition?.handler && !that.aiprompt.trigger(\"outputAction\", eventArgs)) {\n                        definition.handler(e, promptOutput);\n                    } else if (!definition) {\n                        that.aiprompt.trigger(\"outputAction\", eventArgs);\n                    }\n                }\n            });\n        }\n\n        _handleCopyAction(e, promptOutput) {\n            const hasCopyHandler = this.aiprompt._events && this.aiprompt._events.outputCopy && this.aiprompt._events.outputCopy.length > 0;\n\n            if (hasCopyHandler) {\n                kendo.logToConsole(\"The outputCopy event is deprecated. Use the outputAction event instead.\", \"warn\");\n            }\n\n            const copyEventArgs = { output: promptOutput };\n            if (hasCopyHandler && this.aiprompt.trigger(\"outputCopy\", copyEventArgs)) {\n                return;\n            }\n\n            if (navigator.clipboard && typeof navigator.clipboard.writeText === \"function\") {\n                navigator.clipboard.writeText(promptOutput.output || promptOutput.text || promptOutput || \"\");\n            }\n        }\n\n        _handleRetryAction(e, promptOutput) {\n            const { prompt, output } = this.aiprompt.outputManager.extractOutputData(promptOutput);\n            const that = this;\n            const history = {\n                role: messageTypes.ai,\n                contents: [\n                    {\n                        $type: \"text\",\n                        text: output\n                    }\n                ]\n            };\n            const retryEventArgs = {\n                prompt: prompt,\n                output: promptOutput,\n                isRetry: true,\n                history: [history]\n            };\n\n            const service = that.aiprompt?._selectedView?.service;\n\n            if (service) {\n                retryEventArgs.service = service;\n            }\n\n            if (that.aiprompt.trigger(\"promptRequest\", retryEventArgs)) {\n                return;\n            }\n\n            if (that.aiprompt?.options.service) {\n                that.aiprompt?.transport?.read({\n                    prompt: prompt,\n                    history: retryEventArgs.history,\n                    isRetry: true,\n                    service: retryEventArgs.service\n                });\n            }\n        }\n\n        _handleRatePositiveAction(e, promptOutput) {\n            const hasRatingChangeHandler = this.aiprompt._events && this.aiprompt._events.outputRating && this.aiprompt._events.outputRating.length > 0;\n\n            if (hasRatingChangeHandler) {\n                kendo.logToConsole(\"The outputRating event is deprecated. Use the outputAction event instead.\", \"warn\");\n            }\n\n            this.aiprompt.trigger(\"outputRating\", { rateType: \"positive\", output: promptOutput });\n\n            kendo.ui.icon(e.sender.element.find(\".k-icon\"), \"thumb-up\");\n\n            const negativeButton = $(e.target).siblings(\"[data-action-command='rateNegative'], [ref-rate-negative]\");\n            kendo.ui.icon(negativeButton.find(\".k-icon\"), \"thumb-down-outline\");\n        }\n\n        _handleRateNegativeAction(e, promptOutput) {\n            const hasRatingChangeHandler = this.aiprompt._events && this.aiprompt._events.outputRating && this.aiprompt._events.outputRating.length > 0;\n\n            if (hasRatingChangeHandler) {\n                kendo.logToConsole(\"The outputRating event is deprecated. Use the outputAction event instead.\", \"warn\");\n            }\n\n            this.aiprompt.trigger(\"outputRating\", { rateType: \"negative\", output: promptOutput });\n\n            kendo.ui.icon(e.sender.element.find(\".k-icon\"), \"thumb-down\");\n\n            const positiveButton = $(e.target).siblings(\"[data-action-command='ratePositive'], [ref-rate-positive]\");\n            kendo.ui.icon(positiveButton.find(\".k-icon\"), \"thumb-up-outline\");\n        }\n\n        _handleStopAction(e, promptOutput) {\n            this.aiprompt.trigger(\"promptRequestCancel\", { output: promptOutput });\n\n            $(e.target).siblings(\".k-hidden\").removeClass(\"k-hidden\");\n            $(e.target).addClass(\"k-hidden\");\n        }\n\n        destroy() {\n            this.aiprompt = null;\n            this.options = null;\n            this.buttonDefinitions = null;\n        }\n    }\n\n    kendo.ui.AIPromptOutputActionManager = AIPromptOutputActionManager;\n\n})(window.kendo.jQuery);\n","// Template management for AIPrompt views\n(function($) {\n\n    const CSS_CLASSES = {\n        PROMPT_VIEW: \"k-prompt-view\",\n        PROMPT_EXPANDER: \"k-prompt-expander\",\n        SUGGESTION_GROUP: \"k-suggestion-group\",\n        SUGGESTION: \"k-suggestion\",\n        CARD: \"k-card\",\n        CARD_LIST: \"k-card-list\",\n        CARD_HEADER: \"k-card-header\",\n        CARD_TITLE: \"k-card-title\",\n        CARD_SUBTITLE: \"k-card-subtitle\",\n        CARD_BODY: \"k-card-body\",\n        CARD_ACTIONS: \"k-card-actions\",\n        ACTIONS: \"k-actions k-actions-start k-actions-horizontal\",\n        SPACER: \"k-spacer\",\n        HIDDEN: \"k-hidden\"\n    };\n\n    const REFS = {\n        PROMPT_INPUT: \"ref-prompt-input\",\n        SUGGESTIONS_BUTTON: \"ref-prompt-suggestions-button\",\n        GENERATE_BUTTON: \"ref-generate-output-button\",\n        OUTPUT_BODY: \"ref-output-body\",\n        COPY_BUTTON: \"ref-copy-button\",\n        RETRY_BUTTON: \"ref-retry-button\",\n        RATE_POSITIVE: \"ref-rate-positive\",\n        RATE_NEGATIVE: \"ref-rate-negative\",\n        STOP_GENERATION: \"ref-stop-generation\"\n    };\n\n    // Template builder class for consistent template generation\n    class AIPromptTemplateBuilder {\n\n        static createPromptView({ suggestions, promptSuggestionItemTemplate, messages }) {\n            const suggestionsHtml = suggestions?.length ?\n                AIPromptTemplateBuilder._createSuggestionsSection(suggestions, promptSuggestionItemTemplate, messages) : '';\n\n            return `<div class=\"${CSS_CLASSES.PROMPT_VIEW}\">\n                <textarea ${REFS.PROMPT_INPUT}></textarea>\n                ${suggestionsHtml}\n            </div>`;\n        }\n\n        static createPromptFooter({ messages }) {\n            return `<div class=\"${CSS_CLASSES.ACTIONS} k-prompt-actions\">\n                <button ${REFS.GENERATE_BUTTON}>${messages.generateOutput}</button>\n            </div>`;\n        }\n\n        static createSuggestionItem({ suggestion }) {\n            return `<span role=\"listitem\" class=\"${CSS_CLASSES.SUGGESTION}\">${suggestion}</span>`;\n        }\n\n        static createOutputCard({ output, showOutputRating, messages, showOutputSubtitleTooltip, encodedPromptOutputs, isStreaming, outputActions, outputTemplate }) {\n            const contentHtml = AIPromptTemplateBuilder._generateContentHtml({\n                output, outputTemplate, encodedPromptOutputs\n            });\n\n            const actionsHtml = AIPromptTemplateBuilder._generateActionsHtml({\n                outputActions, showOutputRating, messages, isStreaming\n            });\n            const dataIdAttr = output.id ? ` data-id=\"${output.id}\"` : '';\n            return `<div role=\"listitem\" tabindex=\"0\" class=\"${CSS_CLASSES.CARD}\"${dataIdAttr}>\n                ${output.skipHeader ? '' : AIPromptTemplateBuilder._createCardHeader(output, messages, showOutputSubtitleTooltip)}\n                ${output.skipBody ? '' : AIPromptTemplateBuilder._createCardBody(contentHtml, output.isLoading)}\n                ${output.skipActions ? '' : actionsHtml}\n            </div>`;\n        }\n\n        static createOutputView({ promptOutputs, showOutputRating, messages, showOutputSubtitleTooltip, encodedPromptOutputs, outputActions, outputTemplate }) {\n            const cardsHtml = promptOutputs ?\n                promptOutputs.map(output =>\n                    AIPromptTemplateBuilder.createOutputCard({\n                        output, showOutputRating, messages, showOutputSubtitleTooltip,\n                        encodedPromptOutputs, outputActions, outputTemplate\n                    })\n                ).join(\"\") : '';\n\n            return `<div class=\"${CSS_CLASSES.PROMPT_VIEW}\">\n                <div role=\"list\" class=\"${CSS_CLASSES.CARD_LIST}\">\n                    ${cardsHtml}\n                </div>\n            </div>`;\n        }\n\n        // Private helper methods\n        static _createSuggestionsSection(suggestions, promptSuggestionItemTemplate, messages) {\n            const suggestionItems = suggestions\n                .map(suggestion => promptSuggestionItemTemplate({ suggestion }))\n                .join(\"\");\n\n            return `<div class=\"${CSS_CLASSES.PROMPT_EXPANDER}\">\n                <button ${REFS.SUGGESTIONS_BUTTON} aria-expanded=\"true\">${messages.promptSuggestions}</button>\n                <div class=\"k-prompt-expander-content\" role=\"list\">\n                    <div class=\"${CSS_CLASSES.SUGGESTION_GROUP}\">\n                        ${suggestionItems}\n                    </div>\n                </div>\n            </div>`;\n        }\n\n        static _createCardHeader(output, messages, showOutputSubtitleTooltip) {\n            const tooltipAttr = showOutputSubtitleTooltip ?\n                `title=\"${kendo.htmlEncode(output.prompt)}\"` : \"\";\n\n            return `<div class=\"${CSS_CLASSES.CARD_HEADER}\">\n                <div class=\"${CSS_CLASSES.CARD_TITLE}\">${messages.outputTitle}</div>\n                <div class=\"${CSS_CLASSES.CARD_SUBTITLE}\" ${tooltipAttr}>${kendo.htmlEncode(output.prompt)}</div>\n            </div>`;\n        }\n\n        static _createCardBody(contentHtml, isLoading) {\n            return `<div class=\"${CSS_CLASSES.CARD_BODY}\" ${REFS.OUTPUT_BODY}>\n                ${contentHtml}\n            </div>`;\n        }\n\n        static _generateContentHtml({ output, outputTemplate, encodedPromptOutputs }) {\n            if (outputTemplate && typeof outputTemplate === 'function' &&\n                !output.isLoading && output.output) {\n                return outputTemplate({ output: output, content: output.output });\n            }\n\n            const content = output.output || '';\n            const loadingAttr = output.isLoading ? ' data-loading=\"true\"' : ' data-loading=\"false\"';\n            return `<p ref-output-content${loadingAttr}>${encodedPromptOutputs ? kendo.htmlEncode(content) : content}</p>`;\n        }\n\n        static _generateActionsHtml({ outputActions, showOutputRating, messages, isStreaming }) {\n            // outputActions should always be defined due to component defaults,\n            // but provide fallback for safety\n            if (!outputActions) {\n                outputActions = showOutputRating ?\n                    [\"copy\", \"retry\", \"spacer\", \"rating\"] :\n                    [\"copy\", \"retry\"];\n            }\n\n            return AIPromptTemplateBuilder._createCustomActions(outputActions, showOutputRating, messages, isStreaming);\n        }\n\n        static _createCustomActions(outputActions, showOutputRating, messages, isStreaming) {\n            const filteredActions = outputActions.filter(action => action.command !== 'stop');\n\n            // Check if rating buttons are already included in the actions\n            const hasRatingButtons = filteredActions.some(action =>\n                action.command === 'ratePositive' || action.command === 'rateNegative'\n            );\n\n            // If showOutputRating is true and rating buttons aren't already included, add them with a spacer\n            let actionsToRender = [...filteredActions];\n            if (showOutputRating && !hasRatingButtons) {\n                // Check if there's already a spacer, if not add one\n                const hasExistingSpacer = actionsToRender.some(action => action.type === 'spacer');\n                if (!hasExistingSpacer) {\n                    actionsToRender.push({ type: 'spacer' });\n                }\n\n                // Add rating buttons\n                actionsToRender.push(\n                    { command: 'ratePositive', text: messages.ratePositive, type: 'button' },\n                    { command: 'rateNegative', text: messages.rateNegative, type: 'button' }\n                );\n            }\n\n            const actionsHtml = actionsToRender\n                .map(action => AIPromptTemplateBuilder._createActionButton(action, messages, isStreaming))\n                .join('');\n\n            return `<div class=\"${CSS_CLASSES.ACTIONS} ${CSS_CLASSES.CARD_ACTIONS}\">\n                ${actionsHtml}\n            </div>`;\n        }\n\n        static _createActionButton(action, messages, isStreaming) {\n            if (action.type === 'spacer') {\n                return `<span class=\"${CSS_CLASSES.SPACER}\"></span>`;\n            }\n\n            const text = action.text || AIPromptTemplateBuilder._getActionText(action.command, messages);\n            const title = action.title || text;\n\n            return `<button data-action-command=\"${action.command}\" title=\"${title}\">${action.iconButton ? \"\" : text}</button>`;\n        }\n\n        static _getActionText(command, messages) {\n            const textMap = {\n                'copy': messages.copyOutput,\n                'retry': messages.retryGeneration,\n                'ratePositive': messages.ratePositive,\n                'rateNegative': messages.rateNegative\n            };\n\n            return textMap[command] || command;\n        }\n    }\n\n    // Expose to kendo namespace\n    kendo.ui.AIPromptTemplateBuilder = AIPromptTemplateBuilder;\n\n})(window.kendo.jQuery);\n","// Speech-to-text management for AIPrompt\n(function($) {\n\n    class AIPromptSpeechManager {\n        constructor(view, options = {}) {\n            this.view = view;\n            this.aiprompt = view.aiprompt;\n            this.options = this._processSettings(options);\n            this._speechButton = null;\n        }\n\n        _processSettings(speechToTextConfig) {\n            const defaultOptions = {\n                integrationMode: \"webSpeech\",\n                lang: 'en-US',\n                continuous: false,\n                interimResults: false,\n                maxAlternatives: 1\n            };\n\n            if (speechToTextConfig === false || speechToTextConfig === null) {\n                return { enabled: false, options: null };\n            } else if (speechToTextConfig === true) {\n                return { enabled: true, options: defaultOptions };\n            } else if (typeof speechToTextConfig === 'object') {\n                return {\n                    enabled: true,\n                    options: $.extend({}, defaultOptions, speechToTextConfig)\n                };\n            }\n\n            return { enabled: true, options: defaultOptions };\n        }\n\n        isEnabled() {\n            return this.options.enabled;\n        }\n\n        getTextAreaSuffixOptions() {\n            if (!this.isEnabled()) {\n                return {};\n            }\n\n            return {\n                suffixOptions: {\n                    template: function() {\n                        return '<button ref-speech-to-text-button title=\"Speech to Text\"></button>';\n                    },\n                    separator: false,\n                }\n            };\n        }\n\n        initialize(textareaWidget) {\n            if (!this.isEnabled() || !textareaWidget) {\n                return false;\n            }\n\n            const speechButton = textareaWidget.wrapper.find(\"button[ref-speech-to-text-button]\");\n            if (speechButton.length === 0) {\n                return false;\n            }\n\n            this._speechButton = speechButton.kendoSpeechToTextButton({\n                ...this.options.options,\n                fillMode: \"flat\"\n            }).getKendoSpeechToTextButton();\n\n            this._speechButton.bind(\"result\", (e) => this._handleResult(e, textareaWidget));\n            this.aiprompt.speechToTextButton = this._speechButton;\n            return true;\n        }\n\n        _handleResult(e, textareaWidget) {\n            if (e.isFinal || !this.options.options.interimResults) {\n                const transcript = e.alternatives[0]?.transcript || '';\n                const currentValue = textareaWidget.value();\n                let newValue = currentValue ? currentValue + ' ' + transcript : transcript;\n                const maxLength = textareaWidget.options.maxlength;\n\n                if (maxLength && newValue.length > maxLength) {\n                    newValue = newValue.substring(0, maxLength);\n                }\n\n                textareaWidget.value(newValue);\n            }\n        }\n\n        startRecognition() {\n            if (this._speechButton) {\n                this._speechButton.startRecognition();\n            }\n        }\n\n        stopRecognition() {\n            if (this._speechButton) {\n                this._speechButton.stopRecognition();\n            }\n        }\n\n        abortRecognition() {\n            if (this._speechButton) {\n                this._speechButton.abortRecognition();\n            }\n        }\n\n        isListening() {\n            return this._speechButton ? this._speechButton.isListening() : false;\n        }\n\n        destroy() {\n            if (this._speechButton) {\n                this._speechButton.destroy();\n                this._speechButton = null;\n            }\n        }\n    }\n\n    // Expose to kendo namespace\n    kendo.ui.AIPromptSpeechManager = AIPromptSpeechManager;\n\n})(window.kendo.jQuery);\n","// Output management abstraction for AIPrompt components\n(function($) {\n\n    class AIPromptOutputObject {\n        constructor(outputData, outputManager) {\n            this.id = outputData.id;\n            this.data = outputData;\n            this._element = null;\n            this._bodyElement = null;\n            this._aiprompt = outputManager.aiprompt;\n            this._isLoading = outputData.isLoading || false;\n        }\n\n        get isLoading() {\n            return this._isLoading;\n        }\n\n                set isLoading(value) {\n            const wasLoading = this._isLoading;\n            this._isLoading = value;\n\n            this.data.isLoading = value;\n\n            if (value === true) {\n                this.showSkeleton();\n            } else if (value === false) {\n                this.hideSkeleton();\n\n                if (wasLoading || this.data.output) {\n                    this.applyFinalTemplate();\n                }\n            }\n        }\n\n        getElement() {\n            return this._element;\n        }\n\n        setElement(element) {\n            this._element = element;\n            return this;\n        }\n\n        updateContent(newContent) {\n            if (!this._element || this._element.length === 0) {\n                return this;\n            }\n\n            this.data.content = newContent;\n            this.data.output = newContent;\n\n            const bodyElement = this._element.find('.k-card-body');\n            const contentElement = bodyElement.find('[ref-output-content]');\n\n            if (newContent && newContent.trim() && contentElement.length > 0) {\n                bodyElement.find('.k-skeleton').remove();\n\n                contentElement.attr('data-loading', 'false').show();\n                const encodedPromptOutputs = this._aiprompt.options.encodedPromptOutputs;\n                contentElement.html(encodedPromptOutputs ? kendo.htmlEncode(newContent) : newContent);\n            }\n\n            return this;\n        }\n\n        showSkeleton() {\n            this.showHeaderSkeleton();\n            this.showBodySkeleton();\n            this.showActionSkeleton();\n            return this;\n        }\n\n        hideSkeleton() {\n            this.hideHeaderSkeleton();\n            this.hideBodySkeleton();\n            this.hideActionSkeleton();\n            return this;\n        }\n\n        applyFinalTemplate() {\n            if (!this._element || this._element.length === 0) {\n                return this;\n            }\n\n            const bodyElement = this._element.find('.k-card-body');\n            const contentElement = bodyElement.find('[ref-output-content]');\n\n            let outputTemplate = this._aiprompt?.options?.outputTemplate;\n            if (!outputTemplate) {\n                return this;\n            } else if (typeof outputTemplate === 'string') {\n                outputTemplate = kendo.template(outputTemplate);\n            }\n\n            if (outputTemplate && typeof outputTemplate === 'function' && this.data.output) {\n                const customContent = outputTemplate({ output: this.data, content: this.data.output });\n                bodyElement.html(customContent);\n            } else if (contentElement.length > 0) {\n                contentElement.attr('data-loading', 'false').show();\n            }\n\n            return this;\n        }\n\n        showHeaderSkeleton() {\n            if (!this._element || this._element.length === 0) {\n                return this;\n            }\n\n            const headerElement = this._element.find('.k-card-header');\n            if (headerElement.length === 0) {\n                return this;\n            }\n\n            // Optionally hide header content if needed\n            headerElement.children().hide();\n\n            if (headerElement.find('.k-skeleton').length === 0) {\n                const skeleton = $(`<span class=\"k-skeleton k-skeleton-text k-skeleton-pulse\"></span>`);\n                skeleton.css('width', '60%').css('height', '24px');\n                headerElement.prepend(skeleton);\n            }\n\n            return this;\n        }\n\n        hideHeaderSkeleton() {\n            if (!this._element || this._element.length === 0) {\n                return this;\n            }\n\n            const headerElement = this._element.find('.k-card-header');\n            if (headerElement.length === 0) {\n                return this;\n            }\n\n            headerElement.find('.k-skeleton').remove();\n            headerElement.children().removeClass(\"k-hidden\").show();\n\n            return this;\n        }\n\n        showBodySkeleton() {\n            if (!this._element || this._element.length === 0) {\n                return this;\n            }\n\n            const bodyElement = this._element.find('.k-card-body');\n            const contentElement = bodyElement.find('[ref-output-content]');\n\n            contentElement.attr('data-loading', 'true').hide();\n\n            if (bodyElement.find('.k-skeleton').length === 0) {\n                const skeleton = $(`<span class=\"k-skeleton k-skeleton-rect k-skeleton-pulse\"></span>`);\n                skeleton.css('height', '80px');\n                bodyElement.prepend(skeleton);\n            }\n\n            return this;\n        }\n\n        hideBodySkeleton() {\n            if (!this._element || this._element.length === 0) {\n                return this;\n            }\n\n            const bodyElement = this._element.find('.k-card-body');\n\n            bodyElement.find('.k-skeleton').remove();\n\n            this.applyFinalTemplate();\n\n            return this;\n        }\n\n        showActionSkeleton() {\n            if (!this._element || this._element.length === 0) {\n                return this;\n            }\n\n            const actionsElement = this._element.find('.k-card-actions');\n\n            if (actionsElement.length > 0) {\n                actionsElement.children().hide();\n\n                if (actionsElement.find('.k-skeleton').length === 0) {\n                    const skeleton = $(`<span class=\"k-skeleton k-skeleton-text k-skeleton-pulse\"></span>`);\n                    skeleton.css('width', '100%').css('height', '32px');\n                    actionsElement.prepend(skeleton);\n                }\n            }\n\n            return this;\n        }\n\n        hideActionSkeleton() {\n            if (!this._element || this._element.length === 0) {\n                return this;\n            }\n\n            const actionsElement = this._element.find('.k-card-actions');\n\n            if (actionsElement.length > 0) {\n                actionsElement.find('.k-skeleton').remove();\n\n                actionsElement.children().removeClass(\"k-hidden\").show();\n            }\n\n            return this;\n        }\n\n        toggleActionButtons(isStreaming, outputActions) {\n            if (!this._element || this._element.length === 0) {\n                return this;\n            }\n\n            if (outputActions) {\n                // For custom output actions - hide all buttons during streaming\n                const allActions = this._element.find('[data-action-command]');\n\n                if (isStreaming) {\n                    allActions.addClass('k-hidden');\n                } else {\n                    allActions.removeClass('k-hidden');\n                }\n            } else {\n                // For legacy ref-based buttons - hide all except rating buttons during streaming\n                const actionButtons = this._element.find('[ref-copy-button], [ref-retry-button]');\n\n                if (isStreaming) {\n                    actionButtons.addClass('k-hidden');\n                } else {\n                    actionButtons.removeClass('k-hidden');\n                }\n            }\n\n            return this;\n        }\n\n        destroy() {\n            this._element = null;\n            this._bodyElement = null;\n            this._aiprompt = null;\n            this.data = null;\n            this.id = null;\n            this._isLoading = false;\n        }\n    }\n\n    class AIPromptOutputManager {\n        constructor(aiprompt) {\n            this.aiprompt = aiprompt;\n        }\n\n        createOutputObject(outputData) {\n            return new AIPromptOutputObject(outputData, this);\n        }\n\n        getLastOutputObject() {\n            if (this.aiprompt.promptOutputs.length > 0) {\n                const lastOutput = this.aiprompt.promptOutputs[0]; // First element is the most recent\n                return this.aiprompt.outputObjects.get(lastOutput.id);\n            }\n            return null;\n        }\n\n        // Enhanced method that handles parameter flexibility like the main AIPrompt component\n        updatePromptOutputContent(content, outputId) {\n            let outputObj;\n\n            if (outputId) {\n                outputObj = this.aiprompt.outputObjects.get(outputId);\n            } else {\n                outputObj = this.getLastOutputObject();\n            }\n\n            if (outputObj) {\n                // Call the output object's updateContent method directly\n                outputObj.updateContent(content);\n                return outputObj; // Return the updated object for chaining\n            } else {\n                // No output object found\n                return null;\n            }\n        }\n\n        // Stop loading state for the most recent output\n        stopLoading(objectId) {\n            let outputObj = this.aiprompt.outputObjects.get(objectId);\n            if (outputObj) {\n                outputObj.isLoading = false; // This will automatically call hideSkeleton()\n            } else {\n                outputObj = this.getLastOutputObject();\n                if (outputObj) {\n                    outputObj.isLoading = false; // This will automatically call hideSkeleton()\n                }\n            }\n        }\n\n        stopAllLoading() {\n            this.aiprompt.outputObjects.forEach(outputObj => {\n                outputObj.isLoading = false;\n            });\n        }\n\n        getOutputFromElement(element) {\n            let card = $(element).closest(\".k-card\");\n            let id = card.data(\"id\");\n\n            let promptOutput = this.aiprompt.promptOutputs.find(output => output.id == id);\n\n            if (!promptOutput && this.aiprompt.outputObjects) {\n                promptOutput = this.aiprompt.outputObjects.get(id);\n            }\n\n            return promptOutput;\n        }\n\n        extractOutputData(promptOutput) {\n            if (!promptOutput) {\n                return { prompt: null, output: null };\n            }\n\n            if (promptOutput.data) {\n                return {\n                    prompt: promptOutput.data.prompt,\n                    output: promptOutput.data.output\n                };\n            }\n\n            return {\n                prompt: promptOutput.prompt,\n                output: promptOutput.output\n            };\n        }\n\n        destroy() {\n            if (this.aiprompt && this.aiprompt.outputObjects) {\n                this.aiprompt.outputObjects.forEach(outputObj => {\n                    if (outputObj) {\n                        outputObj._element = null;\n                        outputObj._bodyElement = null;\n                        outputObj._aiprompt = null;\n                        outputObj.data = null;\n                    }\n                });\n                this.aiprompt.outputObjects.clear();\n            }\n\n            this.aiprompt = null;\n        }\n    }\n\n    kendo.ui.AIPromptOutputObject = AIPromptOutputObject;\n    kendo.ui.AIPromptOutputManager = AIPromptOutputManager;\n\n})(window.kendo.jQuery);\n","import \"../kendo.core.js\";\nimport \"../kendo.icons.js\";\nimport \"../kendo.textarea.js\";\nimport \"../kendo.button.js\";\nimport \"../kendo.panelbar.js\";\nimport \"../kendo.floatingactionbutton.js\";\nimport \"../kendo.skeletoncontainer.js\";\nimport \"./output-action-manager.js\";\nimport \"./template-builder.js\";\nimport \"./speech-manager.js\";\nimport \"./output-manager.js\";\n\n(function($) {\n    let Widget = kendo.ui.Widget;\n    const messageTypes = {\n        \"ai\": \"assistant\",\n        \"system\": \"system\",\n        \"user\": \"user\",\n        \"tool\": \"tool\"\n    };\n\n    const KDISABLED = \"k-disabled\";\n    const CSS_CLASSES = {\n        PROMPT_VIEW: \"k-prompt-view\",\n        PROMPT_EXPANDER: \"k-prompt-expander\",\n        SUGGESTION_GROUP: \"k-suggestion-group\",\n        SUGGESTION: \"k-suggestion\",\n        CARD: \"k-card\",\n        CARD_LIST: \"k-card-list\",\n    };\n\n    const REFERENCE_ATTRIBUTES = {\n        PROMPT_SUGGESTIONS_BUTTON: \"ref-prompt-suggestions-button\",\n        PROMPT_INPUT: \"ref-prompt-input\",\n        GENERATE_OUTPUT_BUTTON: \"ref-generate-output-button\",\n        OUTPUT_CONTENT: \"ref-output-content\",\n        STOP_GENERATION_BUTTON: \"ref-stop-generation-button\"\n    };\n\n    let AIPromptBaseView = kendo.ui.AIPromptBaseView = Widget.extend({\n        init: function(element, options) {\n            let that = this;\n\n            Widget.fn.init.call(that, element, options);\n\n            that.aiprompt = element.getKendoAIPrompt();\n\n            that.contentElement = that.options.contentElement;\n            that.footerElement = that.options.footerElement;\n            that.buttonText = that.options.buttonText;\n            that.buttonIcon = that.options.buttonIcon;\n            that.service = that.options.service;\n        },\n\n        options: {\n            name: \"AIPromptBaseView\",\n            buttonText: \"\",\n            buttonIcon: \"\",\n        },\n\n        render: function() {\n            let that = this;\n\n            that._renderContent();\n            that._renderFooter();\n        },\n\n        _renderContentElement: function() {\n            let that = this;\n            let content = $(\"<div></div>\").addClass(\"k-prompt-content\");\n            that.contentElement = content;\n            that.element.append(content);\n\n            return that.contentElement;\n        },\n\n        _renderFooterElement: function() {\n            let that = this;\n            let footer = $(\"<div></div>\").addClass(\"k-prompt-footer\");\n            that.footerElement = footer;\n            that.element.append(footer);\n\n            return that.footerElement;\n        },\n\n        _ajaxRequest: function(prompt, isRetry, history) {\n            let that = this;\n            let service = that.service;\n            let data = that._getAjaxData(prompt, isRetry, history);\n            const url = typeof service === \"string\" ? service : service.url;\n            const requestOptions = {\n                url: url,\n                type: \"POST\",\n                contentType: \"application/json\",\n                data: JSON.stringify(data),\n                success: (response) => that._ajaxSuccessHandler(response, isRetry, prompt),\n            };\n\n            if (service?.headers) {\n                requestOptions.headers = service.headers;\n            }\n            kendo.ui.progress(that.contentElement, true);\n\n            return $.ajax(requestOptions);\n        },\n\n        _ajaxSuccessHandler: function(response, isRetry, prompt) {\n            const that = this;\n            const outputGetter = that.service?.outputGetter || that._getResponseMessageText;\n            const output = {\n                id: kendo.guid(),\n                output: outputGetter(response),\n                prompt: prompt,\n                isRetry: isRetry,\n                activeView: 1\n            };\n\n            that.aiprompt.trigger(\"promptResponse\", {\n                output: output.output,\n                prompt: output.prompt,\n                outputId: output.id,\n                isRetry: output.isRetry,\n                response: output.response,\n            });\n\n            that.aiprompt.addPromptOutput(output);\n            that.aiprompt.activeView(output.activeView);\n\n            if (!isRetry) {\n                const generateButton = that.footerElement?.find(`button[${REFERENCE_ATTRIBUTES.GENERATE_OUTPUT_BUTTON}]`);\n                generateButton?.removeClass(KDISABLED);\n            }\n\n            kendo.ui.progress(that.contentElement, false);\n        },\n\n        _getResponseMessageText: function(response) {\n            return response?.Message?.Text || \"An error occurred while processing the request.\";\n        },\n\n        _getAjaxData: function(prompt, isRetry, history) {\n            const that = this;\n            const service = that.service;\n            let defaultData = [\n                {\n                    role: {\n                        value: messageTypes.user\n                    },\n                    text: prompt\n                }\n            ];\n\n            if (history?.length) {\n                defaultData = history.concat(defaultData);\n            }\n\n            if (typeof service === \"string\") {\n                return defaultData;\n            }\n\n            if (kendo.isPresent(service.data) && Object.keys(service.data).length) {\n                service.data.messages = defaultData;\n                return service.data;\n            }\n\n            if (kendo.isFunction(service?.data)) {\n                return service.data(prompt, isRetry, history);\n            }\n\n            if ($.isPlainObject(service) && kendo.isPresent(service.url)) {\n                return defaultData;\n            }\n\n            throw new Error(\"Invalid AIPrompt service configuration.\");\n        },\n\n        destroy: function() {\n            let that = this;\n            Widget.fn.destroy.call(that);\n\n            if (that.contentElement) {\n                that.contentElement.off();\n                kendo.destroy(that.contentElement);\n                that.contentElement.remove();\n            }\n\n            if (that.footerElement) {\n                that.footerElement.off();\n                kendo.destroy(that.footerElement);\n                that.footerElement.remove();\n            }\n\n            that.aiprompt.speechToTextButton = null;\n        }\n    });\n\n    kendo.ui.AIPromptPromptView = AIPromptBaseView.extend({\n        init: function(element, options) {\n            let that = this;\n\n            AIPromptBaseView.fn.init.call(that, element, options);\n            that.promptSuggestions = that.options.promptSuggestions;\n            that.promptSuggestionItemTemplate = that.options.promptSuggestionItemTemplate ?\n                kendo.template(that.options.promptSuggestionItemTemplate) :\n                kendo.ui.AIPromptTemplateBuilder.createSuggestionItem;\n\n            // Initialize speech manager for speech-to-text functionality\n            that.speechManager = new kendo.ui.AIPromptSpeechManager(that, that.options.speechToText);\n        },\n        options: {\n            name: \"AIPromptPromptView\",\n            buttonIcon: \"sparkles\",\n        },\n\n        _renderContent: function() {\n            let that = this;\n            let suggestions = that.promptSuggestions;\n            let promptSuggestionItemTemplate = that.promptSuggestionItemTemplate;\n\n            let content;\n            if (that.options.viewTemplate) {\n                content = kendo.template(that.options.viewTemplate)({\n                    suggestions,\n                    promptSuggestionItemTemplate,\n                    messages: that.options.messages\n                });\n            } else {\n                content = kendo.ui.AIPromptTemplateBuilder.createPromptView({\n                    suggestions,\n                    promptSuggestionItemTemplate,\n                    messages: that.options.messages\n                });\n            }\n\n            that._renderContentElement();\n            that.contentElement.append(content);\n        },\n\n        _renderFooter: function() {\n            let that = this;\n\n            let footer;\n            if (that.options.footerTemplate) {\n                footer = kendo.template(that.options.footerTemplate)({ messages: that.options.messages });\n            } else {\n                footer = kendo.ui.AIPromptTemplateBuilder.createPromptFooter({ messages: that.options.messages });\n            }\n\n            that._renderFooterElement();\n            that.footerElement.append(footer);\n        },\n\n        setTextAreaValue: function(value) {\n            let that = this;\n            const textareaWidget = that.contentElement.find(`textarea[${REFERENCE_ATTRIBUTES.PROMPT_INPUT}]`).getKendoTextArea();\n            if (textareaWidget) {\n                textareaWidget.value(value);\n            } else {\n                that.contentElement.find(`textarea[${REFERENCE_ATTRIBUTES.PROMPT_INPUT}]`).val(value);\n            }\n        },\n\n        _focusSuggestion(element) {\n            let that = this;\n            if (!element || !element.length) {\n                return;\n            }\n\n            that.contentElement.find(`.${CSS_CLASSES.SUGGESTION_GROUP} .${CSS_CLASSES.SUGGESTION}[tabindex=0]`).attr(\"tabindex\", \"-1\");\n\n            element.attr(\"tabindex\", \"0\").trigger(\"focus\");\n        },\n\n        startSpeechRecognition: function() {\n            let that = this;\n            that.speechManager.startRecognition();\n        },\n\n        stopSpeechRecognition: function() {\n            let that = this;\n            that.speechManager.stopRecognition();\n        },\n\n        abortSpeechRecognition: function() {\n            let that = this;\n            that.speechManager.abortRecognition();\n        },\n\n        isSpeechListening: function() {\n            let that = this;\n            return that.speechManager.isListening();\n        },\n\n        initializeComponents: function() {\n            let that = this;\n            let suggestions = that.promptSuggestions;\n            const generateButton = that.footerElement.find(`button[${REFERENCE_ATTRIBUTES.GENERATE_OUTPUT_BUTTON}]`);\n\n            // Initialize regular TextArea with speech manager configuration\n            let textAreaOptions = $.extend({\n                resize: \"vertical\",\n                placeholder: that.options.messages.promptPlaceholder\n            }, that.options.promptTextArea || {});\n\n            // Add speech-to-text button suffix if enabled\n            if (that.speechManager.isEnabled()) {\n                textAreaOptions = $.extend(true, textAreaOptions, that.speechManager.getTextAreaSuffixOptions());\n            }\n\n            // Initialize the textarea as a regular Kendo TextArea\n            const textareaWidget = that.contentElement.find(`textarea[${REFERENCE_ATTRIBUTES.PROMPT_INPUT}]`).kendoTextArea(textAreaOptions).getKendoTextArea();\n\n            // Initialize speech-to-text button if enabled\n            if (that.speechManager.isEnabled()) {\n                that.speechManager.initialize(textareaWidget);\n            }\n\n            generateButton.kendoButton({\n                icon: \"sparkles\",\n                themeColor: \"primary\",\n                rounded: \"full\",\n                click: function(e) {\n                    const textareaWidget = that.contentElement.find(`textarea[${REFERENCE_ATTRIBUTES.PROMPT_INPUT}]`).getKendoTextArea();\n                    const prompt = textareaWidget ? textareaWidget.value() : that.contentElement.find(`textarea[${REFERENCE_ATTRIBUTES.PROMPT_INPUT}]`).val();\n                    const eventArgs = { prompt, isRetry: false, history: [] };\n\n                    if (that.service) {\n                        eventArgs.service = that.service;\n                    }\n\n                    if (that.aiprompt.trigger(\"promptRequest\", eventArgs)) {\n                        return;\n                    }\n\n                    if (that.service) {\n                        that.aiprompt.transport.read({ prompt: eventArgs.prompt, history: eventArgs.history, isRetry: false, service: that.service });\n                    }\n                }\n            });\n\n            if (suggestions?.length) {\n                that.contentElement.find(`.${CSS_CLASSES.SUGGESTION_GROUP} .${CSS_CLASSES.SUGGESTION}`).first().attr(\"tabindex\", \"0\");\n                let nextExpanderContentId = kendo.guid();\n                let expanderButton = that.contentElement.find(`.${CSS_CLASSES.PROMPT_EXPANDER} button[${REFERENCE_ATTRIBUTES.PROMPT_SUGGESTIONS_BUTTON}]`);\n\n                that.contentElement.find(`.${CSS_CLASSES.PROMPT_EXPANDER} button[${REFERENCE_ATTRIBUTES.PROMPT_SUGGESTIONS_BUTTON}]`).attr(\"aria-controls\", nextExpanderContentId);\n                expanderButton.next(`.${CSS_CLASSES.PROMPT_EXPANDER_CONTENT}`).attr(\"id\", nextExpanderContentId);\n\n                that.contentElement.find(`.${CSS_CLASSES.PROMPT_EXPANDER} button[${REFERENCE_ATTRIBUTES.PROMPT_SUGGESTIONS_BUTTON}]`).kendoButton({\n                    icon: \"chevron-up\",\n                    fillMode: \"flat\",\n                    click: function(e) {\n                        let expander = $(e.target).closest(\".k-prompt-expander\");\n                        let content = expander.find(\".k-prompt-expander-content\");\n                        let iconEl = e.sender.element.find(\".k-icon\");\n                        kendo.ui.icon(iconEl, content.is(\":visible\") ? \"chevron-down\" : \"chevron-up\");\n                        content.toggle();\n                        e.sender.element.attr(\"aria-expanded\", content.is(\":visible\"));\n                    }\n                });\n\n                that.contentElement.on(\"click\", \".k-suggestion-group .k-suggestion\", function(e) {\n                    that.setTextAreaValue($(e.target).text());\n                });\n\n                that.contentElement.on(\"keydown\", \".k-suggestion-group .k-suggestion\", function(e) {\n                    if (e.keyCode === 40 || e.keyCode === 38 || e.keyCode === 36 || e.keyCode === 35 || e.keyCode === 13 || e.keyCode === 32) {\n                        e.preventDefault();\n                        let target = $(e.target);\n                        let siblings = target.siblings();\n                        let next, prev;\n\n                        // down arrow\n                        if (e.keyCode === 40) {\n                            next = target.next();\n                            that._focusSuggestion(next);\n                        }\n\n                        // up arrow\n                        if (e.keyCode === 38) {\n                            prev = target.prev();\n                            that._focusSuggestion(prev);\n                        }\n\n                        // home\n                        if (e.keyCode === 36) {\n                            prev = siblings.first();\n                            that._focusSuggestion(prev);\n                        }\n\n                        // end\n                        if (e.keyCode === 35) {\n                            next = siblings.last();\n                            that._focusSuggestion(next);\n                        }\n\n                        // enter or space\n                        if (e.keyCode === 13 || e.keyCode === 32) {\n                            that.setTextAreaValue($(e.target).text());\n                        }\n                    }\n                });\n\n            }\n\n            if (kendo.isFunction(that.options.initializeComponents)) {\n                that.options.initializeComponents({ view: that });\n            }\n        },\n\n        render: function() {\n            let that = this;\n\n            that._renderContent();\n            that._renderFooter();\n            that.initializeComponents();\n        },\n\n        destroy: function() {\n            let that = this;\n\n            if (that.speechManager) {\n                that.speechManager.destroy();\n                that.speechManager = null;\n            }\n\n            AIPromptBaseView.fn.destroy.call(that);\n        }\n    });\n\n    kendo.ui.AIPromptOutputView = AIPromptBaseView.extend({\n        init: function(element, options) {\n            let that = this;\n\n            AIPromptBaseView.fn.init.call(that, element, options);\n\n            that.promptOutputs = (that.aiprompt && that.aiprompt.promptOutputs) ? that.aiprompt.promptOutputs : [];\n\n            that.showOutputRating = that.options.showOutputRating;\n            that.isStreaming = that.options.isStreaming || false;\n            that.outputActions = that.options.outputActions;\n            that.outputTemplate = that.options.outputTemplate;\n\n            that.outputActionManager = that.options.outputActionManager;\n        },\n\n        options: {\n            name: \"AIPromptOutputView\",\n            buttonIcon: \"comment\",\n            isStreaming: false,\n            promptOutputs: []\n        },\n\n        startStreaming: function() {\n            let that = this;\n            // Set view-level streaming state\n            that.isStreaming = true;\n\n            // Show stop generation button\n            that._showStopButton();\n        },\n\n        stopStreaming: function() {\n            let that = this;\n            // Set view-level streaming state\n            that.isStreaming = false;\n\n            // Hide stop generation button\n            that._hideStopButton();\n        },\n\n        _showStopButton: function() {\n            let that = this;\n\n            if (!that.stopGenerationButton) {\n                if (that._initStopGenerationButton()) {\n                    that.stopGenerationButton.show();\n                }\n            } else {\n                that.stopGenerationButton.show();\n            }\n        },\n\n        _hideStopButton: function() {\n            let that = this;\n\n            if (that.stopGenerationButton) {\n                that.stopGenerationButton.hide();\n            }\n        },\n\n        renderPromptOutput: function(output) {\n            let that = this;\n            let showOutputRating = that.options.showOutputRating;\n            let encodedPromptOutputs = that.options.encodedPromptOutputs;\n            let messages = that.options.messages;\n            let isStreaming = that.isStreaming || false; // Use view-level streaming state\n            let outputActions = that.outputActions;\n\n            // Ensure cardListContainer exists\n            if (!that.cardListContainer || that.cardListContainer.length === 0) {\n                if (that.outputsContainer) {\n                    that.cardListContainer = that.outputsContainer.find('.k-card-list');\n                }\n                if (!that.cardListContainer || that.cardListContainer.length === 0) {\n                    return;\n                }\n            }\n\n            // Initialize floating action button if output is streaming and button doesn't exist\n            if (isStreaming && !that.stopGenerationButton) {\n                that._initStopGenerationButton();\n            }\n\n            // Check if we have an enhanced output object from the main widget\n            const outputObj = that.aiprompt.outputObjects.get(output.id);\n\n            if (outputObj) {\n                // Create the card HTML directly using the template builder\n                const cardHtml = kendo.ui.AIPromptTemplateBuilder.createOutputCard({\n                    output,\n                    showOutputRating,\n                    messages,\n                    showOutputSubtitleTooltip: true,\n                    encodedPromptOutputs,\n                    isStreaming,\n                    outputActions,\n                    outputTemplate: that.outputTemplate\n                });\n\n                // Create jQuery element and store references in output object\n                const card = $(cardHtml);\n                outputObj._element = card;\n                outputObj._bodyElement = card.find(`.k-card-body`);\n\n                // Append to the card list container\n                that.cardListContainer.prepend(card);\n\n                // Handle initial state based on loading status\n                if (output.isLoading) {\n                    outputObj.showSkeleton();\n                } else if (output.output) {\n                    outputObj.applyFinalTemplate();\n                }\n\n                that.initializeComponents(card);\n            } else {\n                // Fallback to original rendering method\n                let card = $(kendo.ui.AIPromptTemplateBuilder.createOutputCard({\n                    output,\n                    showOutputRating,\n                    messages,\n                    showOutputSubtitleTooltip: true,\n                    encodedPromptOutputs,\n                    isStreaming,\n                    outputActions,\n                    outputTemplate: that.outputTemplate\n                }));\n                that.cardListContainer.prepend(card);\n                that.initializeComponents(card);\n            }\n        },\n\n        updatePromptOutputContent: function(outputId, content) {\n            let that = this;\n\n            // Use the main widget's output object for streamlined management\n            const outputObj = that.aiprompt.outputObjects.get(outputId);\n\n            if (outputObj) {\n                outputObj.updateContent(content);\n            }\n        },\n\n        _initStopGenerationButton: function() {\n            let that = this;\n            let contentElement = that.contentElement;\n\n            // Ensure contentElement exists and is in DOM\n            if (!contentElement || contentElement.length === 0) {\n                return false;\n            }\n\n            // Check if button already exists\n            if (that.stopGenerationButton) {\n                return true;\n            }\n\n            let stopFab = $(\"<button class='k-prompt-stop-fab k-generating'></button>\");\n            stopFab.attr({\n                \"aria-label\": that.options.messages.stopGeneration,\n                \"title\": that.options.messages.stopGeneration\n            });\n\n            contentElement.prepend(stopFab);\n\n            that.stopGenerationButton = stopFab.kendoFloatingActionButton({\n                _classNames: [\"k-prompt-stop-fab\", \"k-generating\"],\n                icon: \"stop-sm\",\n                positionMode: \"absolute\",\n                align: \"bottom end\",\n                rounded: \"full\",\n                click: function(e) {\n                    // Stop streaming and trigger cancel event\n                    that.stopStreaming();\n                    that.aiprompt.trigger(\"promptRequestCancel\", {});\n                }\n            }).getKendoFloatingActionButton();\n\n            that.stopGenerationButton.hide();\n            return true;\n        },\n        _renderContent: function() {\n            let that = this;\n            let promptOutputs = that.promptOutputs;\n            let showOutputRating = that.options.showOutputRating;\n            let showOutputSubtitleTooltip = that.options.showOutputSubtitleTooltip;\n            let messages = that.options.messages;\n            let encodedPromptOutputs = that.options.encodedPromptOutputs;\n            let outputActions = that.outputActions;\n\n            let outputsContainer;\n            if (that.viewTemplate) {\n                outputsContainer = kendo.template(that.viewTemplate)({\n                    promptOutputs, showOutputRating, messages, showOutputSubtitleTooltip,\n                    encodedPromptOutputs, outputActions, outputTemplate: that.outputTemplate\n                });\n            } else {\n                outputsContainer = kendo.ui.AIPromptTemplateBuilder.createOutputView({\n                    promptOutputs, showOutputRating, messages, showOutputSubtitleTooltip,\n                    encodedPromptOutputs, outputActions, outputTemplate: that.outputTemplate\n                });\n            }\n\n            that.outputsContainer = $(outputsContainer);\n            that.cardListContainer = that.outputsContainer.find('.k-card-list');\n            that._renderContentElement();\n            that.contentElement.append(that.outputsContainer);\n\n            that._initStopGenerationButton();\n        },\n\n        initializeComponents: function(parentElement) {\n            let that = this;\n            parentElement = parentElement || that.contentElement;\n\n            // Use the output action manager to handle all button initialization\n            that.outputActionManager.initializeButtons(parentElement, that.outputActions);\n\n            // Handle CSP-compliant styling for loading content\n            parentElement.find('[data-loading=\"true\"]').hide();\n            parentElement.find('[data-loading=\"false\"]').show();\n\n            // Update DOM references for existing output objects after template rendering\n            // and ensure buttons are initialized for all cards\n            if (that.aiprompt && that.aiprompt.outputObjects) {\n                that.aiprompt.outputObjects.forEach((outputObj, outputId) => {\n                    // Find the corresponding DOM element for this output\n                    const cardElement = parentElement.find(`.k-card[data-id=\"${outputId}\"]`);\n                    if (cardElement.length > 0) {\n                        // Update the output object's DOM references\n                        outputObj._element = cardElement;\n                        outputObj._bodyElement = cardElement.find('.k-card-body');\n\n                        // Apply custom output template for existing outputs when switching views\n                        if (that.outputTemplate && typeof that.outputTemplate === 'function' &&\n                            outputObj.data && outputObj.data.output && !outputObj.data.isLoading) {\n                            const customContent = that.outputTemplate({\n                                output: outputObj.data,\n                                content: outputObj.data.output\n                            });\n                            outputObj._bodyElement.html(customContent);\n                        }\n\n                        // Initialize buttons for this specific card if not already initialized\n                        // Check if buttons are already initialized by looking for kendoButton data\n                        const buttons = cardElement.find('.k-button');\n                        const hasInitializedButtons = buttons.length > 0 && buttons.first().data('kendoButton');\n                        if (!hasInitializedButtons && buttons.length > 0) {\n                            // Initialize buttons for this specific card only\n                            that.outputActionManager.initializeButtons(cardElement, that.outputActions);\n                        }\n                    }\n                });\n            }\n        },\n\n        _initializeCardButtons: function(cardElement) {\n            let that = this;\n            // Delegate all button initialization to the output action manager\n            that.outputActionManager.initializeButtons(cardElement, that.outputActions);\n        },\n\n        render: function() {\n            let that = this;\n            that._renderContent();\n            that.initializeComponents();\n\n            that.contentElement.on(\"keydown\", \".k-card\", function(e) {\n                let target = $(e.target);\n\n                // if up or down arrow, focus next or previous card\n                // if home or end, focus first or last card\n                if (e.keyCode === 40 || e.keyCode === 38 || e.keyCode === 36 || e.keyCode === 35) {\n                    e.preventDefault();\n\n                    // down arrow\n                    if (e.keyCode === 40) {\n                        target.next(\".k-card\").trigger(\"focus\");\n                    }\n\n                    // up arrow\n                    if (e.keyCode === 38) {\n                        target.prev(\".k-card\").trigger(\"focus\");\n                    }\n\n                    // home\n                    if (e.keyCode === 36) {\n                        that.contentElement.find(\".k-card\").first().trigger(\"focus\");\n                    }\n\n                    // end\n                    if (e.keyCode === 35) {\n                        that.contentElement.find(\".k-card\").last().trigger(\"focus\");\n                    }\n                }\n            });\n        },\n\n        destroy: function() {\n            let that = this;\n\n\n            // Call parent destroy\n            AIPromptBaseView.fn.destroy.call(that);\n        }\n    });\n\n    kendo.ui.AIPromptCommandsView = AIPromptBaseView.extend({\n        options: {\n            name: \"AIPromptCommandsView\",\n            buttonText: \"\",\n            buttonIcon: \"more-horizontal\",\n            promptCommands: []\n        },\n\n        initializeComponents: function() {\n            let that = this;\n            let commandItems = that.options.promptCommands;\n\n            let panelBarEl = $(\"<div></div>\").kendoPanelBar({\n                animation: false,\n                dataSource: commandItems,\n                selectable: false,\n                select: function(ev) {\n                    let item = $(ev.item);\n                    let dataItem = this.dataItem(item);\n                    if (dataItem.hasChildren) {\n                        return;\n                    }\n\n                    that.aiprompt.trigger(\"commandExecute\", { sender: that.aiprompt, item: dataItem });\n                }\n            });\n            const promptViewWrapper = $(\"<div class='k-prompt-view'>\");\n            promptViewWrapper.append(panelBarEl);\n\n            that.contentElement.append(promptViewWrapper);\n        },\n\n        render: function() {\n            let that = this;\n            that._renderContentElement();\n            that.initializeComponents();\n        },\n    });\n\n    let EMPTY_TEMPLATE = () => \"\";\n    kendo.ui.AIPromptCustomView = AIPromptBaseView.extend({\n        options: {\n            name: \"AIPromptCustomView\",\n            buttonText: \"\",\n            buttonIcon: \"\",\n            viewTemplate: EMPTY_TEMPLATE,\n            footerTemplate: EMPTY_TEMPLATE,\n        },\n\n        initializeComponents: function() {\n            let that = this;\n            if (typeof that.options.initializeComponents === \"function\") {\n                that.options.initializeComponents.call(that);\n            }\n        },\n\n        _renderContent: function() {\n            let that = this;\n            let content = kendo.template(that.options.viewTemplate)({ aiprompt: that });\n\n            that._renderContentElement();\n            that.contentElement.append(content);\n        },\n\n        _renderFooter: function() {\n            let that = this;\n            if (that.options.footerTemplate === EMPTY_TEMPLATE) {\n                return;\n            }\n\n            let footer = kendo.template(that.options.footerTemplate)({ messages: that.options.messages });\n\n            that._renderFooterElement();\n            that.footerElement.append(footer);\n        },\n        render: function() {\n            let that = this;\n            that._renderContent();\n            that._renderFooter();\n            that.initializeComponents();\n        },\n    });\n\n})(window.kendo.jQuery);\nexport default kendo;\n\n","import \"./kendo.core.js\";\nimport \"./kendo.data.js\";\nimport \"./kendo.icons.js\";\nimport \"./kendo.textarea.js\";\nimport \"./kendo.button.js\";\nimport \"./kendo.toolbar.js\";\nimport \"./kendo.skeletoncontainer.js\";\nimport \"./kendo.speechtotextbutton.js\";\nimport \"./aiprompt/output-action-manager.js\";\nimport \"./aiprompt/template-builder.js\";\nimport \"./aiprompt/speech-manager.js\";\nimport \"./aiprompt/output-manager.js\";\nimport \"./aiprompt/views.js\";\n\nexport const __meta__ = {\n    id: \"aiprompt\",\n    name: \"AIPrompt\",\n    category: \"web\",\n    description: \"The AIPrompt component simplifies the incorporation of external AI services into apps.\",\n    depends: [\"core\", \"icons\", \"textarea\", \"button\", \"toolbar\", \"panelbar\", \"data\", \"floatingactionbutton\", \"skeletoncontainer\", \"speechtotextbutton\"],\n};\n\n(function($) {\n    let kendo = window.kendo,\n        Widget = kendo.ui.Widget,\n        NS = \".kendoAIPrompt\",\n        ui = kendo.ui,\n        extend = $.extend,\n\n        COMMAND_EXECUTE = \"commandExecute\",\n        PROMPT_REQUEST = \"promptRequest\",\n        PROMPT_RESPONSE = \"promptResponse\",\n        OUTPUT_RATING = \"outputRating\",\n        OUTPUT_COPY = \"outputCopy\",\n        OUTPUT_VIEW = \"output\",\n        OUTPUT_ACTION = \"outputAction\",\n        PROMPT_REQUEST_CANCEL = \"promptRequestCancel\",\n\n        DEFAULT_OUTPUT_ACTIONS = [\"copy\", \"retry\", \"spacer\", \"rating\"],\n        DEFAULT_OUTPUT_ACTIONS_WITHOUT_RATING = [\"copy\", \"retry\"],\n\n        FOCUS = \"focus\",\n        KDISABLED = \"k-disabled\";\n\n    let cssClasses = {\n        menuButton: \"k-menu-button\",\n        aIPrompt: \"k-prompt\"\n    };\n\n    let defaultViews = {\n        prompt: {\n            type: \"kendo.ui.AIPromptPromptView\",\n            name: \"prompt\",\n            buttonIcon: \"sparkles\",\n        },\n        output: {\n            type: \"kendo.ui.AIPromptOutputView\",\n            name: \"output\",\n            buttonIcon: \"comment\",\n        },\n        commands: {\n            type: \"kendo.ui.AIPromptCommandsView\",\n            name: \"commands\",\n            buttonIcon: \"more-horizontal\",\n        },\n        custom: {\n            type: \"kendo.ui.AIPromptCustomView\",\n            name: \"custom\",\n        }\n    };\n\n    let AIPrompt = Widget.extend({\n        init: function(element, options) {\n            let that = this;\n            options = options || {};\n\n            Widget.fn.init.call(that, element, options);\n\n            if (that.options.views.length == 0) {\n                that.options.views = [\"prompt\", \"output\"];\n\n                if (this.options.promptCommands && this.options.promptCommands.length) {\n                    this.options.views.push(\"commands\");\n                }\n            }\n\n            that.options.outputActions = (options.outputActions && options.outputActions.length > 0) ? options.outputActions : DEFAULT_OUTPUT_ACTIONS_WITHOUT_RATING;\n\n            that.promptOutputs = that.options.promptOutputs || [];\n            that.outputObjects = new Map();\n\n            that.outputManager = new kendo.ui.AIPromptOutputManager(that);\n\n            // Initialize output action manager at component level\n            that.outputActions = kendo.ui.AIPromptOutputActionManager.processOutputActions(that.options.outputActions);\n            that.outputActionManager = new kendo.ui.AIPromptOutputActionManager(that, {\n                outputActions: that.outputActions\n            });\n\n            // Populate outputObjects if promptOutputs is not empty\n            if (Array.isArray(that.promptOutputs) && that.promptOutputs.length > 0) {\n                that.promptOutputs.forEach(output => {\n                    if (!output.id) {\n                        output.id = kendo.guid();\n                    }\n                    const outputObj = that.outputManager.createOutputObject(output);\n                    that.outputObjects.set(output.id, outputObj);\n                });\n            }\n\n            that._initLayout();\n            that._initViews();\n            that._initToolbar();\n            that.activeView(that.options.activeView);\n\n            if (that.options.service) {\n                that.transport = new kendo.data.AiTransport({\n                    service: that.options.service,\n                    success: that._serviceSuccess.bind(that),\n                    requestStart: () => kendo.ui.progress(that.element, true)\n                });\n            }\n\n            kendo.notify(that);\n        },\n\n        options: {\n            name: \"AIPrompt\",\n            enabled: true,\n            toolbarItems: [],\n            promptOutputs: [],\n            encodedPromptOutputs: true,\n            activeView: 0,\n            views: [],\n            popup: null,\n            speechToText: false,\n            promptTextArea: null,\n            messages: {\n                promptView: \"Ask AI\",\n                outputView: \"Output\",\n                commandsView: \"\",\n                customView: \"Custom View\",\n                promptPlaceholder: \"Ask or generate content with AI\",\n                promptSuggestions: \"Prompt Suggestions\",\n                generateOutput: \"Generate\",\n                outputTitle: \"Generated with AI\",\n                outputRetryTitle: \"Generated with AI\",\n                copyOutput: \"Copy\",\n                retryGeneration: \"Retry\",\n                ratePositive: \"\",\n                rateNegative: \"\",\n                stopGeneration: \"Stop Generation\"\n            },\n            showOutputRating: true,\n            service: null,\n            suffixTemplate: null,\n            outputTemplate: null,\n            outputActions: DEFAULT_OUTPUT_ACTIONS\n        },\n\n        events: [\n            COMMAND_EXECUTE,\n            PROMPT_REQUEST,\n            PROMPT_RESPONSE,\n            PROMPT_REQUEST_CANCEL,\n            OUTPUT_RATING,\n            OUTPUT_COPY,\n            OUTPUT_ACTION\n        ],\n\n        _serviceSuccess: function(output) {\n            const that = this;\n            const outputViewIndex = that.viewsArray.findIndex(v => v.name === OUTPUT_VIEW);\n\n            output.activeView = outputViewIndex;\n            if (!that.trigger(PROMPT_RESPONSE, {\n                output: output.output,\n                prompt: output.prompt,\n                outputId: output.id,\n                isRetry: output.isRetry || false,\n                response: output.response,\n            })) {\n                that.addPromptOutput(output);\n                that.activeView(output.activeView);\n                kendo.ui.progress(that.element, false);\n            }\n\n        },\n\n        _initializeView: function(name) {\n            let viewConfig = this.views[name];\n            let view;\n            if (viewConfig) {\n                let type = viewConfig.type;\n\n                if (typeof type === \"string\") {\n                    type = kendo.getter(viewConfig.type)(window);\n                }\n\n                if (type) {\n                    view = new type(this.element, extend(true, {\n                        promptSuggestions: this.options.promptSuggestions,\n                        promptCommands: this.options.promptCommands,\n                        promptOutputs: this.promptOutputs,\n                        showOutputRating: this.showOutputRating,\n                        messages: this.options.messages,\n                        showOutputSubtitleTooltip: this.options.showOutputSubtitleTooltip,\n                        encodedPromptOutputs: this.options.encodedPromptOutputs,\n                        promptSuggestionItemTemplate: this.options.promptSuggestionItemTemplate,\n                        service: this.options.service,\n                        speechToText: this.options.speechToText,\n                        promptTextArea: this.options.promptTextArea,\n                        outputActions: this.outputActions,\n                        outputActionManager: this.outputActionManager,\n                        outputTemplate: this.options.outputTemplate,\n                    },\n                        viewConfig\n                    ));\n                } else {\n                    throw new Error(\"There is no such view\");\n                }\n            }\n\n            return view;\n        },\n\n        _unbindView: function(view) {\n            if (view) {\n                view.destroy();\n            }\n        },\n\n        _initViews: function() {\n            let that = this,\n                options = that.options,\n                views = options.views;\n\n            that.views = {};\n            that.viewsArray = [];\n\n            for (let i = 0, l = views.length; i < l; i++) {\n                let view = views[i];\n                let isSettings = typeof view === \"object\";\n                let name = view;\n\n                if (isSettings) {\n                    view = { ...view };\n                    name = typeof view.type !== \"string\" ? view.name : view.type;\n                }\n\n                let defaultView = defaultViews[name];\n\n                if (defaultView) {\n                    if (isSettings) {\n                        view.type = defaultView.type;\n                    }\n\n                    defaultView.buttonText = that.options.messages[`${name}View`];\n                }\n\n                view = Object.assign({ title: view.title, name, index: i }, defaultView, isSettings ? view : {});\n                that.viewsArray.push(view);\n\n                if (name) {\n                    that.views[name] = view;\n                }\n            }\n        },\n\n        getViews: function() {\n            return this.viewsArray;\n        },\n\n        activeView: function(name) {\n            let that = this;\n            if (name === undefined) {\n                return that._activeViewIndex;\n            }\n\n            if (Number.isInteger(name)) {\n                name = that.viewsArray[name].name;\n            }\n\n            if (name && that.views[name]) {\n                if (that._selectedView) {\n                    that._unbindView(that._selectedView);\n                }\n\n                that._selectedView = that._initializeView(name);\n                that._activeViewIndex = that.viewsArray.findIndex(v => v.name === name);\n                that._selectedView.render();\n\n                that._updateToolbarState(that._activeViewIndex);\n\n                let toolItem = $(that.toolbar._getAllItems()[that._activeViewIndex]);\n                that.toolbar._resetTabIndex(toolItem);\n                toolItem.trigger(FOCUS);\n            }\n        },\n\n        addPromptOutput: function(output) {\n            if (typeof output === 'string') {\n                output = { output: output };\n            }\n\n            output.id = output.id || kendo.guid();\n\n            const outputObj = this.outputManager.createOutputObject(output);\n            this.promptOutputs.unshift(output);\n            this.outputObjects.set(output.id, outputObj);\n\n            if (this._selectedView && typeof this._selectedView.renderPromptOutput === \"function\") {\n                this._selectedView.renderPromptOutput(output);\n\n                if (output.isLoading) {\n                    this.startStreaming();\n                }\n            }\n        },\n\n        removePromptOutput: function(output) {\n                const that = this;\n                let outputId = output;\n\n                const removeOutput = (id) => {\n                    const el = that.promptOutputs.find((el) => el.id === id);\n\n                    if (el) {\n                        that.promptOutputs = that.promptOutputs.filter((item) => item.id !== id);\n                    }\n\n                    that.outputObjects.delete(id);\n                };\n\n                if (outputId instanceof jQuery) {\n                    outputId = output.data(\"id\");\n                    output.remove();\n                    removeOutput(outputId);\n                } else {\n                    that.element.find(\"[data-id='\" + outputId + \"']\").remove();\n                    removeOutput(outputId);\n                }\n        },\n\n        clearOutput: function() {\n            const that = this;\n            const elements = that.element.find(\"[data-id]\");\n            elements.each(function() {\n                const id = $(this).data(\"id\");\n                that.outputObjects.delete(id);\n            });\n            elements.remove();\n            that.promptOutputs = [];\n        },\n\n        _updateToolbarState: function(activeToolIndex) {\n            let toolbar = this.toolbar;\n            toolbar.element.find(\".k-toolbar-toggle-button\").each(function(index, elm) {\n                toolbar.toggle($(elm), index == activeToolIndex);\n            });\n        },\n\n        _initLayout: function() {\n            let that = this,\n                header = $(\"<div></div>\").addClass(\"k-prompt-header\");\n            that.header = header;\n            that.element.addClass(cssClasses.aIPrompt);\n            that.element.append(header);\n            const popupWrapper = that.element.closest('.k-popup');\n\n            if (popupWrapper.length) {\n                $(popupWrapper).addClass('k-prompt-popup');\n            }\n        },\n\n        _getViewTools: function() {\n            let that = this;\n\n            return that.viewsArray.map(v => {\n                if (v.name === 'commands') {\n                    if (v.buttonText) {\n                        v.title = v.buttonText;\n                    } else {\n                        v.title = \"More Actions\";\n                    }\n                }\n\n                return {\n                type: \"button\",\n                text: v.buttonText,\n                icon: v.buttonIcon,\n                fillMode: \"flat\",\n                themeColor: v.themeColor || \"primary\",\n                rounded: \"full\",\n                togglable: true,\n                attributes: { title: v.title },\n                toggle: function() {\n                    that.activeView(v.name);\n                }\n            };\n        });\n        },\n\n        _initToolbar: function() {\n            let that = this;\n            let items = that.options.toolbarItems;\n            items = Array.isArray(items) ? items : [items];\n            const closeButton = items.find(item => item.icon === 'x');\n\n            if (closeButton) {\n                closeButton.themeColor = 'base';\n            }\n\n            let toolbarEl = $(\"<div></div>\").kendoToolBar({\n                resizable: false,\n                fillMode: \"flat\",\n                items: that._getViewTools().concat(items)\n            }).appendTo(that.header);\n\n            that.toolbar = toolbarEl.data(\"kendoToolBar\");\n        },\n\n        focus: function() {\n            let that = this;\n            that.element.trigger(FOCUS);\n        },\n\n        updatePromptOutputContent: function(content, outputId) {\n            let that = this;\n\n            return that.outputManager.updatePromptOutputContent(content, outputId);\n        },\n\n        startStreaming: function() {\n            let that = this;\n\n            if (that._selectedView && typeof that._selectedView.startStreaming === \"function\") {\n                that._selectedView.startStreaming();\n            }\n        },\n\n        stopStreaming: function() {\n            let that = this;\n\n            if (that._selectedView && typeof that._selectedView.stopStreaming === \"function\") {\n                that._selectedView.stopStreaming();\n            }\n\n            if (that.outputManager) {\n                that.outputManager.stopAllLoading();\n            }\n        },\n\n        setOptions: function(options) {\n            let that = this;\n            let el = that.element;\n            let originalOptions = that.options;\n            let newOptions = extend({}, originalOptions, options);\n\n            kendo.destroy(el);\n\n            $(el).empty();\n\n            that.init(el, newOptions);\n        },\n\n        destroy: function() {\n            let that = this;\n\n            if (that.toolbar) {\n                that.toolbar.destroy();\n                that.toolbar = null;\n            }\n\n            if (that._selectedView) {\n                that._selectedView.destroy();\n                that._selectedView = null;\n            }\n\n            if (that.outputManager) {\n                that.outputManager.destroy();\n                that.outputManager = null;\n            }\n\n            if (that.outputActionManager) {\n                that.outputActionManager.destroy();\n                that.outputActionManager = null;\n            }\n\n            that.promptOutputs = null;\n            if (that.outputObjects) {\n                that.outputObjects.clear();\n                that.outputObjects = null;\n            }\n\n            if (that.transport) {\n                that.transport = null;\n            }\n\n            that.element.off(NS);\n\n            Widget.fn.destroy.call(that);\n        }\n    });\n\n    ui.plugin(AIPrompt);\n\n})(window.kendo.jQuery);\nexport default kendo;\n\n"],"mappings":"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"}