{"version":3,"file":"kendo.data.signalr.min.js","names":[],"sources":["../../src/kendo.data.signalr.js"],"sourcesContent":["import \"./kendo.data.js\";\n\nexport const __meta__ = {\n    id: \"data.signalr\",\n    name: \"SignalR\",\n    category: \"framework\",\n    depends: [ \"data\" ],\n    hidden: true\n};\n\n(function($) {\n    var kendo = window.kendo;\n    var isFunction = kendo.isFunction;\n\n    function isJQueryPromise(promise) {\n        return promise && isFunction(promise.done) && isFunction(promise.fail);\n    }\n\n    function isNativePromise(promise) {\n        return promise && isFunction(promise.then) && isFunction(promise.catch);\n    }\n\n    var transport = kendo.data.RemoteTransport.extend({\n        init: function(options) {\n            var signalr = options && options.signalr ? options.signalr : {};\n\n            var promise = signalr.promise;\n\n            if (!promise) {\n                throw new Error('The \"promise\" option must be set.');\n            }\n\n            if (!isJQueryPromise(promise) && !isNativePromise(promise)) {\n                throw new Error('The \"promise\" option must be a Promise.');\n            }\n\n            this.promise = promise;\n\n            var hub = signalr.hub;\n\n            if (!hub) {\n                throw new Error('The \"hub\" option must be set.');\n            }\n\n            if (typeof hub.on != \"function\" || typeof hub.invoke != \"function\") {\n                throw new Error('The \"hub\" option is not a valid SignalR hub proxy.');\n            }\n\n            this.hub = hub;\n\n            kendo.data.RemoteTransport.fn.init.call(this, options);\n        },\n\n        push: function(callbacks) {\n            var client = this.options.signalr.client || {};\n\n            if (client.create) {\n                this.hub.on(client.create, callbacks.pushCreate);\n            }\n\n            if (client.update) {\n                this.hub.on(client.update, callbacks.pushUpdate);\n            }\n\n            if (client.destroy) {\n                this.hub.on(client.destroy, callbacks.pushDestroy);\n            }\n        },\n\n        _crud: function(options, type) {\n            var hub = this.hub;\n            var promise = this.promise;\n            var server = this.options.signalr.server;\n\n            if (!server || !server[type]) {\n                throw new Error(kendo.format('The \"server.{0}\" option must be set.', type));\n            }\n\n            var args = [server[type]];\n\n            var data = this.parameterMap(options.data, type);\n\n            if (!$.isEmptyObject(data)) {\n                args.push(data);\n            }\n\n            if (isJQueryPromise(promise)) {\n                promise.done(function() {\n                    hub.invoke.apply(hub, args)\n                              .done(options.success)\n                              .fail(options.error);\n                });\n            } else if (isNativePromise(promise)) {\n                promise.then(function() {\n                    hub.invoke.apply(hub, args)\n                              .then(options.success)\n                              .catch(options.error);\n                });\n            }\n        },\n\n        read: function(options) {\n            this._crud(options, \"read\");\n        },\n\n        create: function(options) {\n            this._crud(options, \"create\");\n        },\n\n        update: function(options) {\n            this._crud(options, \"update\");\n        },\n\n        destroy: function(options) {\n            this._crud(options, \"destroy\");\n        }\n    });\n\n    $.extend(true, kendo.data, {\n        transports: {\n            signalr: transport\n        }\n    });\n\n})(window.kendo.jQuery);\nexport default kendo;\n\n"],"mappings":";icAEA,IAAa,EAAW,CACpB,GAAI,eACJ,KAAM,UACN,SAAU,YACV,QAAS,CAAE,OAAQ,CACnB,OAAQ,GACX,EAEA,SAAS,EAAG,CACT,IAAI,EAAQ,OAAO,MACf,EAAa,EAAM,WAEvB,SAAS,EAAgB,EAAS,CAC9B,OAAO,GAAW,EAAW,EAAQ,KAAK,EAAI,EAAW,EAAQ,KAAK,CAG1E,SAAS,EAAgB,EAAS,CAC9B,OAAO,GAAW,EAAW,EAAQ,KAAK,EAAI,EAAW,EAAQ,MAAM,CAG3E,IAAI,EAAY,EAAM,KAAK,gBAAgB,OAAO,CAC9C,KAAM,SAAS,EAAS,CACpB,IAAI,EAAU,GAAW,EAAQ,QAAU,EAAQ,QAAU,EAAE,CAE3D,EAAU,EAAQ,QAEtB,GAAI,CAAC,EACD,MAAU,MAAM,oCAAoC,CAGxD,GAAI,CAAC,EAAgB,EAAQ,EAAI,CAAC,EAAgB,EAAQ,CACtD,MAAU,MAAM,0CAA0C,CAG9D,KAAK,QAAU,EAEf,IAAI,EAAM,EAAQ,IAElB,GAAI,CAAC,EACD,MAAU,MAAM,gCAAgC,CAGpD,GAAI,OAAO,EAAI,IAAM,YAAc,OAAO,EAAI,QAAU,WACpD,MAAU,MAAM,qDAAqD,CAGzE,KAAK,IAAM,EAEX,EAAM,KAAK,gBAAgB,GAAG,KAAK,KAAK,KAAM,EAAQ,EAG1D,KAAM,SAAS,EAAW,CACtB,IAAI,EAAS,KAAK,QAAQ,QAAQ,QAAU,EAAE,CAE1C,EAAO,QACP,KAAK,IAAI,GAAG,EAAO,OAAQ,EAAU,WAAW,CAGhD,EAAO,QACP,KAAK,IAAI,GAAG,EAAO,OAAQ,EAAU,WAAW,CAGhD,EAAO,SACP,KAAK,IAAI,GAAG,EAAO,QAAS,EAAU,YAAY,EAI1D,MAAO,SAAS,EAAS,EAAM,CAC3B,IAAI,EAAM,KAAK,IACX,EAAU,KAAK,QACf,EAAS,KAAK,QAAQ,QAAQ,OAElC,GAAI,CAAC,GAAU,CAAC,EAAO,GACnB,MAAU,MAAM,EAAM,OAAO,uCAAwC,EAAK,CAAC,CAG/E,IAAI,EAAO,CAAC,EAAO,GAAM,CAErB,EAAO,KAAK,aAAa,EAAQ,KAAM,EAAK,CAE3C,EAAE,cAAc,EAAK,EACtB,EAAK,KAAK,EAAK,CAGf,EAAgB,EAAQ,CACxB,EAAQ,KAAK,UAAW,CACpB,EAAI,OAAO,MAAM,EAAK,EAAK,CAChB,KAAK,EAAQ,QAAQ,CACrB,KAAK,EAAQ,MAAM,EAChC,CACK,EAAgB,EAAQ,EAC/B,EAAQ,KAAK,UAAW,CACpB,EAAI,OAAO,MAAM,EAAK,EAAK,CAChB,KAAK,EAAQ,QAAQ,CACrB,MAAM,EAAQ,MAAM,EACjC,EAIV,KAAM,SAAS,EAAS,CACpB,KAAK,MAAM,EAAS,OAAO,EAG/B,OAAQ,SAAS,EAAS,CACtB,KAAK,MAAM,EAAS,SAAS,EAGjC,OAAQ,SAAS,EAAS,CACtB,KAAK,MAAM,EAAS,SAAS,EAGjC,QAAS,SAAS,EAAS,CACvB,KAAK,MAAM,EAAS,UAAU,EAErC,CAAC,CAEF,EAAE,OAAO,GAAM,EAAM,KAAM,CACvB,WAAY,CACR,QAAS,EACZ,CACJ,CAAC,GAEH,OAAO,MAAM,OAAO,CACvB,IAAA,EAAe"}