/**
 * Kendo UI v2026.1.212 (http://www.telerik.com/kendo-ui)
 * Copyright 2026 Progress Software Corporation and/or one of its subsidiaries or affiliates. All rights reserved.
 *
 * Kendo UI commercial licenses may be obtained at
 * http://www.telerik.com/purchase/license-agreement/kendo-ui-complete
 * If you do not own a commercial license, this file shall be governed by the trial license terms.
 */
(function(e,t){typeof exports==`object`&&typeof module<`u`?t(exports,require(`kendo.core.min.js`),require(`kendo.licensing.min.js`),require(`kendo.data.min.js`),require(`kendo.icons.min.js`),require(`kendo.dropdownbutton.min.js`),require(`kendo.button.min.js`),require(`kendo.toolbar.min.js`),require(`kendo.avatar.min.js`),require(`kendo.html.button.min.js`),require(`kendo.promptbox.min.js`),require(`kendo.speechtotextbutton.min.js`),require(`kendo.textarea.min.js`),require(`kendo.textbox.min.js`),require(`kendo.upload.min.js`),require(`kendo.menu.min.js`)):typeof define==`function`&&define.amd?define([`exports`,`kendo.core.min`,`kendo.licensing.min`,`kendo.data.min`,`kendo.icons.min`,`kendo.dropdownbutton.min`,`kendo.button.min`,`kendo.toolbar.min`,`kendo.avatar.min`,`kendo.html.button.min`,`kendo.promptbox.min`,`kendo.speechtotextbutton.min`,`kendo.textarea.min`,`kendo.textbox.min`,`kendo.upload.min`,`kendo.menu.min`],t):(e=typeof globalThis<`u`?globalThis:e||self,t((e.kendo=e.kendo||{},e.kendo._globals=e.kendo._globals||{},e.kendo._globals.Chat={}),e.kendo._globals.Core,e.kendo._globals.Licensing,e.kendo._globals.Data,e.kendo._globals.Icons,e.kendo._globals.Dropdownbutton,e.kendo._globals.Button,e.kendo._globals.Toolbar,e.kendo._globals.Avatar,e.kendo._globals.HtmlButton,e.kendo._globals.Promptbox,e.kendo._globals.Speechtotextbutton,e.kendo._globals.Textarea,e.kendo._globals.Textbox,e.kendo._globals.Upload,e.kendo._globals.Menu))})(this,function(e,t,n,r,i,a,o,s,c,l,u,d,f,p,m,h){Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:`Module`}});var g=Object.create,_=Object.defineProperty,v=Object.getOwnPropertyDescriptor,y=Object.getOwnPropertyNames,b=Object.getPrototypeOf,x=Object.prototype.hasOwnProperty,S=(e,t,n,r)=>{if(t&&typeof t==`object`||typeof t==`function`)for(var i=y(t),a=0,o=i.length,s;a<o;a++)s=i[a],!x.call(e,s)&&s!==n&&_(e,s,{get:(e=>t[e]).bind(null,s),enumerable:!(r=v(t,s))||r.enumerable});return e};n=((e,t,n)=>(n=e==null?{}:g(b(e)),S(t||!e||!e.__esModule?_(n,`default`,{value:e,enumerable:!0}):n,e)))(n);let C=function(e){return e.Singleton=`singleton`,e.Scoped=`scoped`,e}({}),w=new class{constructor(){this.registrations=new Map}singleton(e,t){this.registrations.set(e,{ctor:e,factory:t??(()=>new e),lifetime:C.Singleton,instance:void 0})}singletonInstance(e,t){this.registrations.set(e,{ctor:e,factory:()=>t,lifetime:C.Singleton,instance:t})}scoped(e,t){this.registrations.set(e,{ctor:e,factory:t??(()=>new e),lifetime:C.Scoped,instance:void 0})}resolve(e){let t=this.registrations.get(e);if(!t)throw Error(`Service ${e.name} is not registered`);return t.lifetime===C.Singleton?(t.instance===void 0&&(t.instance=t.factory()),t.instance):t.factory()}tryResolve(e){if(this.has(e))return this.resolve(e)}has(e){return this.registrations.has(e)}getLifetime(e){return this.registrations.get(e)?.lifetime}};function T(e){return w.resolve(e)}var E=class{constructor(e,t,n,r,i,a){this.$=e,this.support=t,this.mouseEventNormalizer=n,this.eventMapService=r,this.utils=i,this.originalOn=e.fn.on,this.kendoJQuery=this.createKendoJQuery(a),this.rootjQuery=this.kendoJQuery(document)}createKendoJQuery(e){let t=this.$,n=this,r=function(e,t){return new r.fn.init(e,t)};return e(!0,r,t),r.fn=r.prototype=new t,r.fn.constructor=r,r.fn.init=function(e,i){return i&&i instanceof t&&!(i instanceof r)&&(i=r(i)),t.fn.init.call(this,e,i,n.rootjQuery)},r.fn.init.prototype=r.fn,t.extend(r.fn,{handler:function(e){return this.data(`handler`,e),this},autoApplyNS:function(e){return this.data(`kendoNS`,e||n.utils.guid()),this},on:function(...e){let t=this,r=t.data(`kendoNS`),i=n.originalOn;if(e.length===1)return i.call(t,e[0]);let a=t,o=e.slice();o[o.length-1]===void 0&&o.pop();let s=o[o.length-1],c=n.eventMapService.applyEventMap(o[0],r);if(n.support.mouseAndTouchPresent&&c.search(/mouse|click/)>-1&&this[0]!==document.documentElement){n.mouseEventNormalizer.setupMouseMute();let e=o.length===2?null:o[1],t=c.indexOf(`click`)>-1&&c.indexOf(`touchend`)>-1;i.call(this,{touchstart:e=>n.mouseEventNormalizer.muteMouse(e),touchend:()=>n.mouseEventNormalizer.unMuteMouse()},e,{bustClick:t})}if(o[0].indexOf(`keydown`)!==-1&&o[1]&&o[1].options){o[0]=c;let e=o[1],r=o[o.length-1];return o[o.length-1]=function(t){if(n.keyDownHandler(t,e))return r.apply(this,[t])},i.apply(t,o),t}if(typeof s==`string`){a=t.data(`handler`);let e=a[s];o[o.length-1]=function(t){e.call(a,t)}}return o[0]=c,i.apply(t,o),t},kendoDestroy:function(e){return e||=this.data(`kendoNS`),e&&this.off(`.`+e),this}}),r}getConstructor(){return this.kendoJQuery}create(e,t){return this.kendoJQuery(e,t)}keyDownHandler(e,t){let n=t._events.kendoKeydown;if(!n)return!0;let r=n.slice();e.sender=t,e.preventKendoKeydown=!1;for(let n=0,i=r.length;n<i;n++)r[n].call(t,e);return!e.preventKendoKeydown}},D=class{static extend(e){let t=this,n=function(){};n.prototype=t.prototype;let r=e&&e.init?e.init:function(...e){t.prototype.init&&t.prototype.init.apply(this,e)},i=r.fn=r.prototype=new n;if(e)for(let t in e)e[t]!=null&&e[t].constructor===Object?i[t]=T(E).getConstructor().extend(!0,{},n.prototype[t],e[t]):i[t]=e[t];return i.constructor=r,r.extend=t.extend,r}};D.fn=D.prototype,D.prototype.init=function(...e){},D.prototype._initOptions=function(e){this.options=T(E).getConstructor().extend(!0,{},this.options,e)};let O=`string`,k=`function`;function A(){this._defaultPrevented=!0}function j(){return this._defaultPrevented===!0}var M=class extends D{constructor(){super(),this._events={}}init(...e){this._events={}}bind(e,t,n){let r=this,i,a,o,s,c=typeof t===k,l;if(t===void 0){let t=e;for(i in t)r.bind(i,t[i]);return r}let u=typeof e===O?[e]:e;for(i=0,a=u.length;i<a;i++){let e=u[i];s=c?t:t[e],s&&(n&&(o=s,s=(function(e,t){let n=function(){r.unbind(e,n),t.apply(r,arguments)};return n.original=t,n})(e,o)),l=r._events[e]=r._events[e]||[],l.push(s))}return r}one(e,t){return this.bind(e,t,!0)}first(e,t){let n=this,r,i=typeof e===O?[e]:e,a=i.length,o,s=typeof t===k,c;for(r=0;r<a;r++){let e=i[r];o=s?t:t[e],o&&(c=n._events[e]=n._events[e]||[],c.unshift(o))}return n}trigger(e,t){let n=this,r=n._events[e],i,a=r?r.length:0;if(r){let e=t||{};for(e.sender=n,e._defaultPrevented=!1,e.preventDefault=A,e.isDefaultPrevented=j,r=r.slice(),i=0;i<a;i++)r[i].call(n,e);return e._defaultPrevented===!0}return!1}unbind(e,t){let n=this,r=e?n._events[e]:void 0,i;if(e===void 0)n._events={};else if(r)if(t)for(i=r.length-1;i>=0;i--)(r[i]===t||r[i].original===t)&&r.splice(i,1);else n._events[e]=[];return n}};let ee=M.prototype;[`init`,`bind`,`one`,`first`,`trigger`,`unbind`].forEach(e=>{let t=ee[e];Object.defineProperty(ee,e,{value:t,writable:!0,configurable:!0,enumerable:!0})}),M.fn=M.prototype;let N=/%/,te=/(\d+(?:\.?)\d*)px\s*(\d+(?:\.?)\d*)px\s*(\d+(?:\.?)\d*)px\s*(\d+)?/i;var P=class{constructor(e,t,n,r,i){this.supportService=e,this.$=t,this.namespaceService=n,this.utils=r,this.kendo=i,this.animationQueue=[];let a=window;this.animationFrameFn=a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame||(e=>{setTimeout(e,1e3/60)})}isElement(e){return e instanceof Element||e instanceof HTMLDocument}outerWidth(e,t,n){let r=this.$(e);return n?this.getHiddenDimensions(r,t).width:r.outerWidth(t||!1)||0}outerHeight(e,t,n){let r=this.$(e);return n?this.getHiddenDimensions(r,t).height:r.outerHeight(t||!1)||0}getComputedStyles(e,t){let n={},r;return document.defaultView&&document.defaultView.getComputedStyle?(r=document.defaultView.getComputedStyle(e,``),t&&this.$.each(t,(e,t)=>{n[t]=r.getPropertyValue(t)})):(r=e.currentStyle,t&&this.$.each(t,(e,t)=>{n[t]=r[this.utils.toCamelCase(t)]})),this.utils.size(n)?n:r}isScrollable(e){if(e.dataset[this.namespaceService.ns+`scrollable`]===`false`)return!1;if(typeof e?.className==`string`&&e.className.indexOf(`k-auto-scrollable`)>-1)return!0;let t=this.getComputedStyles(e,[`overflow`]).overflow||``;return t.indexOf(`auto`)>-1||t.indexOf(`scroll`)>-1}scrollLeft(e,t){let n=this.supportService.browser.webkit,r=this.supportService.browser.mozilla,i=this.supportService.browser.version;if(e instanceof this.$&&t!==void 0){e.each((e,n)=>{this.scrollLeft(n,t)});return}let a=e instanceof this.$?e[0]:e;if(!a)return;let o=this.supportService.isRtl(e);if(t!==void 0)o&&n&&(i<85||this.supportService.browser.safari)?a.scrollLeft=a.scrollWidth-a.clientWidth-t:o&&(r||n)&&t>0?a.scrollLeft=-t:a.scrollLeft=t;else if(o&&n&&(i<85||this.supportService.browser.safari))return a.scrollWidth-a.clientWidth-a.scrollLeft;else return Math.abs(a.scrollLeft)}getOffset(e,t=`offset`,n){let r=e[t](),i={top:r.top,right:r.right,bottom:r.bottom,left:r.left};if(this.supportService.browser.msie&&(this.supportService.pointers||this.supportService.msPointers)&&!n){let t=this.supportService.isRtl(e)?1:-1;i.top-=window.pageYOffset-document.documentElement.scrollTop,i.left-=window.pageXOffset+t*document.documentElement.scrollLeft}return i}getHiddenDimensions(e,t){let n=e.clone();n.css(`display`,``),n.css(`visibility`,`hidden`),n.appendTo(this.$(`body`));let r=n.outerWidth(t||!1),i=n.outerHeight(t||!1);return n.remove(),{width:r||0,height:i||0}}parseEffects(e){let t={},n=typeof e==`string`?e.split(` `):e;return this.$.each(n,function(e){t[e]=this}),t}stripWhitespace(e){if(document.createNodeIterator){let t=document.createNodeIterator(e,NodeFilter.SHOW_TEXT,t=>t.parentNode===e?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT);for(;t.nextNode();){let e=t.referenceNode;e&&!e.textContent?.trim()&&e.parentNode?.removeChild(e)}}}animationFrame(e){this.animationFrameFn.call(window,e)}queueAnimation(e){this.animationQueue.push(e),this.animationQueue.length===1&&this.runNextAnimation()}runNextAnimation(){this.animationFrame(()=>{this.animationQueue[0]&&(this.animationQueue.shift()(),this.animationQueue[0]&&this.runNextAnimation())})}parseQueryStringParams(e){let t=e.split(`?`)[1]||``,n={},r=t.split(/&|=/),i=r.length;for(let e=0;e<i;e+=2)r[e]!==``&&(n[decodeURIComponent(r[e])]=decodeURIComponent(r[e+1]));return n}elementUnderCursor(e){return e.x.client===void 0?null:document.elementFromPoint(e.x.client,e.y.client)}wheelDeltaY(e){let t=e.originalEvent,n=t.wheelDeltaY,r;return t.wheelDelta?(n===void 0||n)&&(r=t.wheelDelta):t.detail&&t.axis===t.VERTICAL_AXIS&&(r=-t.detail*10),r}getShadows(e){let t=e.css(`box-shadow`),n=t&&te.exec(t)||[0,0,0,0,0],r=Math.max(+n[3],+(n[4]||0));return{left:-n[1]+r,right:+n[1]+r,bottom:+n[2]+r}}wrap(e,t,n,r=!0,i){let a=e.parent(),o=this.outerWidth(window);if(a.parent().removeClass(`k-animation-container-sm`),a.hasClass(`k-child-animation-container`))this.wrapResize(e,t,r);else{let n=e[0].style.width,r=e[0].style.height,o=N.test(n),s=N.test(r),c=e.hasClass(`k-tooltip`)||e.is(`.k-menu-horizontal.k-context-menu`),l=e.hasClass(`k-tooltip`),u=o||s,d=n,f=r;!o&&(!t||t&&n||c)&&(d=t?this.outerWidth(e,!1,l)+1:this.outerWidth(e,!1,l)),(!s&&(!t||t&&r)||c)&&(f=this.outerHeight(e,!1,l)),e.wrap(this.$(`<div/>`).addClass(`k-child-animation-container`).css({width:i?`auto`:d,height:f})),a=e.parent(),a.wrap(this.$(`<div/>`).addClass(`k-animation-container`).attr(`role`,`region`)),u&&e.css({width:`100%`,height:`100%`})}return a=a.parent(),o<this.outerWidth(a)&&(a.addClass(`k-animation-container-sm`),n=!0),n&&this.wrapResize(e,t,r),a}wrapResize(e,t,n=!0){let r=e.parent(),i=e.closest(`.k-animation-container`),a=e.hasClass(`k-tooltip`),o=e.is(`:visible`),s=r[0].style,c=e[0].style.height;i.is(`:hidden`)&&i.css({display:``,position:``}),N.test(s.width)||N.test(s.height)||(o||e.add(r).show(),n&&r.css(`width`,``),r.css({width:t?this.outerWidth(e,!1,a)+1:this.outerWidth(e,!1,a)}),c===`auto`?e.css({height:this.outerHeight(r)}):r.css({height:this.outerHeight(e)}),o||e.hide())}scrollByDelta(e,t){let n=this.supportService.isRtl(e),r=(n?-this.scrollLeft(e):this.scrollLeft(e))+t,i=e[0].scrollWidth-e[0].clientWidth,a={scrollLeft:r};e.finish().animate(a,`fast`,`linear`);let o=n?-i:i,s=n?Math.max(Math.min(r,0),o):Math.min(Math.max(r,0),o);return{atStart:s===0,atEnd:s===o}}scrollVerticalByDelta(e,t,n={}){let{duration:r=`fast`,easing:i=`linear`}=n,a=(e.scrollTop()||0)+t,o={scrollTop:a};e.finish().animate(o,r,i);let s=e[0].scrollHeight-e[0].clientHeight,c=Math.min(Math.max(a,0),s);return{atTop:c===0,atBottom:c>=s}}scrollToElement(e,t,n={}){if(!e.length||!t.length)return!1;let{duration:r=0,easing:i=`linear`,position:a=`center`,offset:o=0,onComplete:s}=n,c=e.height()||0,l=e.scrollTop()||0,u=e.offset(),d=t.offset(),f=t.outerHeight()||0,p=d.top-u.top+l,m;switch(a){case`top`:m=p+o;break;case`bottom`:m=p-c+f+o;break;default:m=p-c/2+f/2+o;break}let h=e[0].scrollHeight-e[0].clientHeight;return m=Math.min(Math.max(m,0),h),e.finish().animate({scrollTop:m},r,i,s),!0}addAttribute(e,t,n){let r=e.attr(t)||``;r.indexOf(n)<0&&e.attr(t,(r+` `+n).trim())}removeAttribute(e,t){e.removeAttr(t)}toggleAttribute(e,t,n){let r=(e.attr(t)||``).indexOf(n)<0,i=[`disabled`,`readonly`].indexOf(t)>-1;r&&!i||i&&n?this.addAttribute(e,t,n):this.removeAttribute(e,t)}onResize(e){let t=e;return this.supportService.mobileOS&&this.supportService.mobileOS.android&&(t=function(){setTimeout(e,600)}),this.$(window).on(this.supportService.resize,t),t}unbindResize(e){this.$(window).off(this.supportService.resize,e)}attrValue(e,t){return e.data(this.namespaceService.ns+t)}attr(e){return`data-`+this.namespaceService.ns+e}dimensions(e,t){let n=e[0];return t&&e.css(t),{width:n.offsetWidth,height:n.offsetHeight}}triggeredByInput(e){return/^(label|input|textarea|select)$/i.test(e.target.tagName)}applyStylesFromKendoAttributes(e,t){let n=this.$,r=t.map(e=>`[${this.attr(`style-${e}`)}]`).join(`,`);e.find(r).addBack(r).each((e,r)=>{let i=n(r);t.forEach(e=>{let t=this.attr(`style-${e}`);i.attr(t)&&(i.css(e,i.attr(t)),i.removeAttr(t))})})}progress(e,t,n){let r=e.find(`.k-loading-mask`),i=this.supportService.browser,a=this.$.extend({},{width:`100%`,height:`100%`,top:e.scrollTop(),opacity:!1},n),o=a.opacity?`k-loading-mask k-opaque`:`k-loading-mask`;if(t){if(!r.length){let t=this.supportService.isRtl(e),n=t?`right`:`left`,r=this.scrollLeft(e),s=0;i.webkit&&t&&(s=e[0].scrollWidth-(e.width()||0)-2*r);let c=this.kendo.ui?.progress?.messages?.loading||`Loading...`;this.$(`<div class='${o}'><span role='alert' aria-live='polite' class='k-loading-text'>${c}</span><div class='k-loading-image'></div><div class='k-loading-color'></div></div>`).width(a.width).height(a.height).css(`top`,a.top).css(n,Math.abs(r)+s).prependTo(e)}}else r&&r.remove()}eventTarget(e){if(!this.supportService.touch)return e.target;let t=e.originalEvent?.changedTouches||e.changedTouches;return t&&t.length>0?document.elementFromPoint(t[0].clientX,t[0].clientY):e.target}createDragToScrollHandler(e,t){return new ne(this.$,e,t)}},ne=class e{static{this.DRAG_THRESHOLD=5}constructor(e,t,n){this.isDragging=!1,this.hasDragged=!1,this.dragStartX=0,this.scrollStartLeft=0,this.currentDragTarget=null,this.$=e,this.scrollContainer=t,this.namespace=n.namespace,this.captureElement=n.captureElement,this.delegateSelector=n.delegateSelector,this.onDragStart=this.onDragStart.bind(this),this.onDragMove=this.onDragMove.bind(this),this.onDragEnd=this.onDragEnd.bind(this),this.preventClickOnce=this.preventClickOnce.bind(this)}attach(){this.captureElement&&(this.delegateSelector?this.scrollContainer.on(`mousedown`+this.namespace,this.delegateSelector,this.onDragStart).on(`touchstart`+this.namespace,this.delegateSelector,this.onDragStart):this.scrollContainer.on(`mousedown`+this.namespace,this.onDragStart).on(`touchstart`+this.namespace,this.onDragStart),this.bindCaptureEvents())}destroy(){this.scrollContainer.off(this.namespace),this.captureElement&&this.unbindCaptureEvents(),this.scrollContainer[0].removeEventListener(`click`,this.preventClickOnce,!0)}getClientX(e){if(e.type.indexOf(`touch`)!==-1){let t=e.originalEvent?.touches?.[0]||e.originalEvent?.changedTouches?.[0];return t?t.clientX:0}return e.clientX||e.originalEvent?.clientX||0}preventClickOnce(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),this.scrollContainer[0].removeEventListener(`click`,this.preventClickOnce,!0)}onDragStart(e){let t=this.$(e.currentTarget);t.length&&(this.isDragging=!0,this.hasDragged=!1,this.currentDragTarget=t[0],this.dragStartX=this.getClientX(e),this.scrollStartLeft=t[0].scrollLeft,t.css(`cursor`,`grabbing`),t.css(`user-select`,`none`))}onDragMove(t){if(!this.isDragging||!this.currentDragTarget)return;let n=this.getClientX(t),r=this.dragStartX-n;!this.hasDragged&&Math.abs(r)>=e.DRAG_THRESHOLD&&(this.hasDragged=!0),this.hasDragged&&(t.preventDefault(),this.currentDragTarget.scrollLeft=this.scrollStartLeft+r)}onDragEnd(){if(this.isDragging){if(this.currentDragTarget){let e=this.$(this.currentDragTarget);e.css(`cursor`,``),e.css(`user-select`,``)}this.hasDragged&&this.scrollContainer[0].addEventListener(`click`,this.preventClickOnce,!0),this.isDragging=!1,this.hasDragged=!1,this.currentDragTarget=null}}bindCaptureEvents(){this.captureElement&&this.$(document).on(`mousemove`+this.namespace,this.onDragMove).on(`touchmove`+this.namespace,this.onDragMove).on(`mouseup`+this.namespace,this.onDragEnd).on(`touchend`+this.namespace,this.onDragEnd)}unbindCaptureEvents(){this.$(document).off(this.namespace)}};let re=`object`;var F=class{constructor(e){this.kendo=e,this.keys={INSERT:45,DELETE:46,BACKSPACE:8,TAB:9,ENTER:13,ESC:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,END:35,HOME:36,SPACEBAR:32,PAGEUP:33,PAGEDOWN:34,F2:113,F10:121,F12:123,SHIFT:16,NUMPAD_PLUS:107,NUMPAD_MINUS:109,NUMPAD_DOT:110},this.days={Sunday:0,Monday:1,Tuesday:2,Wednesday:3,Thursday:4,Friday:5,Saturday:6}}get kendoData(){return this.kendo.data||{}}toHyphens(e){return e.replace(/([a-z][A-Z])/g,e=>e.charAt(0)+`-`+e.charAt(1).toLowerCase())}toCamelCase(e){return e.replace(/\-(\w)/g,(e,t)=>t.toUpperCase())}size(e){let t=0;for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&n!==`toJSON`&&t++;return t}deepExtend(e,...t){for(let n=0;n<t.length;n++)this.deepExtendOne(e,t[n]);return e}deepExtendOne(e,t){let n=this.kendoData.ObservableArray,r=this.kendoData.LazyObservableArray,i=this.kendoData.DataSource,a=this.kendoData.HierarchicalDataSource;for(let o in t){if(o===`__proto__`||o===`constructor`||o===`prototype`)continue;let s=t[o],c=typeof s,l=null;c===re&&s!==null&&(l=s.constructor);let u=l?.name===`RegExp`,d=l?.name===`ArrayBuffer`,f=l?.name===`Date`;if(l&&!Array.isArray(s)&&l!==n&&l!==r&&l!==i&&l!==a&&!u&&(!this.isFunction(window.ArrayBuffer)||!d)&&!(s instanceof HTMLElement))if(f)e[o]=new Date(s.getTime());else if(this.isCloneable(s))e[o]=s.clone();else{let t=e[o];typeof t===re?e[o]=t||{}:e[o]={},this.deepExtendOne(e[o],s)}else c!==`undefined`&&(e[o]=s)}return e}isCloneable(e){return typeof e.clone==`function`}throttle(e,t){if(!t||t<=0)return e;let n,r=0,i=function(...i){let a=this,o=+new Date-r;function s(){let t=e.apply(a,i);return r=+new Date,t}if(!r||(n&&clearTimeout(n),o>t))return s();n=setTimeout(s,t-o)};return i.cancel=function(){n&&=(clearTimeout(n),void 0)},i}guid(){let e=window.crypto;try{return e.randomUUID()}catch{return e.getRandomValues(new Uint8Array(16)).reduce((e,t,n)=>((n===4||n===6||n===8||n===10)&&(e+=`-`),e+=t.toString(16).padStart(2,`0`),e),``)}}trim(e){return e?e.toString().trim():``}isPresent(e){return e!=null}isBlank(e){return e==null}isEmpty(e){return e.length===0}isString(e){return typeof e==`string`}isInteger(e){return Number.isInteger(e)}isNumeric(e){return!isNaN(e-parseFloat(e))}isDate(e){return e&&e.getTime}isFunction(e){return typeof e==`function`}isObject(e){return e!==null&&typeof e===re}logToConsole(e,t){let n=window.console;!this.kendo.suppressLog&&n!==void 0&&n.log&&n[t||`log`](e)}whenAll(e){let t=window.jQuery,n=arguments.length===1&&Array.isArray(e)?e:Array.prototype.slice.call(arguments),r=n.length,i=r,a=t.Deferred(),o=0,s=0,c=Array(r),l=Array(r),u=Array(r),d,f=(e,t,r)=>function(){r!==n&&s++,a.notifyWith(t[e]=this,r[e]=Array.prototype.slice.call(arguments)),--i||a[(s?`reject`:`resolve`)+`With`](t,r)};for(;o<r;o++)d=n[o],d&&this.isFunction(d.promise)?d.promise().done(f(o,u,n)).fail(f(o,c,l)):(a.notifyWith(this,d),--i);return i||a.resolveWith(u,n),a.promise()}isLocalUrl(e){return e&&!/^([a-z]+:)?\/\//i.test(e)}getAllMethods(e){let t=Object.getOwnPropertyNames(e).filter(t=>typeof e[t]==`function`),n=Object.getOwnPropertyNames(Object.getPrototypeOf(new e({}))).filter(e=>e!==`constructor`);return t.concat(n)}getBaseClass(e){if(e instanceof Function){let t=e,n=Object.getPrototypeOf(t);if(n&&n!==Object&&n.name)return n}return null}createProxyMember(e,t){e.fn[t]=function(){let e=this._instance;if(e)return e[t].apply(e,arguments)}}convertPromiseToDeferred(e){let t=$.Deferred();return e.finally(t.always).then(t.resolve).catch(t.reject),t.promise()}};let ie=`prefix`;var ae=class{constructor(){this.themeColorValues=[`base`,`primary`,`secondary`,`tertiary`,`inherit`,`info`,`success`,`warning`,`error`,`dark`,`light`,`inverse`],this.fillModeValues=[`solid`,`outline`,`flat`],this.shapeValues=[`rectangle`,`square`],this.sizeValues=[[`small`,`sm`],[`medium`,`md`],[`large`,`lg`]],this.roundedValues=[[`small`,`sm`],[`medium`,`md`],[`large`,`lg`],[`full`,`full`],[`none`,`none`]],this.positionModeValues=[`fixed`,`static`,`sticky`,`absolute`],this.resizeValues=[[`both`,`resize`],[`horizontal`,`resize-x`],[`vertical`,`resize-y`]],this.overflowValues=[`auto`,`hidden`,`visible`,`scroll`,`clip`],this.layoutFlowValues=[[`vertical`,`!k-flex-col`],[`horizontal`,`!k-flex-row`]],this.defaultValues={},this.propertyDictionary={},this.propertyToCssClassMap={},this.registerDefaultCssClasses(`themeColor`,this.themeColorValues),this.registerDefaultCssClasses(`fillMode`,this.fillModeValues),this.registerDefaultCssClasses(`shape`,this.shapeValues),this.registerDefaultCssClasses(`size`,this.sizeValues),this.registerDefaultCssClasses(`positionMode`,this.positionModeValues),this.registerDefaultCssClasses(`rounded`,this.roundedValues),this.registerDefaultCssClasses(`resize`,this.resizeValues),this.registerDefaultCssClasses(`overflow`,this.overflowValues),this.registerDefaultCssClasses(`layoutFlow`,this.layoutFlowValues),this.registerCssClasses(`themeColor`,this.themeColorValues),this.registerCssClasses(`fill`,this.fillModeValues),this.registerCssClasses(`shape`,this.shapeValues),this.registerCssClasses(`size`,this.sizeValues),this.registerCssClasses(`positionMode`,this.positionModeValues)}registerPrefix(e,t){this.propertyDictionary[e]||(this.propertyDictionary[e]={}),this.propertyDictionary[e][ie]=t}registerValues(e,t){let n,r,i,a,o,s;for(this.propertyDictionary[e]||(this.propertyDictionary[e]={}),n=0;n<t.length;n++)for(i=t[n].prop,o=t[n].values,this.propertyDictionary[e][i]||(this.propertyDictionary[e][i]={}),a=this.propertyDictionary[e][i],r=0;r<o.length;r++)s=o[r],Array.isArray(s)?a[s[0]]=s[1]:a[s]=s}getValidClass(e){let t=e.widget,n=e.propName,r=e.value,i=e.prefix,a=this.defaultValues[n],o=this.propertyDictionary[t];if(!o)return``;let s=o[n],c=s&&s[r]||a&&a[r];if(c){let e;return e=n===`themeColor`?o[ie]:n===`positionMode`?`k-pos-`:n===`rounded`?`k-rounded-`:n===`resize`?`k-`:n===`overflow`?`k-overflow-`:n===`layoutFlow`?``:o[ie],e=i||e,e+c}else return``}registerDefaultCssClass(e,t,n){this.defaultValues[e]||(this.defaultValues[e]={}),this.defaultValues[e][t]=n||t}registerDefaultCssClasses(e,t){for(let n=0;n<t.length;n++)if(Array.isArray(t[n])){let r=t[n];this.registerDefaultCssClass(e,r[0],r[1])}else this.registerDefaultCssClass(e,t[n])}registerCssClass(e,t,n){this.propertyToCssClassMap[e]||(this.propertyToCssClassMap[e]={}),this.propertyToCssClassMap[e][t]=n||t}registerCssClasses(e,t){for(let n=0;n<t.length;n++)if(Array.isArray(t[n])){let r=t[n];this.registerCssClass(e,r[0],r[1])}else this.registerCssClass(e,t[n])}getValidCssClass(e,t,n){if(n===void 0)return``;let r=this.propertyToCssClassMap[t]?.[n];if(r)return e+r}};let oe=[`themeColor`,`fillMode`,`shape`,`size`,`rounded`,`positionMode`],se=`aria-labelledby`,ce=`aria-label`;var I=class e extends M{static call(t,n,r){e.fn.init.call(t,n,r)}static apply(t,n){e.fn.init.apply(t,n)}constructor(e,t){super(),e!==void 0&&this.init(e,t)}init(e,t){let r=this;n.validatePackage()||(r._showWatermarkOverlay=n.addWatermarkOverlayAndBanner);let i=T(E).getConstructor();r.element=i(e).handler(r),M.fn.init.call(r);let a=t?t.dataSource:null,o;t&&(o=(r.componentTypes||{})[t.componentType]),a&&(t=i.extend({},t,{dataSource:{}})),t=r.options=i.extend(!0,{},r.options,r.defaults,o||{},t),a&&(t.dataSource=a);let s=T(P).attr(`role`);r.element.attr(s)||r.element.attr(s,(t.name||``).toLowerCase()),r.element.data(`kendo`+t.prefix+t.name,r),r.bind(r.events,t)}_hasBindingTarget(){return!!this.element[0].kendoBindingTarget}_tabindex(e){e||=this.wrapper;let t=this.element,n=`tabindex`,r=e.attr(n)||t.attr(n);t.removeAttr(n),e.attr(n,isNaN(r)?0:r)}setOptions(e){this._clearCssClasses(e),this._setEvents(e),T(E).getConstructor().extend(this.options,e),this._applyCssClasses()}_setEvents(e){let t=this,n=0,r=t.events.length,i;for(;n<r;n++)i=t.events[n],t.options[i]&&e[i]&&(t.unbind(i,t.options[i]),t._events&&t._events[i]&&delete t._events[i]);t.bind(t.events,e)}resize(e){let t=this.getSize(),n=this._size;(e||(t.width>0||t.height>0)&&(!n||t.width!==n.width||t.height!==n.height))&&(this._size=t,this._resize(t,e),this.trigger(`resize`,t))}getSize(){return T(P).dimensions(this.element)}size(e){if(e)this.setSize(e);else return this.getSize()}setSize(e){}_resize(e,t){}destroy(){let e=this;e.element.removeData(`kendo`+e.options.prefix+e.options.name),e.element.removeData(`handler`),e.unbind()}_destroy(){this.destroy()}_applyCssClasses(e){let t=this.__proto__.options,n=this.options,r=e||this.wrapper||this.element,i=[],a,o,s,c,l=T(ae);if(s=this.options._altname||t.name,c=l.propertyDictionary[s],!(!l||!c)){for(a=0;a<oe.length;a++)o=oe[a],s=this.options._altname||t.name,(o in t||o in n)&&i.push(l.getValidClass({widget:s,propName:o,value:n[o]}));r.addClass(i.join(` `))}}_ariaLabel(e){let t=this,n=t.element,r=n.attr(`id`),i=T(E).getConstructor()(`label[for="`+r+`"]`),a=n.attr(ce),o=n.attr(se),s;if(e[0]!==n[0]){if(a)e.attr(ce,a);else if(o)e.attr(se,o);else if(i.length){let n=T(F).guid();s=i.attr(`id`)||t._generateLabelId(i,r||n),e.attr(se,s)}}}_clearCssClasses(e,t){let n=this.__proto__.options,r=this.options,i=t||this.wrapper||this.element,a,o,s,c,l=T(ae);if(s=this.options._altname||n.name,c=l.propertyDictionary[s],!(!l||!c))for(a=0;a<oe.length;a++)o=oe[a],(o in n||o in r)&&e.hasOwnProperty(o)&&(o===`themeColor`?i.removeClass(l.getValidClass({widget:s,propName:o,value:r[o],fill:r.fillMode})):(o===`fillMode`&&i.removeClass(l.getValidClass({widget:s,propName:`themeColor`,value:r.themeColor,fill:r.fillMode})),i.removeClass(l.getValidClass({widget:s,propName:o,value:r[o]}))))}_generateLabelId(e,t){let n=t+`_label`;return e.attr(`id`,n),n}};I.fn=I.prototype,I.prototype.options={prefix:``},I.prototype.events=[];let le=/&/g,ue=/</g,de=/"/g,fe=/'/g,pe=/>/g,me=[`http:`,`https:`];var L=class{decode(e){let t={"&amp;":`&`,"&lt;":`<`,"&gt;":`>`,"&quot;":`"`,"&#39;":`'`};return e.replace(/&(?:amp|lt|gt|quot|#39);/g,function(e){return t[e]})}encode(e,t){return t===!0&&(e=this.decode(e)),(``+e).replace(le,`&amp;`).replace(ue,`&lt;`).replace(pe,`&gt;`).replace(de,`&quot;`).replace(fe,`&#39;`)}sanitizeLink(e){let t=``;try{let n=new URL(e,window.location.origin);if(me.includes(n.protocol))t=e;else throw Error(`Invalid protocol`)}catch{t=`#INVALIDLINK`}return this.encode(t)}convertTextUrlToLink(e,t){return(t?e:this.encode(e)).replace(/((https?:\/\/[^\s"'<>]+)|(www\.[^\s"'<>]+))/gi,(e,t,n,r,i,a)=>{let o=a.lastIndexOf(`>`,i-1),s=a.substring(o+1,i);if(/\w+\s*=\s*["']$/.test(s))return e;let c=e.trim(),l=e.trim();/^www\./i.test(c)&&(c=`https://`+c);try{return c=new URL(c).href,`<a href="${c}" target="_blank" rel="noopener noreferrer">${l}</a>`}catch{return e}})}unescape(e){let t;try{t=window.decodeURIComponent(e)}catch{t=e.replace(/%u([\dA-F]{4})|%([\dA-F]{2})/gi,function(e,t,n){return String.fromCharCode(parseInt(`0x`+(t||n),16))})}return t}};let he={}.toString,ge=/[+|\-]\d{1,2}/,_e=/[+|\-]\d{1,2}:?\d{2}/,ve=/^\/Date\((.*?)\)\/$/,ye=/[+-]\d*/,be=[[],[`G`,`g`,`F`],[`D`,`d`,`y`,`m`,`T`,`t`]],xe=[[`yyyy-MM-ddTHH:mm:ss.fffffffzzz`,`yyyy-MM-ddTHH:mm:ss.fffffff`,`yyyy-MM-ddTHH:mm:ss.fffzzz`,`yyyy-MM-ddTHH:mm:ss.fff`,`ddd MMM dd yyyy HH:mm:ss`,`yyyy-MM-ddTHH:mm:sszzz`,`yyyy-MM-ddTHH:mmzzz`,`yyyy-MM-ddTHH:mmzz`,`yyyy-MM-ddTHH:mm:ss`,`yyyy-MM-dd HH:mm:ss`,`yyyy/MM/dd HH:mm:ss`],[`yyyy-MM-ddTHH:mm`,`yyyy-MM-dd HH:mm`,`yyyy/MM/dd HH:mm`],[`yyyy/MM/dd`,`yyyy-MM-dd`,`HH:mm:ss`,`HH:mm`]],Se={2:/^\d{1,2}/,3:/^\d{1,3}/,4:/^\d{4}/,exact3:/^\d{3}/};var Ce=class{constructor(e,t){this.cultureService=e,this.roundFn=t,this.timezoneService=null}setTimezoneService(e){this.timezoneService=e}parseDate(e,t,n,r){return this.internalParseDate(e,t,n,!1,r)}parseExactDate(e,t,n){return this.internalParseDate(e,t,n,!0)}internalParseDate(e,t,n,r,i){if(he.call(e)===`[object Date]`)return e;if(!e)return null;let a=String(e),o=null,s;if(a.indexOf(`/D`)===0){let e=ve.exec(a);if(e){let t=e[1];if(s=ye.exec(t.substring(1)),o=new Date(parseInt(t,10)),s&&this.timezoneService){let e=this.parseMicrosoftFormatOffset(s[0]);o=this.timezoneService.apply(o,0),o=this.timezoneService.convert(o,0,-1*e)}return o}}let c=this.cultureService.getCulture(n),l;l=t?Array.isArray(t)?t:[t]:this.getDefaultFormats(c);for(let e=0;e<l.length;e++)if(o=this.parseExact(a,l[e],c,r,i),o)return o;return o}parseExact(e,t,n,r,i){if(!e)return null;let a=n.calendars.standard,o=0,s=0,c=e=>{let n=0;for(;t[o]===e;)n++,o++;return n>0&&--o,n},l=t=>{let n=``;if(t===2)for(let r=0;r<=t;r++)n+=e[s+r]||``;n=i&&n.match(Se.exact3)&&Number.isInteger(Number(n))&&Number(n)>0?this.unpadZero(n):e.substr(s,t);let r=Se[t]||RegExp(`^\\d{1,`+t+`}`),a=n.match(r);if(a){let e=a[0];return s+=e.length,parseInt(e,10)}return null},u=(t,n,r)=>{let i=0,a=0;for(let o=0;o<t.length;o++){let c=t[o],l=c.length,u=e.substr(s,r||l);n&&(u=u.toLowerCase()),u===c&&l>i&&(i=l,a=o)}return i?(s+=i,a+1):null},d=()=>e.charAt(s)===t[o]?(s++,!0):!1,f=null,p=null,m=null,h=null,g=null,_=null,v=null,y=!1,b=new Date,x=a.twoDigitYearMax||2029,S=b.getFullYear(),C=null,w,T=null,E=null;t||=`d`;let D=a.patterns[t];D&&(t=D);let O=t.split(``),k=O.length;for(a._lowerDays||=this.lowerLocalInfo(a.days),a._lowerMonths||=this.lowerLocalInfo(a.months);o<k;o++){let t=O[o];if(y)t===`'`?y=!1:d();else if(t===`d`){let e=c(`d`);if(m!==null&&e>2)continue;if(m=e<3?l(2):u(a._lowerDays[e===3?`namesAbbr`:`names`],!0),m===null||this.outOfRange(m,1,31))return null}else if(t===`M`){let e=c(`M`);if(p=e<3?l(2):u(a._lowerMonths[e===3?`namesAbbr`:`names`],!0),p===null||this.outOfRange(p,1,12))return null;--p}else if(t===`y`){let e=c(`y`);if(f=l(e),f===null)return null;if(e===2){let e=x;typeof e==`string`&&(e=S+parseInt(e,10)),f=S-S%100+f,f>e&&(f-=100)}}else if(t===`h`){if(c(`h`),h=l(2),h===12&&(h=0),h===null||this.outOfRange(h,0,11))return null}else if(t===`H`){if(c(`H`),h=l(2),h===null||this.outOfRange(h,0,23))return null}else if(t===`m`){if(c(`m`),g=l(2),g===null||this.outOfRange(g,0,59))return null}else if(t===`s`){if(c(`s`),_=l(2),_===null||this.outOfRange(_,0,59))return null}else if(t===`f`){let t=c(`f`),n=e.substr(s,t).match(Se[3]);if(v=l(t),v!==null&&n){let e=parseFloat(`0.`+n[0]);e=parseFloat(this.roundFn(e,3)),v=e*1e3}if(v===null||this.outOfRange(v,0,999))return null}else if(t===`t`){let e=c(`t`),t=a.AM,n=a.PM;if(e===1&&(t=this.mapDesignators(t),n=this.mapDesignators(n)),C=u(n,!1,this.longestStringLength(n)),!C&&!u(t,!1,this.longestStringLength(t)))return null}else if(t===`z`){w=!0;let t=c(`z`);if(e.substr(s,1)===`Z`){d();continue}let n=e.substr(s,6).match(t>2?_e:ge);if(!n)return null;let r=n[0].split(`:`),i=r[0],a=r[1];if(!a&&i.length>3&&(s=i.length-2,a=i.substring(s),i=i.substring(0,s)),T=parseInt(i,10),this.outOfRange(T,-12,13)||t>2&&(a=r[0][0]+a,E=parseInt(a,10),isNaN(E)||this.outOfRange(E,-59,59)))return null}else if(t===`'`)y=!0,d();else if(!d())return null}if(r&&!/^\s*$/.test(e.substr(s)))return null;f===null&&p===null&&m===null&&(h!==null||g!==null||_!==null)?(f=S,p=b.getMonth(),m=b.getDate()):(f===null&&(f=S),m===null&&(m=1)),C&&h!==null&&h<12&&(h+=12);let A;return w?(T&&h!==null&&(h+=-T),E&&g!==null&&(g+=-E),A=new Date(Date.UTC(f,p??0,m,h??0,g??0,_??0,v??0))):(A=new Date(f,p??0,m,h??0,g??0,_??0,v??0),this.adjustDST(A,h)),f<100&&A.setFullYear(f),A.getDate()!==m&&w===void 0?null:A}parseMicrosoftFormatOffset(e){let t=e.substr(0,1)===`-`?-1:1;return e=e.substring(1),t*(parseInt(e.substr(0,2),10)*60+parseInt(e.substring(2),10))}getDefaultFormats(e){let t=Math.max(be.length,xe.length),n=(e.calendar||e.calendars.standard).patterns,r=[];for(let e=0;e<t;e++){let t=be[e]||[];for(let e=0;e<t.length;e++)r.push(n[t[e]]);r.push(...xe[e]||[])}return r}outOfRange(e,t,n){return!(e>=t&&e<=n)}adjustDST(e,t){!t&&e.getHours()===23&&e.setHours(e.getHours()+2)}lowerLocalInfo(e){return{names:e.names.map(e=>e.toLowerCase()),namesAbbr:e.namesAbbr.map(e=>e.toLowerCase())}}unpadZero(e){return e.replace(/^0*/,``)}mapDesignators(e){return e.map(e=>e.charAt(0))}longestStringLength(e){return e.reduce((e,t)=>Math.max(e,t.length),0)}},we=class e{static{this.DEFAULT_OPTIONS={autoSync:!0,schema:{model:{id:`id`,fields:{id:{type:`string`},text:{type:`string`},authorId:{type:`string`},authorName:{type:`string`},authorImageUrl:{type:`string`},authorImageAltText:{type:`string`},replyToId:{type:`string`,defaultValue:null},isDeleted:{type:`boolean`,defaultValue:!1},isPinned:{type:`boolean`,defaultValue:!1},isTyping:{type:`boolean`,defaultValue:!1},timestamp:{type:`date`},files:{parse:e=>e||[]}}}}}}static{this.FIELD_MAP={text:`textField`,authorId:`authorIdField`,authorName:`authorNameField`,authorImageUrl:`authorImageUrlField`,authorImageAltText:`authorImageAltTextField`,id:`idField`,timestamp:`timestampField`,files:`filesField`,replyToId:`replyToIdField`,isDeleted:`isDeletedField`,isPinned:`isPinnedField`,isTyping:`isTypingField`}}constructor(e){this.context=e,this.options=this.buildOptions(e.chatOptions),this.dataSource=this.createDataSource(e.chatOptions)}buildOptions(t){let n;return n=t.dataSource instanceof kendo.data.DataSource?$.extend(!0,{},e.DEFAULT_OPTIONS,t.dataSource.options):Array.isArray(t.dataSource)?$.extend(!0,{},e.DEFAULT_OPTIONS,{data:t.dataSource}):$.extend(!0,{},e.DEFAULT_OPTIONS,t.dataSource),n.autoAssignId=t.autoAssignId,this.mapFields(n.schema.model.fields,t),n}createDataSource(e){return e.dataSource instanceof kendo.data.DataSource?e.dataSource:kendo.data.DataSource.create(this.options)}mapFields(t,n){for(let r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e.FIELD_MAP[r]){let i=e.FIELD_MAP[r];t[r].from=n[i]}}getDataSource(){return this.dataSource}getView(){return this.dataSource.view()}getLastMessage(){let e=this.getView();return e.length?e[e.length-1]:null}getMessageById(e){return e?this.dataSource.get(e):null}getMessageByUid(e){return this.dataSource.getByUid(e)}getFileByUid(e,t){return!e||!t?null:e.files.find(e=>e.uid===t)||null}getPinnedMessage(){return this.dataSource.data().find(e=>e.isPinned)||null}postMessage(e,t){let n=typeof e==`string`?{text:e}:e,r={id:this.options.autoAssignId?this.context.utilsService.guid():void 0,timestamp:new Date,files:[],...n,authorId:n.authorId?.toString()||t};return this.dataSource.add(r)}updateMessage(e,t){if(!e)return null;let n=e;if(e instanceof kendo.data.ObservableObject||(n=this.getMessageById(e.id)),!n)return null;for(let e in t)Object.prototype.hasOwnProperty.call(t,e)&&n.set(e,t[e]);return n}removeMessage(e){return e?(e.set(`isDeleted`,!0),!0):!1}pinMessage(e){if(!e)return!1;let t=this.getPinnedMessage();return t&&t.set(`isPinned`,!1),e.set(`isPinned`,!0),e}clearPinnedMessage(){let e=this.getPinnedMessage();e&&e.set(`isPinned`,!1)}};let R=`.kendoChat`,Te={STANDARD:`standard`,FULL:`full`},Ee={SENT:`sent`,DELIVERED:`delivered`,SEEN:`seen`,FAILED:`failed`},z={HORIZONTAL:`horizontal`,VERTICAL:`vertical`,WRAP:`wrap`},B={SCROLL:`scroll`,WRAP:`wrap`,SCROLLBUTTONS:`scrollbuttons`},V={attachment:`paperclip-outline-alt-right`,attachmentMenu:`more-vertical`,checkCircle:`check-circle`,chevronDown:`chevron-down`,chevronLeft:`chevron-left`,chevronRight:`chevron-right`,chevronUp:`chevron-up`,download:`download`,fileError:`file-error`,filePdf:`file-pdf`,microphoneOutline:`microphone-outline`,pin:`pin`,undo:`undo`,copy:`copy`,trash:`trash`,send:`paper-plane`,stop:`stop-sm`,upload:`upload`,x:`x`,arrowDown:`arrow-down`,retry:`arrow-rotate-cw`},H={reply:`reply`,copy:`copy`,pin:`pin`,delete:`delete`,download:`download`},U={active:`k-active`,selected:`k-selected`,focus:`k-focus`,expanded:`k-expanded`,disabled:`k-disabled`,hidden:`k-hidden`,generating:`k-generating`,noAvatar:`k-no-avatar`,file:`k-file-box`,fileInfo:`k-file-info`,fileName:`k-file-name`,fileSize:`k-file-size`,fileWrapper:`k-file-box-wrapper`,fileWrapperScrollableStart:`k-file-box-wrapper-scrollable-start`,filesScroll:`k-files-scroll`,filesVertical:`k-files-vertical`,filesWrap:`k-files-wrap`,avatar:`k-avatar`,bubble:`k-bubble`,bubbleContent:`k-bubble-content`,bubbleExpandable:`k-bubble-expandable`,bubbleExpandableIndicator:`k-bubble-expandable-indicator`,chatBubble:`k-chat-bubble`,chatBubbleText:`k-chat-bubble-text`,button:`k-button`,buttonDefaults:`k-button-md k-rounded-md k-button-solid k-button-solid-base`,buttonIcon:`k-button-icon`,buttonPrimary:`k-button-md k-rounded-md k-button-flat k-button-flat-primary`,iconButton:`k-icon-button`,menuButton:`k-menu-button`,chatSend:`k-chat-send`,chatUpload:`k-chat-upload`,downloadButton:`k-chat-download-button`,downloadButtonWrapper:`k-chat-download-button-wrapper`,canvas:`k-chat-canvas`,card:`k-card`,cardAction:`k-card-action`,cardActions:`k-card-actions`,cardActionsVertical:`k-actions-vertical`,cardBody:`k-card-body`,cardDeck:`k-card-deck`,cardDeckScrollWrap:`k-card-deck-scrollwrap`,cardList:`k-card-list`,cardMedia:`k-card-media`,cardRich:`k-card-type-rich`,cardSubtitle:`k-card-subtitle`,cardTitle:`k-card-title`,cardWrapper:`k-card-container`,dropzoneHint:`k-dropzone-hint`,dropzoneIcon:`k-dropzone-icon`,dropzoneInner:`k-dropzone-inner`,externalDropzone:`k-external-dropzone`,header:`k-chat-header`,message:`k-message`,messageAuthor:`k-message-author`,messageGroup:`k-message-group`,messageGroupContent:`k-message-group-content`,messageGroupFullWidth:`k-message-group-full-width`,messageGroupReceiver:`k-message-group-receiver`,messageGroupSender:`k-message-group-sender`,messageListContent:`k-message-list-content`,messageRemoved:`k-message-removed`,messageStatus:`k-message-status`,messageTime:`k-message-time`,messageInfo:`k-message-info`,messageFailed:`k-message-failed`,messageToolbar:`k-chat-message-toolbar`,messageRetryButton:`k-message-retry-button`,messagePinned:`k-message-pinned`,messageReference:`k-message-reference`,messageReferenceContent:`k-message-reference-content`,messageReferenceReceiver:`k-message-reference-receiver`,messageReferenceSender:`k-message-reference-sender`,scrollButtonIconLeft:`chevron-left`,scrollButtonIconRight:`chevron-right`,suggestion:`k-suggestion`,suggestionGroup:`k-suggestion-group`,suggestionGroupScrollable:`k-suggestion-group-scrollable`,suggestionGroupWrap:`k-suggestion-group-wrap`,suggestionsScroll:`k-suggestions-scroll`,suggestionScrollWrap:`k-suggestion-scrollwrap`,suggestionScrollWrapGradient:`k-suggestion-scrollwrap-gradient`,timestamp:`k-timestamp`,typingIndicator:`k-typing-indicator`,viewWrapper:`k-message-list`,wrapper:`k-chat`,messageBox:`k-message-box`,messageBoxWrapper:`k-message-box-wrapper`,spacer:`k-spacer`,scrollFab:`k-chat-scroll-fab`,fab:`k-fab`},W={fileButton:`ref-chat-file-button`,fileMenuButton:`ref-chat-file-menu-button`,fileWrapper:`ref-chat-file-wrapper`,fileCloseButton:`ref-chat-file-close-button`,bubbleExpandableIndicator:`ref-chat-bubble-expandable-indicator`,messageReferencePinWrapper:`ref-chat-message-reference-pin-wrapper`,messageReferenceReplyWrapper:`ref-chat-message-reference-reply-wrapper`,pinnedMessageCloseButton:`ref-chat-pinned-message-close-button`,replyMessageCloseButton:`ref-chat-reply-message-close-button`,leftScrollButton:`ref-chat-left-scroll-button`,rightScrollButton:`ref-chat-right-scroll-button`,sendButton:`ref-chat-message-box-send-button`,speechToTextButton:`ref-chat-message-box-speech-to-text-button`,suggestionGroup:`ref-chat-suggestion-group`,fileUploadInput:`ref-chat-file-upload-input`,viewWrapper:`ref-chat-view-wrapper`,scrollToBottomButton:`ref-chat-scroll-to-bottom-button`,retryButton:`ref-chat-message-retry-button`},G={sendMessage:`sendMessage`,suggestionClick:`suggestionClick`,unpin:`unpin`,input:`input`,toolbarAction:`toolbarAction`,fileMenuAction:`fileMenuAction`,contextMenuAction:`contextMenuAction`,download:`download`,fileSelect:`fileSelect`,fileRemove:`fileRemove`,executeAction:`executeAction`,resendMessage:`resendMessage`,suggestedActionClick:`suggestedActionClick`,messageToolbarExecute:`messageToolbarExecute`,fileMenuExecute:`fileMenuExecute`,downloadAllFiles:`downloadAllFiles`,expandableToggle:`expandableToggle`,replyMessageCloseButtonClick:`replyMessageCloseButtonClick`},K=`click`,De=`focus`,Oe=`blur`,ke=`change`,q=`${R}navigation`,Ae=null,je=!1;var Me=class{constructor(e){this.context=e}setupAriaAttributes(){let e=this.context.getOptions().messages,t=this.context.wrapper.find(`.${U.viewWrapper}`);t.length&&t.attr(`role`,`log`).attr(`aria-live`,`polite`).attr(`aria-label`,e.messageListLabel),this.setupBubbleTabNavigation(),this.setupSuggestionAccessibility(),this.setupButtonAccessibility(e),this.setupExpandableIndicators(),this.setupScrollButtonsAria(),this.setupMessageBoxAria(e)}setupBubbleTabNavigation(){let e=this.context.wrapper.find(`.${U.bubble}`),t=e.filter(function(){return $(this).find(`.${U.typingIndicator}`).length===0}),n=e.filter(function(){return $(this).find(`.${U.typingIndicator}`).length>0});t.attr(`tabindex`,`0`),n.attr(`tabindex`,`-1`),t.off(`${De}${q} ${Oe}${q} ${K}${q}`).on(`${De}${q}`,function(){let t=$(this);Ae&&e.removeClass(U.selected),e.removeClass(U.focus),Ae&&t.addClass(U.selected),t.addClass(U.focus),Ae=!1}).on(`${Oe}${q}`,function(){Ae&&!je&&$(this).removeClass(U.selected),$(this).removeClass(U.focus)}).on(`${K}${q}`,function(e){$(e.target).closest(W.fileMenuButton)||$(this).trigger(De)})}setupSuggestionAccessibility(){this.context.wrapper.find(`.${U.suggestionGroup}`).each((e,t)=>{let n=$(t);n.attr(`role`,`group`),n.find(`.${U.suggestion}`).each((e,t)=>{$(t).attr(`role`,`button`).attr(`tabindex`,`0`)})})}setupButtonAccessibility(e){this.context.wrapper.find(`.k-input-suffix > .k-button`).each((t,n)=>{let r=$(n);!r.attr(`role`)&&n.nodeName.toLowerCase()!==`button`&&r.attr(`role`,`button`),!r.attr(`aria-label`)&&!r.attr(`title`)&&(r.hasClass(U.chatSend)?r.attr(`aria-label`,e.actionButton||e.sendButton):r.hasClass(`k-chat-upload`)&&r.attr(`aria-label`,e.fileButton)),r.hasClass(U.chatSend)&&r.hasClass(`k-disabled`)&&r.attr(`aria-disabled`,`true`)}),this.context.wrapper.find(`.${U.downloadButton}`).each((t,n)=>{let r=$(n);!r.attr(`role`)&&n.nodeName.toLowerCase()!==`button`&&r.attr(`role`,`button`),!r.attr(`aria-label`)&&!r.attr(`title`)&&r.attr(`aria-label`,e.downloadAll)}),this.setupCloseButtonAria(W.pinnedMessageCloseButton,e.pinnedMessageCloseButton),this.setupCloseButtonAria(W.replyMessageCloseButton,e.replyMessageCloseButton),this.context.wrapper.find(`[${W.fileMenuButton}]`).each((t,n)=>{let r=$(n);r.attr(`aria-label`,e.fileMenuButton),r.attr(`title`,e.fileMenuButton)})}setupCloseButtonAria(e,t){this.context.wrapper.find(`[${e}]`).each((e,n)=>{let r=$(n);!r.attr(`role`)&&n.nodeName.toLowerCase()!==`button`&&r.attr(`role`,`button`),!r.attr(`aria-label`)&&!r.attr(`title`)&&(r.attr(`aria-label`,t),r.attr(`title`,t))})}setupExpandableIndicators(){this.context.wrapper.find(`.${U.bubbleExpandableIndicator}`).each((e,t)=>{let n=$(t);n.attr(`role`,`button`).attr(`tabindex`,`0`);let r=n.closest(`.${U.bubble}`).hasClass(U.expanded)?`Collapse message`:`Expand message`;n.attr(`aria-label`,r)})}setupScrollButtonsAria(){let e=this.context.getOptions().dir,t=this.context.wrapper.find(`[${W.leftScrollButton}]`),n=this.context.wrapper.find(`[${W.rightScrollButton}]`),r=e===`rtl`?`Scroll Right`:`Scroll Left`,i=e===`rtl`?`Scroll Left`:`Scroll Right`;t.attr(`aria-label`,r),t.attr(`title`,r),n.attr(`aria-label`,i),n.attr(`title`,i)}setupMessageBoxAria(e){this.context.wrapper.find(`.${U.messageBox}`).find(`textarea`).attr(`aria-label`,e.messageBoxLabel)}setFileCloseButtonAria(e){e.find(`[${W.fileCloseButton}]`).each((e,t)=>{let n=$(t);!n.attr(`role`)&&t.nodeName.toLowerCase()!==`button`&&n.attr(`role`,`button`),!n.attr(`aria-label`)&&!n.attr(`title`)&&(n.attr(`aria-label`,`Remove selected file`),n.attr(`title`,`Remove selected file`))})}updateExpandableIndicatorAria(e,t){let n=t?`Collapse message`:`Expand message`;e.attr(`aria-label`,n)}handleKeyDown(e,t){if(!$(e.target).closest(this.context.wrapper).length)return null;let n=$(e.target),r=e.keyCode||e.which;return Ae=!0,je=e.shiftKey,n.hasClass(U.bubble)&&this.handleBubbleKeyDown(e,r),n.hasClass(U.suggestion)&&this.handleClickableElementKeyDown(e,r),n.hasClass(U.bubbleExpandableIndicator)&&this.handleExpandableIndicatorKeyDown(e,r,n),n.hasClass(`k-input-inner`)&&this.handleMessageInputKeyDown(e,r,t),n.closest(`.k-input-suffix .k-button`).length&&this.handleClickableElementKeyDown(e,r),null}handleBubbleKeyDown(e,t){let n=$(e.target);if(n.find(`.${U.typingIndicator}`).length>0)return;let r=this.context.wrapper.find(`.${U.bubble}`).filter(function(){return $(this).find(`.${U.typingIndicator}`).length===0}),i=r.index(n),a=this.context.utilsService.keys;switch(t){case a.UP:e.preventDefault(),this.focusBubbleAtIndex(r,i-1);break;case a.DOWN:e.preventDefault(),this.focusBubbleAtIndex(r,i+1);break;case a.HOME:e.preventDefault(),this.focusBubbleAtIndex(r,0);break;case a.END:e.preventDefault(),this.focusBubbleAtIndex(r,r.length-1);break}}focusBubbleAtIndex(e,t){if(e.length===0||t<0||t>=e.length)return;let n=e.eq(t);n.attr(`data-keyboard-focus`,`true`),n.focus(),n.removeAttr(`data-keyboard-focus`)}handleExpandableIndicatorKeyDown(e,t,n){let r=this.context.utilsService.keys;if(t===r.ENTER||t===r.SPACEBAR){e.preventDefault(),n.trigger(K);let t=n.closest(`.${U.bubble}`).hasClass(U.expanded);this.updateExpandableIndicatorAria(n,!t)}}handleMessageInputKeyDown(e,t,n){}handleClickableElementKeyDown(e,t){let n=this.context.utilsService.keys;(t===n.ENTER||t===n.SPACEBAR)&&(e.preventDefault(),$(e.target).trigger(K))}},Ne=class e extends I{static{this.options={name:`MessageToolbar`}}constructor(t,n){super(t,$.extend(!0,{},e.options,n)),this.extendItemsConfig(),this.create(),this.attachEvents()}create(){let e=this.element.data(`kendoToolBar`);e&&e.destroy();let t=$.extend({},this.options,{fillMode:`flat`});delete t.name,this.toolbar=new kendo.ui.ToolBar(this.element,t)}extendItemsConfig(){let e=this.options.items;e&&e.forEach(e=>{e.attributes=e.attributes||{};let t=e.attributes[`aria-label`];e.attributes[`data-command`]=e.name.toLowerCase(),e.attributes[`aria-label`]=t??e.name,e.type=`button`,e.fillMode=`flat`,e.overflow=`never`})}attachEvents(){this.toolbar.bind(K,this.onClick.bind(this))}onClick(e){let t=e.target.closest(`.`+U.message),n=e.target.data(`command`);n&&this.executeCommand(n,e.target,t)}executeCommand(e,t,n){this.trigger(`execute`,{type:e,item:t,message:n})}destroy(){this.toolbar&&=(this.toolbar.destroy(),null),this.element.empty()}},Pe=class e extends I{static{this.options={name:`ChatFileMenu`,items:[]}}constructor(t,n){super(t,$.extend(!0,{},e.options,n)),this.setCommandAttributes(),this.createDropdownButton()}createDropdownButton(){this.dropdownButton=new kendo.ui.DropDownButton(this.element,{items:this.options.items,fillMode:`flat`,icon:V.attachmentMenu}),this.dropdownButton.bind(`click`,this.onClick.bind(this)).bind(`open`,this.onOpen.bind(this)).bind(`close`,this.onClose.bind(this))}setCommandAttributes(){this.options.items.forEach(e=>{e.attributes=e.attributes||{},e.attributes[`data-command`]=e.name.toLowerCase(),e.id=e.name.toLowerCase()})}onClick(e){let t=e.id,n=$(e.sender.element).closest(`.`+U.file),r=$(e.sender.element).closest(`.`+U.message);t&&this.executeCommand(t,$(e.sender.element),n,r)}onOpen(e){let t=!0,n=$(e.sender.element);(n.closest(`.`+U.messageRemoved).length||n.find(`.`+U.typingIndicator).length)&&(e.preventDefault(),t=!1),this.setActive(n,t)}onClose(e){let t=$(e.sender.element),n=t.closest(`.`+U.message);this.setActive(t,!1),this.trigger(`close`,{message:n})}executeCommand(e,t,n,r){this.trigger(`execute`,{type:e,item:t,file:n,message:r})}setActive(e,t){let n=e.closest(`.`+U.bubble);t?n.addClass(U.active):n.removeClass(U.active)}destroy(){this.dropdownButton&&=(this.dropdownButton.destroy(),null),super.destroy()}},Fe=class{constructor(e,t,n){this.$=e,this.support=t,this.inputService=n,this._fileGroupMap=this.createFileGroupMap(),this.fileSaver=document.createElement(`a`),this.downloadAttribute=`download`in this.fileSaver&&!this.support.browser.edge}createFileGroupMap(){return{audio:[`.aif`,`.iff`,`.m3u`,`.m4a`,`.mid`,`.mp3`,`.mpa`,`.wav`,`.wma`,`.ogg`,`.wav`,`.wma`,`.wpl`],video:[`.3g2`,`.3gp`,`.avi`,`.asf`,`.flv`,`.m4u`,`.rm`,`.h264`,`.m4v`,`.mkv`,`.mov`,`.mp4`,`.mpg`,`.rm`,`.swf`,`.vob`,`.wmv`],image:[`.ai`,`.dds`,`.heic`,`.jpe`,`jfif`,`.jif`,`.jp2`,`.jps`,`.eps`,`.bmp`,`.gif`,`.jpeg`,`.jpg`,`.png`,`.ps`,`.psd`,`.svg`,`.svgz`,`.tif`,`.tiff`],txt:[`.doc`,`.docx`,`.log`,`.pages`,`.tex`,`.wpd`,`.wps`,`.odt`,`.rtf`,`.text`,`.txt`,`.wks`],presentation:[`.key`,`.odp`,`.pps`,`.ppt`,`.pptx`],data:[`.xlr`,`.xls`,`.xlsx`],programming:`.tmp,.bak,.msi,.cab,.cpl,.cur,.dll,.dmp,.drv,.icns,.ico,.link,.sys,.cfg,.ini,.asp,.aspx,.cer,.csr,.css,.dcr,.htm,.html,.js,.php,.rss,.xhtml`.split(`,`),pdf:[`.pdf`],config:[`.apk`,`.app`,`.bat`,`.cgi`,`.com`,`.exe`,`.gadget`,`.jar`,`.wsf`],zip:[`.7z`,`.cbr`,`.gz`,`.sitx`,`.arj`,`.deb`,`.pkg`,`.rar`,`.rpm`,`.tar.gz`,`.z`,`.zip`,`.zipx`],"disc-image":[`.dmg`,`.iso`,`.toast`,`.vcd`,`.bin`,`.cue`,`.mdf`]}}get fileGroupMap(){return this._fileGroupMap}getFileGroup(e,t){let n=this._fileGroupMap,r=Object.keys(n),i=`file`;if(e===void 0||!e.length)return i;let a=e.toLowerCase();a.startsWith(`.`)||(a=`.`+a);for(let e=0;e<r.length;e+=1)if(n[r[e]].indexOf(a)>-1)return t?`file-`+r[e]:r[e];return i}getFileSizeMessage(e){let t=[`Bytes`,`KB`,`MB`,`GB`,`TB`];if(e===0)return`0 Byte`;let n=parseInt(String(Math.floor(Math.log(e)/Math.log(1024))),10);return Math.round(e/1024**n)+` `+t[n]}postToProxy(e,t,n,r){let i=this.$,a=i(`<form>`).attr({action:n,method:`POST`,target:r}),o=this.inputService.antiForgeryTokens();o.fileName=t;let s=e.split(`;base64,`);for(let e in o.contentType=s[0].replace(`data:`,``),o.base64=s[1],o)Object.prototype.hasOwnProperty.call(o,e)&&i(`<input>`).attr({value:o[e],name:e,type:`hidden`}).appendTo(a);a.appendTo(`body`).submit().remove()}saveAsBlob(e,t){let n=e;if(typeof e==`string`){let t=e.split(`;base64,`),r=t[0],i=atob(t[1]),a=new Uint8Array(i.length);for(let e=0;e<i.length;e++)a[e]=i.charCodeAt(e);n=new Blob([a.buffer],{type:r})}navigator.msSaveBlob(n,t)}saveAsDataURI(e,t){let n=e;window.Blob&&e instanceof Blob&&(n=URL.createObjectURL(e)),this.fileSaver.download=t,this.fileSaver.href=n;let r=document.createEvent(`MouseEvents`);r.initMouseEvent(`click`,!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.fileSaver.dispatchEvent(r),setTimeout(function(){URL.revokeObjectURL(n)})}saveAs(e){let t=this.postToProxy.bind(this);e.forceProxy||(this.downloadAttribute?t=this.saveAsDataURI.bind(this):navigator.msSaveBlob&&(t=this.saveAsBlob.bind(this))),t(e.dataURI,e.fileName,e.proxyURL,e.proxyTarget)}};let Ie=(e,t,n=T(L))=>new kendo.ui.Avatar(`<div>`,{type:`image`,image:e,alt:n.encode(t??``)}).wrapper[0].outerHTML,Le=()=>`<div class="${U.typingIndicator}">
        <span></span>
        <span></span>
        <span></span>
    </div>`,Re=(e,t,n=!0,r=T(L),i=T(Fe))=>{let a=t?new kendo.ui.Button(`<button class="" ${W.fileCloseButton}>`,{icon:V.x,fillMode:`flat`,size:`small`}).wrapper[0].outerHTML:``,o=n&&!t?new kendo.ui.Button(`<button class="${U.menuButton}" ${W.fileMenuButton}>`,{icon:V.attachmentMenu,fillMode:`flat`,size:`small`}).wrapper[0].outerHTML:``;return`<li class="${U.file}" data-uid="${r.encode(e.uid)}">
        ${kendo.ui.icon({icon:i.getFileGroup(e.extension,!0),size:`xlarge`})}
        <div class="${U.fileInfo}">
            <span class="${U.fileName}">${r.encode(e.name)}</span>
            <span class="${U.fileSize}">${r.encode(i.getFileSizeMessage(e.size))}</span>
        </div>
        ${a}
        ${o}
    </li>`},ze=(e,t,n,r,i=z.VERTICAL)=>{if(!e?.length)return``;let a=``;e.forEach(e=>{a+=Re(e,r??!1,!0)});let o=``;i===z.VERTICAL?o=` ${U.filesVertical}`:i===z.WRAP&&(o=` ${U.filesWrap}`);let s=`<ul class="${U.fileWrapper}${o}" ${W.fileWrapper}>`;return i===z.HORIZONTAL?s+=`<div class="${U.filesScroll}">${a}</div>`:s+=a,s+=`</ul>`,t&&e.length>1&&n?.downloadAll&&(s+=`<div class="${U.downloadButtonWrapper}">
            ${new kendo.ui.Button(`<button class="${U.downloadButton}">${n.downloadAll}</button>`,{icon:V.download,fillMode:`flat`,size:`small`}).wrapper[0].outerHTML}
        </div>`),s},Be=(e,t=T(L))=>{let{text:n,files:r,isOwnMessage:i,isPinMessage:a,isDeleted:o,renderCloseButton:s,renderFileMenuButton:c,messages:l}=e,u=i?U.messageReferenceSender:U.messageReferenceReceiver,d=a?U.messagePinned:``,f=a?W.pinnedMessageCloseButton:W.replyMessageCloseButton,p=a?W.messageReferencePinWrapper:W.messageReferenceReplyWrapper,m=t.convertTextUrlToLink(n||``);return m||=r?.length?Re(r[0],!1,c??!1):``,o&&l&&(m=i?t.encode(l.selfMessageDeleted):t.encode(l.otherMessageDeleted)),`<div class="${U.messageReference} ${u} ${d}" ${p}>
        ${a?kendo.ui.icon({icon:V.pin,size:`xlarge`}):``}
        <div class="${U.messageReferenceContent}">${m}</div>
        <span class="${U.spacer}"></span>
        ${s?new kendo.ui.Button(`<button ${f}>`,{icon:V.x,fillMode:`flat`}).wrapper[0].outerHTML:``}
    </div>`},Ve=/^(n|c|p|e)(\d*)$/i,He=/(\\.)|(googol)|(['][^']*[']?)|(["][^"]*["]?)/g,Ue=/\,/g;var We=class e{constructor(e){this.cultureService=e}format(e,t,n){let r=n?this.cultureService.getCulture(n):this.cultureService.culture(),i=r.numberFormat,a=i[`.`],o=i.decimals,s=i.pattern[0],c=[],l,u,d,f,p,m=e<0,h,g,_,v=``,y,b,x,S,C,w=-1,T;if(e===void 0)return``;if(!isFinite(e))return String(e);if(!t)return r.name.length?e.toLocaleString():e.toString();if(p=Ve.exec(t),p){if(t=p[1].toLowerCase(),u=t===`c`,d=t===`p`,(u||d)&&(i=u?i.currency:i.percent,a=i[`.`],o=i.decimals,l=i.symbol,s=i.pattern[m?0:1]),f=p[2],f&&(o=+f),t===`e`)return(f?e.toExponential(o):e.toExponential()).replace(`.`,i[`.`]);d&&(e*=100);let n=this.round(e,o);m=parseFloat(n)<0;let r=n.split(`.`);if(h=r[0],g=r[1],m&&(h=h.substring(1)),v=this.groupInteger(h,0,h.length,i),g&&(v+=a+g),t===`n`&&!m)return v;let c=``;for(let e=0,t=s.length;e<t;e++){let t=s.charAt(e);t===`n`?c+=v:t===`$`||t===`%`?c+=l:c+=t}return c}t=this.extractLiterals(t,c);let E=t.split(`;`),D=this.selectFormatSection(E,m,e);if(t=D.format,x=D.hasNegativeFormat,D.isZeroFormat)return t;let O=t.indexOf(`%`),k=t.indexOf(`$`);d=O!==-1,u=k!==-1,d&&(e*=100),u&&t[k-1]===`\\`&&(t=t.split(`\\`).join(``),u=!1),(u||d)&&(i=u?i.currency:i.percent,a=i[`.`],o=i.decimals,l=i.symbol),b=t.indexOf(`,`)>-1,b&&(t=t.replace(Ue,``));let A=this.calculateDecimalPrecision(t,e,m);t=A.format,S=A.decimalIndex,y=A.length;let j=A.number,M=this.findPlaceholderPositions(t);if(w=M.start,T=M.end,C=M.zeroIndex,w===y&&(T=w),w!==-1){let e=j.toString().split(`.`);h=e[0],g=e[1]||``,_=h.length,m&&parseFloat(j)*-1>=0&&(m=!1);let n=this.applyPatternToNumber(t,w,T,y,m,x,S,h,g,a,C);return b&&(n=this.groupInteger(n,w+(m&&!x?1:0),Math.max(T,_+w),i)),T>=w&&(n+=t.substring(T+1)),(u||d)&&(n=this.replaceSymbols(n,l)),c.length&&(n=this.replaceLiterals(n,c)),n}return String(j)}replaceSymbols(e,t){let n=``;for(let r=0,i=e.length;r<i;r++){let i=e.charAt(r);n+=i===`$`||i===`%`?t:i}return n}replaceLiterals(e,t){for(let n=0;n<t.length;n++)e=e.replace(`??`,t[n]);return e}applyPatternToNumber(e,t,n,r,i,a,o,s,c,l,u){let d=e.substring(0,t),f=``,p=s.length;i&&!a&&(d+=`-`);let m=t;for(;m<r;){let t=e.charAt(m);if(o===-1){if(n-m<p){d+=s;break}}else if(u!==-1&&u<m&&(f=``),o-m<=p&&o-m>-1&&(d+=s,m=o),o===m){d+=(c?l:``)+c,m+=n-o+1;continue}t===`0`?(d+=t,f=t):t===`#`&&(d+=f),m++}return d}selectFormatSection(e,t,n){let r,i=!1,a=!1;return t&&e[1]?(r=e[1],i=!0):n===0&&e[2]?(r=e[2],r.indexOf(`#`)===-1&&r.indexOf(`0`)===-1&&(a=!0)):r=e[0],{format:r,hasNegativeFormat:i,isZeroFormat:a}}calculateDecimalPrecision(e,t,n){let r=e.indexOf(`.`),i=0,a=e.length,o,s,c,l,u,d;if(r!==-1){let f=t.toString().split(`e`);if(o=f[1]?this.round(t,Math.abs(parseInt(f[1],10))):f[0],o=o.split(`.`)[1]||``,s=e.lastIndexOf(`0`)-r,c=e.lastIndexOf(`#`)-r,l=s>-1,u=c>-1,i=o.length,!l&&!u&&(e=e.substring(0,r)+e.substring(r+1),a=e.length,r=-1,i=0),l&&s>c)i=s;else if(c>s)if(u&&i>c){for(d=this.round(t,c,n);d.charAt(d.length-1)===`0`&&c>0&&c>s;)c--,d=this.round(t,c,n);i=c}else l&&i<s&&(i=s)}let f=this.round(t,i,n);return{format:e,decimalIndex:r,length:a,number:f}}findPlaceholderPositions(e){let t=e.indexOf(`#`),n=e.indexOf(`0`),r,i,a;return r=t===-1&&n!==-1?n:t!==-1&&n===-1?t:t>n?n:t,t=e.lastIndexOf(`#`),a=e.lastIndexOf(`0`),i=t===-1&&a!==-1?a:t!==-1&&a===-1||t>a?t:a,{start:r,end:i,zeroIndex:a}}extractLiterals(e,t){return(e.indexOf(`'`)>-1||e.indexOf(`"`)>-1||e.indexOf(`\\`)>-1)&&(e=e.replace(He,e=>{let n=e.charAt(0).replace(`\\`,``),r=e.slice(1).replace(n,``);return t.push(r),`??`})),e}groupInteger(e,t,n,r){let i=e.indexOf(r[`.`]),a=r.groupSize.slice(),o=a.shift(),s,c,l,u,d,f;if(n=i===-1?n+1:i,s=e.substring(t,n),c=s.length,c>=o){for(l=c,u=[];l>-1;)if(d=s.substring(l-o,l),d&&u.push(d),l-=o,f=a.shift(),o=f===void 0?o:f,o===0){l>0&&u.push(s.substring(0,l));break}s=u.reverse().join(r[`,`]),e=e.substring(0,t)+s+e.substring(n)}return e}round(t,n,r){return e.round(t,n,r)}static round(e,t,n){t||=0;let r=e.toString().split(`e`),i=Math.round(+(r[0]+`e`+(r[1]?+r[1]+t:t)));return n&&(i=-i),r=i.toString().split(`e`),(+(r[0]+`e`+(r[1]?+r[1]-t:-t))).toFixed(Math.min(t,20))}};let Ge=/\{(\d+)(:[^\}]+)?\}/g,Ke={}.toString;var qe=class{constructor(e,t){this.numberFormatter=e,this.dateFormatter=t}toString(e,t,n){if(t){if(Ke.call(e)===`[object Date]`)return this.dateFormatter.format(e,t,n);if(typeof e==`number`)return this.numberFormatter.format(e,t,n)}return e===void 0?``:e}format(e,...t){return e.replace(Ge,(e,n,r)=>{let i=t[parseInt(n,10)],a=this.toString(i,r?r.substring(1):``);return String(a)})}extractFormat(e){return e.slice(0,3)===`{0:`&&(e=e.slice(3,e.length-1)),e}getNumberFormatter(){return this.numberFormatter}getDateFormatter(){return this.dateFormatter}static round(e,t,n){return We.round(e,t,n)}};let Je={G:`era`,y:`year`,q:`quarter`,Q:`quarter`,M:`month`,L:`month`,d:`day`,E:`weekday`,c:`weekday`,e:`weekday`,h:`hour`,H:`hour`,k:`hour`,K:`hour`,m:`minute`,s:`second`,a:`dayperiod`,t:`dayperiod`,x:`zone`,X:`zone`,z:`zone`,Z:`zone`},Ye={month:{type:`months`,minLength:3,standAlone:`L`},quarter:{type:`quarters`,minLength:3,standAlone:`q`},weekday:{type:`days`,minLength:{E:0,c:3,e:3},standAlone:`c`},dayperiod:{type:`dayPeriods`,minLength:0},era:{type:`eras`,minLength:0}};var Xe=class{constructor(e,t){this.cultureService=e,this.formatterService=t,this.MS_PER_MINUTE=6e4,this.MS_PER_HOUR=60*6e4,this.MS_PER_DAY=864e5}adjustDST(e,t){return t===0&&e.getHours()===23?(e.setHours(e.getHours()+2),!0):!1}setDayOfWeek(e,t,n=1){let r=e.getHours();t=(t-e.getDay()+7*n)%7,e.setDate(e.getDate()+t),this.adjustDST(e,r)}dayOfWeek(e,t,n){return e=new Date(e),this.setDayOfWeek(e,t,n),e}firstDayOfMonth(e){return new Date(e.getFullYear(),e.getMonth(),1)}lastDayOfMonth(e){let t=new Date(e.getFullYear(),e.getMonth()+1,0),n=this.firstDayOfMonth(e),r=Math.abs(t.getTimezoneOffset()-n.getTimezoneOffset());return r&&t.setHours(n.getHours()+r/60),t}firstDayOfYear(e){return new Date(e.getFullYear(),0,1)}lastDayOfYear(e){return new Date(e.getFullYear(),11,31)}moveDateToWeekStart(e,t){return t===1?this.addDays(e,4-(e.getDay()||7)):this.addDays(this.dayOfWeek(e,t,-1),4)}calcWeekInYear(e,t){let n=new Date(e.getFullYear(),0,1,-6),r=this.moveDateToWeekStart(e,t).getTime()-n.getTime(),i=Math.floor(r/this.MS_PER_DAY);return 1+Math.floor(i/7)}weekInYear(e,t){t===void 0&&(t=this.cultureService.culture().calendar.firstDay);let n=this.addDays(e,-7),r=this.addDays(e,7),i=this.calcWeekInYear(e,t);return i===0?this.calcWeekInYear(n,t)+1:i===53&&this.calcWeekInYear(r,t)>1?1:i}getDate(e){return e=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0),this.adjustDST(e,0),e}toUtcTime(e){return Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}getMilliseconds(e){return this.toInvariantTime(e).getTime()-this.getDate(this.toInvariantTime(e)).getTime()}isInTimeRange(e,t,n){let r=this.getMilliseconds(t),i=this.getMilliseconds(n);if(!e||r===i)return!0;t>=n&&(i+=this.MS_PER_DAY);let a=this.getMilliseconds(e);return r>a&&(a+=this.MS_PER_DAY),i<r&&(i+=this.MS_PER_DAY),a>=r&&a<=i}isInDateRange(e,t,n){let r=t.getTime(),i=n.getTime();r>=i&&(i+=this.MS_PER_DAY);let a=e.getTime();return a>=r&&a<=i}addDays(e,t){let n=e.getHours();return e=new Date(e),this.setTime(e,t*this.MS_PER_DAY),this.adjustDST(e,n),e}setTime(e,t,n){let r=e.getTimezoneOffset();if(e.setTime(e.getTime()+t),!n){let t=e.getTimezoneOffset()-r;e.setTime(e.getTime()+t*this.MS_PER_MINUTE)}}setHours(e,t){return e=new Date(e.getFullYear(),e.getMonth(),e.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),this.adjustDST(e,t.getHours()),e}today(){return this.getDate(new Date)}isToday(e){return this.getDate(e).getTime()===this.today().getTime()}toInvariantTime(e){let t=new Date(1980,1,1,0,0,0);return e&&t.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),t}addYear(e,t){let n=new Date(e);return new Date(n.setFullYear(n.getFullYear()+t))}nextDay(e){return this.addDays(e,1)}previousDay(e){return this.addDays(e,-1)}nextYear(e){return this.addYear(e,1)}previousYear(e){return this.addYear(e,-1)}addLiteral(e,t){let n=e[e.length-1];n&&n.type===`LITERAL`?n.pattern+=t:e.push({type:`literal`,pattern:t})}isHour12(e){return e===`h`||e===`K`}dateNameType(e){if(e<=3)return`abbreviated`;if(e===4)return`wide`;if(e===5)return`narrow`}startsWith(e,t,n=0){return e.indexOf(t,n)===n}datePattern(e,t){let n=t.calendar,r;return typeof e==`string`&&(r=n.patterns[e]?n.patterns[e]:e),r||=n.patterns.d,r}splitDateFormat(e){let t=this.cultureService.culture(),n=this.datePattern(e,t).replaceAll(`dddd`,`EEEE`).replaceAll(`ddd`,`EEE`).replace(`tt`,`aa`),r=[],i=/d{1,2}|E{1,6}|e{1,6}|c{3,6}|c{1}|M{1,5}|L{1,5}|y{1,4}|H{1,2}|h{1,2}|k{1,2}|K{1,2}|m{1,2}|a{1,5}|s{1,2}|S{1,3}|t{1,2}|z{1,4}|Z{1,5}|x{1,5}|X{1,5}|G{1,5}|q{1,5}|Q{1,5}|"[^"]*"|'[^']*'/g,a=i.lastIndex=0,o=i.exec(n);for(;o;){let e=o[0];if(a<o.index&&this.addLiteral(r,n.substring(a,o.index)),this.startsWith(e,`"`)||this.startsWith(e,`'`))this.addLiteral(r,e);else{let t=e[0],n=Je[t],i={type:n,pattern:e};n===`hour`&&(i.hour12=this.isHour12(e));let a=Ye[n];if(a){let n=typeof a.minLength==`number`?a.minLength:a.minLength[t],r=e.length;r>=n&&e!==`aa`&&(i.names={type:a.type,nameType:this.dateNameType(r)||`abbreviated`,standAlone:a.standAlone===t})}r.push(i)}a=i.lastIndex,o=i.exec(n)}return a<n.length&&this.addLiteral(r,n.substring(a)),r}dateFormatNames(e){let{type:t,nameType:n}=e,r=this.cultureService.culture();n===`wide`&&(n=`names`),n===`abbreviated`&&(n=`namesAbbr`),n===`narrow`&&(n=`namesShort`);let i=r.calendar[t]?.[n];return i||=r.calendar[t]?.name,i||[]}dateFieldName(e){return(this.cultureService.culture().calendar.dateFields?.[e.type]||{})[e.nameType]}getRelativeDateString(e,t=new Date){if(!e)return``;let n=new Date(t);n.setHours(0,0,0,0);let r=new Date(e);r.setHours(0,0,0,0);let i=n.getTime()-r.getTime(),a=Math.floor(i/this.MS_PER_DAY);return a===0?`Today`:a===1?`Yesterday`:a<=6?`Last ${this.formatterService.toString(r,`dddd`)}`:String(this.formatterService.toString(r,`dddd, MMMM dd, yyyy`))}};let Ze=(e,t)=>e.failed?kendo.html.renderButton(`<button class="${U.messageRetryButton}" ${W.retryButton} title="${t}" aria-label="${t}" data-uid="${e.uid||``}"></button>`,{icon:V.retry,size:`small`,fillMode:`flat`}):``,Qe=(e,t,n,r=T(L),i)=>{if(!e)return``;if(n)return n({status:e,message:t});let a=i?.[e],o=e===Ee.FAILED?`${U.messageStatus} ${U.messageFailed}${a?.cssClass?` `+a.cssClass:``}`:`${U.messageStatus}${a?.cssClass?` `+a.cssClass:``}`,s=``;a?.icon?s=kendo.ui.icon({icon:a.icon}):a?.svgIcon&&(s=kendo.ui.icon({icon:a.svgIcon}));let c=a?.text===void 0?e.charAt(0).toUpperCase()+e.slice(1):a.text;return`<span class="${o}">${s}${r.encode(c)}</span>`},$e=(e,t,n,r=T(L))=>{if(n)return n({attachment:e,message:t});let i=e.title?`<div class="${U.cardTitle}">${r.encode(e.title)}</div>`:``,a=e.subtitle?`<div class="${U.cardSubtitle}">${r.encode(e.subtitle)}</div>`:``,o=e.thumbnailUrl?`<div class="${U.cardMedia}"><img src="${r.encode(e.thumbnailUrl)}" alt="" /></div>`:``,s=e.actions?.length?`<div class="${U.cardActions}">${e.actions.map(e=>`<button class="${U.cardAction} ${U.button}">${r.encode(e.text)}</button>`).join(``)}</div>`:``;return`<div class="${U.card}">
        ${o}
        <div class="${U.cardBody}">
            ${i}
            ${a}
        </div>
        ${s}
    </div>`},et=(e,t,n=`list`,r)=>{if(!e?.length)return``;let i=e.map(e=>$e(e,t,r)).join(``);return`<div class="${n===`carousel`?U.cardDeckScrollWrap:U.cardList}">${i}</div>`},tt=(e,t,n,r,i,a,o,s,c=z.VERTICAL,l=T(L),u=T(qe),d=T(Ce),f,p,m)=>{let h=e.isDeleted,g=e.failed||e.status===Ee.FAILED,_=i&&!e.isTyping?[U.bubbleExpandable,U.expanded]:[],v=t?Be({text:t.text,files:t.files,isOwnMessage:t.isOwnMessage,isPinMessage:!1,renderCloseButton:!1,renderFileMenuButton:!1}):``,y=``;y=e.isTyping&&!e.isOwnMessage?Le():f&&!h?f(e):h?e.isOwnMessage?l.encode(r.selfMessageDeleted):l.encode(r.otherMessageDeleted):l.convertTextUrlToLink(e.text||``,o);let b=h?``:et(e.attachments,e,m||e.attachmentLayout||`list`,p),x=`<time class="${U.messageTime}">${u.toString(d.parseDate(e.timestamp),a)}</time>`,S=Qe(e.status,e,s,l),C=g?Ze(e,r.retryMessage||`Retry`):``,w=`<div class="${U.messageInfo}">${x}${S}${C}</div>`;return`<div class="${U.message}${h?` `+U.messageRemoved:``}${g?` `+U.messageFailed:``}" data-uid="${l.encode(e.uid??``)}">
        <div class="${U.chatBubble} ${U.bubble} ${_.join(` `)}">
            <div class="${U.bubbleContent}">
                ${v}
                <span class="${U.chatBubbleText}">${y}</span>
                ${h?``:ze(e.files,n,r,!1,c)}
                ${b}
            </div>
            ${i&&!e.isTyping?`<span class="${U.bubbleExpandableIndicator}" ${W.bubbleExpandableIndicator}>${kendo.ui.icon({icon:V.chevronUp})}</span>`:``}
        </div>
        ${w}
        ${h?``:`<div class="${U.messageToolbar}"></div>`}
    </div>`},nt=(e,t=T(F),n=T(Xe),r=T(L),i=T(Ce))=>{let{message:a,author:o,isOwnMessage:s,replyMessage:c,downloadAll:l=!0,messages:u,expandable:d=!1,fullWidth:f=!1,messageTimeFormat:p=`ddd MMM dd yyyy`,timestampTemplate:m,statusTemplate:h,showTimestamp:g=!1,messageTemplate:_,skipSanitization:v=!1,messageSettings:y,filesLayoutMode:b=z.VERTICAL,contentTemplate:x,authorMessageContentTemplate:S,receiverMessageContentTemplate:C,attachmentTemplate:w,attachmentLayout:E,userStatusTemplate:D}=e,O=s?S||x:C||x,k=y?.showAvatar===void 0?o&&o.imageUrl:y.showAvatar&&o&&o.imageUrl,A=y?.showUsername===void 0?!0:y.showUsername,j=y?.allowMessageCollapse===void 0?d:y.allowMessageCollapse,M=y?.messageWidthMode===`full`||f,ee=[U.messageGroup,s?U.messageGroupSender:U.messageGroupReceiver,k?``:U.noAvatar,M?U.messageGroupFullWidth:``].filter(Boolean).join(` `),N=``;if(g&&a.timestamp){let e=i.parseDate(a.timestamp);if(t.isFunction(m))N=m({date:e,message:a});else{let t=n.getRelativeDateString(e);N=`<div class="${U.timestamp}">${t}</div>`}}let te=D?D({author:o}):``,P;return P=_?_({...a,isOwnMessage:s,author:o},c??null,l,u,j,p,v):tt({...a,isOwnMessage:s,author:o},c??null,l,u,j,p,v,h,b,r,void 0,void 0,O,w,E),`${g&&N?N:``}
        <div class="${ee}">${te}
            ${k?Ie(o.imageUrl,o.imageAltText):``}
            <div class="${U.messageGroupContent}">
                ${A?`<span class="${U.messageAuthor}">${r.encode(o.name??``)}</span>`:``}
                ${P}
            </div>
        </div>`},rt=(e,t=T(L))=>{if(!e?.length)return``;let n=e.map(e=>`<span class="${U.suggestion}">${t.encode(e.text)}</span>`).join(``);return`<div class="${U.suggestionGroup}" ${W.suggestionGroup}>${n}</div>`},it=(e,t=B.SCROLL,n=!1,r=T(L))=>e?.length?at(e.map(e=>`<span class="${U.suggestion}">${r.encode(e.text)}</span>`).join(``),t,n):``,at=(e,t=B.SCROLL,n=!1)=>{if(!e)return``;if(t===B.WRAP)return`<div class="${U.suggestionGroup}" ${W.suggestionGroup}>${e}</div>`;let r=t===B.SCROLL?U.suggestionGroupScrollable:``,i=r?`${U.suggestionGroup} ${r}`:U.suggestionGroup,a=`<div class="${U.suggestionsScroll}">${e}</div>`,o=`<div class="${i}" ${W.suggestionGroup}>${a}</div>`;return t===B.SCROLLBUTTONS?ot(o,n):o},ot=(e,t)=>{let n=t?V.chevronRight:V.chevronLeft,r=t?V.chevronLeft:V.chevronRight;return`<div class="${U.suggestionScrollWrap} ${U.suggestionScrollWrapGradient}">
        ${new kendo.ui.Button(`<button ${W.leftScrollButton}>`,{icon:n}).wrapper[0].outerHTML}
        ${e}
        ${new kendo.ui.Button(`<button ${W.rightScrollButton}>`,{icon:r}).wrapper[0].outerHTML}
    </div>`},st=(e,t)=>{if(t)return`<div class="${U.header}">${t()}</div>`;if(!e||e.length===0)return``;let n=$(`<div class="${U.header}">`);return new kendo.ui.ToolBar(n,{items:e}),n[0].outerHTML};var ct=class{constructor(e){this.context=e}renderMessage(e){let t=this.context.options,n=t.messages,r=t.allowMessageCollapse,i=t.messageWidthMode===Te.FULL,a={id:e.authorId,name:e.authorName,imageUrl:e.authorImageUrl,imageAltText:e.authorImageAltText},o=a.id===t.authorId,s=this.context.getReplyMessage(e),c=t.messageTimeFormat,l=t.skipSanitization,u=t.messageStatusTemplate,d=o?t.authorMessageSettings:t.receiverMessageSettings,f=this._mergeMessageSettings(t,d);if(this._handleExistingMessageUpdate({message:e,author:a,isOwnMessage:o,replyMessage:s,componentMessages:n,expandable:r,messageTimeFormat:c,skipSanitization:l,statusTemplate:u,messageSettings:f}))return;let p=this._findTargetMessageGroup();if(this._canGroupWithLastMessage(p,a.id)&&p.length)this._addMessageToExistingGroup({message:e,author:a,isOwnMessage:o,replyMessage:s,componentMessages:n,expandable:r,targetGroupElement:p,messageTimeFormat:c,skipSanitization:l,statusTemplate:u,messageSettings:f});else{let t=this._shouldShowTimestamp(e);this._createNewMessageGroup({message:e,author:a,isOwnMessage:o,replyMessage:s,componentMessages:n,expandable:r,fullWidth:i,messageTimeFormat:c,showTimestamp:t,skipSanitization:l,statusTemplate:u,messageSettings:f})}}_mergeMessageSettings(e,t){let n={showAvatar:e.showAvatar,showUsername:e.showUsername,showTimestamp:e.timestampVisibility!==`never`,allowMessageCollapse:e.allowMessageCollapse,messageWidthMode:e.messageWidthMode};return t&&(t.showAvatar!==void 0&&(n.showAvatar=t.showAvatar),t.showUsername!==void 0&&(n.showUsername=t.showUsername),t.showTimestamp!==void 0&&(n.showTimestamp=t.showTimestamp),t.allowMessageCollapse!==void 0&&(n.allowMessageCollapse=t.allowMessageCollapse),t.messageWidthMode!==void 0&&(n.messageWidthMode=t.messageWidthMode),t.enableFileActions!==void 0&&(n.enableFileActions=t.enableFileActions),t.enableContextMenuActions!==void 0&&(n.enableContextMenuActions=t.enableContextMenuActions),t.messageToolbarActions!==void 0&&(n.messageToolbarActions=t.messageToolbarActions),t.messageActions!==void 0&&(n.messageActions=t.messageActions)),n}_shouldShowTimestamp(e){if(!e.timestamp)return!1;let t=this.context.list.find(`.`+U.message).filter(function(){return $(this).find(`.`+U.typingIndicator).length===0}).last();if(!t.length)return!0;let n=this.context.dataItem(t);if(!n||!n.timestamp)return!0;let r=this.context.dateParserService.parseDate(e.timestamp),i=this.context.dateParserService.parseDate(n.timestamp);if(!r||!i)return!1;let a=new Date(r);a.setHours(0,0,0,0);let o=new Date(i);return o.setHours(0,0,0,0),a.getTime()!==o.getTime()}_handleExistingMessageUpdate(e){let{message:t,author:n,isOwnMessage:r,replyMessage:i,componentMessages:a,expandable:o,messageTimeFormat:s,skipSanitization:c,statusTemplate:l,messageSettings:u}=e,d=this.context.options,f=this.context.list.find(`.`+U.message+`[data-uid="${this.context.htmlService.encode(t.uid??``)}"]`);if(f.length){let e=d.messageTemplate,p;p=e?e({...t,isOwnMessage:r,author:n},i,!0,a,u?.allowMessageCollapse??o,s,c,l):tt({...t,isOwnMessage:r,author:n},i,!0,a,u?.allowMessageCollapse??o,s,c,l,d.filesLayoutMode,this.context.htmlService);let m=$(p);return f.replaceWith(m),this.context.initMessageToolbar(m.find(`.`+U.messageToolbar)),this.context.initFileMenus(m),!0}return!1}_findTargetMessageGroup(){let e=this.context.list.children(`.`+U.messageGroup).last(),t=e,n=e.find(`.`+U.message);return n.length===1&&n.first().find(`.`+U.typingIndicator).length>0&&(t=e.prev(`.`+U.messageGroup)),t}_canGroupWithLastMessage(e,t){let n=e.find(`.`+U.message).filter(function(){return $(this).find(`.`+U.typingIndicator).length===0}).last();return this.context.dataItem(n)?.authorId===t}_addMessageToExistingGroup(e){let{message:t,author:n,isOwnMessage:r,replyMessage:i,componentMessages:a,expandable:o,targetGroupElement:s,messageTimeFormat:c,skipSanitization:l,statusTemplate:u,messageSettings:d}=e,f=this.context.options,p=f.messageTemplate,m=s.find(`.`+U.messageGroupContent),h;h=p?p({...t,isOwnMessage:r,author:n},i,!0,a,d?.allowMessageCollapse??o,c,l,u):tt({...t,isOwnMessage:r,author:n},i,!0,a,d?.allowMessageCollapse??o,c,l,u,f.filesLayoutMode,this.context.htmlService);let g=$(h);m.append(g),this.context.initMessageToolbar(g.find(`.`+U.messageToolbar)),this.context.initFileMenus(g),this._moveTypingIndicatorsToEnd()}_createNewMessageGroup(e){let{message:t,author:n,isOwnMessage:r,replyMessage:i,componentMessages:a,expandable:o,fullWidth:s,messageTimeFormat:c,showTimestamp:l,skipSanitization:u,statusTemplate:d,messageSettings:f}=e,p=this.context.options,m=p.messageGroupTemplate,h=p.timestampTemplate,g=p.messageTemplate,_=$(m({message:t,author:n,isOwnMessage:r,replyMessage:i,downloadAll:!0,messages:a,expandable:o,fullWidth:s,messageTimeFormat:c,timestampTemplate:h,statusTemplate:d,showTimestamp:l,messageTemplate:g,skipSanitization:u,messageSettings:f,filesLayoutMode:p.filesLayoutMode,contentTemplate:p.messageContentTemplate,authorMessageContentTemplate:p.authorMessageContentTemplate,receiverMessageContentTemplate:p.receiverMessageContentTemplate,attachmentTemplate:p.attachmentTemplate,attachmentLayout:p.attachmentLayout,userStatusTemplate:p.userStatusTemplate}));return this.context.list.append(_),this.context.initMessageToolbar(_.find(`.`+U.messageToolbar)),this.context.initFileMenus(_),this._moveTypingIndicatorsToEnd(),_}_moveTypingIndicatorsToEnd(){let e=this.context,t=e.options,n=t.messageGroupTemplate,r=t.messageWidthMode===Te.FULL;e.list.find(`.`+U.message).filter(function(){return $(this).find(`.`+U.typingIndicator).length>0}).each(function(){let i=$(this),a=i.closest(`.`+U.messageGroup);if(a.find(`.`+U.message).length===1)a.detach().appendTo(e.list);else{i.remove();let a=e.dataItem(i);if(!a)return;let o={id:a.authorId,name:a.authorName,imageUrl:a.authorImageUrl,imageAltText:a.authorImageAltText},s=$(n({message:a,author:o,isOwnMessage:o.id===t.authorId,fullWidth:r,messageTimeFormat:t.messageTimeFormat,showTimestamp:!1,timestampTemplate:t.timestampTemplate,messageTemplate:t.messageTemplate,filesLayoutMode:t.filesLayoutMode}));e.list.append(s)}})}},lt=class{constructor(e){this.scrollToBottomButton=null,this._scrollHandler=null,this._clickHandler=null,this.context=e,this._initScrollToBottomButton(),this._attachEvents()}_initScrollToBottomButton(){if(this.context.options.scrollToBottomButton===!1){this.scrollToBottomButton=null;return}let e=kendo.html.renderButton(`<button class="${U.scrollFab} ${U.hidden}" ${W.scrollToBottomButton} aria-label="Scroll to bottom"></button>`,{icon:V.arrowDown,rounded:`full`});this.scrollToBottomButton=$(e).appendTo(this.context.element);let t={position:`sticky`,bottom:`16px`,transform:`translateX(-50%)`,zIndex:1},n=this.context.element.css(`direction`)===`rtl`;t[n?`right`:`left`]=`50%`,this.scrollToBottomButton.css(t)}_attachEvents(){this._scrollHandler=this._onScroll.bind(this),this._clickHandler=this._scrollToBottomButtonClick.bind(this),this.context.element.on(`scroll`+R+`.scrollManager`,this._scrollHandler).on(K+R+`.scrollManager`,`[${W.scrollToBottomButton}]`,this._clickHandler)}_updateScrollToBottomButtonVisibility(){if(!this.scrollToBottomButton)return;let e=this.context.element.scrollTop()||0,t=this.context.element.prop(`scrollHeight`)||0,n=this.context.element.prop(`clientHeight`)||0;t-e-n>100?this.scrollToBottomButton.removeClass(U.hidden):this.scrollToBottomButton.addClass(U.hidden)}_onScroll(){this._updateScrollToBottomButtonVisibility()}_scrollToBottomButtonClick(e){e.preventDefault(),this.scrollToBottom()}scrollToBottom(){this.context.element.scrollTop(this.context.element.prop(`scrollHeight`))}scrollToMessage(e){if(!e)return!1;let t=this.context.list.find(`.`+U.message+`[data-uid="${this.context.htmlService.encode(e)}"]`);if(!t.length)return!1;let n=this.context.element.find(`.`+U.messagePinned),r=n.length&&n.outerHeight()||0;return this.context.domUtilsService.scrollToElement(this.context.element,t,{position:`top`,offset:-r})}destroy(){this.scrollToBottomButton&&=(this.scrollToBottomButton.remove(),null),this.context.element.off(R+`.scrollManager`)}},ut=class{constructor(e){this.context=e}renderSuggestedActions(){let e=this.context.options,t=this.context.dataManager.getLastMessage()?.suggestedActions||[],n=at(e.suggestedActionsTemplate(t),this._getSuggestedActionsLayoutMode(e),e.dir===`rtl`);this.removeSuggestedActions(),this.context.list.append(t.length?n:``),this.context.list.find(`[${W.leftScrollButton}]`).addClass(U.disabled)}removeSuggestedActions(){this.context.list.find(`.`+U.suggestionGroup).remove(),this.context.list.find(`.`+U.suggestionScrollWrap).remove()}_getSuggestedActionsLayoutMode(e){return e.suggestedActionsLayoutMode?e.suggestedActionsLayoutMode:e.suggestedActionsScrollable?B.SCROLLBUTTONS:B.SCROLL}},dt=class e extends I{static{this.options={name:`ChatView`}}constructor(t,n,r){super(t,$.extend(!0,{},e.options,n)),this._dragHandler=null,this.events=[G.suggestedActionClick,G.messageToolbarExecute,G.fileMenuExecute,G.downloadAllFiles,G.expandableToggle,G.resendMessage],this.context=r,this._initList(),this._initHelpers(),this._attachEvents()}_initList(){let e=this.options.messages;this.element.addClass(U.viewWrapper).attr(`role`,`log`).attr(`aria-label`,e.messageListLabel),this.list=$(`<div>`).addClass(U.messageListContent).appendTo(this.element)}_initHelpers(){let e=this.options;this._messageRenderer=new ct({list:this.list,options:e,dataManager:this.context.dataManager,htmlService:this.context.htmlService,dateParserService:this.context.dateParserService,dataItem:this.dataItem.bind(this),getReplyMessage:this.getReplyMessage.bind(this),initMessageToolbar:this._initMessageToolbar.bind(this),initFileMenus:this._initFileMenus.bind(this)}),this._scrollManager=new lt({element:this.element,options:e,list:this.list,domUtilsService:this.context.domUtilsService,htmlService:this.context.htmlService}),this._suggestionRenderer=new ut({list:this.list,options:e,dataManager:this.context.dataManager})}_attachEvents(){this.element.on(K+R,this._listClick.bind(this)).on(K+R,`.`+U.message,this._messageClick.bind(this)).on(K+R,`.`+U.suggestion,this._suggestionClick.bind(this)).on(K+R,`[${W.leftScrollButton}]`,this._leftScrollButtonClick.bind(this)).on(K+R,`[${W.rightScrollButton}]`,this._rightScrollButtonClick.bind(this)).on(K+R,`.`+U.downloadButton,this._downloadAllClick.bind(this)).on(K+R,`[${W.retryButton}]`,this._retryButtonClick.bind(this)),this._attachDragToScrollEvents()}_attachDragToScrollEvents(){this._dragHandler=this.context.domUtilsService.createDragToScrollHandler(this.element,{namespace:R+`.chatViewDrag`,captureElement:this.element,delegateSelector:`.`+U.suggestionsScroll}),this._dragHandler.attach()}_retryButtonClick(e){e.preventDefault(),e.stopPropagation();let t=$(e.currentTarget),n=t.attr(`data-uid`),r=t.closest(`.`+U.message),i=this._getMessageFromElement(r);this.trigger(G.resendMessage,{message:i,uid:n})}_getMessageFromElement(e){let t=e.attr(`data-uid`);return t?(this.options.dataSource?.data()||[]).find(e=>e.uid===t)||{uid:t}:null}renderMessage(e){this._messageRenderer.renderMessage(e)}_initMessageToolbar(e){let t=this.options,n=t.messageToolbarActions;if(!n||!n.length||!e.length){e.remove();return}new Ne(e,{items:n,dir:t.dir,messages:t.messages,resizable:!1}).bind(`execute`,e=>this.trigger(G.messageToolbarExecute,e))}_initFileMenus(e){let t=this.options.fileActions,n=e.find(`[${W.fileMenuButton}]`);if(!t||!t.length||!e.length){n.remove();return}n.each((e,n)=>{let r=$(n);r.data(`kendoDropDownButton`)||new Pe(r,{items:t}).bind(`execute`,e=>this.trigger(G.fileMenuExecute,e))})}dataItem(e){let t=e&&e.data(`uid`);return t?this.context.dataManager.getMessageByUid(t):null}fileDataItem(e,t){let n=t&&t.data(`uid`);return n?this.context.dataManager.getFileByUid(e,n):null}getReplyMessage(e){if(!e?.replyToId)return null;let t=this.context.dataManager.getMessageById(e.replyToId);return t&&(t.isOwnMessage=t.authorId===this.options.authorId),t}renderSuggestedActions(){this._suggestionRenderer.renderSuggestedActions()}clearMessages(){this.list.find(`.`+U.messageGroup).remove(),this.list.find(`.`+U.timestamp).remove(),this._suggestionRenderer.removeSuggestedActions()}removeMessage(e){let t=this.list.find(`.`+U.message+`[data-uid="${this.context.htmlService.encode(e)}"]`);if(!t.length)return!1;let n=t.closest(`.`+U.messageGroup);return n.find(`.`+U.message).length===1?n.remove():t.remove(),!0}scrollToBottom(){this._scrollManager.scrollToBottom()}scrollToMessage(e){return this._scrollManager.scrollToMessage(e)}refreshDataManager(e){this.context.dataManager=e}showNoData(e){this.list.html(e)}hasMessages(){return this.list.children(`.`+U.messageGroup).length>0}_listClick(e){let t=$(e.target);t.hasClass(U.message)||t.parents(`.`+U.message).length||this._clearSelection(t)}_suggestionClick(e){let t=$(e.currentTarget);t.length&&this.trigger(G.suggestedActionClick,{text:t.text()})}_messageClick(e){let t=$(e.target),n=t.closest(`[${W.bubbleExpandableIndicator}]`);if(!this._allowMessageClick(t)){if(this._clearSelection(t),n.length){let e=n.closest(`.`+U.bubble),t=e.hasClass(U.expanded);e.toggleClass(U.expanded,!t),n.html(kendo.ui.icon({icon:t?V.chevronDown:V.chevronUp})),this.trigger(G.expandableToggle,{indicator:n,isExpanded:!t});return}$(e.currentTarget).find(`.`+U.bubble).addClass(U.selected)}}_allowMessageClick(e){let t=[`[${W.fileMenuButton}]`,`.`+U.messageToolbar,`.`+U.typingIndicator,`.`+U.downloadButton].join(`, `);return e.closest(t).length>0||e.children(t).length>0||e.is(t)}_clearSelection(e){let t=this.element.find(`.`+U.selected);e.closest(`[${W.bubbleExpandableIndicator}]`).length||t.each((e,t)=>{$(t).removeClass(U.selected)})}_leftScrollButtonClick(e){e.preventDefault();let t=$(e.currentTarget),n=this.element.find(`.${U.suggestionsScroll}`),r=this.options.dir===`rtl`,i=this.context.domUtilsService.scrollByDelta(n,r?200:-200);this.element.find(`[${W.rightScrollButton}]`).removeClass(U.disabled),i.atStart&&t.addClass(U.disabled)}_rightScrollButtonClick(e){e.preventDefault();let t=$(e.currentTarget),n=this.element.find(`.${U.suggestionsScroll}`),r=this.options.dir===`rtl`,i=this.context.domUtilsService.scrollByDelta(n,r?-200:200);this.element.find(`[${W.leftScrollButton}]`).removeClass(U.disabled),i.atEnd&&t.addClass(U.disabled)}_downloadAllClick(e){let t=$(e.currentTarget).closest(`.`+U.message);t.length&&this.trigger(G.downloadAllFiles,{messageElement:t})}destroy(){super.destroy(),this._scrollManager.destroy(),this._dragHandler&&this._dragHandler.destroy(),this.element.find(`[data-role='button']`).each(function(){let e=$(this).data(`kendoChatFileMenu`);e&&e.destroy()}),this.element.empty(),this.element.off(R),this.list=null}};let J=`.kendoPromptBox`,Y={SINGLE:`single`,MULTI:`multi`,AUTO:`auto`},ft={send:`paper-plane`,stop:`stop-sm`,attachment:`paperclip-outline-alt-right`},X={promptBox:`k-prompt-box`,promptBoxContent:`k-prompt-box-content`,promptBoxHeader:`k-prompt-box-header`,promptBoxAffix:`k-prompt-box-affix`,promptBoxTextarea:`k-prompt-box-textarea`,promptBoxInput:`k-prompt-box-input`,promptBoxSingleline:`k-prompt-box-singleline`,promptBoxMultiline:`k-prompt-box-multiline`,input:`k-input`,inputInner:`k-input-inner`,disabled:`k-disabled`,hidden:`k-hidden`,focus:`k-focus`,generating:`k-generating`,active:`k-active`,speechToTextButton:`k-speech-to-text-button`,fileSelectButton:`k-file-select-button`,fileBoxWrapper:`k-file-box-wrapper`,fileBoxWrapperScrollableStart:`k-file-box-wrapper-scrollable-start`,filesScroll:`k-files-scroll`,fileBox:`k-file-box`,fileInfo:`k-file-info`,fileName:`k-file-name`,fileSize:`k-file-size`,spacer:`k-spacer`},Z={sendButton:`ref-promptbox-send-button`,fileSelectButton:`ref-promptbox-file-select-button`,fileInput:`ref-promptbox-file-input`,attachmentsHost:`ref-promptbox-attachments-host`,attachmentRemoveButton:`ref-promptbox-attachment-remove-button`,input:`ref-promptbox-input`,header:`ref-promptbox-header`,startAffix:`ref-promptbox-start-affix`,endAffix:`ref-promptbox-end-affix`,topAffix:`ref-promptbox-top-affix`,affixSpacer:`ref-promptbox-affix-spacer`},Q={valueChange:`valueChange`,input:`input`,promptAction:`promptAction`,fileSelect:`fileSelect`,fileRemove:`fileRemove`,speechToTextClick:`speechToTextClick`,speechToTextStart:`speechToTextStart`,speechToTextEnd:`speechToTextEnd`,speechToTextError:`speechToTextError`,speechToTextResult:`speechToTextResult`,focus:`focus`,blur:`blur`,inputFocus:`inputFocus`,inputBlur:`inputBlur`,multilineStateChange:`multilineStateChange`},pt=`click`,mt=(e,t=!1)=>{let n=``;if(e&&(n=e()),!n&&!t)return``;let r=n?``:` ${X.hidden}`;return`<div class="${X.promptBoxHeader}${r}" ${Z.header}><div ${Z.attachmentsHost}></div>${n}</div>`},ht=e=>e?e():``,gt=(e,t=!0,n)=>{let r=t?``:` ${X.disabled}`,i=t?``:` aria-disabled="true"`,a={icon:n?.icon||`arrow-up-outline`,size:n?.size||`small`,rounded:n?.rounded||`full`};return n?.fillMode&&(a.fillMode=n.fillMode),n?.themeColor&&(a.themeColor=n.themeColor),kendo.html.renderButton(`<button title="${e.actionButton}" aria-label="${e.actionButton}" aria-live="polite" class="${r}"${i} ${Z.sendButton} type="button"></button>`,a)},_t=(e,t,n,r,i=!0,a)=>{let o=n?` multiple`:``,s=t?` accept="${t}"`:``,c=i?``:` disabled`,l=i?``:` aria-disabled="true"`,u=i?``:` ${X.disabled}`,d=r?.text||a?.fileSelectButton||`Attach file`,f={icon:r?.icon||ft.attachment,fillMode:r?.fillMode||`clear`};return r?.size&&(f.size=r.size),r?.rounded&&(f.rounded=r.rounded),r?.themeColor&&(f.themeColor=r.themeColor),`${kendo.html.renderButton(`<button title="${d}" aria-label="${d}" class="${u}" ${Z.fileSelectButton} type="button"${c}${l}></button>`,f)}<input type="file" id="${e}" class="${X.hidden}" ${Z.fileInput}${o}${s} />`},vt=e=>`<button class="${X.speechToTextButton}" type="button"></button>`,yt=e=>{let t=ht(e);return t?`<div class="${X.promptBoxAffix}" ${Z.startAffix}>${t}</div>`:``},bt=(e,t,n=!0,r,i,a)=>{let o=ht(r),s=i?.enable!==!1,c=i?_t(i.fileInputId,i.accept,i.multiple,i.settings,s,e):``,l=i?.showSpacer?`<div class="${X.spacer}"></div>`:``,u=n?vt(a?.speechToTextButtonSettings):``,d=t?gt(e,!0,a?.actionButtonSettings):``;return`${o}${c}${l}${u}${d}`.trim()?`<div class="${X.promptBoxAffix}" ${Z.endAffix}>
        ${o}
        ${c}
        ${l}
        ${u}
        ${d}
    </div>`:``},xt=(e,t,n=!0,r,i,a,o)=>{let s=ht(r),c=ht(i),l=a?.enable!==!1,u=a?_t(a.fileInputId,a.accept,a.multiple,a.settings,l,e):``,d=n?vt(o?.speechToTextButtonSettings):``,f=t?gt(e,!0,o?.actionButtonSettings):``,p=`<div class="${X.spacer}"></div>`;return a?.showSpacer?`<div class="${X.promptBoxAffix}" ${Z.endAffix}>
        ${u}
        ${s}
        ${p}
        ${c}
        ${d}
        ${f}
    </div>`:`<div class="${X.promptBoxAffix}" ${Z.endAffix}>
            ${s}
            ${p}
            ${c}
            ${u}
            ${d}
            ${f}
        </div>`},St=e=>{let t=ht(e);return t?`<div class="${X.promptBoxAffix}" ${Z.topAffix}>${t}</div>`:``},Ct=(e,t,n,r,i=!0,a={})=>{let{affixConfig:o={},fileSelectButtonConfig:s,buttonSettingsConfig:c}=a,l=mt(e,!!s),u=r===Y.MULTI?St(o.topAffixTemplate):``,d=r===Y.MULTI,f=d?``:yt(o.startAffixTemplate),p=d?xt(t,n,i,o.startAffixTemplate,o.endAffixTemplate,s,c):bt(t,n,i,o.endAffixTemplate,s,c);return`${l}
        <div class="${X.promptBoxContent}">
            ${u}
            ${f}
            <span ${Z.input}></span>
            ${p}
        </div>`};var wt=class{constructor(e){this.context=e}applyInitial(){let e=this.context.getOptions();this.context.getInputElement().attr(`aria-label`,e.messages?.messageBoxTitle||`Message`),e.enable||this.context.wrapper.attr(`aria-disabled`,`true`),e.readonly&&this.updateInputAccessibility(),e.loading&&this.context.wrapper.attr(`aria-busy`,`true`)}updateInputAccessibility(){let e=this.context.getOptions(),t=this.context.getInputElement();t&&(t.attr(`aria-label`,e.messages?.messageBoxTitle||`Message`),e.readonly?t.attr(`aria-readonly`,`true`):t.removeAttr(`aria-readonly`),e.enable?t.removeAttr(`aria-disabled`):t.attr(`aria-disabled`,`true`))}updateWrapper(e){e.disabled!==void 0&&(e.disabled?this.context.wrapper.attr(`aria-disabled`,`true`):this.context.wrapper.removeAttr(`aria-disabled`)),e.loading!==void 0&&(e.loading?this.context.wrapper.attr(`aria-busy`,`true`):this.context.wrapper.removeAttr(`aria-busy`))}},Tt=class{constructor(e){this.context=e}getSendButton(){return this.context.wrapper.find(`[${Z.sendButton}]`)}setLoading(e){let t=this.getSendButton(),n=this.context.getMessages(),r=this.context.getSettings();if(e){t.addClass(`${X.generating} ${X.active}`),t.attr(`title`,n.actionButtonLoading),t.attr(`aria-label`,n.actionButtonLoading);let e=t.find(`.k-icon, .k-svg-icon`);if(e.length){let t=r?.loadingIcon||`stop-sm`;kendo.ui.icon(e,{icon:t})}}else{t.removeClass(`${X.generating} ${X.active}`),t.attr(`title`,n.actionButton),t.attr(`aria-label`,n.actionButton);let e=t.find(`.k-icon, .k-svg-icon`);if(e.length){let t=r?.icon||`arrow-up-outline`;kendo.ui.icon(e,{icon:t})}}this.updateState()}updateState(){let e=this.getSendButton();if(this.context.isDisabled()){e.addClass(X.disabled),e.attr(`aria-disabled`,`true`);return}if(e.removeAttr(`aria-disabled`),this.context.isLoading()){e.removeClass(X.disabled);return}this.context.hasContent()?e.removeClass(X.disabled):e.addClass(X.disabled)}updateMessages(){let e=this.getSendButton(),t=this.context.getMessages();this.context.isLoading()?(e.attr(`title`,t.actionButtonLoading),e.attr(`aria-label`,t.actionButtonLoading)):(e.attr(`title`,t.actionButton),e.attr(`aria-label`,t.actionButton))}},Et=class{constructor(e){this.instance=null,this.context=e}init(){let e=this.context.getSpeechToTextButtonOption();if(e===!1)return;let t=this.context.wrapper.find(`.`+X.speechToTextButton);if(!t.length)return;let n={fillMode:`flat`,size:`small`,enable:!0},r=typeof e==`object`&&e?e:{},i=r.enable!==!1,a={...n,...r,start:e=>this.context.callbacks.onStart(e),end:e=>this.context.callbacks.onEnd(e),result:e=>this.context.callbacks.onResult(e),error:e=>this.context.callbacks.onError(e)};this.instance=new kendo.ui.SpeechToTextButton(t,a),i||this.instance.enable(!1)}enable(e){this.instance&&this.instance.enable(e)}destroy(){this.instance&&=(this.instance.destroy(),null)}},Dt=class{constructor(e){this.files=[],this._dragHandler=null,this.context=e}initUpload(){let e=this.context.getOptions();if(!this.showFileSelectButton(e))return;let t=this.context.wrapper.find(`[${Z.fileInput}]`);if(t.length===0)return;let n=this.getFileSelectButtonSettings(e)?.multiple!==!1,r=new kendo.ui.Upload(t,{multiple:n,async:!1,uniqueFileUids:!0,select:this.onUploadSelect.bind(this)});r?.wrapper?.addClass(X.hidden),this.uploadInstance=r}getFiles(){return[...this.files]}setFiles(e){this.files=[...e],this.renderAttachments(),this.context.callbacks.onFilesChanged()}clearFiles(){this.files=[],this.renderAttachments(),this.context.callbacks.onFilesChanged()}hasFiles(){return this.files.length>0}handleFileSelectClick(){let e=this.context.getOptions(),t=this.getFileSelectButtonSettings(e);if(!e.enable||e.readonly||t?.enable===!1)return;let n=this.uploadInstance?.element?.[0]||this.context.wrapper.find(`[${Z.fileInput}]`)[0];n&&typeof n.click==`function`&&n.click()}removeAttachmentByUid(e){let t=this.files.find(t=>this.getFileUid(t)===e),n=this.files.filter(t=>this.getFileUid(t)!==e);n.length!==this.files.length&&(this.files=n,this.renderAttachments(),this.context.callbacks.onFilesChanged(),t&&this.context.callbacks.onFileRemove(t,[...this.files]))}renderAttachments(){this._destroyDragHandler();let e=this.context.wrapper.find(`[${Z.header}]`),t=this.context.wrapper.find(`[${Z.attachmentsHost}]`);if(t.length===0)return;if(!this.files.length){t.empty(),this.context.getOptions().headerTemplate||e.addClass(X.hidden);return}e.removeClass(X.hidden);let n=`<ul class="${X.fileBoxWrapper} ${X.fileBoxWrapperScrollableStart}">`;n+=`<div class="${X.filesScroll}">`;for(let e=0;e<this.files.length;e++){let t=this.files[e],r=t?.rawFile||t,i=this.getFileUid(t),a=r?.name||t?.name||``,o=r?.size||t?.size||0,s=a.lastIndexOf(`.`)>-1?a.substring(a.lastIndexOf(`.`)).toLowerCase():``,c=this.context.fileUtilsService.getFileGroup(s,!0),l=this.context.fileUtilsService.getFileSizeMessage(o),u=kendo.ui.icon({icon:c,size:`xlarge`}),d=kendo.html.renderButton(`<button type="button" ${Z.attachmentRemoveButton} data-uid="${this.context.htmlService.encode(i)}" aria-label="Remove attachment" title="Remove attachment"></button>`,{icon:`x-mark-sm-outline`,fillMode:`flat`});n+=`<li class="${X.fileBox}">`,n+=u,n+=`<div class="${X.fileInfo}">`,n+=`<span class="${X.fileName}">${this.context.htmlService.encode(a)}</span>`,n+=`<span class="${X.fileSize}">${this.context.htmlService.encode(l)}</span>`,n+=`</div>`,n+=d,n+=`</li>`}n+=`</div></ul>`,t.html(n),this._attachDragToScroll()}_attachDragToScroll(){let e=this.context.wrapper.find(`[${Z.attachmentsHost}]`).find(`.`+X.filesScroll);e.length&&(this._dragHandler=this.context.domUtilsService.createDragToScrollHandler(e,{namespace:J+`.promptBoxFileDrag`,captureElement:this.context.wrapper}),this._dragHandler.attach())}_destroyDragHandler(){this._dragHandler&&=(this._dragHandler.destroy(),null)}destroy(){this._destroyDragHandler(),this.uploadInstance&&=(this.uploadInstance.destroy(),null)}onUploadSelect(e){e.preventDefault();let t=e.files,n=this.context.getOptions(),r=this.getFileSelectButtonSettings(n),i=this.validateFiles(t,r);i.length>0&&(this.files=[...this.files,...i],this.renderAttachments(),this.context.callbacks.onFilesChanged(),this.context.callbacks.onFileSelect(i))}validateFiles(e,t){let n=[],r=t?.restrictions;for(let t=0;t<e.length;t++){let i=e[t],a=i.rawFile||i,o=!0;if(r){if(r.allowedExtensions&&r.allowedExtensions.length>0){let e=a.name.split(`.`).pop()?.toLowerCase()||``;r.allowedExtensions.map(e=>e.toLowerCase().replace(`.`,``)).includes(e)||(o=!1)}r.maxFileSize&&a.size>r.maxFileSize&&(o=!1),r.minFileSize&&a.size<r.minFileSize&&(o=!1)}o&&n.push(i)}return n}getFileUid(e){return e?(e.uid||=this.context.utilsService.guid(),e.uid):``}showFileSelectButton(e){return e.fileSelectButton===!0||typeof e.fileSelectButton==`object`&&e.fileSelectButton!==null}getFileSelectButtonSettings(e){if(typeof e.fileSelectButton==`object`&&e.fileSelectButton!==null)return e.fileSelectButton}};let Ot={placeholder:`Type a message...`,actionButton:`Send`,actionButtonLoading:`Stop`,messageBoxTitle:`Message`};var kt=class{constructor(e){this.inputInstance=null,this.singleRowHeight=0,this.singleLineWidth=0,this.initialHeight=0,this.minMultiRowHeight=0,this.multiline=!1,this.context=e}init(){let e=this.context.wrapper.find(`[${Z.input}]`),t=this.context.getMode(),n=this.createInputElement(t);e.replaceWith(n);let r=this.context.getOptions().value||``;r&&n.val(r),this.captureInitialDimensions(),this.attachInputEvents()}getElement(){return this.inputInstance?.element||null}getValue(){return this.inputInstance?this.inputInstance.value():``}setValue(e){this.inputInstance&&this.inputInstance.value(e),this.updateAutoResize(),this.updateMultiResize()}enable(e){this.inputInstance&&this.inputInstance.enable(e)}setReadonly(e){this.inputInstance?.element&&this.inputInstance.element.prop(`readonly`,e)}focus(){this.inputInstance&&this.inputInstance.focus()}blur(){this.inputInstance?.element&&this.inputInstance.element.blur()}isMultiline(){return this.multiline}updateAutoResize(){if(this.context.getMode()!==Y.AUTO||!this.inputInstance)return;let e=this.inputInstance.element;if(!e.is(`textarea`))return;let t=e[0];this.multiline?(this.updateHeight(),this.shouldCollapse()&&(this.updateMultilineState(!1),e.css(`height`,``))):(t.scrollWidth>t.clientWidth||t.scrollHeight>t.clientHeight)&&(this.updateMultilineState(!0),this.updateHeight())}updateMultiResize(){if(this.context.getMode()!==Y.MULTI||!this.inputInstance)return;let e=this.inputInstance.element;if(!e.is(`textarea`))return;let t=e[0],n=this.context.getOptions();e.css(`overflow`,`hidden`),e.css(`height`,this.initialHeight+`px`);let r=t.scrollHeight,i=this.calculateMultiHeight(r,n.maxTextAreaHeight);i===n.maxTextAreaHeight&&e.css(`overflow`,``),e.css(`height`,i+`px`)}updatePlaceholder(){let e=this.context.getOptions(),t=$.extend({},Ot,e.messages),n=e.placeholder||t.placeholder;this.inputInstance?.element&&this.inputInstance.element.attr(`placeholder`,n)}destroy(){this.inputInstance&&=(this.inputInstance.element.off(J),this.inputInstance.destroy(),null)}createInputElement(e){let t=this.context.getOptions(),n=$.extend({},Ot,t.messages),r=t.title?`title="${t.title}"`:``,i=t.readonly?`readonly`:``,a;if(e===Y.SINGLE)a=$(`<input type="text" class="${X.promptBoxInput} ${X.inputInner}" placeholder="${t.placeholder||n.placeholder}" autocomplete="off" ${r} ${i} />`),this.inputInstance={element:a,value:e=>{if(e===void 0)return a.val();a.val(e)},enable:e=>{a.prop(`disabled`,!e)},focus:()=>a.trigger(`focus`),destroy:()=>{}};else{let o=e===Y.AUTO?1:t.rows||1;a=$(`<textarea class="${X.promptBoxTextarea} ${X.inputInner}" placeholder="${t.placeholder||n.placeholder}" rows="${o}" aria-multiline="true" ${r} ${i}></textarea>`),t.maxTextAreaHeight&&(a.css(`max-height`,t.maxTextAreaHeight+`px`),a.css(`overflow-y`,`auto`)),this.inputInstance={element:a,value:e=>{if(e===void 0)return a.val();a.val(e)},enable:e=>{a.prop(`disabled`,!e)},focus:()=>a.trigger(`focus`),destroy:()=>{}}}return a}captureInitialDimensions(){if(this.context.getMode()===Y.SINGLE||!this.inputInstance)return;let e=this.inputInstance.element;if(!e.is(`textarea`))return;let t=e[0],n=window.getComputedStyle(t),r=parseFloat(n.lineHeight)||20,i=parseFloat(n.paddingTop)||0,a=parseFloat(n.paddingBottom)||0,o=this.context.getOptions().rows||1;this.singleRowHeight=r+i+a,this.initialHeight=t.offsetHeight||this.singleRowHeight,this.singleLineWidth=t.offsetWidth,this.minMultiRowHeight=r*o+i+a}shouldCollapse(){if(!this.inputInstance||this.singleLineWidth<=0)return!1;let e=this.inputInstance.element;if(!e.is(`textarea`))return!1;let t=e[0],n=t.style.height;e.css({overflow:`hidden`,width:this.singleLineWidth+`px`,whiteSpace:`nowrap`,height:this.initialHeight+`px`});let r=t.scrollWidth<=this.singleLineWidth&&t.scrollHeight<=this.initialHeight;return e.css({overflow:``,width:``,whiteSpace:``}),n?e.css(`height`,n):e.css(`height`,``),r}updateHeight(){let e=this.context.getOptions();if(!this.inputInstance)return;let t=this.inputInstance.element;if(!t.is(`textarea`))return;let n=t[0];t.css(`overflow`,`hidden`),t.css(`height`,this.initialHeight+`px`);let r=n.scrollHeight,i=e.maxTextAreaHeight?Math.min(r,e.maxTextAreaHeight):r;i===e.maxTextAreaHeight&&t.css(`overflow`,``),t.css(`height`,i+`px`)}calculateMultiHeight(e,t){return t&&e>t?t:Math.max(this.minMultiRowHeight,e)}updateMultilineState(e){if(this.context.getMode()!==Y.AUTO||this.multiline===e)return;let t=this.multiline;this.multiline=e,e?this.context.wrapper.addClass(X.promptBoxMultiline):this.context.wrapper.removeClass(X.promptBoxMultiline),this.context.callbacks.onMultilineStateChange(e,t)}attachInputEvents(){if(!this.inputInstance)return;let e=this.inputInstance.element;e.on(`input`+J,()=>{this.updateAutoResize(),this.updateMultiResize(),this.context.callbacks.onInput()}),e.on(`keydown`+J,e=>{this.context.callbacks.onKeyDown(e)}),e.on(`focus`+J,()=>{this.context.callbacks.onFocus()}),e.on(`blur`+J,()=>{this.context.callbacks.onBlur()})}};let At={placeholder:`Type a message...`,actionButton:`Send`,actionButtonLoading:`Stop`,messageBoxTitle:`Message`,fileSelectButton:`Attach file`};var jt=class e extends I{static{this.options={name:`PromptBox`,prefix:``,mode:Y.AUTO,placeholder:``,value:``,enable:!0,readonly:!1,title:``,fillMode:void 0,maxTextAreaHeight:void 0,rows:1,headerTemplate:null,loading:!1,actionButton:null,fileSelectButton:!1,speechToTextButton:!0,startAffixTemplate:null,endAffixTemplate:null,topAffixTemplate:null,messages:At}}constructor(t,n,r=T(F),i=T(L),a=T(Fe),o=T(P)){super(t,$.extend(!0,{},e.options,n)),this.events=[Q.valueChange,Q.input,Q.promptAction,Q.fileSelect,Q.fileRemove,Q.speechToTextClick,Q.speechToTextStart,Q.speechToTextEnd,Q.speechToTextError,Q.speechToTextResult,Q.focus,Q.blur,Q.inputFocus,Q.inputBlur,Q.multilineStateChange],this._value=``,this._loading=!1,this._readonly=!1,this._hasFocus=!1,this._fileInputId=``,this.utilsService=r,this.htmlService=i,this.fileUtilsService=a,this.domUtilsService=o,this._value=this.options.value||``,this._loading=this.options.loading||!1,this._fileInputId=`promptbox_file_`+this.utilsService.guid(),this._initWrapper(),this._initInputManager(),this._initSpeechHandler(),this._initFileHandler(),this._attachEvents(),this.fileHandler.renderAttachments(),this._initAccessibilityManager(),this._initActionButtonManager(),this.bind(this.events,this.options),this.options.enable||this.enable(!1),this.options.readonly&&this.readonly(!0),this._value&&this._getMode()===Y.AUTO&&this.inputManager.updateAutoResize(),this.actionButtonManager.updateState()}value(e){if(e===void 0)return this._value;this._value=e,this.inputManager.setValue(e),this.actionButtonManager.updateState()}enable(e=!0){let t=this.options;t.enable=e,e?(this._readonly=!1,t.readonly=!1,this.inputManager.setReadonly(!1),this.wrapper.removeClass(X.disabled)):this.wrapper.addClass(X.disabled),this.inputManager.enable(e),this.speechHandler.enable(e),this._updateFileSelectButtonState(),this.actionButtonManager.updateState(),this.accessibilityManager.updateWrapper({disabled:!e}),this.accessibilityManager.updateInputAccessibility()}readonly(e){if(e===void 0)return this._readonly;this._readonly=e;let t=this.options;t.readonly=e,this.inputManager.setReadonly(e),this.accessibilityManager.updateInputAccessibility(),this.actionButtonManager.updateState(),this.speechHandler.enable(!e),this._updateFileSelectButtonState()}loading(e){if(e===void 0)return this._loading;this._loading=e,this.accessibilityManager.updateWrapper({loading:e}),this.actionButtonManager.setLoading(e)}focus(){this.inputManager.focus()}blur(){this.inputManager.blur()}files(e){if(e===void 0)return this.fileHandler.getFiles();this.fileHandler.setFiles(e)}clearFiles(){this.fileHandler.clearFiles()}destroy(){this._detachEvents(),this._destroyCollaborators(),super.destroy()}_destroyCollaborators(){this.fileHandler.destroy(),this.speechHandler.destroy(),this.inputManager.destroy()}setOptions(e){if(e.headerTemplate!==void 0||e.startAffixTemplate!==void 0||e.endAffixTemplate!==void 0||e.topAffixTemplate!==void 0||e.actionButton!==void 0||e.actionButtonSettings!==void 0||e.fileSelectButton!==void 0||e.speechToTextButton!==void 0||e.mode!==void 0){let t=this._value,n=this._loading,r=this.options.attachments,i=this.fileHandler.getFiles();this._detachEvents(),this._destroyCollaborators(),super.setOptions(e),this.wrapper.remove(),this._initWrapper(),this._initInputManager(),this._initSpeechHandler(),this._initFileHandler(),this._attachEvents(),i.length>0&&this.fileHandler.setFiles(i),this._initAccessibilityManager(),this._initActionButtonManager(),t&&this.value(t),n&&this.loading(!0),r&&(this.options.attachments=r,this.fileHandler.renderAttachments());return}super.setOptions(e),(e.placeholder!==void 0||e.messages?.placeholder!==void 0)&&this.inputManager.updatePlaceholder(),(e.messages?.actionButton!==void 0||e.messages?.actionButtonLoading!==void 0)&&this.actionButtonManager.updateMessages(),e.enable!==void 0&&this.enable(e.enable),e.readonly!==void 0&&this.readonly(e.readonly),e.loading!==void 0&&this.loading(e.loading)}_initInputManager(){this.inputManager=new kt({wrapper:this.wrapper,getOptions:()=>this.options,getMode:()=>this._getMode(),callbacks:{onInput:()=>this._handleInput(),onKeyDown:e=>this._handleKeyDown(e),onFocus:()=>this.trigger(Q.inputFocus),onBlur:()=>this.trigger(Q.inputBlur),onMultilineStateChange:(e,t)=>{this._handleAffixReorganization(e),this.trigger(Q.multilineStateChange,{isMultiline:e,wasMultiline:t})}}}),this.inputManager.init()}_handleAffixReorganization(e){if(!this.options.startAffixTemplate)return;let t=this.wrapper.find(`[${Z.startAffix}]`),n=this.wrapper.find(`[${Z.endAffix}]`);if(!(!t.length||!n.length))if(e){let e=t.contents().detach();t.addClass(X.hidden);let r=$(`<div class="${X.spacer}" ${Z.affixSpacer}></div>`);n.prepend(r),n.prepend(e)}else{let e=n.find(`[${Z.affixSpacer}]`);if(e.length){let n=e.prevAll().detach();t.empty().append(n),t.removeClass(X.hidden),e.remove()}}}_initSpeechHandler(){this.speechHandler=new Et({wrapper:this.wrapper,getSpeechToTextButtonOption:()=>this.options.speechToTextButton,callbacks:{onStart:e=>this.trigger(Q.speechToTextStart,e),onEnd:e=>this.trigger(Q.speechToTextEnd,e),onResult:e=>{let t=e.alternatives?.[0]?.transcript||``;if(t){let e=this._value||``,n=e+(e?` `:``)+t;this.value(n)}this.trigger(Q.speechToTextResult,{...e,transcript:t})},onError:e=>this.trigger(Q.speechToTextError,e)}}),this.speechHandler.init()}_initFileHandler(){this.fileHandler=new Dt({wrapper:this.wrapper,getOptions:()=>this.options,htmlService:this.htmlService,fileUtilsService:this.fileUtilsService,utilsService:this.utilsService,domUtilsService:this.domUtilsService,callbacks:{onFilesChanged:()=>this.actionButtonManager.updateState(),onFileSelect:e=>this.trigger(Q.fileSelect,{files:e}),onFileRemove:(e,t)=>this.trigger(Q.fileRemove,{file:e,files:t})}}),this.fileHandler.initUpload()}_initAccessibilityManager(){this.accessibilityManager=new wt({wrapper:this.wrapper,getOptions:()=>this.options,getInputElement:()=>this.inputManager.getElement()}),this.accessibilityManager.applyInitial()}_initActionButtonManager(){this.actionButtonManager=new Tt({wrapper:this.wrapper,getMessages:()=>this._getMessages(),getSettings:()=>this.options.actionButton,isDisabled:()=>{let e=this.options,t=!e.enable,n=e.readonly,r=e.actionButton?.enable===!1;return t||n||r},isLoading:()=>this._loading,hasContent:()=>!!this._value?.trim()||this.fileHandler.hasFiles()})}_getMode(){return this.options.mode||Y.AUTO}_getMessages(){let e=this.options,t=e.actionButton,n=typeof e.fileSelectButton==`object`?e.fileSelectButton:null,r=$.extend({},At,e.messages);return t?.text&&(r.actionButton=t.text),t?.loadingText&&(r.actionButtonLoading=t.loadingText),n?.text&&(r.fileSelectButton=n.text),r}_showActionButton(){return!0}_showSpeechToTextButton(){let e=this.options;return e.speechToTextButton===!0||e.speechToTextButton===null||e.speechToTextButton===void 0||typeof e.speechToTextButton==`object`&&e.speechToTextButton!==null}_showFileSelectButton(){let e=this.options;return e.fileSelectButton===!0||typeof e.fileSelectButton==`object`&&e.fileSelectButton!==null}_updateFileSelectButtonState(){let e=this.options,t=this.wrapper.find(`[${Z.fileSelectButton}]`);if(!t.length)return;let n=this._getFileSelectButtonSettings();!e.enable||e.readonly||n?.enable===!1?(t.addClass(X.disabled),t.attr(`aria-disabled`,`true`)):(t.removeClass(X.disabled),t.removeAttr(`aria-disabled`))}_getFileSelectButtonSettings(){let e=this.options;if(typeof e.fileSelectButton==`object`&&e.fileSelectButton!==null)return e.fileSelectButton}_initWrapper(){let e=this.options,t=this._getMessages(),n=this._getMode(),r=``;n===Y.SINGLE?r=` ${X.promptBoxSingleline}`:n===Y.MULTI&&(r=` ${X.promptBoxMultiline}`);let i=this._getAppearanceClasses(),a={affixConfig:{startAffixTemplate:e.startAffixTemplate,endAffixTemplate:e.endAffixTemplate,topAffixTemplate:e.topAffixTemplate},fileSelectButtonConfig:this._getFileSelectButtonConfig(),buttonSettingsConfig:this._getButtonSettingsConfig()},o=Ct(e.headerTemplate,t,this._showActionButton(),n,this._showSpeechToTextButton(),a);this.wrapper=this.element.wrap(`<div class="${X.input}${i} ${X.promptBox}${r}" role="group"></div>`).parent(),this.wrapper.prepend(o),this.element.addClass(X.hidden),this.wrapper.after(this.element)}_getAppearanceClasses(){let e=this.options;return e.fillMode?` k-input-${e.fillMode}`:``}_getFileSelectButtonConfig(){if(!this._showFileSelectButton())return;let e=this._getFileSelectButtonSettings(),t=e?.accept;return!t&&e?.restrictions?.allowedExtensions?.length&&(t=e.restrictions.allowedExtensions.map(e=>e.startsWith(`.`)?e:`.${e}`).join(`,`)),{enable:e?.enable,fileInputId:this._fileInputId,accept:t,multiple:e?.multiple,showSpacer:e?.showSpacer,settings:e}}_getButtonSettingsConfig(){let e=this.options,t=e.speechToTextButton,n=typeof t==`object`&&t?t:void 0;return{actionButtonSettings:e.actionButton||void 0,fileSelectButtonSettings:this._getFileSelectButtonSettings(),speechToTextButtonSettings:n}}isMultiline(){return this.inputManager.isMultiline()}_attachEvents(){this.wrapper.on(pt+J,`[${Z.sendButton}]`,e=>{e.preventDefault(),this._handleSend()}),this.wrapper.on(pt+J,`[${Z.fileSelectButton}]`,e=>{e.preventDefault(),this.fileHandler.handleFileSelectClick()}),this.wrapper.on(pt+J,`[${Z.attachmentRemoveButton}]`,e=>{e.preventDefault();let t=e.currentTarget.getAttribute(`data-uid`);t&&this.fileHandler.removeAttachmentByUid(t)}),this.wrapper.on(`focusin`+J,e=>{this._handleFocusIn(e)}),this.wrapper.on(`focusout`+J,e=>{this._handleFocusOut(e)})}_detachEvents(){this.wrapper.off(J)}_handleFocusIn(e){this._hasFocus||(this._hasFocus=!0,this.wrapper.addClass(X.focus),this.trigger(Q.focus))}_handleFocusOut(e){let t=e.relatedTarget;!(t&&this.wrapper[0].contains(t))&&this._hasFocus&&(this._hasFocus=!1,this.wrapper.removeClass(X.focus),this.trigger(Q.blur))}_handleSend(){let e=this.options;if(!e.enable||e.readonly||e.actionButton?.enable===!1)return;if(this._loading){this.trigger(Q.promptAction,{actionType:`stop`}),this.loading(!1);return}let t=this._value,n=t?.trim(),r=this.fileHandler.hasFiles();if(!n&&!r)return;let i={actionType:`send`,value:n?t.trim():``,files:this.fileHandler.getFiles()};this.trigger(Q.promptAction,i),this.value(``),this.clearFiles(),this.focus()}_handleInput(){let e=this._value;this._value=this.inputManager.getValue(),this.actionButtonManager.updateState(),this.trigger(Q.input,{value:this._value}),e!==this._value&&this.trigger(Q.valueChange,{oldValue:e,newValue:this._value})}_handleKeyDown(e){let t=this._getMode();if(e.key===`Enter`||e.which===13||e.keyCode===13){if(e.shiftKey&&t!==Y.SINGLE)return;e.preventDefault(),this._loading||this._handleSend()}}};let Mt=T(ae);Mt.registerPrefix(`PromptBox`,`k-input-`),Mt.registerValues(`PromptBox`,[{prop:`fillMode`,values:Mt.fillModeValues}]);var Nt=class e extends I{static{this.options={name:`MessageBox`}}get textAreaInstance(){return this.promptBoxInstance}constructor(t,n,r){super(t,$.extend(!0,{},e.options,n)),this.events=[G.sendMessage,G.input,G.suggestionClick,G.replyMessageCloseButtonClick,G.fileSelect,G.fileRemove],this._generating=!1,this._typing=!1,this._dragHandler=null,this.context=r,this.chatElement=r.chatElement,this._generating=!1,this._initWrapper(),this._initPromptBox(),this._attachEvents(),this._typing=!1}_initWrapper(){let e=this.options;if(this.wrapper=$(`<div class="${U.messageBoxWrapper}"></div>`),e.suggestions.length){let t=this._getSuggestionsLayoutMode(e),n=it(e.suggestions,t,e.dir===`rtl`);this.suggestions=this.wrapper.append(n)}this.wrapper.find(`[${W.leftScrollButton}]`).addClass(U.disabled),this.chatElement.append(this.wrapper)}_getSuggestionsLayoutMode(e){return e.suggestionsLayoutMode?e.suggestionsLayoutMode:e.suggestionsScrollable?B.SCROLLBUTTONS:B.SCROLL}_initPromptBox(){let e=this.options,t=e.messages||{},n=e.messageBox||{},r=e.actionButton,i=e.fileAttachment!==!1,a=n.mode||`auto`,o=n.maxTextAreaHeight,s=n.rows||1,c=this._getActionButtonSettings(r),l=this._getSpeechToTextSettings(e),u=this._getFileAttachmentSettings(e,i),d=new jt(this.element,{mode:a,maxTextAreaHeight:o,rows:s,placeholder:t.placeholder,speechToTextButton:l,actionButton:c,fileSelectButton:u,messages:{placeholder:t.placeholder,actionButton:t.sendButton||r?.text||t.actionButton,actionButtonLoading:t.sendButtonLoading||r?.loadingText||r?.stopText||t.actionButtonLoading||t.stopButton},input:this._input.bind(this),promptAction:this._promptBoxAction.bind(this),fileSelect:this._promptBoxFileSelect.bind(this),fileRemove:this._promptBoxFileRemove.bind(this)});d.wrapper.appendTo(this.wrapper),this.promptBoxInstance=d}_getActionButtonSettings(e){return{enable:!0,icon:e?.icon,loadingIcon:e?.loadingIcon||e?.stopIcon,fillMode:e?.fillMode,rounded:e?.rounded,size:e?.size,themeColor:e?.themeColor,text:e?.text,loadingText:e?.loadingText||e?.stopText}}_getSpeechToTextSettings(e){return e.speechToText===!1?!1:this.context.utilsService.isObject(e.speechToText)?e.speechToText:null}_getFileAttachmentSettings(e,t){return t?this.context.utilsService.isObject(e.fileAttachment)?{showSpacer:!0,...e.fileAttachment}:{showSpacer:!0}:!1}_promptBoxAction(e){e.preventDefault();let t=e.actionType,n=e.value||``,r=e.files||[];if(t===`stop`){this.trigger(G.sendMessage,{generating:!0});return}if(!n.length&&!r.length)return;let i={message:{text:n,files:r}};this.trigger(G.sendMessage,i)}_promptBoxFileSelect(e){let t=this.promptBoxInstance?.files()||[];this.trigger(G.fileSelect,{files:t})}_promptBoxFileRemove(e){this.trigger(G.fileRemove,{file:e.file,files:e.files})}_attachEvents(){this.wrapper.on(K+R,`[${W.replyMessageCloseButton}]`,this._replyMessageCloseButtonClick.bind(this)).on(K+R,`.`+U.suggestion,this._suggestionClick.bind(this)).on(K+R,`[${W.leftScrollButton}]`,this._leftScrollButtonClick.bind(this)).on(K+R,`[${W.rightScrollButton}]`,this._rightScrollButtonClick.bind(this)),this._attachDragToScrollEvents()}_attachDragToScrollEvents(){let e=this.wrapper.find(`.`+U.suggestionsScroll);e.length&&(this._dragHandler=this.context.domUtilsService.createDragToScrollHandler(e,{namespace:R+`.chatMessageBoxDrag`,captureElement:this.chatElement}),this._dragHandler.attach())}getFiles(){return this.promptBoxInstance?.files()||[]}setFiles(e){this.promptBoxInstance?.files(e)}clearFiles(){this.promptBoxInstance?.clearFiles()}_getPrefixContainer(){let e=this.promptBoxInstance.wrapper.find(`.k-prompt-box-header`);return e.length===0&&(e=$(`<div class="k-prompt-box-header" ref-promptbox-header><div ref-promptbox-attachments-host></div></div>`),this.promptBoxInstance.wrapper.prepend(e)),e}setReplyMessage(e,t){let n=this.options,r=this.getReplyMessageContainer(),i=n.messageReferenceTemplate({text:e.text,files:e.files,isOwnMessage:t,renderCloseButton:!0,renderFileMenuButton:!1}),a=this._getPrefixContainer();a.removeClass(`k-hidden`),r.length===0?a.prepend(i):r.replaceWith(i)}removeReplyMessage(){let e=this.getReplyMessageContainer();e.length>0&&(e.remove(),this._updateHeaderVisibility())}_updateHeaderVisibility(){let e=this._getPrefixContainer(),t=this.promptBoxInstance?.files(),n=t&&t.length>0,r=this.getReplyMessageContainer().length>0;!n&&!r&&e.addClass(`k-hidden`)}getReplyMessageContainer(){return this._getPrefixContainer().find(`[${W.messageReferenceReplyWrapper}]`)}loading(e){if(e===void 0)return this._generating;this._generating=e,this.promptBoxInstance.loading(e)}value(e){if(e===void 0)return this._getInputValue();this._setInputValue(e)}_input(e){let t=e?.value??this._getInputValue();this.trigger(G.input,{value:t})}_replyMessageCloseButtonClick(e){e.preventDefault(),this.trigger(G.replyMessageCloseButtonClick)}_suggestionClick(e){e.preventDefault();let t=this.options,n=$(e.target).closest(`.`+U.suggestion).text();this.trigger(G.suggestionClick,{text:n,behavior:t.suggestionsBehavior||`send`}),t.suggestionsBehavior===`insert`&&this._setInputValue(n)}_getInputValue(){return this.promptBoxInstance.value()}_setInputValue(e){this.promptBoxInstance.value(e)}_leftScrollButtonClick(e){e.preventDefault();let t=$(e.currentTarget),n=this.wrapper.find(`.${U.suggestionsScroll}`),r=this.options.dir===`rtl`,i=this.context.domUtilsService.scrollByDelta(n,r?200:-200);this.wrapper.find(`[${W.rightScrollButton}]`).removeClass(U.disabled),i.atStart&&t.addClass(U.disabled)}_rightScrollButtonClick(e){e.preventDefault();let t=$(e.currentTarget),n=this.wrapper.find(`.${U.suggestionsScroll}`),r=this.options.dir===`rtl`,i=this.context.domUtilsService.scrollByDelta(n,r?-200:200);this.wrapper.find(`[${W.leftScrollButton}]`).removeClass(U.disabled),i.atEnd&&t.addClass(U.disabled)}destroy(){this._dragHandler&&this._dragHandler.destroy(),this.promptBoxInstance&&this.promptBoxInstance.destroy(),this.wrapper.remove()}},Pt=class e extends I{static{this.options={name:`ChatMessageMenu`,filter:`.${U.chatBubble}`,dataSource:[],keyboardAlignToAnchor:!0}}constructor(t,n){super(t,$.extend(!0,{},e.options,n)),this.setCommandAttributes(),this.create(),this.attachEvents()}create(){this.menu=new kendo.ui.ContextMenu(this.element,this.options)}attachEvents(){this.menu.bind(`select`,this.onSelect.bind(this)).bind(`open`,this.onOpen.bind(this)).bind(`close`,this.onClose.bind(this))}setCommandAttributes(){this.options.dataSource.forEach(e=>{e.attr=e.attr||{},e.attr[`data-command`]=e.name.toLowerCase()})}onSelect(e){let t=$(e.item),n=$(e.target).closest(`.`+U.message),r=t.data(`command`);r&&this.executeCommand(r,t,n)}onOpen(e){let t=!0,n=$(e.target),r=$(e.event?.target).length?$(e.event.target):n,i=n.closest(`.`+U.messageRemoved).length>0,a=n.find(`.`+U.typingIndicator).length>0,o=r.closest(`[${W.fileMenuButton}]`).length>0,s=n.closest(`.`+U.message);(i||a||o||!s.length)&&(e.preventDefault(),t=!1),n.toggleClass(U.active,t),this.trigger(`open`,{message:s})}onClose(e){let t=$(e.target),n=t.closest(`.`+U.message);t.removeClass(U.active),this.trigger(`close`,{message:n})}executeCommand(e,t,n){this.trigger(`execute`,{type:e,item:t,message:n})}toggleDeleteVisibility(e){let t=this.element.find(`[data-command='delete']`);t.length&&t.toggleClass(U.hidden,!e)}destroy(){this.menu&&(this.menu.destroy(),this.menu=null,this.element.remove())}},Ft=class{constructor(e){this.context=e}commandExecute(e){let t=this.context.dataItem(e.message),n=this.context.fileDataItem(t,e.file),r=e.type;if(n){switch(r){case H.download:this.context.trigger(G.download,{files:[n],message:t});break}this.context.trigger(G.fileMenuAction,{type:r,file:n,message:t})}else switch(r){case H.reply:this.messageReply(t);break;case H.copy:this.messageCopy(t);break;case H.pin:this.messagePin(t);break;case H.delete:this.messageDelete(t);break}}contextMenuExecute(e){this.commandExecute(e);let t=this.context.dataItem(e.message),n=e.type;this.context.trigger(G.contextMenuAction,{type:n,message:t})}messageReply(e){let t=e.authorId===this.context.getUserId();this.context.setCurrentMessageReplyId(e.id),this.context.setReplyMessage(e,t),this.context.setupAriaAttributes()}messageCopy(e){navigator&&navigator.clipboard&&navigator.clipboard.writeText(e.text)}messagePin(e){this.context.pinMessage(e)}messageDelete(e){this.context.removeMessage(e)}messageContextMenuOpen(e){let t=this.context.dataItem(e.message);if(!t)return;let n=t.authorId===this.context.getUserId();this.context.toggleDeleteVisibility(n)}},It=class{constructor(e){this.context=e}attach(){this._attachViewEvents(),this._attachMessageBoxEvents(),this._attachContextMenuEvents(),this._attachWrapperDomEvents()}_attachViewEvents(){let e=this.context;e.view.bind(`suggestedActionClick`,t=>{if(e.options.suggestionsBehavior===`insert`)e.value(t.text),e.trigger(G.suggestionClick,{text:t.text});else{let n={text:t.text,files:[]};e.trigger(G.sendMessage,{message:n}),e.postMessage(n)}}).bind(`messageToolbarExecute`,t=>{let n=e.dataItem(t.message);e.commandExecute({type:t.type,message:t.message}),e.trigger(G.toolbarAction,{type:t.type,message:n})}).bind(`fileMenuExecute`,t=>{e.commandExecute(t)}).bind(`downloadAllFiles`,t=>{let n=e.dataItem(t.messageElement);e.trigger(G.download,{files:n?.files,message:n})}).bind(`expandableToggle`,t=>{e.accessibility.updateExpandableIndicatorAria(t.indicator,t.isExpanded)})}_attachMessageBoxEvents(){let e=this.context;e.messageBox.bind(`input`,t=>{e.trigger(G.input,{value:t.value})}).bind(`sendMessage`,t=>{let n=t.generating;if(n)e.trigger(G.sendMessage,{generating:n});else{let n={text:t.text||t.message?.text,files:t.files||t.message?.files||[]};e.trigger(G.sendMessage,{message:n}),e.postMessage(n),e.clearReplyState()}}).bind(`suggestionClick`,t=>{if(e.trigger(G.suggestionClick,{text:t.text}),t.behavior!==`insert`){let n={text:t.text,files:[]};e.trigger(G.sendMessage,{message:n}),e.postMessage(n)}}).bind(`fileSelect`,t=>{e.trigger(G.fileSelect,{files:t.files})}).bind(`fileRemove`,t=>{e.trigger(G.fileRemove,{file:t.file,files:t.files})}).bind(`replyMessageCloseButtonClick`,()=>{e.clearReplyState()})}_attachContextMenuEvents(){let e=this.context;e.messageContextMenu.bind(`execute`,e.contextMenuExecute.bind(e)).bind(`open`,e.messageContextMenuOpen.bind(e))}_attachWrapperDomEvents(){let e=this.context;e.wrapper.on(K+R,`[${W.pinnedMessageCloseButton}]`,()=>{e.trigger(G.unpin,{message:e.getPinnedMessage()}),e.clearPinnedMessage()}),e.wrapper.on(K+R,`[${W.messageReferencePinWrapper}]`,t=>{if($(t.target).closest(`[${W.pinnedMessageCloseButton}]`).length||$(t.target).is(`a`))return;t.preventDefault(),t.stopPropagation();let n=e.getPinnedMessage();n&&n.uid&&e.scrollToMessage(n.uid)}),e.wrapper.on(K+R,`[${W.messageReferenceReplyWrapper}]`,t=>{if($(t.target).is(`a`))return;t.preventDefault(),t.stopPropagation();let n=$(t.currentTarget).closest(`.`+U.message),r=e.dataItem(n);if(r&&r.replyToId){let t=e.getMessageById(r.replyToId);t&&t.uid&&e.scrollToMessage(t.uid)}}),e.wrapper.on(`keydown`+R,t=>{e.accessibility.handleKeyDown(t,e.messageBoxRef)}),e.wrapper.on(`focus${R}`,`.${U.bubble}`,t=>{let n=$(t.target);if(!(n.find(`.${U.typingIndicator}`).length>0)&&n.attr(`data-keyboard-focus`)===`true`){let t=n.closest(`.${U.message}`),r=e.dataItem(t);r&&r.uid&&e.scrollToMessage(r.uid)}})}};let Lt=[{name:H.reply,text:`Reply`,icon:V.undo},{name:H.copy,text:`Copy`,icon:V.copy},{name:H.pin,text:`Pin`,icon:V.pin},{name:H.delete,text:`Delete`,icon:V.trash}],Rt=[{name:H.download,text:`Download`,icon:V.download}],zt={messageListLabel:`Message list`,placeholder:`Type a message...`,sendButton:`Send message`,sendButtonLoading:`Stop`,actionButton:`Send message`,actionButtonLoading:`Stop`,stopButton:`Stop`,speechToTextButton:`Toggle speech to text`,fileButton:`Attach file`,downloadAll:`Download all`,selfMessageDeleted:`You removed this message.`,otherMessageDeleted:`This message was removed by its sender.`,stopGeneration:`Stop generation`,messageBoxLabel:`Type your message here`,pinnedMessageCloseButton:`Unpin message`,replyMessageCloseButton:`Remove reply`,fileMenuButton:`File menu`,retryMessage:`Retry`};var Bt=class e extends I{static{this.options={name:`Chat`,autoAssignId:!0,autoBind:!0,allowMessageCollapse:!1,showUsername:!0,showAvatar:!0,timestampVisibility:`always`,suggestionsBehavior:`insert`,authorId:null,suggestionsScrollable:!1,suggestedActionsScrollable:!1,suggestionsLayoutMode:`scroll`,suggestedActionsLayoutMode:`scroll`,speechToText:!0,fileAttachment:!0,scrollToBottomButton:!0,loading:!1,messageBox:{mode:`multi`,maxTextAreaHeight:110},messageToolbarActions:[],messageActions:Lt,fileActions:Rt,suggestions:[],headerItems:[],dir:`ltr`,messageTimeFormat:`ddd MMM dd yyyy`,width:null,height:null,messages:zt,messageWidthMode:`standard`,messageTemplate:null,messageGroupTemplate:nt,messageReferenceTemplate:Be,filesTemplate:ze,suggestionsTemplate:rt,suggestedActionsTemplate:rt,timestampTemplate:null,messageStatusTemplate:null,messageStatusSettings:null,headerTemplate:null,noDataTemplate:null,messageContentTemplate:null,authorMessageTemplate:null,receiverMessageTemplate:null,authorMessageContentTemplate:null,receiverMessageContentTemplate:null,userStatusTemplate:null,attachmentTemplate:null,messageBoxTemplate:null,authorMessageSettings:null,receiverMessageSettings:null,actionButton:null,attachmentLayout:`list`,filesLayoutMode:`vertical`,textField:`text`,authorIdField:`authorId`,authorNameField:`authorName`,authorImageUrlField:`authorImageUrl`,authorImageAltTextField:`authorImageAltText`,idField:`id`,timestampField:`timestamp`,filesField:`files`,replyToIdField:`replyToId`,isDeletedField:`isDeleted`,isPinnedField:`isPinned`,isTypingField:`isTyping`,statusField:`status`,failedField:`failed`,attachmentsField:`attachments`,attachmentLayoutField:`attachmentLayout`,skipSanitization:!1}}constructor(t,n,r,i=T(F),a=T(P),o=T(L),s=T(Ce)){n||={},e.mergeContextMenuActions(n,e.options,`messageActions`),e.mergeContextMenuActions(n,e.options,`fileActions`),super(t,$.extend(!0,{},e.options,n)),this.currentMessageReplyId=null,this._hasHeader=!1,this._loading=!1,this.events=[G.sendMessage,G.suggestionClick,G.unpin,G.input,G.toolbarAction,G.fileMenuAction,G.contextMenuAction,G.download,G.fileSelect,G.fileRemove,G.executeAction,G.resendMessage],this.utilsService=i,this.domUtilsService=a,this.htmlService=o,this.dateParserService=s,this.options.messageActions=n.messageActions,this.options.fileActions=n.fileActions,r&&(this._events=r),this._init(n)}static mergeContextMenuActions(e,t,n){let r=e[n];if(Array.isArray(r)){let i=t[n]||[],a={};for(let e of i)a[e.name]={...e};e[n]=r.map(e=>e.name in a?{...a[e.name],...e}:{...e})}else e[n]=t[n]||[]}_init(e){this.currentMessageReplyId=null,this._hasHeader=!!e.headerItems?.length,this._initUser(),this._initWrapper(),this._initDataSource(),this._initView(),e?.toolbar&&this.utilsService.logToConsole(`The 'toolbar' option has been deprecated.`,`warn`),this._initMessageBox(),this._initMenus(),this._initAccessibility(),this._attachEvents(),this.options.loading&&this.loading(!0),this.options.autoBind&&this.dataSource.fetch(),this.scrollToBottom()}_initUser(){let e=this.options;if(e.authorId){e.authorId=e.authorId.toString();return}e.authorId=this.utilsService.guid()}_initWrapper(){let e=this.options,t=e.height,n=e.width,r=e.headerItems,i=e.headerTemplate,a=`<div ${W.viewWrapper}></div>`;this.wrapper=this.element.addClass(U.wrapper).attr(`dir`,e.dir).append(a),(this._hasHeader||i)&&this.wrapper.prepend(st(r,i)),t&&this.wrapper.css({height:t,minHeight:t}),n&&this.wrapper.css({width:n,minWidth:n})}_initDataSource(){this._refreshHandler=this.refresh.bind(this),this._dataManager=new we({chatOptions:this.options,utilsService:this.utilsService}),this.dataSource=this._dataManager.getDataSource(),this.dataSource.bind(ke,this._refreshHandler)}_unbindDataSource(){this.dataSource.unbind(ke,this._refreshHandler),this._dataManager=null}_initView(){let e=$.extend(!0,{},this.options);delete e.name,this.view=new dt(this.wrapper.find(`[${W.viewWrapper}]`),e,{dataManager:this._dataManager,domUtilsService:this.domUtilsService,htmlService:this.htmlService,dateParserService:this.dateParserService})}_initMessageBox(){let e=$.extend(!0,{},this.options);delete e.name,this.messageBox=new Nt($(`<textarea></textarea>`),e,{chatElement:this.wrapper,utilsService:this.utilsService,domUtilsService:this.domUtilsService})}_initMenus(){let e=this.options.messageActions;this.messageContextMenu=new Pt($(`<ul></ul>`),{dataSource:e})}_initAccessibility(){this.accessibility=new Me({wrapper:this.wrapper,getOptions:()=>this.options,utilsService:this.utilsService}),this.accessibility.setupAriaAttributes(),this.accessibility.setupBubbleTabNavigation()}_attachEvents(){this._commandHandler=new Ft({getUserId:this.getUserId.bind(this),dataItem:this.dataItem.bind(this),fileDataItem:this.fileDataItem.bind(this),removeMessage:this.removeMessage.bind(this),pinMessage:e=>this._dataManager.pinMessage(e),setReplyMessage:(e,t)=>this.messageBox.setReplyMessage(e,t),setCurrentMessageReplyId:e=>{this.currentMessageReplyId=e},setupAriaAttributes:()=>this.accessibility.setupAriaAttributes(),toggleDeleteVisibility:e=>this.messageContextMenu.toggleDeleteVisibility(e),trigger:this.trigger.bind(this)}),this._eventWiring=new It({options:this.options,wrapper:this.wrapper,view:this.view,messageBox:this.messageBox,messageContextMenu:this.messageContextMenu,value:this.value.bind(this),postMessage:this.postMessage.bind(this),clearReplyState:this.clearReplyState.bind(this),commandExecute:this._commandHandler.commandExecute.bind(this._commandHandler),contextMenuExecute:this._commandHandler.contextMenuExecute.bind(this._commandHandler),messageContextMenuOpen:this._commandHandler.messageContextMenuOpen.bind(this._commandHandler),dataItem:this.dataItem.bind(this),scrollToMessage:this.scrollToMessage.bind(this),clearPinnedMessage:this.clearPinnedMessage.bind(this),getPinnedMessage:()=>this._dataManager.getPinnedMessage(),getMessageById:e=>this._dataManager.getMessageById(e),trigger:this.trigger.bind(this),accessibility:this.accessibility,messageBoxRef:this.messageBox}),this._eventWiring.attach(),this.bind(this.events,this.options)}getUserId(){return this.options.authorId}value(e){if(e===void 0)return this.messageBox?.value()||``;this.messageBox&&(this.messageBox.value(e),this.trigger(G.input,{value:e}))}setOptions(t){super.setOptions(t),this.destroy();let n=new e(this.element,this.options);Object.assign(this,n)}setDataSource(e){this.dataSource&&this._unbindDataSource(),this.view.clearMessages(),this.options.dataSource=e,this._initDataSource(),this.options.autoBind&&this.dataSource.fetch(),this.view&&this.view.refreshDataManager(this._dataManager)}postMessage(e){return this.currentMessageReplyId&&(typeof e==`string`&&(e={text:e}),e.replyToId=this.currentMessageReplyId),this._dataManager.postMessage(e,this.getUserId())}removeMessage(e){return this._dataManager.removeMessage(e)}updateMessage(e,t){return this._dataManager.updateMessage(e,t)}getMessageByUid(e){return this._dataManager.getMessageByUid(e)}dataItem(e){return this.view.dataItem(e)}fileDataItem(e,t){return this.view.fileDataItem(e,t)}clearMessages(){this.view.clearMessages()}renderMessage(e){this.view.renderMessage(e),this.accessibility.setupBubbleTabNavigation()}renderPinnedMessage(e){let t=e.authorId===this.getUserId(),n=this.options,r=$(n.messageReferenceTemplate({text:e.text,files:e.files,isDeleted:e.isDeleted,isOwnMessage:t,messages:n.messages,isPinMessage:!0,renderCloseButton:!0,renderFileMenuButton:!1}));this.wrapper.find(`[${W.messageReferencePinWrapper}]`).remove();let i=this.wrapper.find(`.`+U.viewWrapper);i.length?i.prepend(r):this._hasHeader?r.insertAfter(this.wrapper.find(`.`+U.header)):this.wrapper.prepend(r),this.view._initFileMenus(r)}clearPinnedMessage(){this._dataManager.clearPinnedMessage(),this.wrapper.find(`.`+U.messagePinned).remove()}clearReplyState(){this.messageBox.removeReplyMessage(),this.currentMessageReplyId=null}scrollToBottom(){this.view.scrollToBottom()}scrollToMessage(e){return this.view.scrollToMessage(e)}loading(e){if(e===void 0)return this._loading;this._loading=e,this.wrapper&&this.wrapper.toggleClass(U.generating,e),this.messageBox&&this.messageBox.loading(e)}toggleSendButtonGenerating(e){this.loading(e)}refresh(e){let t=this,n=this.options,r=t.dataSource.view(),i=r.find(e=>e.isPinned),a=e?.changedItems||[];if(!e||!e.action){if(r.length===0&&n.noDataTemplate){let e=n.noDataTemplate();t.view.showNoData(e)}else t.view.clearMessages(),r.forEach(e=>{t.renderMessage(e)});t.scrollToBottom()}if(i&&t.renderPinnedMessage(i),e?.action===`sync`){n.noDataTemplate&&!t.view.hasMessages()&&t.view.clearMessages();let e=a.length?a[0]:r[r.length-1];t.renderMessage(e),a.length||t.scrollToBottom()}t.view.renderSuggestedActions(),t.accessibility.setupAriaAttributes(),t.accessibility.setupBubbleTabNavigation()}commandExecute(e){this._commandHandler.commandExecute(e)}messageReply(e){this._commandHandler.messageReply(e)}messageCopy(e){this._commandHandler.messageCopy(e)}messagePin(e){this._commandHandler.messagePin(e)}messageDelete(e){this._commandHandler.messageDelete(e)}messageContextMenuOpen(e){this._commandHandler.messageContextMenuOpen(e)}destroy(){this.dataSource&&=(this._unbindDataSource(),null),this.view&&=(this.view.unbind(),this.view.destroy(),null),this.messageBox&&=(this.messageBox.unbind(),this.messageBox.destroy(),null),this.messageContextMenu&&this.messageContextMenu.destroy(),this.wrapper&&=(this.wrapper.off(),this.wrapper.empty(),null),super.destroy()}},Vt=class extends I{dataItems(){let e=this.dataSource;return e&&typeof e.view==`function`?e.flatView():[]}};Vt.fn=Vt.prototype;var Ht=class{constructor(e,t){this.$=e,this.formatterService=t,this.widgets=[],this.namespaces=new Map}createNamespace(e,t){let n={roles:{},...t};return this.namespaces.set(e,n),n}getNamespace(e){return this.namespaces.get(e)}register(e,t={}){let n=t.namespace||`ui`,r=this.namespaces.get(n);if(!r)throw Error(`Unknown widget namespace: ${n}`);this.registerToNamespace(e,r,t.prefix)}registerToNamespace(e,t,n){let r=e.fn.options.name||e.options?.name;if(!r)throw Error(`Widget must have a name in options`);n||=``,t[r]=e,t.roles[r.toLowerCase()]=e;let i=`getKendo`+n+r,a=`kendo`+n+r;this.createJQueryPlugin(a,e,i);let o={name:a,widget:e,prefix:n};this.widgets.push(o)}getWidget(e,t){if(t)return this.namespaces.get(t)?.[e];for(let t of this.namespaces.values())if(t[e])return t[e]}getWidgetByRole(e,t){let n=e.toLowerCase();if(t)return this.namespaces.get(t)?.roles[n];for(let e of this.namespaces.values())if(e.roles[n])return e.roles[n]}getAllWidgets(){return this.widgets.slice()}getWidgetInstance(e,t){let n=this.$(e),r,i=t?[t]:Array.from(this.namespaces.values());for(let e of i)for(let t in e.roles){let i=e.roles[t],a=`kendo`+(i.fn?.options?.prefix||``)+(i.fn?.options?.name||``);if(r=n.data(a),r)return r}}createJQueryPlugin(e,t,n){let r=this.$,i=this.formatterService,a=Array.prototype.slice;r.fn[e]=function(n){let o=this,s;return typeof n==`string`?(s=a.call(arguments,1),this.each(function(){let t=r.data(this,e),a,c;if(!t)throw Error(i.format(`Cannot call method '{0}' of {1} before it is initialized`,n,e));if(a=t[n],typeof a!=`function`)throw Error(i.format(`Cannot find method '{0}' of {1}`,n,e));if(c=a.apply(t,s),c!==void 0)return o=c,!1})):this.each(function(){return new t(this,n)}),o},r.fn[e].widget=t,r.fn[n]=function(){return this.data(e)}}rolesFromNamespaces(e,t){let n=[],r,i;for(!e[0]&&t&&(e=t),r=0,i=e.length;r<i;r++)n[r]=e[r].roles;return this.$.extend.apply(null,[{}].concat(n.reverse()))}};let Ut={id:`chat`,name:`Chat`,category:`web`,description:`The Chat component.`,depends:[`data`,`draganddrop`,`html.button`,`textarea`,`menu`,`avatar`,`toolbar`,`speechtotextbutton`]};window.kendo.chat={},$.extend(window.kendo.chat,{ChatView:{},Component:{},Components:{},Templates:{},getTemplate:()=>T(F).logToConsole(`The getTemplate method is deprecated. Use one of the built-in templates or append elements manually.`,`warn`),getComponent:()=>T(F).logToConsole(`The getComponent method is deprecated. Use one of the built-in templates or append elements manually.`,`warn`),registerTemplate:()=>T(F).logToConsole(`The registerTemplate method is deprecated. Use one of the built-in templates or append elements manually.`,`warn`),registerComponent:()=>T(F).logToConsole(`The registerComponent method is deprecated. Use one of the built-in templates or append elements manually.`,`warn`)}),T(Ht).register(Bt);var Wt=kendo;e.Chat=Bt,e.__meta__=Ut,e.default=Wt});
//# sourceMappingURL=kendo.chat.min.js.map